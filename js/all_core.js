

/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js from "mergejs_file_list_core.txt" begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


/* Last merge : Wed Feb 10 11:50:14 GMT 2016  */

/* Merging order :

- ../js/systo.js
- ../js/jquery_1.11.3_jquery.min.js
- ../js/jquery-ui_1.11.4_jquery-ui.min.js
- ../js/jquery.xml2json.js
- ../js/formatting.js
- ../js/simulation.js
- ../js/action.js
- ../js/equation.js
- ../js/functions.js
- ../js/FileSaver.js
- ../js/process_query_string.js
- ../js/go.js
- ../js/NodeLabelDraggingTool.js

*/


/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/systo.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


/*jshint loopfunc: true */

// JSHint: 5 Sept 2014 - a couple of issues remaining

var SYSTO = {};
SYSTO.gojs = {};  // Temporary measure, to hold GoJS diagram(s)
SYSTO.models = {};
SYSTO.modelInstances = {};
SYSTO.languages = {};
SYSTO.tutorials = {};
SYSTO.selectedArcs = {};
SYSTO.selectedNodes = {};
SYSTO.node_dialogs = {};
SYSTO.specialVariables = {SIMTIME:true, DT:true};
SYSTO.reservedWords = {SIMTIME:true, DT:true, and:true, or:true, if:true, then:true, else:true, elseif:true};
SYSTO.plugins = {codeGenerator: {}};   // These are not actual jQuery plugins,
        // but they could be...
SYSTO.state = {
    mode: 'pointer',
    currentModelId: null,
    modelInstanceCounter: 0,
    simulationRunSequenceNumber: 0,
    simulationTimings: [{dateTime: 'start', nRuns: 0, cumElapsedTime: 0,
             cumEvaluationTime: 0}], 
        // an array of {dateTime:DATE, nRuns:INTEGER, 
        // cumulativeTime:INTEGER(milliseconds), 
        // averageTime:INTEGER(milliseconds)} objects.
        // Note that there is a separate entry for each run *sequence*, not
        // each run, where a run sequence starts and ends with a slider 
        // start/stop.
    simulationSettings: {
        start_time: 0,
        end_time: 100,
        nstep: 100,
        display_interval: 1,
        integration_method: "euler1"
    }
};
SYSTO.logging = {
    listener_classes: {
        model_modified_event: true, 
        change_model_listener: true, 
        display_listener: true,
        highlight_listener: true},
    triggering_action_exclude: {
        'slide function': true}
};

// ======================================= Initialise

SYSTO.initialise = function () {

    // Make a working copy of each model that has already been loaded using a script.
    for (var modelId in SYSTO.models) {
        var model = SYSTO.models[modelId];
        model.meta.editable = false;
        var modelCopy = JSON.parse(JSON.stringify(model));
        modelCopy.meta.editable = true;
        modelCopyId = modelId+'_copy1';
        modelCopy.meta.id = modelCopyId;
        SYSTO.models[modelCopyId] = modelCopy;
    }
};
        

SYSTO.copyModel = function(modelId, modelCopyId) {
    var model = SYSTO.models[modelId];
    var modelCopy = JSON.parse(JSON.stringify(model));
    modelCopy.meta.id = modelCopyId;
    modelCopy.meta.editable = true;
    modelCopy.meta.copiedFrom = modelId;
    var historyItem = {
        created:new Date(), 
        creationMethod:'copied', 
        copiedFromId:modelId, 
        copiedFromLabel:model.meta.label
    };
    var history = model.meta.history;
    if (history && $.isArray(history)) {
        history.push(historyItem);
    } else {
        history = [historyItem];
    }
    modelCopy.meta.history = history;
    SYSTO.models[modelCopyId] = modelCopy;
};




// ============================================= switchToModel

SYSTO.switchToModel = function (modelId, packageId) {
	if (!packageId) packageId = 'package1';
    console.debug('@log. switchToModel. packageId:'+packageId+'; modelId:'+modelId);

    if (SYSTO.models[modelId]) {
        console.debug('switching...');
        var model = SYSTO.models[modelId];
        if (SYSTO.checkModel) var resultObject = SYSTO.checkModel(model);

        if (!model.workspace) {
            model.workspace = {};
        }
        if (!model.scenarios) {
            SYSTO.createDefaultScenario(model);
        }
        var oldModelId = SYSTO.state.currentModelId;
        SYSTO.state.currentModelId = modelId;
        SYSTO.unselectAllNodes(model);

        SYSTO.saveModelToLocalStorage('current');

        SYSTO.clearResults();
        if (SYSTO.generateSimulationFunction) {
            SYSTO.generateSimulationFunction(model);
        }

        SYSTO.colourFlowNetworks(model);

        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.switchToModel()', 
            event_type: 'message_listener', 
            parameters: {message:'Switching to model <b>' + model.meta.name + ' in package '+packageId+'</b><br/>Description:' + model.meta.description}
        });

        console.debug('triggering...');
        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.switchToModel()', 
            event_type: 'change_model_listener', 
            parameters: {packageId:packageId, oldModelId:oldModelId, newModelId:modelId}
        });

        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.switchToModel()', 
            event_type: 'display_listener', 
            parameters: {packageId:packageId, modelId:modelId}
        });
        return true;

    } else {
        alert('INTERNAL ERROR - not your fault.\n\nFile:     systo.js\nFunction: switchToModel(modelId)\nError:    Model with the specified modelId ('+modelId+') does not exist.');
        return false;
    }
};




SYSTO.prepareModel = function (modelId) {
    console.debug('@log. prepareModel.  modelId:'+modelId);

    if (SYSTO.models[modelId]) {
        var model = SYSTO.models[modelId];
        if (SYSTO.checkModel) {   // This is currently in js/simulation.js
            // No need to check that resultObject.status==='OK', since failure to
            // check that a model is OK is not a fatal eoor.
            var resultObject = SYSTO.checkModel(model);
        }

        if (!model.workspace) {
            model.workspace = {};
        }
        if (!model.scenarios) {
            SYSTO.createDefaultScenario(model);
        }
        var oldModelId = SYSTO.state.currentModelId;
        SYSTO.state.oldModelId = oldModelId;
        SYSTO.state.currentModelId = modelId;
        SYSTO.unselectAllNodes(model);

        SYSTO.saveModelToLocalStorage('current');

        SYSTO.clearResults();
        if (SYSTO.generateSimulationFunction) {
            // No need to check that resultObject.status==='OK', since failure to
            // check that a model is OK is not a fatal eoor.
            resultObject = SYSTO.generateSimulationFunction(model);
        }

        SYSTO.colourFlowNetworks(model);

        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.prepareModel()', 
            event_type: 'message_listener', 
            parameters: {message:'Preparing model with ID <b>' + model.meta.id + '</b> and name <b>' + model.meta.name + '</b><br/>Description:' + model.meta.description}
        });

        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.prepareModel()', 
            event_type: 'change_model_listener', 
            parameters: {packageId:null, oldModelId:oldModelId, newModelId:modelId}
        });

        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.switchToModel()', 
            event_type: 'display_listener', 
            parameters: {packageId:null, modelId:modelId}
        });
        return true;

    } else {
        alert('INTERNAL ERROR - not your fault.\n\nFile:     systo.js\nSYSTO.prepareModel(modelId)\nError:    Model with the specified modelId ('+modelId+') does not exist. in SYSTO.models');
        return false;
    }
};


/*
SYSTO.switchFromToModel = function (oldModelId, newModelId) {
    console.debug('@log. switchFromToModel. oldModelId:'+oldModelId+'  newModelId: '+newModelId);

    var modelId = newModelId;

    if (SYSTO.models[modelId]) {
        var model = SYSTO.models[modelId];
        if (SYSTO.checkModel) var resultObject = SYSTO.checkModel(model);

        if (!model.workspace) {
            model.workspace = {};
        }
        if (!model.scenarios) {
            SYSTO.createDefaultScenario(model);
        }
        SYSTO.state.currentModelId = modelId;
        SYSTO.unselectAllNodes(model);

        SYSTO.saveModelToLocalStorage('current');

        SYSTO.clearResults();
        if (SYSTO.generateSimulationFunction) {
            SYSTO.generateSimulationFunction(model);
        }

        SYSTO.colourFlowNetworks(model);

        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.switchToModel()', 
            event_type: 'message_listener', 
            parameters: {message:'Switching to model <b>' + model.meta.name +'</b><br/>Description:' + model.meta.description}
        });

        console.debug('triggering...');
        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.switchToModel()', 
            event_type: 'change_model_listener', 
            parameters: {oldModelId:oldModelId, newModelId:newModelId}
        });

        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.switchToModel()', 
            event_type: 'display_listener', 
            parameters: {modelId:modelId}
        });
        return true;

    } else {
        alert('INTERNAL ERROR - not your fault.\n\nFile:     systo.js\nFunction: switchToModel(modelId)\nError:    Model with the specified modelId ('+modelId+') does not exist.');
        return false;
    }
};
*/


// Retained for legacy reasons.   Intention is to use SYSTO.prepareModel,
// keeping SYSTO.swicthToModel for simple switching (not initialising).

SYSTO.switchFromToModel = function (oldModelId, newModelId) {
    console.debug('@log. switchFromToModel. oldModelId:'+oldModelId+'  newModelId: '+newModelId);

    var modelId = newModelId;

    if (SYSTO.models[modelId]) {
        var model = SYSTO.models[modelId];
        if (SYSTO.checkModel) var resultObject = SYSTO.checkModel(model);

        if (!model.workspace) {
            model.workspace = {};
        }
        if (!model.scenarios) {
            SYSTO.createDefaultScenario(model);
        }
        SYSTO.state.currentModelId = modelId;
        SYSTO.unselectAllNodes(model);

        SYSTO.saveModelToLocalStorage('current');

        SYSTO.clearResults();
        if (SYSTO.generateSimulationFunction) {
            SYSTO.generateSimulationFunction(model);
        }

        SYSTO.colourFlowNetworks(model);

        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.switchToModel()', 
            event_type: 'message_listener', 
            parameters: {message:'Switching to model <b>' + model.meta.name +'</b><br/>Description:' + model.meta.description}
        });

        console.debug('triggering...');
        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.switchToModel()', 
            event_type: 'change_model_listener', 
            parameters: {oldModelId:oldModelId, newModelId:newModelId}
        });

        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.switchToModel()', 
            event_type: 'display_listener', 
            parameters: {modelId:modelId}
        });
        return true;

    } else {
        alert('INTERNAL ERROR - not your fault.\n\nFile:     systo.js\nFunction: switchToModel(modelId)\nError:    Model with the specified modelId ('+modelId+') does not exist.');
        return false;
    }
};



// =======================================  Action-related methods - undo, redo...

SYSTO.undoAction = function (model) {

    if (SYSTO.tutorials && SYSTO.state.tutorial === 'running') {
        alert('Sorry - you cannot use Undo during a tutorial.\n'+
                'Instead, use the Back button in the tutorial panel.');
        return;
    }

    if (!model.previousAction) {
        alert('Nothing to undo.');
        return;
    }
    if (model.previousAction === 'undo') {
        if (model.currentActionIndex === 1) {
            alert('You cannot undo past the first action.');
            return;
        }
        model.currentActionIndex -= 1;
    }
    var action = model.actionArray[model.currentActionIndex];
    action.undoAction();
    model.previousAction = 'undo';
};



SYSTO.redoAction = function (model) {

    if (SYSTO.tutorials && SYSTO.state.tutorial === 'running') {
        alert('Sorry - you cannot use Redo during a tutorial.\n'+
                'Instead, use the Forwad button in the tutorial panel.');
        return;
    }

    if (!model.previousAction) {
        alert('Nothing to redo.');
        return;
    }
    if (model.previousAction === 'redo') {
        if (model.currentActionIndex === model.actionArray.length-1) {
            alert('You cannot redo past the most recent action.');
            return;
        }
        model.currentActionIndex += 1;
    }
    var action = model.actionArray[model.currentActionIndex];
    action.doAction();
    model.previousAction = 'redo';
    SYSTO.saveModelToLocalStorage('current');
};



// ================================================ Model handling

// Create new model, and return its ID
// OK, I know this is not the way to do it - I should be using a constructor:
//    var model1 = new Model();
// and/or using a custom pub-sub mechanism.
// But this will do for the time being, until I sort out a proper object-based
// approach,

SYSTO.createNewModel = function (languageId) {
    var modelId = SYSTO.getUID();
    SYSTO.state.currentModelId = modelId;
    SYSTO.models[modelId] = {
        meta:{
            language:languageId,
            name:'noname',
            id:modelId},
        nodes:{},
        arcs:{},
        workspace:{},
        results:{},
        resultStats:{}
    };
    SYSTO.createDefaultScenario(SYSTO.models[SYSTO.state.currentModelId]);
    return modelId;
};


SYSTO.createNewModel_1 = function (parameters) {
    var action;
    var file;
    var instructions;
    var languageId;
    var modelId;

    if (parameters.file) {
        file = parameters.file;
    } else {
        file = 'no file specified';
    }

    if (parameters.action) {
        action = parameters.action;
    } else {
        action = 'no action specified';
    }

    if (parameters.instructions) {
        instructions = parameters.instructions;
    } else {
        instructions = '<b>Start a new model</b><br/>Use the stock, variable, flow and influence buttons in the toolbar to start making your model diagram.';
    }

    if (parameters.languageId) {
        languageId = parameters.languageId;
    } else {
        alert('INTERNAL ERROR - not your fault!\n\nError is: "No language specified while trying to create new model in SYSTO.createNewModel_1"');
        return {status:'failed', message:'SYSTO_createNewModel_1: no languageId specified.'};
    }

    if (parameters.modelId) {
        modelId = parameters.modelId;
    } else {
        modelId = SYSTO.getUID();
    }

    console.debug('=====');
    console.debug(SYSTO.models);
    if (parameters.baseName) {
        var modelName = SYSTO.makeUniqueModelName(parameters.baseName);
    } else {
        modelName = SYSTO.makeUniqueModelName('noname');
    }

    SYSTO.revertToPointer();
    SYSTO.trigger({
        file:file, 
        action:'Clicked on the New button', 
        event_type: 'message_listener', 
        parameters: {message:instructions}});
    SYSTO.state.currentModelId = modelId;
    var model = {
        meta:{
            language:languageId,
            name:modelName,
            id:modelId},
        nodes:{},
        arcs:{},
        workspace:{}
    };

    SYSTO.models[SYSTO.state.currentModelId] = model;
    model.actionArray = [];
    model.actionArray[0] = 'start';
    model.currentAction = null;     // Should only need one of these (i.e. the action object
    model.currentActionIndex = 0;   // itself, or its array index).
    model.previousAction = 'none';
    model.selectedNodes = [];
    model.deletedNodeList = {};
    model.deletedArcList = {};
    SYSTO.createDefaultScenario(model);
    delete SYSTO.results;
    delete SYSTO.resultStats;
    delete SYSTO.resultsBase;
    delete SYSTO.resultStatsBase;

    SYSTO.trigger({
        file:file, 
        action:action, 
        event_type: 'add_new_model_listener', 
        parameters: {newModelId:SYSTO.state.currentModelId}});

    SYSTO.trigger({
        file:file, 
        action:action, 
        event_type: 'change_model_listener', 
        parameters: {oldModelId:'',newModelId:SYSTO.state.currentModelId}});

    SYSTO.trigger({
        file:file, 
        action:action, 
        event_type: 'display_listener', 
        parameters: {
            packageId:SYSTO.state.currentPackageId,
            modelId:SYSTO.state.currentModelId
        }
    });
    return {status:'OK', modelId:modelId};
};



SYSTO.createDefaultScenario = function (model) {
    console.debug('@log function(SYSTO.createDefaultScenario(model) - start');
    model.scenarios = {
        default:{
            simulation_settings:{
                start_time: 0,
                end_time: 100,
                nstep: 100,
                display_interval: 1,
                integration_method: 'euler1'
            }
        }
    };
};



// This function takes a propsed model name (name, not ID), looks to see if it is already
// loaded (i.e. in SYSTO.models), and generates a new one by adding on the next available integer
// to the proposed name (the baseName).

SYSTO.makeUniqueModelName = function (baseName) {
    if (!SYSTO.modelNameExists(baseName)) {
        console.debug('..... '+baseName+' OK');
        return baseName;
    }
    for (var i=1; i<9999; i++) {
        var newName = baseName+'_'+i;
        if (!SYSTO.modelNameExists(newName)) {
            console.debug('.......... '+newName+'created OK');
            return newName;
        }
    }
};


SYSTO.modelNameExists = function (modelName) {
    for (modelId in SYSTO.models) {
        var model = SYSTO.models[modelId];
        if (modelName === model.meta.name) return true;
    }
    return false;
};



// =================================== Scenario handling

SYSTO.storeScenario = function (modelId, scenarioId) {

    var model = SYSTO.models[modelId];
    alert('***1');
    model.scenarios[scenarioId]  = {simulation_settings:{}, nodes:{}};
    var scenario = model.scenarios[scenarioId];
    for (var nodeId in model.nodes) {
        if (model.nodes.hasOwnProperty(nodeId)) {
            var modelNode = model.nodes[nodeId];
            if (isParameter(modelNode)) {
                value = modelNode.workspace.jsequation;
                scenario.nodes[nodeId] = {value:value};
            }
        }
    }   
};




SYSTO.switchToScenario = function (modelId, scenarioId) {

    var model = SYSTO.models[modelId];
    var scenario = model.scenarios[scenarioId];
    if (scenario) {
        for (var nodeId in scenario.nodes) {
            if (scenario.nodes.hasOwnProperty(nodeId)) {
                var scenarioNode = scenario.nodes[nodeId];
                var modelNode = model.nodes[nodeId];
                modelNode.workspace.jsequation = scenarioNode.value;
            }
        }   
        SYSTO.trigger({
            file:'systo.js', 
            action:'SYSTO.switchToScenario()', 
            event_type: 'change_scenario_listener', 
            parameters: {packageId:'package1', modelId:modelId, oldScenarioId:'',newScenarioId:'base'}
        });
    } else {
        alert('ERROR in function SYSTO.retrieveScenario:\n\nTrying to retrieve scenario "'+scenarioId+'", but it does not exist.');
    }
};

// =================================== Adding reverse lookups, for efficiency

// TODO: Add in something similar for node labels (see SYSTO.isNodelabel() below)

// The job of this function is to assign, for each node, its inarcs and outarcs to its
// inarcList and outarcList properties respectively.   This violates the DRY (Don't Repeat 
// Yourself) principle, but it greatly improves the efficiency of finding arcs 
// associated with each node.
// Note that the method works by looping over all arcs, picking up the start and end nodes,
// then assigning that arc to the respective inarcList and outarcList properties.   This is
// far more efficient than loping over all nodes, then looping over all arcs to see which ones
// are associated with that node.

function assignInarcsAndOutarcsForEachNode(model) {
    var arcList,
        endNode,
        nodeList,
        startNode;

    nodeList = model.nodes;
    arcList = model.arcs;

    $.each(nodeList, function(nodeId, node) {
        node.inarcList = {};
        node.outarcList = {};
    });

    $.each(arcList, function(arcId, arc) {
        startNode = nodeList[arc.start_node_id];
        endNode = nodeList[arc.end_node_id];
        startNode.outarcList[arcId] = arc;
        endNode.inarcList[arcId] = arc;
    });
}


SYSTO.getNodeInfluences = function (model, node) {
    var nodeList = model.nodes;
    var arcList = model.arcs;

    var influences = {};

    $.each(arcList, function(arcId, arc) {
        if (arc.type === 'influence' && arc.end_node_id === node.id) {
            influences[arc.start_node_id] = nodeList[arc.start_node_id];
        }
    });
    return influences;
};



// =============================== Rounding

function quickRound(value) {
    for (var i=0; i<10; i++) {
        var tens = Math.pow(10,i);
        roundedValue = Math.floor(Math.round(value*tens))/tens;
        if (Math.abs(1-roundedValue/value) < 0.0001) {
            return roundedValue;
        }
    }
    return value;
}


// Derived from the old Presto QROUND() subroutine!
// Does a reasonable job, but could do with setting the min value (bmin) to be consistent
// with the interval (bint).    Sometimes you get bmin of (say) 1.3 with an interval of 0.2.
// Note that, unlike most of the solutions you across when doing a search, this solution 
// calculates the number of intervals, rather than having that as a user-defined input.
// Robert note to himself: There's a test implementation in Systo_extra/qround

SYSTO.myRound = function(amin, amax) {
    var kint = [[0,0],
                [10,0.1],[10,0.2],[6,0.5],[8,0.5],[10,0.5],[6,1],[7,1],[8,1],[9,1],[10,1],
                [6,2],[6,2],[7,2],[7,2],[8,2],[8,2],[9,2],[9,2],[10,2],[10,2],
                [6,4],[6,4],[6,4],[6,4],[7,4],[7,4],[7,4],[7,4],[10,3],[10,3],
                [8,4],[8,4],[9,4],[9,4],[9,4],[9,4],[10,4],[10,4],[10,4],[10,4],
                [7,5],[7,5],[9,5],[9,5],[9,5]];
    if (amin === amax) return {};
    aamin = amin;
    aamax = amax;
    if (amin>0 && amin/amax<0.2) amin = 0;
    if (amax<0 && amax/amin<0.2) amax = 0;
    var adiff = amax-amin;
    var i = Math.floor(Math.log(Math.abs(adiff/2))/Math.LN10);
    //if (adiff<1) i = i-1;  // In original Presto, but seems to give wrong values 
    var p = Math.pow(10,i+5)/100000;
    var imin = Math.floor(amin/p);
    var imax = Math.floor(amax/p);
    //if (amax>0 && imax*p<amax) imax += 1;
    if (imax*p<amax) imax += 1;
    if (amin<0 && imin*p>amin) imin -= 1;
    var idiff = imax-imin;
    //var nint = kint[idiff][1];
    var bmin = imin*p;
    var bmax = imax*p;
    var bdiff = bmax-bmin;
    //var nbint = kint[idiff][0];
    var nbint = kint[idiff][0];
    //var bint = bdiff/nbint;
    bint = kint[idiff][1]*p;
    bmax = bmin + nbint*bint;
    return {amin:aamin, amax:aamax, i:i, p:p, imin:imin, imax:imax, idiff:idiff, bmin:bmin, bmax:bmax, nbint:nbint, bint:bint};
};



// From Paul Heckbert's article "Nice Numbers for Graph Labels" on Graphics Gems.
// http://books.google.com/books?id=fvA7zLEFWZgC&pg=PA61&lpg=PA61#v=onepage&q&f=false


SYSTO.niceAxisNumbering = function (amin, amax, ntick) {
    var nfrac;  // number of fractional digits to show
    var d;      // tick mark spacing
    var graphmin, graphmax;
    var range, x;
    var axisValues = [];

    if (amin>0 && amin/amax < 0.5) amin = 0;   // My fudge, to show origin when appropriate.

    range = SYSTO.niceNum(amax-amin, false);
    d = SYSTO.niceNum(range/(ntick-1), true);
    graphmin = Math.floor(amin/d)*d;
    graphmax = Math.ceil(amax/d)*d;
    nfrac = Math.max(-Math.floor(Math.log(d)/Math.LN10),0);
    
    
    for (x=graphmin; x<=graphmax+0.5*d; x+=d) {
        axisValues.push(x);
    }
    return axisValues;
};



SYSTO.niceNum = function(x, makeRound) {
    var exp_x; // exponent of x
    var f;     // fractional part of x;
    var nf;    // nice, rounded fraction
    
    exp_x = Math.floor(Math.log(x)/Math.LN10);
    f = x/Math.pow(10, exp_x);
    if (makeRound) {
        if (f<1.5) {
            nf = 1;
        } else if (f<=3) {
            nf = 2;
        } else if (f<=7) {
            nf = 5;
        } else {
            nf = 10;
        }
    } else {
        if (f<1) {
            nf = 1;
        } else if (f<=2) {
            nf = 2;
        } else if (f<=5) {
            nf = 5;
        } else {
            nf = 10;
        }
    }        
    return nf*Math.pow(10, exp_x);
};



// ============================== COORDINATE CONVERSIONS ======================

// The following is a useful link for general issues about getting window sizes etc:
// http://www.howtocreate.co.uk/tutorials/javascript/browserwindow

// There is quite a lot of stuff out there on getting mouse coordinates in a canvas 
// (or, more generally, an HTML element, typically a div) from the event properties.
// It's generally recognised as being a messy problem, since there is (or seems to be)
// no standard method whoch works across all browsers for simply getting the coordinates
// of a mouse event in a particular HTML element.

// The following is pasted here as a reminder about document.body.scroll(Left,Top) - could
// be required if I ever allow scrolling of elements inside <body>.
// x = window.pageXOffset - containerPos.left + 0*document.body.scrollLeft + evt.clientX;
// y = window.pageYOffset - containerPos.top + 0*document.body.scrollTop + evt.clientY;
// In current tests:
//    window.pageXOffset equals document.body.scrollLeft, and
//    window.pageYOffset equals document.body.scrollTop.

// The following function gets the canvas coordinates (i.e. with the top-left corner being 0,0) from
// the mouse event properties.    It allows for 3 different methods, with the actual method
// used being determined by a SYSTOGRAM.diagramMeta.canvasPointMethod:
// 'eventClient' - uses evt.clientX, evt.clientY
// 'eventOffset' - uses evt.offsetX, evt.offsetY
// 'eventLayer'  - uses evt.layerX, evt.layerY

// The 3 methods are made available so that it will be easy to provide a preferences setting
// to switch between them, in case a particular browser does not support one or the other.
// Obviously, I should be checking that the properties being used are available in the
// user's browser., and allowing for an automatic fall-back to an alternative method if necessary.

SYSTO.eventToElementCoords = function(method, evt, canvas) {

    var canvasx;
    var canvasy;

    var canvasPointMethod = method;

    if (canvasPointMethod === 'eventClient') {
        containerPos = getContainerPos(canvas);
        canvasx = window.pageXOffset - containerPos.left + evt.clientX;
        canvasy = window.pageYOffset - containerPos.top + evt.clientY;

    } else if (canvasPointMethod === 'eventOffset') {
        canvasx = evt.offsetX;
        canvasy = evt.offsetY;

    } else if (canvasPointMethod === 'eventLayer') {
        containerPos = getContainerPos(canvas);
        canvasx = evt.layerX - containerPos.left;
        canvasy = evt.layerY - containerPos.top;
    }

    return {x: canvasx, y: canvasy};


    function getContainerPos(canvas){
        var obj = canvas;
        var top = 0;
        var left = 0;
        while (obj.tagName !== "BODY") {
            top += obj.offsetTop;
            left += obj.offsetLeft;
            obj = obj.offsetParent;
        }
        return {
            left: left,
            top: top
        };
    }
};




// ====================================== Utilities

// Would you believe it?   You need to do this, since "if (obj === {})" doesn't work,
// and other proposed solutions are flaky/browser-dependent.

function isEmpty(obj) {
    for(var prop in obj) {
        if(obj.hasOwnProperty(prop))
            return false;
    }
    return true;
}




function isNumericConstant(value) {
    if (value) {
        return !isNaN(parseFloat(value)) && isFinite(value);
    } else {
        return false;
    }
}


SYSTO.a_or_an = function (string) {
    if (/[aeiou]/.test(string.charAt(0))) {
        return 'an';
    } else {
        return 'a';
    }
};


function isNumericArray(equation) {
    try{
        var term = JSON.parse(equation);
        if (jQuery.isArray(term)) {
            var len = term.length;
            for (var i=0; i<len; i++) {
                if (!isNumericConstant(term[i])) {
                    return false;
                }
            }         
        } else {
            return false;
        }
        return true;
    }catch(e){
        return false;
    }
}

function isParameter(node) {
    var equation = getEquation(node);
    if (node.type === 'variable' || node.type === 'valve') {
        if (isNumericConstant(equation) || isNumericArray(equation)) {
            return true;
        }
    }
    return false;
}



SYSTO.isNodeLabel = function (model, word) {
    var nodeList = model.nodes;
    var ok = false;
    for (var nodeId in nodeList) {
        if (nodeList.hasOwnProperty(nodeId)) {
            var node = nodeList[nodeId];
            if (word === node.label) {
                ok = true;
                break;
            }
        }
    }
    return ok;
};
/*
SYSTO.isNodeLabel = function (model, word) {
    var nodeList = model.nodes;
    var ok = false;
    $.each(nodeList, function(nodeId, node) {
        if (word === node.label) {
            ok = true;
            break;
        }
    }
    return ok;
};
*/



SYSTO.numberOfProperties = function (object) {
    var nProperties = 0;
    for (var propertyId in object) {
        if (object.hasOwnProperty(propertyId)) {
            nProperties += 1;
        }
    }
    return nProperties;
};



SYSTO.nProperties = function(object) {
    var nProps = 0;
    $.each(object, function(prop, value) {
        nProps += 1;
    });
    return nProps;
};



SYSTO.findNodeIdFromLabel = function(model, nodeLabel) {
    if (!model.workspace) {
        model.workspace = {};
    }
    if (!model.workspace.lookupNodeIdFromLabel) {
        model.workspace.lookupNodeIdFromLabel = {};
        for (var nodeId in model.nodes) {
            var node = model.nodes[nodeId];
            model.workspace.lookupNodeIdFromLabel[node.label] = nodeId;
        }
    }
    return model.workspace.lookupNodeIdFromLabel[nodeLabel];
};

// ======================================================== SYSTO.getUID()

// Note; lowercase L and number 1 left out, to avoid confusion.
SYSTO.cs = 'abcdefghijkmnopqrstuvwxyz023456789'.split('');

SYSTO.getUID = function () {
    var d = new Date();
    var n = d.getTime()-1395000000000;
    var UID = '';
    for (var i=7;i>=0;i--) {
        var j = Math.pow(34,i);
        var k = Math.floor(n/j);
        n -= k*j;
        UID += SYSTO.cs[k];
        if (i === 4) UID += '_';
    }
    return UID;
};



// =============================== Functions for managing node selection

// 5 Feb 2014 This used to be in jquery.diagram.js, but has now been moved 
// here since selecting a node is not necessarily restricted to the diagram
// widget.
// For example, one might also have an equation-listing widget open at the 
// same time.

SYSTO.addSelect = function  (model, node, ctrlKey) {
    if (!ctrlKey) {
        SYSTO.clearSelection(model);
    }
    node.select_state = 'selected';
    SYSTO.selectedNodes[node.id] = node;   // TODO: Make this separate for each model
    SYSTO.trigger({
        file:' systo.js', 
        action: 'SYSTO.addSelect()', 
        event_type: 'model_modified_event', 
        parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
    });
    SYSTO.trigger({
        file:' systo.js', 
        action: 'SYSTO.addSelect()', 
        event_type: 'node_selected_listener', 
        parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id, nodeId:node.id}
    });
};


SYSTO.unSelect = function (model, node) {
    node.select_state = 'normal';
    delete SYSTO.selectedNodes[node.id];     // TODO: Make this separate for each model
    SYSTO.trigger({
        file:' systo.js', 
        action: 'SYSTO.unSelect()', 
        event_type: 'model_modified_event', 
        parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
    });
};



SYSTO.addSelectArc = function  (model, arc, ctrlKey) {
    if (!ctrlKey) {
        SYSTO.clearSelection(model);
    }
    arc.select_state = 'selected';
    SYSTO.selectedArcs[arc.id] = arc;   // TODO: Make this separate for each model
    SYSTO.trigger({
        file: 'systo.js', 
        action: 'SYSTO.addSelectArc()', 
        event_type: 'model_modified_event', 
        parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
    });
};



SYSTO.unSelectArc = function (model, arc) {
    arc.select_state = 'normal';
    delete SYSTO.selectedArcs[arc.id];     // TODO: Make this separate for each model
    SYSTO.trigger({
        file: 'systo.js', 
        action: 'SYSTO.unSelectArc()', 
        event_type: 'model_modified_event', 
        parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
    });
};



SYSTO.clearSelection = function (model) {

    $.each(model.nodes, function(nodeId, node) {
        node.select_state = 'normal';
    });
    $.each(model.arcs, function(arcId, arc) {
        arc.select_state = 'normal';
    });

    SYSTO.selectedNodes = {};
    SYSTO.selectedArcs = {};

    SYSTO.trigger({
        file: 'systo.js', 
        action: 'SYSTO.clearSelection()', 
        event_type: 'model_modified_event', 
        parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
    });
};




// Adapted from the code used in Systogram

SYSTO.deleteSelect = function (model) {
    var arc;
    var arcId;
    var arcList = model.arcs;
    var deletedArcList = {};
    var deletedNodeList = {};
    var node;
    var nodeId;
    var nodeList = model.nodes;

    markSelectedAndDependants(model);
    
    $.each(nodeList, function(nodeId, node) {
        if (node.marked_for_deletion) {
            delete node.marked_for_deletion;
            deletedNodeList[nodeId] = node;
        }
    });

    $.each(arcList, function(arcId, arc) {
        if (arc.marked_for_deletion) {
            delete arc.marked_for_deletion;
            deletedArcList[arcId] = arc;
        }
    });

    action = new Action(model, 'delete_selected', 
            {deleteNodeList:deletedNodeList, deleteArcList:deletedArcList});
    action.doAction();
};



// Marking selected nodes and arcs, and their dependants.

function markSelectedAndDependants(model) {
    var arc;
    var arcList = model.arcs;
    var node;
    var nodeList = model.nodes;
    var language = SYSTO.languages[model.meta.language];
    var nodeTypeList = language.NodeType;

    // Associate an arc with an internode.   We do this because an arc records
    // its internode, while (to avoid duplication) we do not store the internode's
    // arcwith that node.   So this is really a local operation.
    $.each(arcList, function(arcId, arc) {
        if (arc.node_id) nodeList[arc.node_id].arc_id = arcId;
    });

    // Mark any selected node(s) for deletion.
    $.each(SYSTO.selectedNodes, function(nodeId, node) {
        node.marked_for_deletion = true;
        if (node.arc_id) {
            var arc = arcList[node.arc_id];
            arc.marked_for_deletion = true;
        }
    });
    $.each(SYSTO.selectedArcs, function(arcId, arc) {
        arc.marked_for_deletion = true;
    });

    // This section deletes all arcs which are missing a node at one or both ends.
    // It does this repeatedly, since deleting an arc may in turn cause another
    // arc to be missing a node at one end.
    // I use a standard 'for' loop, rather than a seemingly more appropriate
    // 'while' or 'do-while' loop, to ensure that we don't get into an infinite loop
    // for some reason.   We break out of the loop if we don't pick up any rcs during
    // an iteration (i.e. nArcDeleted === 0).
    for (var iteration = 0; iteration <10; iteration ++) {
        var nArcDeleted = 0;
        for (var arcId in arcList) {
            if (arcList.hasOwnProperty(arcId)) {
                var arc = arcList[arcId];
                var startNode = nodeList[arc.start_node_id];
                var endNode = nodeList[arc.end_node_id];
                if (startNode.marked_for_deletion || endNode.marked_for_deletion) {
                    arc.marked_for_deletion = true;
                    if (arc.node_id) {
                        nodeList[arc.node_id].marked_for_deletion = true;
                    }
                    nArcDeleted += 1;
                }
            }
        }
        if (nArcDeleted === 0) {
            break;
        }
    }

    // Tidy up loose ends - mark any orphan nodes.
    // An example of an orphan node is a 'cloud' which does not have any other
    // flows associated with it (apart from the one that has just been deleted).
    // We do this here, rather than as part of the process of deleting an arc, to
    // avoid getting into potential circular loops.
    // Note that a node should have  property (defined in the model language) which
    // says whether it is eligible for deletion at this time.   In the absence of such
    // a property, I take the has_label property (false) as a surrogate.
    // This section is heavily iterative, basically executing nNode x nArc times.
    // The only way to avoid this is to give each node an array of inarcs and an
    // array of outarcs...
    $.each(nodeList, function(nodeId, node) {
        if (node.arc_id) delete node.arc_id;
        var nodeTypeId = node.type;
        var nodeType = nodeTypeList[nodeTypeId];
        if (nodeType.has_label === false) {
            var deleteThisNode = true;
            $.each(arcList, function(arcId, arc) {
                if (arc.marked_for_deletion) {
                    return true;
                }
                if (arc.start_node_id === node.id || arc.end_node_id === node.id) {
                    deleteThisNode = false;
                    return false;
                }
            });
            if (deleteThisNode) {
                node.marked_for_deletion = true;
            }
        }
    });
}



SYSTO.unselectAllNodes = function (model) {
    for (var nodeId in model.nodes) {
        if (model.nodes.hasOwnProperty(nodeId)) {
            var node = model.nodes[nodeId];
            node.select_state = 'normal';
        }
    }
};




SYSTO.revertToPointer = function () {
    SYSTO.state.mode = 'pointer';
    var model = SYSTO.models[SYSTO.state.currentModelId];
    SYSTO.clearSelection(model);
    SYSTO.trigger({
        file: 'systo.js', 
        action: 'SYSTO.revertToPointer()', 
        event_type: 'revert_to_pointer_listener',
        parameters: {}
    });
    SYSTO.trigger({
        file:'systo.js', 
        action:'revertToPointer() called', 
        event_type: 'message_listener', 
        parameters: {message:''}});
};





// =========================================== SYSTO.trigger - replaces individual trigger() calls



/* 
Example:
    SYSTO.trigger({
        file:'jquery.local_load.js', 
        action:'function loadModel()', 
        event_type: 'change_model_listener', 
        parameters: {oldModelId:oldModelId, newModelIdnewModelId}
    });

Template:
    SYSTO.trigger({
        file:'trigger.js', 
        action:'triggeraction', 
        event_type: 'my_custom_event', 
        parameters: {}
    });
*/


// TODO: Change the names of the custom events (from ...._listener to something more appropriate) 
//       once all the changes made.


// args can have the following properties:
// - file: the file in which the triggering call is made (string, optional)
// - action: the cation (typically, a function name) which triggers the custom event (string, optional);
// - event_type: the name of the custom event (string, required);
// - parameters: the custom-event-type-specific set of parameters (object)
//               Whether this argument is required is dependent on the custom event.


SYSTO.trigger = function (args) {
    //console.log('#log. SYSTO.trigger  args='+JSON.stringify(args));
    if (args && args.event_type) {
        // Checks to see if we should be logging this trigger
        //if (SYSTO.logging.listener_classes[args.listener_class] &&
        //    !SYSTO.logging.action_exclude[args.action]) {
        //    //console.debug('@log. trigger: '+JSON.stringify(args,null,4));
        //}
        if (args.event_type === 'click' && args.listener_class) {   // Old method - probably now obsolete
            $('.'+args.listener_class).trigger('click', args.parameters);
            $(document).trigger(args.listener_class, args.parameters);
        } else {                                                   // New (Dec 2014) method
            //console.debug('@log. trigger: '+args.file+': '+args.action+': '+args.event_type);
            if (!SYSTO.trigger_log) SYSTO.trigger_log = [];
            SYSTO.trigger_log.push(args);
            $('.'+args.event_type).trigger('click', args.parameters); // Probably now obsolete
            $(document).trigger(args.event_type, args.parameters);
        }
    } else {
        console.debug('@log. ERROR: - SYSTO.trigger(): unrecognised event_type.\n'+JSON.stringify(args));
    }
};




// =============================================== SYSTO.makeModelGallery()

SYSTO.makeModelGallery = function (galleryModels) {
            for (var i=0; i<galleryModels.length; i++) {
                console.debug('\n\n\n=================================== makeModelGallery()');
                var j = i+1;
                var packageId = 'package'+j;
                var galleryModel = galleryModels[i];
                var modelId = galleryModel.modelId;
                //SYSTO.generateSimulationFunction(model);
                SYSTO.switchToModel(modelId, packageId);
                var model = SYSTO.models[modelId];

                $('#maintable').append(
                    '<tr>'+
                        '<td id="'+modelId+'_description" class="maintd" style="min-width:200px;"><b>'+galleryModels[i].title+'</b><br/>'+galleryModels[i].description+'</td>'+
                        '<td class="maintd"><div id="'+modelId+'_diagram" style="max-height:200px;"></div></td>'+
                        '<td class="maintd"><div id="'+modelId+'_sliders" style="width:350px; height:200px; overflow-y:auto; overflow:x:hidden;""></div></td>'+
                        '<td class="maintd"><div id="'+modelId+'_plotter" style="float:left; position:relative; margin:1px; width:300px; height:200px;"></div></td>'+
                        '<td class="maintd"><div id="'+modelId+'_equations" style="height:200px; width:400px; overflow:auto;"></div></td>'+
                    '</tr>');

                // diagram widget
                $('#'+modelId+'_diagram').diagram({
                    packageId: packageId,
                    modelId:modelId, 
                    initialZoomToFit: true,
                    allowEditing:true}).
                    resizable();

                // multiple_sliders widget
                $('#'+modelId+'_sliders').multiple_sliders({
                    packageId: packageId,
                    modelId:modelId
                });

                // plotter widget
                $('#'+modelId+'_plotter').plotter({
                    allowChangeOfModel:false,
                    packageId: packageId,
                    modelId:modelId,
                    canvasWidth:100, 
                    canvasHeight:100,
                    selectNode:function (node) {
                        if (node.type === 'stock') {
                            return true;
                        } else {
                            return false;
                        }
                    }
                });

                // equation_listing widget
                $('#'+modelId+'_equations').equation_listing({
                    packageId: packageId,
                    modelId:modelId
                });

                SYSTO.switchToModel(modelId, packageId);

                resultsObject = SYSTO.simulate(model);
                // Temporary measure.
                SYSTO.results = resultsObject.results;
                SYSTO.resultStats = resultsObject.resultStats;

                model.results = resultsObject.results;
                model.resultStats = resultsObject.resultStats;
                
                SYSTO.trigger({
                    file: 'systo.js',
                    action: 'makeModelGallery()',
                    event_type: 'display_listener',
                    parameters: {packageId:packageId, modelId:modelId, nodeId:null, value: null}
                });
            }
};




// =================================================== Model saving

SYSTO.saveModelToLocalStorage = function (modelId) {
    if (!modelId) return;

    if (modelId === 'current') {
        modelId = SYSTO.state.currentModelId;
        saveModelId = 'current';
    } else {
        saveModelId = modelId;
    }

    // Do not save changed demo models - miniworld, predator_prey_shodor or cascade.
    // This is to avoid confusing people using SystoLite who play around with one of these 3 provided
    // demo models, and then are surprised that that the model is different when they start up
    // SystoLite again - i.e. it's the model loaded from local storage, not the one hard-wired into
    // SystoLite.
    // TODO: recocnsider how to handle this situation.
    if (modelId==='miniworld' || modelId==='predator_prey_shodor' || modelId==='cascade') {
        return;
    }
        
    console.debug('@log. saveModelToLocalStorage: '+modelId+', '+saveModelId);

    var model = SYSTO.models[modelId];
    if (!model) return;

    var preparedModel = SYSTO.prepareModelForSaving(model, false);

    localStorage.setItem('SYSTO_MODEL_'+saveModelId, JSON.stringify(preparedModel));
};


// This removes unwanted properties (e.g. a nodes inArcs and outArcs) prior 
// to saving.    Note that this operation is already done in specific saving
// functions: the idea now is that this is done in one place, to ensure 
// consistency and to reduce duplicate code.  So the similar code elsewhere
// should be refactored to use this function.
// Potentially, this function can be further developed to not save properties
// which are the same as in the model's language.
// Note that we return the model object rather than the model string, even though
// it's probably the string that is going to be save, to allow for further 
// inspection or analysis if required.

SYSTO.prepareModelForSaving = function (model, replaceParamValues) {
    if (!model.scenarios) {
        alert('***3');
        model.scenarios = {
            default:{
                simulation_settings:{
                    start_time: 0,
                    end_time: 100,
                    nstep: 10,
                    display_interval: 1,
                    integration_method: 'euler'
                }
            }
        };
    }
    var nodes1 = {};
    $.each(model.nodes, function(nodeId, node) {
        nodes1[nodeId] = {
            id:node.id,
            type:node.type,
            label:node.label,
            centrex:node.centrex,
            centrey:node.centrey,
            text_shiftx:node.text_shiftx,
            text_shifty:node.text_shifty,
            extras:node.extras
        };
    });

    var arcs1 = {};
    $.each(model.arcs, function(arcId, arc) {
        arcs1[arcId] = {
            id:arc.id,
            type:arc.type,
            label:arc.label,
            start_node_id: arc.start_node_id,
            end_node_id: arc.end_node_id,
            curvature: arc.curvature,
            along: arc.along,
            node_id: arc.node_id,
            line_colour: arc.line_colour,
            line_width: arc.line_width,
            fill_colour: arc.fill_colour
        };
    });


    if (replaceParamValues) {
        nodes1 = SYSTO.replaceParameterValues(model.nodes, nodes1);
    }
    var preparedModel = JSON.parse(JSON.stringify({
        meta:model.meta, 
        nodes:nodes1,
        arcs:arcs1, 
        scenarios:model.scenarios}));
    return preparedModel;
};



// Note: nodeList could be model.nodes, or a temporary nodes object, e.g. when preparing
// the model for saving.
SYSTO.replaceParameterValues = function (nodes, nodes1) {
    for (var nodeId in nodes) {
        var node = nodes[nodeId];
        var node1 = nodes1[nodeId];
        //if (node.workspace.jsequation && node.extras.equation.value) {
        //    console.debug('\n'+nodeId+': '+node.workspace.jsequation+'; '+node.extras.equation.value);
        //}
        if (node.workspace.jsequation) {
            if (isNumericConstant(node.workspace.jsequation)) {
                node1.extras.equation.value = node.workspace.jsequation;
            }
        }
    }
    return nodes1;
};
            


// ===================================================== SYSTO.getUrlVars()

// http://stackoverflow.com/questions/4656843/jquery-get-querystring-from-url
// Read a page's GET URL variables and return them as an associative array.


SYSTO.getUrlVars = function () {
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
};






// This is used as part of error-handling.
// If a function fails, it returns: {status:failed, message:Message, path:Path}
// where Message is generated by the original failure, and
//       Path is the function calling path, an arry, starting with the original
//       functionwhich caused the failure.
// This function ensures that we handle all possible values for the pathSoFar.
SYSTO.addToPath = function (pathSoFar, addStep) {
    if (pathSoFar) {
        if (Array.isArray(pathSoFar)) {
            return pathSoFar.push(addStep);
        } else {
            return [pathSoFar, addStep];
        }
    } else {
        return [addStep];
    }
};




SYSTO.clearResults = function () {
    // Temporary measure
    delete SYSTO.results;
    delete SYSTO.resultStats;
    delete SYSTO.resultsBase;
    delete SYSTO.resultStatsBase;

    var modelId = SYSTO.state.currentModelId;
    var model = SYSTO.models[modelId];
    delete model.results;
    delete model.resultStats;
    delete model.resultsBase;
    delete model.resultStatsBase;
};



SYSTO.test = function () {
    var action = new Action(SYSTO.models.miniworld, 'create_node', {mode:'stock', nodeId:'stock21', diagramx:100, diagramy:100});
    action.doAction();
};

function test1 () {
    var aaa = new Action('miniworld', 'create_node', {mode:'stock', nodeId:'stock21', diagramx:100, diagramy:100});
}



// Experimental section for "colouring" flow networks, with all connected stocks and flows
// being identified as nvolvingf the same "substance".

SYSTO.colourFlowNetworks = function (model) {
    var nodeList = model.nodes;
    var arcList = model.arcs;
    $.each(nodeList, function(nodeId, node) {
        if (node.type === 'stock') {
            if (node.workspace) {
                node.workspace.colour = null;
            } else {
                node.workspace = {colour:null};
            }
        }
    });
    $.each(arcList, function(arcId, arc) {
        if (arc.type === 'flow') {
            if (arc.workspace) {
                arc.workspace.colour = null;
            } else {
                arc.workspace = {colour:null};
            }
        }
    });

    var icolour = 0;
    var colours = ['#ffa0a0', '#a0a0ff', '#a0ffa0', 'red','blue','green','yellow','orange'];
    $.each(nodeList, function(nodeId, node) {
        if (node.type === 'stock') {
            if (!node.workspace.colour) {
                SYSTO.colourStock(model, node, colours[icolour]);
                icolour += 1;
            }
        }
    }); 
};



SYSTO.colourStock = function (model, node, colour) {
    if (!node.workspace) {
        node.workspace = {};
    }
    if (node.workspace.colour) {
        return;
    } else {
        node.workspace.colour = colour;
        SYSTO.colourInflows(model, node, colour);
        SYSTO.colourOutflows(model, node, colour);
    }
};


SYSTO.colourInflows = function (model, node, colour) {
    if (node.inarcList) {
        $.each(node.inarcList, function(arcId, arc) {
            if (arc.type === 'flow') {
                if (!arc.workspace) arc.workspace = {};
                if (arc.workspace.colour) {
                    return;
                } else {
                    arc.workspace.colour = colour;
                }
                var node = model.nodes[arc.start_node_id];
                SYSTO.colourStock(model, node, colour);
            }
        });
    }
};


SYSTO.colourOutflows = function (model, node, colour) {
    if (node.outarcList) {
        $.each(node.outarcList, function(arcId, arc) {
            if (arc.type === 'flow') {
                if (!arc.workspace) arc.workspace = {};
                if (arc.workspace.colour) {
                    return;
                } else {
                    arc.workspace.colour = colour;
                }
                var node = model.nodes[arc.end_node_id];
                SYSTO.colourStock(model, node, colour);
            }
        }); 
    }
};



// Generic options-handling functions
// Each widget type (not instance) should have its own options dialog.  This is created
// when the widget is initialised, checing that it does not already exist.    Rather than
// having all the messy HTML and option setting/getting in each widget, the idea is to have
// this generic code, and a much simpler function call in each widget.

SYSTO.createOptionsDialog = function(parameters) {
    var baseName = parameters.baseName;
    var sections = parameters.sections;

    if ($('#dialog_'+baseName+'_options').length=== 0) {

        var optionsDiv = $('<div id="dialog_'+baseName+'_options" style="width:700px; font-size:14px;"></div>');
        for (var isection=0; isection<sections.length; isection++) {
            var options = sections[isection];
            var optionsTable = $('<table style="float:left;"></table>');
            $(optionsDiv).append(optionsTable);

            for (var i=0; i<options.length; i++) {
                var optionTr = $('<tr id="dialog_'+baseName+'_options_'+options[i].name+'_tr"></tr>');
                if (options[i].checkbox) {
                    var optionTdCheckbox = $('<td><input type="checkbox"/></td>');
                } else {
                    optionTdCheckbox = $('<td></td>');
                }
                var optionTdLabel = $('<td style="vertical-align:top">'+options[i].label+'</td>');
                if (options[i].type === 'menu') {
                    var optionTdInput = $('<td></td>');
                    var optionTdSelect = $('<select size="20" multiple style="width:174px;"></select>');
                    $(optionTdInput).append(optionTdSelect);
                } else {
                    optionTdInput = $('<td><input type="text" id="dialog_'+baseName+'_options_'+options[i].name+'"/></td>');
                }
                var optionTdHelp = $('<td style="vertical-align:top"><b>?</b></td>').
                    click({help:options[i].help},function(event) {alert(event.data.help);});
                $(optionTr).append(optionTdCheckbox).append(optionTdLabel).append(optionTdInput).append(optionTdHelp);
                $(optionsTable).append(optionTr);
            }
        }

        $(optionsDiv).
            dialog({
                autoOpen: false,
                height: 500,
                width: 750,
                modal: true,
                title: 'Plotter options',
                buttons: {
                    OK: function() {
                        //alert(JSON.stringify($('#dialog_plotter_options_selectNodeObject_tr select').val()));
                        var widget = $(this).data('widget');
                        var options = widget.options;
                        var sections = $(this).data('dialogOptions');
                        console.debug(JSON.stringify(sections,null,4));
                        var baseName = $(this).data('baseName');
                        var modelId = widget.options.modelId;
                        var nodeId = widget.options.nodeId;
                        var node = SYSTO.models[modelId].nodes[nodeId];
                        for (var isection=0; isection<sections.length; isection++) {
                            var dialogOptions = sections[isection];
                            for (var i=0; i<dialogOptions.length; i++) {
                                console.debug(isection+': '+i);
                                try {
                                    if (dialogOptions[i].type === 'menu') {
                                        var value = $('#dialog_plotter_options_selectNodeObject_tr select').val();  // TODO: Use baseName.
                                        console.debug(['try1: ',dialogOptions[i].name, value]);
                                        var object = {};
                                        for (var j=0; j<value.length; j++) {
                                            object[value[j]] = true;
                                        }
                                        widget.option(dialogOptions[i].name, object);
                                    } else {
                                        value = JSON.parse($('#dialog_'+baseName+'_options_'+dialogOptions[i].name).val());
                                        console.debug(['try2: ',dialogOptions[i].name, value]);
                                        widget.option([dialogOptions[i].name], object);
                                    }
                                }
                                catch(err) {   // This is for string values, which otherwise would be double-quoted.
                                    value = $('#dialog_'+baseName+'_options_'+dialogOptions[i].name).val();
                                    console.debug(['catch: ',dialogOptions[i].name, value]);
                                    widget.option(dialogOptions[i].name, value);
                                }
                            }
                        }
                        console.debug(JSON.stringify(widget.options,null,4));
/*
                        if ($('input[name=yaxis_scaling_mode]:checked').val()==='fixed') {
                            widget.option('ymin',$('#dialog_plotter_options_ymin').val());
                            widget.option('ymax',$('#dialog_plotter_options_ymax').val());
                            widget.options.yscaling.initialised = false;
                        }
*/
                        $('body').find('.optionsButton').fadeOut(0);
                        if (parameters.closeFunction) {
                            parameters.closeFunction(widget);
                        }
                        $( this ).dialog( "close" );
                    },
                    Cancel: function() {
                      $(this).dialog( "close" );
                    }
                },
                open: function() {
                    var widget = $(this).data('widget');
                    var model = SYSTO.models[widget.options.modelId];
                    var options = widget.options;
                    var sections = $(this).data('dialogOptions');
                    var baseName = $(this).data('baseName');
                    var nodeId = widget.options.nodeId;
                    for (var isection=0; isection<sections.length; isection++) {
                        var dialogOptions = sections[isection];
                        for (var i=0; i<dialogOptions.length; i++) {
                            if (dialogOptions[i].type === 'text') {
                                $('#dialog_'+baseName+'_options_'+dialogOptions[i].name).
                                    val(JSON.stringify(options[dialogOptions[i].name]).replace(/^"(.*)"$/, '$1'));
                            } else if (dialogOptions[i].type === 'menu') {
                                var availableNodes = {};
                                for (var nodeId in model.nodes) {
                                    var node = model.nodes[nodeId];
                                    if (node.type === 'cloud' || isParameter(node)) {
                                    } else {
                                        availableNodes[nodeId] = {nodeId:nodeId, label:node.label};
                                        $('#dialog_'+baseName+'_options_'+dialogOptions[i].name+'_tr').find('select').append('<option value="'+nodeId+'">'+node.label+'</option>');
                                    }
                                }
                            }
                        }
                    }
                },
                close: function() {
                }
        });
    }
};



SYSTO.createVariablesDialog = function(parameters) {
    var baseName = parameters.baseName;
    var sections = parameters.sections;

    if ($('#dialog_'+baseName+'_variables').length=== 0) {

        var variablesDiv = $('<div id="dialog_'+baseName+'_variables" style="font-size:14px;"></div>');
        var guidanceDiv = $('<div>Click then shift-click to select a range.<br/>CTRL-click to select multiple options.</div>');
        var variablesSelect = $('<select id="dialog_'+baseName+'_variables_select" size="19" multiple style="width:245px;"></select>');
        $(variablesDiv).append(guidanceDiv).append(variablesSelect);

        $(variablesDiv).
            dialog({
                autoOpen: false,
                height: 500,
                width: 280,
                modal: false,
                position: {my: "right", at: "left", of: '#dialog_'+baseName+'_variables'}, 
                title: 'Available',
                buttons: {
                    OK: function() {
                        //alert(JSON.stringify($('#dialog_plotter_options_selectNodeObject_tr select').val()));
                        var widget = $(this).data('widget');
                        var baseName = $(this).data('baseName');     // Check that this will work!
                        var options = widget.options;
                        var baseName = $(this).data('baseName');
                        var modelId = widget.options.modelId;
                        var nodeId = widget.options.nodeId;
                        var node = SYSTO.models[modelId].nodes[nodeId];
                        var value = $('#dialog_'+baseName+'_variables_select').val();
                        if (value) {
                            var object = {};
                            for (var j=0; j<value.length; j++) {
                                object[value[j]] = true;
                            }
                            widget.option('selectNodeObject', object);
                            $('body').find('.optionsButton').fadeOut(0);
                            if (parameters.closeFunction) {
                                parameters.closeFunction(widget);
                            }
                        }
                        $( this ).dialog( "close" );
                    },
                    Cancel: function() {
                      $(this).dialog( "close" );
                    }
                },
                open: function() {
                    var widget = $(this).data('widget');
                    var model = SYSTO.models[widget.options.modelId];
                    var options = widget.options;
                    var baseName = $(this).data('baseName');
                    var nodeId = widget.options.nodeId;
                    var availableNodes = {};
                    $('#dialog_'+baseName+'_variables_select').empty();
/*
                    for (var nodeId in model.nodes) {
                        var node = model.nodes[nodeId];
                        if (node.type === 'cloud' || isParameter(node)) {
                        } else {
                            availableNodes[nodeId] = {nodeId:nodeId, label:node.label};
                            var selectOption = $('<option value="'+nodeId+'">'+node.label+'</option>').
                                click(function(event) {
                                    console.debug(widget);
                                    console.debug(parameters);
                                    //var node = SYSTO.models[modelId].nodes[nodeId];
                                    var value = $('#dialog_'+baseName+'_variables_select').val();
                                    var object = {};
                                    for (var j=0; j<value.length; j++) {
                                        object[value[j]] = true;
                                    }
                                    widget.option('selectNodeObject', object);
                                    if (parameters.closeFunction) {
                                        console.debug('aaa');
                                        parameters.closeFunction(widget);
                                    }
                                });
                            $('#dialog_'+baseName+'_variables_select').append(selectOption);
                            //$('#dialog_'+baseName+'_variables_select').append('<option value="'+nodeId+'">'+node.label+'</option>');
                        }
                    }
*/
///*
                    function compare(a,b) {
                        if (a.last_nom < b.last_nom)
                            return -1;
                        if (a.last_nom > b.last_nom)
                            return 1;
                        return 0;
                    }

                    var nodeTypeIdArray = ['stock', 'valve', 'variable'];
                    var nodeTypeLabelObject = {stock:'Stocks', valve:'Flows', variable:'Variables'};
                    var availableNodeObject = {};
                    availableNodeObject.stock = [];
                    availableNodeObject.valve = [];
                    availableNodeObject.variable = [];
                    for (var nodeId in model.nodes) {
                        var node = model.nodes[nodeId];
                        if (node.type === 'stock' || node.type === 'valve' || (node.type === 'variable' && !isParameter(node))) {
                            availableNodeObject[node.type].push(node);
                        }
                    }
                    console.debug(availableNodeObject);
                    availableNodeObject.stock.sort(compare);
                    availableNodeObject.valve.sort(compare);
                    availableNodeObject.variable.sort(compare);
                    for (var nodeTypeId in availableNodeObject) {
                        var optGroup = $('<optgroup label="'+nodeTypeLabelObject[nodeTypeId]+'"></optgroup>');
                        $('#dialog_'+baseName+'_variables_select').append(optGroup);
                        for (var i=0; i<availableNodeObject[nodeTypeId].length; i++) {
                            var node = availableNodeObject[nodeTypeId][i];
                            var selectOption = $('<option value="'+node.id+'">'+node.label+'</option>').
                                click(function(event) {
                                    console.debug(widget);
                                    console.debug(parameters);
                                    //var node = SYSTO.models[modelId].nodes[nodeId];
                                    var currentlySelectedArray = $('#dialog_'+baseName+'_variables_select').val();
                                    console.debug(JSON.stringify(currentlySelectedArray,null,4));
                                    var object = {};
                                    for (var j=0; j<currentlySelectedArray.length; j++) {
                                        object[currentlySelectedArray[j]] = true;
                                    }
                                    widget.option('selectNodeObject', object);
                                    if (parameters.closeFunction) {
                                        console.debug('aaa');
                                        parameters.closeFunction(widget);
                                    }
                                });
                            $(optGroup).append(selectOption);
                            //$('#dialog_'+baseName+'_variables_select').append(selectOption);
                        }
                    }
//*/
                },
                close: function() {
                }
        });
    }
};

// ==========================================================REST API, AJAX, YQL....
    // YQL, AJAX etc

    // See https://developer.yahoo.com/yql/guide/response.html... but still can't get it to return JSON.
    // So used a clunky workaround instead.

SYSTO.openModelFromUrlUsingYql = function (modelJsonUrl) {
    console.debug(111);
    yqlUrl = 
        "http://query.yahooapis.com/v1/public/yql"+
        "?q=" + encodeURIComponent("select * from json where url='" + modelJsonUrl + "'")+
        //"&format=json&callback=fred&jsonCompat=new";  // Doesn't work
        "&format=xml&callback=?";
    $.getJSON(yqlUrl, function(data){
        console.debug(data);
        var fileObject = $.xml2json(data.results[0],true);
        var yqlObjects = fileObject;
        var systoObjects = processYqlObjects(yqlObjects, {});
        SYSTO.models['myex'] = systoObjects;
        SYSTO.switchToModel('myex', 'package1');
    }).success(function(a,b,c) {console.debug(a);console.debug(b);console.debug(c);});


    function processYqlObjects(yqlObjects, systoObjects) {
        for (var key in yqlObjects) {
            if (yqlObjects[key][0].text) {
                var value = yqlObjects[key][0].text;
                if (key !== 'value' && isNumericConstant(value)) {
                    systoObjects[key] = parseFloat(value);
                } else {
                    systoObjects[key] = yqlObjects[key][0].text;
                }
            } else if (yqlObjects[key][0] === "") {
                systoObjects[key] = "";
            } else {
                var yqlObject = yqlObjects[key][0];
                systoObjects[key] = processYqlObjects(yqlObject, {});
            }
        }
        return systoObjects;
    }
};

function fred(aa, bb, cc) {
    alert('completed');
    console.debug('fred');
    console.debug(aa);
}





SYSTO.loadModelFromUrl = function (url) {

    // Reject anything that doesn't resemble a "plain" URL.
    // This is regex2 from http://jsfiddle.net/mwoodman/UycV9/
    var httpRegexp = /^(https?:\/\/)?((([a-z\d]([a-z\d-]*[a-z\d])*)\.)+[a-z]{2,}|((\d{1,3}\.){3}\d{1,3}))(\:\d+)?(\/[-a-z\d%_.~+]*)*(\?[,;&a-z\d%_.~+=-]*)?(\#[-a-z\d_]*)?$/;
    var regexp = new RegExp(httpRegexp);
    if (!url.match(regexp)) {
        alert('ERROR: Expected a URL.\n'+url+'\n'+'is not a valid URL.'); 
        return;
    }

    var base_url = 'http://jsonp-proxy.systo.org/_jsonp_proxy/get_jsonp';
    var jsonp_url = base_url + '?url=' + url;
    console.debug(jsonp_url);

    var script = document.createElement( "script" );
    script.type = "text/javascript";
    script.src = jsonp_url;
    $('head').append(script);
}



function ptq(q) {
    /* parse the query */
    /* semicolons are nonstandard but we accept them */
    var x = q.replace(/;/g, '&').split('&'), i, name, t;
    /* q changes from string version of query to object */
    for (q={}, i=0; i<x.length; i++) {
        t = x[i].split('=');
        name = unescape(t[0]);
        if (!q[name]) {
            q[name] = [];
        }
        if (t.length == 1) {
            q[name][0] = true;   // non-standard
        } else {
            for (var j=1; j<t.length; j++) {
                q[name][j-1] = unescape(t[j]);
            }
        }
    }
    return q;
}

function param() {
return ptq(location.search.substring(1).replace(/\+/g, ' '));
}



// ==========================================================REST API, AJAX, YQL....
    // YQL, AJAX etc


// This is Mark's simple proxy, allowing for a static HTML file and for the
// proxy to live on a different server.
// See emails of 8 June 2015

// function parsePayload(Url) is called in a template on the proxy's server, in a
// file called templates/json_wrapper.js

function parsePayload(data) {
    console.debug(data);
    if (data) {
        if (SYSTO.validateModelJson(data) && data.meta) {
            if (data.meta.id) {
                var modelId = data.meta.id;
            } else {
                modelId = 'loaded_from_url_with_no_id';  // Should not happen.
            }
            SYSTO.models[modelId] = data;
            // There are 3 reasons for switching to this model now:

            // 1. The initialModelId has been specified, so check its ID.
            if (SYSTO.state.initialModelId && SYSTO.state.initialModelId === modelId) {
                var switchToModelNow = true;

            // 2. Only one model has been provided via a URL.
            } else if (SYSTO.state.nModelsFromUrl && SYSTO.state.nModelsFromUrl === 1) {
                switchToModelNow = true;

            // 3. We have no information on the two state settings.  (The information has to
            // be set by the Javascript on the web page, and we can't guarantee that the page
            // developer will have provided it.)
            } else if (!SYSTO.state.nModelsFromUrl && !SYSTO.state.initialModelId) {
                switchToModelNow = true;

            } else {
                switchToModelNow = false;
            }
            if (switchToModelNow) {
                SYSTO.switchToModel(modelId, 'package1');
                SYSTO.state.currentModelId = modelId;
            }
        } else {
            alert('ERROR\n'+
                'Attempting to access an external model file, but failed.\n'+
                'No "meta" property.');
            SYSTO.state.currentModelId = null;
        }
    } else {
        alert('ERROR\n'+
            'Attempting to access an external model file, but failed.\n'+
            'Possibly incorrect URL entered, or the file no longer exists, or the server is down.');
        SYSTO.state.currentModelId = null;
    }
}


SYSTO.loadModelFromUrl = function (url) {

    // Reject anything that doesn't resemble a "plain" URL.
    // This is regex2 from http://jsfiddle.net/mwoodman/UycV9/
    var httpRegexp = /^(https?:\/\/)?((([a-z\d]([a-z\d-]*[a-z\d])*)\.)+[a-z]{2,}|((\d{1,3}\.){3}\d{1,3}))(\:\d+)?(\/[-a-z\d%_.~+]*)*(\?[,;&a-z\d%_.~+=-]*)?(\#[-a-z\d_]*)?$/;
    var regexp = new RegExp(httpRegexp);
    if (!url.match(regexp)) {
        alert('ERROR: Expected a URL.\n'+url+'\n'+'is not a valid URL.'); 
        return;
    }

    var base_url = 'http://jsonp-proxy.systo.org/_jsonp_proxy/get_jsonp';
    var jsonp_url = base_url + '?url=' + url;
    console.debug(jsonp_url);

    var script = document.createElement( "script" );
    script.type = "text/javascript";
    script.src = jsonp_url;
    $('head').append(script);
}



// Ideally, Systo will automatically fall back on this method (using YQL) if the default
// Systo proxy (Mark's) fails for some reason (like the server is down).   However, I can't
// see how to do that.

// Generic  version - allows for choice of proxy
SYSTO.loadModelFromUrlxxx = function (modelJsonUrl) {

    yqlProxy = {};  // The default - YQL

    var systoProxy = { 
        url: 'http://www.systo.org/php/proxy.php?format=xml&callback=?', 
        cleanup: function (data) { 
            data = data.result; 
            return (data ? data : null); 
        } 
    }; 
    
    var proxy = yqlProxy;
    //var proxy = systoProxy;

    proxyGet(
        modelJsonUrl,
        function (data) {
            console.debug(data);
            SYSTO.models['myex'] = JSON.parse(data);
            SYSTO.switchToModel('myex', 'package1');
        }, 
        proxy 
    );

    // .......................................................
    // The following functions are taken from 
    // http://andowebsit.es/blog/noteslog.com/post/how-to-workaround-the-same-origin-policy/
    // This looks like a very useful site, both because it tackles the issue of how to wrap 
    // up YQL in a neat, resilient manner; and because it seems to be sayig how you can make
    // your own alternative.  If that works, at the least it could be a fallback for YQL, in
    // case the latter is down or ceases to be supported.

    // This is a wapper for YQL, which in fact also allows for some other proxy.

    proxyGet = function ( url, callback, options ) { 
     
        // reject anything that doesn't resemble a "plain" URL or a null (see below) 
        if (! (url === null || /^(https?:|\/\/)/.test(url))) { 
            throw new SyntaxError('Expected a URL.'); 
        } 
         
        // allow detection of current SSL mode by starting the url with '//' 
        if (url && url.indexOf('//') === 0) { 
            url = window.location.protocol + url; 
        } 
         
        // you are strongly advised to choose a different proxy. YQL "from html" is a toy !!  
        var yql_proxy = { 
             
            // a url with or without a '--URL--' placeholder 
            // -- the placeholder will be replaced by the url param 
            // -- use a null url param if the proxy url is requestable as is 
            url: 'http://query.yahooapis.com/v1/public/yql' + '?q=' + encodeURIComponent('select * from html where url="--URL--" and compat="html5" and xpath="*"') + '&format=xml', 
             
            // null (no action) or a function that takes response data and returns clean data 
            cleanup: function (data) { 
                data = data.results && data.results[0]; 
                if (! data) return null; 
                data = data.replace(/&#xD;/ig, "\r").replace(/&#xA;/ig, "\n"); 
                data = data.replace('<html><head/><body>','');
                data = data.replace('</body></html>','');
                return data; 
            }, 
             
            // null (no action) or a function that takes clean data and returns filtered data 
            filter: null 
        }; 
         
        // use YQL proxy by default, but allow for customizations 
        options = $.extend(yql_proxy, options || {}); 
         
        // make the jsonp request 
        var jsonp_url = options.url.replace('--URL--', encodeURIComponent(url)) + '&callback=?'; 
        $.getJSON( jsonp_url, function (data) { 
            if ($.isFunction(callback)) { 
                if ($.isFunction(options.cleanup)) { 
                    data = options.cleanup(data); 
                    if ($.isFunction(options.filter)) { 
                        data = options.filter(data); 
                    } 
                } 
                callback(data); 
            } 
        } ); 
    };

}

    // See https://developer.yahoo.com/yql/guide/response.html... but still can't get it to return JSON.
    // So used a clunky workaround instead.

// Old version
SYSTO.loadModelFromUrlUsingYql = function (modelJsonUrl) {
    yqlUrl = 
        "http://query.yahooapis.com/v1/public/yql"+
        "?q=" + encodeURIComponent("select * from json where url='" + modelJsonUrl + "'")+
        //"&format=json&callback=fred&jsonCompat=new";  // Doesn't work
        "&format=xml&callback=?";
    $.getJSON(yqlUrl, function(data){
        if (data.results.length === 1) {
            var yqlObjects = $.xml2json(data.results[0],true);
            SYSTO.models['myex'] = processYqlObjects(yqlObjects, {});
            SYSTO.switchToModel('myex', 'package1');
        } else {
            alert('Sorry - cannot load the model specified with the URL '+modelJsonUrl+': there is no model at this address.');
        }
    });

    function processYqlObjects(yqlObjects, systoObjects) {
        for (var key in yqlObjects) {
            if (yqlObjects[key][0].text) {
                var value = yqlObjects[key][0].text;
                if (key !== 'value' && isNumericConstant(value)) {
                    systoObjects[key] = parseFloat(value);
                } else {
                    systoObjects[key] = yqlObjects[key][0].text;
                }
            } else if (yqlObjects[key][0] === "") {
                systoObjects[key] = "";
            } else {
                var yqlObject = yqlObjects[key][0];
                systoObjects[key] = processYqlObjects(yqlObject, {});
            }
        }
        return systoObjects;
    }
};


    // .......................................................
    // The following functions are taken from 
    // http://andowebsit.es/blog/noteslog.com/post/how-to-workaround-the-same-origin-policy/
    // This looks like a very useful site, both because it tackles the issue of how to wrap 
    // up YQL in a neat, resilient manner; and because it seems to be sayig how you can make
    // your own alternative.  If that works, at the least it could be a fallback for YQL, in
    // case the latter is down or ceases to be supported.

    // This is a wapper for YQL, which in fact also allows for some other proxy.

    SYSTO.proxyGet = function ( url, callback, options ) { 
     
        // reject anything that doesn't resemble a "plain" URL or a null (see below) 
        if (! (url === null || /^(https?:|\/\/)/.test(url))) { 
            throw new SyntaxError('Expected a URL.'); 
        } 
         
        // allow detection of current SSL mode by starting the url with '//' 
        if (url && url.indexOf('//') === 0) { 
            url = window.location.protocol + url; 
        } 
         
        // you are strongly advised to choose a different proxy. YQL "from html" is a toy !!  
        var yql_proxy = { 
             
            // a url with or without a '--URL--' placeholder 
            // -- the placeholder will be replaced by the url param 
            // -- use a null url param if the proxy url is requestable as is 
            url: 'http://query.yahooapis.com/v1/public/yql' + '?q=' + encodeURIComponent('select * from html where url="--URL--" and compat="html5" and xpath="*"') + '&format=xml', 
             
            // null (no action) or a function that takes response data and returns clean data 
            cleanup: function (data) { 
                data = data.results && data.results[0]; 
                if (! data) return null; 
                data = data.replace(/&#xD;/ig, "\r").replace(/&#xA;/ig, "\n"); 
                data = data.replace('<html><head/><body>','');
                data = data.replace('</body></html>','');
                return data; 
            }, 
             
            // null (no action) or a function that takes clean data and returns filtered data 
            filter: null 
        }; 
         
        // use YQL proxy by default, but allow for customizations 
        options = $.extend(yql_proxy, options || {}); 
         
        // make the jsonp request 
        var jsonp_url = options.url.replace('--URL--', encodeURIComponent(url)) + '&callback=?'; 
        $.getJSON( jsonp_url, function (data) { 
            if ($.isFunction(callback)) { 
                if ($.isFunction(options.cleanup)) { 
                    data = options.cleanup(data); 
                    if ($.isFunction(options.filter)) { 
                        data = options.filter(data); 
                    } 
                } 
                callback(data); 
            } 
        } ); 
    };

/*
Here is the php code for an alternative-to-YQL proxy:
<?php 
 
$url = $_GET['url']; 
$url = preg_replace('/^(?!https?\b)/', 'http://', $url); 
if (preg_match('/^(https?:\/\/)?([\w-]+\.)*\bandowebsit\.es\b/', $url)) { 
  stop_now(); 
} 
$cached = dirname(__FILE__) . '/cached/' . md5($url); 
 
$pass = '73e69002e737fb0d1c7a19a3159d0634'; 
$code = $_GET['code']; 
if ($pass == md5($code)) { 
  $result = file_get_contents($url); 
  $response = array( 
    'url'     => $url, 
    'header'  => $http_response_header,  // see also http://php.net/manual/en/reserved.variables.httpresponseheader.php#113361 
    'result'  => $result, 
  ); 
  $json_response = json_encode($response); 
  file_put_contents($cached, $json_response); 
} 
elseif (file_exists($cached)) { 
  $json_response = file_get_contents($cached); 
} 
else { 
  stop_now(); 
} 
 
respond($json_response); 
 
//---------------------------------------------------------------------------------------------------------------------- 
 
// Sends the response and exits. 
function respond($json_response) { 
  $callback = preg_replace('/\W+/', '', $_GET['callback']); 
  if ($callback) { 
    header('Content-Type: application/javascript'); 
    echo $callback . '(' . $json_response . ');'; 
  } 
  else { 
    header('Content-Type: application/json'); 
    echo $json_response; 
  } 
  exit; 
} 
 
// Stops execution by returning null in the expected result format. 
function stop_now() { 
  respond(array('result' => null)); 
} 
// End of php

 ... and here is how it is used...
var my_proxy = { 
    url: '.../?url=--URL--&code=...', 
    cleanup: function (data) { 
        data = data.result; 
        return (data ? data : null); 
    } 
}; 
 
$.proxyGet(ajax_url, function (data) {console.log("--- using my proxy:\n" + data);}, my_proxy);
*/





// This *should* check the JSON for a presumed Systo model against the Systo model 
// JSON Schema (which does not currently exist...).

SYSTO.validateModelJson = function (json) {

    if (json.meta && json.nodes && json.arcs) {
        return true;
    } else {
        return false;
    }
};



SYSTO.Model = function(args) {
	this.object_literal = args.model_object_literal;
};



// ======================================  GoJS  ========================================

SYSTO.convertSystoToGojs = function(systoModel) {

        var gojsModel = { 
            "class": "go.GraphLinksModel",
            linkLabelKeysProperty: "labelKeys",
            nodeDataArray: [],
            linkDataArray: []
        }

        var nodeList = systoModel.nodes;
        for (var nodeId in nodeList) {
            var node = nodeList[nodeId];
            var key = node.id;
            var category = node.type;
            if (node.type !== "cloud") {
                var has_equation = true;
                var label = node.label;
            } else {
                has_equation = false;
            }
            var loc = node.centrex+" "+node.centrey;
            var shifty = -1*node.text_shifty+20;
            var text_shift = "0.5 0.5 "+node.text_shiftx+" "+shifty;
            if (node.extras && node.extras.equation) {
                var equation = node.extras.equation.value;
            }
            var gojsNode = {key:key, category:category, label:label, loc:loc, text_shift:text_shift, equation:equation, has_equation:has_equation};
            console.debug(JSON.stringify(gojsNode));
            gojsModel.nodeDataArray.push(gojsNode);
        }

        var arcList = systoModel.arcs;
        for (var arcId in arcList) {
            var arc = arcList[arcId];
            var key = arcId;   // Not actually use in GoJS, but so an be pushed back to Systo.
            var category = arc.type;
            var from = arc.start_node_id;
            var to = arc.end_node_id;
            if (arc.node_id) {
                var labelKeys = [arc.node_id];
                var gojsArc = {key:key, category:category, from:from, to:to, labelKeys:labelKeys};
            } else {
                gojsArc = {category:category, from:from, to:to};
            }
            console.debug(JSON.stringify(gojsArc));
            gojsModel.linkDataArray.push(gojsArc);
        }
   
        return gojsModel;
};


SYSTO.convertGojsToSysto = function(gojsModel) {

        console.debug(gojsModel);
        var systoModel = {
            meta:{
                //modelId: SYSTO.state.currentModelId,
                modelId: "gojs",
                language: "system_dynamics",
                name:'GoJS'
            },
            nodes:{},
            arcs:{},
            scenarios: {
                default:{
                    simulation_settings:{
                        start_time: 0,
                        end_time: 100,
                        nstep: 10,
                        display_interval: 1,
                        integration_method: 'euler'
                    }
                }
            },
            workspace:{}
        };

        console.debug("Number of nodes = "+gojsModel.nodeDataArray.length);
        console.debug(JSON.stringify(gojsModel.nodeDataArray));
        for (var i=0; i<gojsModel.nodeDataArray.length; i++) {
            console.debug("Node "+i);
            var gojsNode = gojsModel.nodeDataArray[i];
            var systoNode = {};
            systoNode.id = gojsNode.key;
            systoNode.label = gojsNode.label;
            var loc = go.Point.parse(gojsNode.loc);
            systoNode.centrex = loc.x;
            systoNode.centrey = loc.y;
            var alignment = go.Spot.parse(gojsNode.alignment);
            systoNode.text_shiftx = alignment.offsetX;
            systoNode.text_shifty = alignment.offsetY;
            systoNode.extras = {
                equation: {type:"long_text", value:gojsNode.equation, default_value:""},
                min_value: {type:"short_text", value:"", default_value:""},
                max_value: {type:"short_text", value:"", default_value:""},
                documentation: {type:"long_text", value:"", default_value:""},
                comments: {type:"long_text", value:"", default_value:""}
             };
             systoModel.nodes[systoNode.id] = systoNode;
        }

        console.debug('links: '+gojsModel.linkDataArray.length);
        console.debug(gojsModel.linkDataArray.length);
        for (j=0; j<gojsModel.linkDataArray.length; j++) {
            var gojsLink = gojsModel.linkDataArray[j];
            console.debug(gojsLink);
            SYSTO.state.languageId = "system_dynamics";  // TODO: Shouldn't have to do this here
            //var currentModelId = SYSTO.state.currentModelId;
            //var systoModel = SYSTO.models[currentModelId];
            arcId = getNewArcId(systoModel, gojsLink.category);
            var systoArc = {};
            systoArc.id = arcId;
            systoArc.type = gojsLink.category;
            systoArc.start_node_id = gojsLink.from;
            systoArc.end_node_id = gojsLink.to;
            if (gojsLink.labelKeys) {
                systoArc.node_id = gojsLink.labelKeys[0]; // Should be able to safely assume it's a 1-element array
            }
            systoModel.arcs[arcId] = systoArc;
        }
        console.debug(JSON.stringify(systoModel,null,4));
        return systoModel;
    };





/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/jquery_1.11.3_jquery.min.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


/*! jQuery v@1.8.1 jquery.com | jquery.org/license */
(function(a,b){function G(a){var b=F[a]={};return p.each(a.split(s),function(a,c){b[c]=!0}),b}function J(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(I,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:+d+""===d?+d:H.test(d)?p.parseJSON(d):d}catch(f){}p.data(a,c,d)}else d=b}return d}function K(a){var b;for(b in a){if(b==="data"&&p.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function ba(){return!1}function bb(){return!0}function bh(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function bi(a,b){do a=a[b];while(a&&a.nodeType!==1);return a}function bj(a,b,c){b=b||0;if(p.isFunction(b))return p.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return p.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=p.grep(a,function(a){return a.nodeType===1});if(be.test(b))return p.filter(b,d,!c);b=p.filter(b,d)}return p.grep(a,function(a,d){return p.inArray(a,b)>=0===c})}function bk(a){var b=bl.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function bC(a,b){return a.getElementsByTagName(b)[0]||a.appendChild(a.ownerDocument.createElement(b))}function bD(a,b){if(b.nodeType!==1||!p.hasData(a))return;var c,d,e,f=p._data(a),g=p._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;d<e;d++)p.event.add(b,c,h[c][d])}g.data&&(g.data=p.extend({},g.data))}function bE(a,b){var c;if(b.nodeType!==1)return;b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),c==="object"?(b.parentNode&&(b.outerHTML=a.outerHTML),p.support.html5Clone&&a.innerHTML&&!p.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):c==="input"&&bv.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):c==="option"?b.selected=a.defaultSelected:c==="input"||c==="textarea"?b.defaultValue=a.defaultValue:c==="script"&&b.text!==a.text&&(b.text=a.text),b.removeAttribute(p.expando)}function bF(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bG(a){bv.test(a.type)&&(a.defaultChecked=a.checked)}function bY(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=bW.length;while(e--){b=bW[e]+c;if(b in a)return b}return d}function bZ(a,b){return a=b||a,p.css(a,"display")==="none"||!p.contains(a.ownerDocument,a)}function b$(a,b){var c,d,e=[],f=0,g=a.length;for(;f<g;f++){c=a[f];if(!c.style)continue;e[f]=p._data(c,"olddisplay"),b?(!e[f]&&c.style.display==="none"&&(c.style.display=""),c.style.display===""&&bZ(c)&&(e[f]=p._data(c,"olddisplay",cc(c.nodeName)))):(d=bH(c,"display"),!e[f]&&d!=="none"&&p._data(c,"olddisplay",d))}for(f=0;f<g;f++){c=a[f];if(!c.style)continue;if(!b||c.style.display==="none"||c.style.display==="")c.style.display=b?e[f]||"":"none"}return a}function b_(a,b,c){var d=bP.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function ca(a,b,c,d){var e=c===(d?"border":"content")?4:b==="width"?1:0,f=0;for(;e<4;e+=2)c==="margin"&&(f+=p.css(a,c+bV[e],!0)),d?(c==="content"&&(f-=parseFloat(bH(a,"padding"+bV[e]))||0),c!=="margin"&&(f-=parseFloat(bH(a,"border"+bV[e]+"Width"))||0)):(f+=parseFloat(bH(a,"padding"+bV[e]))||0,c!=="padding"&&(f+=parseFloat(bH(a,"border"+bV[e]+"Width"))||0));return f}function cb(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=!0,f=p.support.boxSizing&&p.css(a,"boxSizing")==="border-box";if(d<=0||d==null){d=bH(a,b);if(d<0||d==null)d=a.style[b];if(bQ.test(d))return d;e=f&&(p.support.boxSizingReliable||d===a.style[b]),d=parseFloat(d)||0}return d+ca(a,b,c||(f?"border":"content"),e)+"px"}function cc(a){if(bS[a])return bS[a];var b=p("<"+a+">").appendTo(e.body),c=b.css("display");b.remove();if(c==="none"||c===""){bI=e.body.appendChild(bI||p.extend(e.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!bJ||!bI.createElement)bJ=(bI.contentWindow||bI.contentDocument).document,bJ.write("<!doctype html><html><body>"),bJ.close();b=bJ.body.appendChild(bJ.createElement(a)),c=bH(b,"display"),e.body.removeChild(bI)}return bS[a]=c,c}function ci(a,b,c,d){var e;if(p.isArray(b))p.each(b,function(b,e){c||ce.test(a)?d(a,e):ci(a+"["+(typeof e=="object"?b:"")+"]",e,c,d)});else if(!c&&p.type(b)==="object")for(e in b)ci(a+"["+e+"]",b[e],c,d);else d(a,b)}function cz(a){return function(b,c){typeof b!="string"&&(c=b,b="*");var d,e,f,g=b.toLowerCase().split(s),h=0,i=g.length;if(p.isFunction(c))for(;h<i;h++)d=g[h],f=/^\+/.test(d),f&&(d=d.substr(1)||"*"),e=a[d]=a[d]||[],e[f?"unshift":"push"](c)}}function cA(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h,i=a[f],j=0,k=i?i.length:0,l=a===cv;for(;j<k&&(l||!h);j++)h=i[j](c,d,e),typeof h=="string"&&(!l||g[h]?h=b:(c.dataTypes.unshift(h),h=cA(a,c,d,e,h,g)));return(l||!h)&&!g["*"]&&(h=cA(a,c,d,e,"*",g)),h}function cB(a,c){var d,e,f=p.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d]);e&&p.extend(!0,a,e)}function cC(a,c,d){var e,f,g,h,i=a.contents,j=a.dataTypes,k=a.responseFields;for(f in k)f in d&&(c[k[f]]=d[f]);while(j[0]==="*")j.shift(),e===b&&(e=a.mimeType||c.getResponseHeader("content-type"));if(e)for(f in i)if(i[f]&&i[f].test(e)){j.unshift(f);break}if(j[0]in d)g=j[0];else{for(f in d){if(!j[0]||a.converters[f+" "+j[0]]){g=f;break}h||(h=f)}g=g||h}if(g)return g!==j[0]&&j.unshift(g),d[g]}function cD(a,b){var c,d,e,f,g=a.dataTypes.slice(),h=g[0],i={},j=0;a.dataFilter&&(b=a.dataFilter(b,a.dataType));if(g[1])for(c in a.converters)i[c.toLowerCase()]=a.converters[c];for(;e=g[++j];)if(e!=="*"){if(h!=="*"&&h!==e){c=i[h+" "+e]||i["* "+e];if(!c)for(d in i){f=d.split(" ");if(f[1]===e){c=i[h+" "+f[0]]||i["* "+f[0]];if(c){c===!0?c=i[d]:i[d]!==!0&&(e=f[0],g.splice(j--,0,e));break}}}if(c!==!0)if(c&&a["throws"])b=c(b);else try{b=c(b)}catch(k){return{state:"parsererror",error:c?k:"No conversion from "+h+" to "+e}}}h=e}return{state:"success",data:b}}function cL(){try{return new a.XMLHttpRequest}catch(b){}}function cM(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function cU(){return setTimeout(function(){cN=b},0),cN=p.now()}function cV(a,b){p.each(b,function(b,c){var d=(cT[b]||[]).concat(cT["*"]),e=0,f=d.length;for(;e<f;e++)if(d[e].call(a,b,c))return})}function cW(a,b,c){var d,e=0,f=0,g=cS.length,h=p.Deferred().always(function(){delete i.elem}),i=function(){var b=cN||cU(),c=Math.max(0,j.startTime+j.duration-b),d=1-(c/j.duration||0),e=0,f=j.tweens.length;for(;e<f;e++)j.tweens[e].run(d);return h.notifyWith(a,[j,d,c]),d<1&&f?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:p.extend({},b),opts:p.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:cN||cU(),duration:c.duration,tweens:[],createTween:function(b,c,d){var e=p.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(e),e},stop:function(b){var c=0,d=b?j.tweens.length:0;for(;c<d;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;cX(k,j.opts.specialEasing);for(;e<g;e++){d=cS[e].call(j,a,k,j.opts);if(d)return d}return cV(j,k),p.isFunction(j.opts.start)&&j.opts.start.call(a,j),p.fx.timer(p.extend(i,{anim:j,queue:j.opts.queue,elem:a})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function cX(a,b){var c,d,e,f,g;for(c in a){d=p.camelCase(c),e=b[d],f=a[c],p.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=p.cssHooks[d];if(g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}}function cY(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=a.style,n={},o=[],q=a.nodeType&&bZ(a);c.queue||(j=p._queueHooks(a,"fx"),j.unqueued==null&&(j.unqueued=0,k=j.empty.fire,j.empty.fire=function(){j.unqueued||k()}),j.unqueued++,l.always(function(){l.always(function(){j.unqueued--,p.queue(a,"fx").length||j.empty.fire()})})),a.nodeType===1&&("height"in b||"width"in b)&&(c.overflow=[m.overflow,m.overflowX,m.overflowY],p.css(a,"display")==="inline"&&p.css(a,"float")==="none"&&(!p.support.inlineBlockNeedsLayout||cc(a.nodeName)==="inline"?m.display="inline-block":m.zoom=1)),c.overflow&&(m.overflow="hidden",p.support.shrinkWrapBlocks||l.done(function(){m.overflow=c.overflow[0],m.overflowX=c.overflow[1],m.overflowY=c.overflow[2]}));for(d in b){f=b[d];if(cP.exec(f)){delete b[d];if(f===(q?"hide":"show"))continue;o.push(d)}}g=o.length;if(g){h=p._data(a,"fxshow")||p._data(a,"fxshow",{}),q?p(a).show():l.done(function(){p(a).hide()}),l.done(function(){var b;p.removeData(a,"fxshow",!0);for(b in n)p.style(a,b,n[b])});for(d=0;d<g;d++)e=o[d],i=l.createTween(e,q?h[e]:0),n[e]=h[e]||p.style(a,e),e in h||(h[e]=i.start,q&&(i.end=i.start,i.start=e==="width"||e==="height"?1:0))}}function cZ(a,b,c,d,e){return new cZ.prototype.init(a,b,c,d,e)}function c$(a,b){var c,d={height:a},e=0;b=b?1:0;for(;e<4;e+=2-b)c=bV[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function da(a){return p.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}var c,d,e=a.document,f=a.location,g=a.navigator,h=a.jQuery,i=a.$,j=Array.prototype.push,k=Array.prototype.slice,l=Array.prototype.indexOf,m=Object.prototype.toString,n=Object.prototype.hasOwnProperty,o=String.prototype.trim,p=function(a,b){return new p.fn.init(a,b,c)},q=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,r=/\S/,s=/\s+/,t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,u=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,y=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,z=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,A=/^-ms-/,B=/-([\da-z])/gi,C=function(a,b){return(b+"").toUpperCase()},D=function(){e.addEventListener?(e.removeEventListener("DOMContentLoaded",D,!1),p.ready()):e.readyState==="complete"&&(e.detachEvent("onreadystatechange",D),p.ready())},E={};p.fn=p.prototype={constructor:p,init:function(a,c,d){var f,g,h,i;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(typeof a=="string"){a.charAt(0)==="<"&&a.charAt(a.length-1)===">"&&a.length>=3?f=[null,a,null]:f=u.exec(a);if(f&&(f[1]||!c)){if(f[1])return c=c instanceof p?c[0]:c,i=c&&c.nodeType?c.ownerDocument||c:e,a=p.parseHTML(f[1],i,!0),v.test(f[1])&&p.isPlainObject(c)&&this.attr.call(a,c,!0),p.merge(this,a);g=e.getElementById(f[2]);if(g&&g.parentNode){if(g.id!==f[2])return d.find(a);this.length=1,this[0]=g}return this.context=e,this.selector=a,this}return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a)}return p.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),p.makeArray(a,this))},selector:"",jquery:"1.8.1",length:0,size:function(){return this.length},toArray:function(){return k.call(this)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=p.merge(this.constructor(),a);return d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")"),d},each:function(a,b){return p.each(this,a,b)},ready:function(a){return p.ready.promise().done(a),this},eq:function(a){return a=+a,a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(k.apply(this,arguments),"slice",k.call(arguments).join(","))},map:function(a){return this.pushStack(p.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:j,sort:[].sort,splice:[].splice},p.fn.init.prototype=p.fn,p.extend=p.fn.extend=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;typeof h=="boolean"&&(k=h,h=arguments[1]||{},i=2),typeof h!="object"&&!p.isFunction(h)&&(h={}),j===i&&(h=this,--i);for(;i<j;i++)if((a=arguments[i])!=null)for(c in a){d=h[c],e=a[c];if(h===e)continue;k&&e&&(p.isPlainObject(e)||(f=p.isArray(e)))?(f?(f=!1,g=d&&p.isArray(d)?d:[]):g=d&&p.isPlainObject(d)?d:{},h[c]=p.extend(k,g,e)):e!==b&&(h[c]=e)}return h},p.extend({noConflict:function(b){return a.$===p&&(a.$=i),b&&a.jQuery===p&&(a.jQuery=h),p},isReady:!1,readyWait:1,holdReady:function(a){a?p.readyWait++:p.ready(!0)},ready:function(a){if(a===!0?--p.readyWait:p.isReady)return;if(!e.body)return setTimeout(p.ready,1);p.isReady=!0;if(a!==!0&&--p.readyWait>0)return;d.resolveWith(e,[p]),p.fn.trigger&&p(e).trigger("ready").off("ready")},isFunction:function(a){return p.type(a)==="function"},isArray:Array.isArray||function(a){return p.type(a)==="array"},isWindow:function(a){return a!=null&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):E[m.call(a)]||"object"},isPlainObject:function(a){if(!a||p.type(a)!=="object"||a.nodeType||p.isWindow(a))return!1;try{if(a.constructor&&!n.call(a,"constructor")&&!n.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||n.call(a,d)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},error:function(a){throw new Error(a)},parseHTML:function(a,b,c){var d;return!a||typeof a!="string"?null:(typeof b=="boolean"&&(c=b,b=0),b=b||e,(d=v.exec(a))?[b.createElement(d[1])]:(d=p.buildFragment([a],b,c?null:[]),p.merge([],(d.cacheable?p.clone(d.fragment):d.fragment).childNodes)))},parseJSON:function(b){if(!b||typeof b!="string")return null;b=p.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(w.test(b.replace(y,"@").replace(z,"]").replace(x,"")))return(new Function("return "+b))();p.error("Invalid JSON: "+b)},parseXML:function(c){var d,e;if(!c||typeof c!="string")return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&p.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&r.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(A,"ms-").replace(B,C)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var e,f=0,g=a.length,h=g===b||p.isFunction(a);if(d){if(h){for(e in a)if(c.apply(a[e],d)===!1)break}else for(;f<g;)if(c.apply(a[f++],d)===!1)break}else if(h){for(e in a)if(c.call(a[e],e,a[e])===!1)break}else for(;f<g;)if(c.call(a[f],f,a[f++])===!1)break;return a},trim:o&&!o.call("﻿ ")?function(a){return a==null?"":o.call(a)}:function(a){return a==null?"":a.toString().replace(t,"")},makeArray:function(a,b){var c,d=b||[];return a!=null&&(c=p.type(a),a.length==null||c==="string"||c==="function"||c==="regexp"||p.isWindow(a)?j.call(d,a):p.merge(d,a)),d},inArray:function(a,b,c){var d;if(b){if(l)return l.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=c.length,e=a.length,f=0;if(typeof d=="number")for(;f<d;f++)a[e++]=c[f];else while(c[f]!==b)a[e++]=c[f++];return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;c=!!c;for(;f<g;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,c,d){var e,f,g=[],h=0,i=a.length,j=a instanceof p||i!==b&&typeof i=="number"&&(i>0&&a[0]&&a[i-1]||i===0||p.isArray(a));if(j)for(;h<i;h++)e=c(a[h],h,d),e!=null&&(g[g.length]=e);else for(f in a)e=c(a[f],f,d),e!=null&&(g[g.length]=e);return g.concat.apply([],g)},guid:1,proxy:function(a,c){var d,e,f;return typeof c=="string"&&(d=a[c],c=a,a=d),p.isFunction(a)?(e=k.call(arguments,2),f=function(){return a.apply(c,e.concat(k.call(arguments)))},f.guid=a.guid=a.guid||f.guid||p.guid++,f):b},access:function(a,c,d,e,f,g,h){var i,j=d==null,k=0,l=a.length;if(d&&typeof d=="object"){for(k in d)p.access(a,c,k,d[k],1,g,e);f=1}else if(e!==b){i=h===b&&p.isFunction(e),j&&(i?(i=c,c=function(a,b,c){return i.call(p(a),c)}):(c.call(a,e),c=null));if(c)for(;k<l;k++)c(a[k],d,i?e.call(a[k],k,c(a[k],d)):e,h);f=1}return f?a:j?c.call(a):l?c(a[0],d):g},now:function(){return(new Date).getTime()}}),p.ready.promise=function(b){if(!d){d=p.Deferred();if(e.readyState==="complete")setTimeout(p.ready,1);else if(e.addEventListener)e.addEventListener("DOMContentLoaded",D,!1),a.addEventListener("load",p.ready,!1);else{e.attachEvent("onreadystatechange",D),a.attachEvent("onload",p.ready);var c=!1;try{c=a.frameElement==null&&e.documentElement}catch(f){}c&&c.doScroll&&function g(){if(!p.isReady){try{c.doScroll("left")}catch(a){return setTimeout(g,50)}p.ready()}}()}}return d.promise(b)},p.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){E["[object "+b+"]"]=b.toLowerCase()}),c=p(e);var F={};p.Callbacks=function(a){a=typeof a=="string"?F[a]||G(a):p.extend({},a);var c,d,e,f,g,h,i=[],j=!a.once&&[],k=function(b){c=a.memory&&b,d=!0,h=f||0,f=0,g=i.length,e=!0;for(;i&&h<g;h++)if(i[h].apply(b[0],b[1])===!1&&a.stopOnFalse){c=!1;break}e=!1,i&&(j?j.length&&k(j.shift()):c?i=[]:l.disable())},l={add:function(){if(i){var b=i.length;(function d(b){p.each(b,function(b,c){var e=p.type(c);e==="function"&&(!a.unique||!l.has(c))?i.push(c):c&&c.length&&e!=="string"&&d(c)})})(arguments),e?g=i.length:c&&(f=b,k(c))}return this},remove:function(){return i&&p.each(arguments,function(a,b){var c;while((c=p.inArray(b,i,c))>-1)i.splice(c,1),e&&(c<=g&&g--,c<=h&&h--)}),this},has:function(a){return p.inArray(a,i)>-1},empty:function(){return i=[],this},disable:function(){return i=j=c=b,this},disabled:function(){return!i},lock:function(){return j=b,c||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],i&&(!d||j)&&(e?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!d}};return l},p.extend({Deferred:function(a){var b=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return p.Deferred(function(c){p.each(b,function(b,d){var f=d[0],g=a[b];e[d[1]](p.isFunction(g)?function(){var a=g.apply(this,arguments);a&&p.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f+"With"](this===e?c:this,[a])}:c[f])}),a=null}).promise()},promise:function(a){return typeof a=="object"?p.extend(a,d):d}},e={};return d.pipe=d.then,p.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[a^1][2].disable,b[2][2].lock),e[f[0]]=g.fire,e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=k.call(arguments),d=c.length,e=d!==1||a&&p.isFunction(a.promise)?d:0,f=e===1?a:p.Deferred(),g=function(a,b,c){return function(d){b[a]=this,c[a]=arguments.length>1?k.call(arguments):d,c===h?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},h,i,j;if(d>1){h=new Array(d),i=new Array(d),j=new Array(d);for(;b<d;b++)c[b]&&p.isFunction(c[b].promise)?c[b].promise().done(g(b,j,c)).fail(f.reject).progress(g(b,i,h)):--e}return e||f.resolveWith(j,c),f.promise()}}),p.support=function(){var b,c,d,f,g,h,i,j,k,l,m,n=e.createElement("div");n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=n.getElementsByTagName("*"),d=n.getElementsByTagName("a")[0],d.style.cssText="top:1px;float:left;opacity:.5";if(!c||!c.length||!d)return{};f=e.createElement("select"),g=f.appendChild(e.createElement("option")),h=n.getElementsByTagName("input")[0],b={leadingWhitespace:n.firstChild.nodeType===3,tbody:!n.getElementsByTagName("tbody").length,htmlSerialize:!!n.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:d.getAttribute("href")==="/a",opacity:/^0.5/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:h.value==="on",optSelected:g.selected,getSetAttribute:n.className!=="t",enctype:!!e.createElement("form").enctype,html5Clone:e.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:e.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},h.checked=!0,b.noCloneChecked=h.cloneNode(!0).checked,f.disabled=!0,b.optDisabled=!g.disabled;try{delete n.test}catch(o){b.deleteExpando=!1}!n.addEventListener&&n.attachEvent&&n.fireEvent&&(n.attachEvent("onclick",m=function(){b.noCloneEvent=!1}),n.cloneNode(!0).fireEvent("onclick"),n.detachEvent("onclick",m)),h=e.createElement("input"),h.value="t",h.setAttribute("type","radio"),b.radioValue=h.value==="t",h.setAttribute("checked","checked"),h.setAttribute("name","t"),n.appendChild(h),i=e.createDocumentFragment(),i.appendChild(n.lastChild),b.checkClone=i.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=h.checked,i.removeChild(h),i.appendChild(n);if(n.attachEvent)for(k in{submit:!0,change:!0,focusin:!0})j="on"+k,l=j in n,l||(n.setAttribute(j,"return;"),l=typeof n[j]=="function"),b[k+"Bubbles"]=l;return p(function(){var c,d,f,g,h="padding:0;margin:0;border:0;display:block;overflow:hidden;",i=e.getElementsByTagName("body")[0];if(!i)return;c=e.createElement("div"),c.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",i.insertBefore(c,i.firstChild),d=e.createElement("div"),c.appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",f=d.getElementsByTagName("td"),f[0].style.cssText="padding:0;margin:0;border:0;display:none",l=f[0].offsetHeight===0,f[0].style.display="",f[1].style.display="none",b.reliableHiddenOffsets=l&&f[0].offsetHeight===0,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",b.boxSizing=d.offsetWidth===4,b.doesNotIncludeMarginInBodyOffset=i.offsetTop!==1,a.getComputedStyle&&(b.pixelPosition=(a.getComputedStyle(d,null)||{}).top!=="1%",b.boxSizingReliable=(a.getComputedStyle(d,null)||{width:"4px"}).width==="4px",g=e.createElement("div"),g.style.cssText=d.style.cssText=h,g.style.marginRight=g.style.width="0",d.style.width="1px",d.appendChild(g),b.reliableMarginRight=!parseFloat((a.getComputedStyle(g,null)||{}).marginRight)),typeof d.style.zoom!="undefined"&&(d.innerHTML="",d.style.cssText=h+"width:1px;padding:1px;display:inline;zoom:1",b.inlineBlockNeedsLayout=d.offsetWidth===3,d.style.display="block",d.style.overflow="visible",d.innerHTML="<div></div>",d.firstChild.style.width="5px",b.shrinkWrapBlocks=d.offsetWidth!==3,c.style.zoom=1),i.removeChild(c),c=d=f=g=null}),i.removeChild(n),c=d=f=g=h=i=n=null,b}();var H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,I=/([A-Z])/g;p.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(p.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?p.cache[a[p.expando]]:a[p.expando],!!a&&!K(a)},data:function(a,c,d,e){if(!p.acceptData(a))return;var f,g,h=p.expando,i=typeof c=="string",j=a.nodeType,k=j?p.cache:a,l=j?a[h]:a[h]&&h;if((!l||!k[l]||!e&&!k[l].data)&&i&&d===b)return;l||(j?a[h]=l=p.deletedIds.pop()||++p.uuid:l=h),k[l]||(k[l]={},j||(k[l].toJSON=p.noop));if(typeof c=="object"||typeof c=="function")e?k[l]=p.extend(k[l],c):k[l].data=p.extend(k[l].data,c);return f=k[l],e||(f.data||(f.data={}),f=f.data),d!==b&&(f[p.camelCase(c)]=d),i?(g=f[c],g==null&&(g=f[p.camelCase(c)])):g=f,g},removeData:function(a,b,c){if(!p.acceptData(a))return;var d,e,f,g=a.nodeType,h=g?p.cache:a,i=g?a[p.expando]:p.expando;if(!h[i])return;if(b){d=c?h[i]:h[i].data;if(d){p.isArray(b)||(b in d?b=[b]:(b=p.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,f=b.length;e<f;e++)delete d[b[e]];if(!(c?K:p.isEmptyObject)(d))return}}if(!c){delete h[i].data;if(!K(h[i]))return}g?p.cleanData([a],!0):p.support.deleteExpando||h!=h.window?delete h[i]:h[i]=null},_data:function(a,b,c){return p.data(a,b,c,!0)},acceptData:function(a){var b=a.nodeName&&p.noData[a.nodeName.toLowerCase()];return!b||b!==!0&&a.getAttribute("classid")===b}}),p.fn.extend({data:function(a,c){var d,e,f,g,h,i=this[0],j=0,k=null;if(a===b){if(this.length){k=p.data(i);if(i.nodeType===1&&!p._data(i,"parsedAttrs")){f=i.attributes;for(h=f.length;j<h;j++)g=f[j].name,g.indexOf("data-")===0&&(g=p.camelCase(g.substring(5)),J(i,g,k[g]));p._data(i,"parsedAttrs",!0)}}return k}return typeof a=="object"?this.each(function(){p.data(this,a)}):(d=a.split(".",2),d[1]=d[1]?"."+d[1]:"",e=d[1]+"!",p.access(this,function(c){if(c===b)return k=this.triggerHandler("getData"+e,[d[0]]),k===b&&i&&(k=p.data(i,a),k=J(i,a,k)),k===b&&d[1]?this.data(d[0]):k;d[1]=c,this.each(function(){var b=p(this);b.triggerHandler("setData"+e,d),p.data(this,a,c),b.triggerHandler("changeData"+e,d)})},null,c,arguments.length>1,null,!1))},removeData:function(a){return this.each(function(){p.removeData(this,a)})}}),p.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=p._data(a,b),c&&(!d||p.isArray(c)?d=p._data(a,b,p.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=p.queue(a,b),d=c.length,e=c.shift(),f=p._queueHooks(a,b),g=function(){p.dequeue(a,b)};e==="inprogress"&&(e=c.shift(),d--),e&&(b==="fx"&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return p._data(a,c)||p._data(a,c,{empty:p.Callbacks("once memory").add(function(){p.removeData(a,b+"queue",!0),p.removeData(a,c,!0)})})}}),p.fn.extend({queue:function(a,c){var d=2;return typeof a!="string"&&(c=a,a="fx",d--),arguments.length<d?p.queue(this[0],a):c===b?this:this.each(function(){var b=p.queue(this,a,c);p._queueHooks(this,a),a==="fx"&&b[0]!=="inprogress"&&p.dequeue(this,a)})},dequeue:function(a){return this.each(function(){p.dequeue(this,a)})},delay:function(a,b){return a=p.fx?p.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=p.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};typeof a!="string"&&(c=a,a=b),a=a||"fx";while(h--)d=p._data(g[h],a+"queueHooks"),d&&d.empty&&(e++,d.empty.add(i));return i(),f.promise(c)}});var L,M,N,O=/[\t\r\n]/g,P=/\r/g,Q=/^(?:button|input)$/i,R=/^(?:button|input|object|select|textarea)$/i,S=/^a(?:rea|)$/i,T=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,U=p.support.getSetAttribute;p.fn.extend({attr:function(a,b){return p.access(this,p.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){p.removeAttr(this,a)})},prop:function(a,b){return p.access(this,p.prop,a,b,arguments.length>1)},removeProp:function(a){return a=p.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g,h;if(p.isFunction(a))return this.each(function(b){p(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(s);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{f=" "+e.className+" ";for(g=0,h=b.length;g<h;g++)~f.indexOf(" "+b[g]+" ")||(f+=b[g]+" ");e.className=p.trim(f)}}}return this},removeClass:function(a){var c,d,e,f,g,h,i;if(p.isFunction(a))return this.each(function(b){p(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(s);for(h=0,i=this.length;h<i;h++){e=this[h];if(e.nodeType===1&&e.className){d=(" "+e.className+" ").replace(O," ");for(f=0,g=c.length;f<g;f++)while(d.indexOf(" "+c[f]+" ")>-1)d=d.replace(" "+c[f]+" "," ");e.className=a?p.trim(d):""}}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";return p.isFunction(a)?this.each(function(c){p(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if(c==="string"){var e,f=0,g=p(this),h=b,i=a.split(s);while(e=i[f++])h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&p._data(this,"__className__",this.className),this.className=this.className||a===!1?"":p._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(O," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,f=this[0];if(!arguments.length){if(f)return c=p.valHooks[f.type]||p.valHooks[f.nodeName.toLowerCase()],c&&"get"in c&&(d=c.get(f,"value"))!==b?d:(d=f.value,typeof d=="string"?d.replace(P,""):d==null?"":d);return}return e=p.isFunction(a),this.each(function(d){var f,g=p(this);if(this.nodeType!==1)return;e?f=a.call(this,d,g.val()):f=a,f==null?f="":typeof f=="number"?f+="":p.isArray(f)&&(f=p.map(f,function(a){return a==null?"":a+""})),c=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()];if(!c||!("set"in c)||c.set(this,f,"value")===b)this.value=f})}}),p.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,f=a.selectedIndex,g=[],h=a.options,i=a.type==="select-one";if(f<0)return null;c=i?f:0,d=i?f+1:h.length;for(;c<d;c++){e=h[c];if(e.selected&&(p.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!p.nodeName(e.parentNode,"optgroup"))){b=p(e).val();if(i)return b;g.push(b)}}return i&&!g.length&&h.length?p(h[f]).val():g},set:function(a,b){var c=p.makeArray(b);return p(a).find("option").each(function(){this.selected=p.inArray(p(this).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},attrFn:{},attr:function(a,c,d,e){var f,g,h,i=a.nodeType;if(!a||i===3||i===8||i===2)return;if(e&&p.isFunction(p.fn[c]))return p(a)[c](d);if(typeof a.getAttribute=="undefined")return p.prop(a,c,d);h=i!==1||!p.isXMLDoc(a),h&&(c=c.toLowerCase(),g=p.attrHooks[c]||(T.test(c)?M:L));if(d!==b){if(d===null){p.removeAttr(a,c);return}return g&&"set"in g&&h&&(f=g.set(a,d,c))!==b?f:(a.setAttribute(c,""+d),d)}return g&&"get"in g&&h&&(f=g.get(a,c))!==null?f:(f=a.getAttribute(c),f===null?b:f)},removeAttr:function(a,b){var c,d,e,f,g=0;if(b&&a.nodeType===1){d=b.split(s);for(;g<d.length;g++)e=d[g],e&&(c=p.propFix[e]||e,f=T.test(e),f||p.attr(a,e,""),a.removeAttribute(U?e:c),f&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(Q.test(a.nodeName)&&a.parentNode)p.error("type property can't be changed");else if(!p.support.radioValue&&b==="radio"&&p.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}},value:{get:function(a,b){return L&&p.nodeName(a,"button")?L.get(a,b):b in a?a.value:null},set:function(a,b,c){if(L&&p.nodeName(a,"button"))return L.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g,h=a.nodeType;if(!a||h===3||h===8||h===2)return;return g=h!==1||!p.isXMLDoc(a),g&&(c=p.propFix[c]||c,f=p.propHooks[c]),d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&(e=f.get(a,c))!==null?e:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):R.test(a.nodeName)||S.test(a.nodeName)&&a.href?0:b}}}}),M={get:function(a,c){var d,e=p.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;return b===!1?p.removeAttr(a,c):(d=p.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase())),c}},U||(N={name:!0,id:!0,coords:!0},L=p.valHooks.button={get:function(a,c){var d;return d=a.getAttributeNode(c),d&&(N[c]?d.value!=="":d.specified)?d.value:b},set:function(a,b,c){var d=a.getAttributeNode(c);return d||(d=e.createAttribute(c),a.setAttributeNode(d)),d.value=b+""}},p.each(["width","height"],function(a,b){p.attrHooks[b]=p.extend(p.attrHooks[b],{set:function(a,c){if(c==="")return a.setAttribute(b,"auto"),c}})}),p.attrHooks.contenteditable={get:L.get,set:function(a,b,c){b===""&&(b="false"),L.set(a,b,c)}}),p.support.hrefNormalized||p.each(["href","src","width","height"],function(a,c){p.attrHooks[c]=p.extend(p.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),p.support.style||(p.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),p.support.optSelected||(p.propHooks.selected=p.extend(p.propHooks.selected,{get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}})),p.support.enctype||(p.propFix.enctype="encoding"),p.support.checkOn||p.each(["radio","checkbox"],function(){p.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]=p.extend(p.valHooks[this],{set:function(a,b){if(p.isArray(b))return a.checked=p.inArray(p(a).val(),b)>=0}})});var V=/^(?:textarea|input|select)$/i,W=/^([^\.]*|)(?:\.(.+)|)$/,X=/(?:^|\s)hover(\.\S+|)\b/,Y=/^key/,Z=/^(?:mouse|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=function(a){return p.event.special.hover?a:a.replace(X,"mouseenter$1 mouseleave$1")};p.event={add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,q,r;if(a.nodeType===3||a.nodeType===8||!c||!d||!(g=p._data(a)))return;d.handler&&(o=d,d=o.handler,f=o.selector),d.guid||(d.guid=p.guid++),i=g.events,i||(g.events=i={}),h=g.handle,h||(g.handle=h=function(a){return typeof p!="undefined"&&(!a||p.event.triggered!==a.type)?p.event.dispatch.apply(h.elem,arguments):b},h.elem=a),c=p.trim(_(c)).split(" ");for(j=0;j<c.length;j++){k=W.exec(c[j])||[],l=k[1],m=(k[2]||"").split(".").sort(),r=p.event.special[l]||{},l=(f?r.delegateType:r.bindType)||l,r=p.event.special[l]||{},n=p.extend({type:l,origType:k[1],data:e,handler:d,guid:d.guid,selector:f,namespace:m.join(".")},o),q=i[l];if(!q){q=i[l]=[],q.delegateCount=0;if(!r.setup||r.setup.call(a,e,m,h)===!1)a.addEventListener?a.addEventListener(l,h,!1):a.attachEvent&&a.attachEvent("on"+l,h)}r.add&&(r.add.call(a,n),n.handler.guid||(n.handler.guid=d.guid)),f?q.splice(q.delegateCount++,0,n):q.push(n),p.event.global[l]=!0}a=null},global:{},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,q,r=p.hasData(a)&&p._data(a);if(!r||!(m=r.events))return;b=p.trim(_(b||"")).split(" ");for(f=0;f<b.length;f++){g=W.exec(b[f])||[],h=i=g[1],j=g[2];if(!h){for(h in m)p.event.remove(a,h+b[f],c,d,!0);continue}n=p.event.special[h]||{},h=(d?n.delegateType:n.bindType)||h,o=m[h]||[],k=o.length,j=j?new RegExp("(^|\\.)"+j.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(l=0;l<o.length;l++)q=o[l],(e||i===q.origType)&&(!c||c.guid===q.guid)&&(!j||j.test(q.namespace))&&(!d||d===q.selector||d==="**"&&q.selector)&&(o.splice(l--,1),q.selector&&o.delegateCount--,n.remove&&n.remove.call(a,q));o.length===0&&k!==o.length&&((!n.teardown||n.teardown.call(a,j,r.handle)===!1)&&p.removeEvent(a,h,r.handle),delete m[h])}p.isEmptyObject(m)&&(delete r.handle,p.removeData(a,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,f,g){if(!f||f.nodeType!==3&&f.nodeType!==8){var h,i,j,k,l,m,n,o,q,r,s=c.type||c,t=[];if($.test(s+p.event.triggered))return;s.indexOf("!")>=0&&(s=s.slice(0,-1),i=!0),s.indexOf(".")>=0&&(t=s.split("."),s=t.shift(),t.sort());if((!f||p.event.customEvent[s])&&!p.event.global[s])return;c=typeof c=="object"?c[p.expando]?c:new p.Event(s,c):new p.Event(s),c.type=s,c.isTrigger=!0,c.exclusive=i,c.namespace=t.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+t.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,m=s.indexOf(":")<0?"on"+s:"";if(!f){h=p.cache;for(j in h)h[j].events&&h[j].events[s]&&p.event.trigger(c,d,h[j].handle.elem,!0);return}c.result=b,c.target||(c.target=f),d=d!=null?p.makeArray(d):[],d.unshift(c),n=p.event.special[s]||{};if(n.trigger&&n.trigger.apply(f,d)===!1)return;q=[[f,n.bindType||s]];if(!g&&!n.noBubble&&!p.isWindow(f)){r=n.delegateType||s,k=$.test(r+s)?f:f.parentNode;for(l=f;k;k=k.parentNode)q.push([k,r]),l=k;l===(f.ownerDocument||e)&&q.push([l.defaultView||l.parentWindow||a,r])}for(j=0;j<q.length&&!c.isPropagationStopped();j++)k=q[j][0],c.type=q[j][1],o=(p._data(k,"events")||{})[c.type]&&p._data(k,"handle"),o&&o.apply(k,d),o=m&&k[m],o&&p.acceptData(k)&&o.apply(k,d)===!1&&c.preventDefault();return c.type=s,!g&&!c.isDefaultPrevented()&&(!n._default||n._default.apply(f.ownerDocument,d)===!1)&&(s!=="click"||!p.nodeName(f,"a"))&&p.acceptData(f)&&m&&f[s]&&(s!=="focus"&&s!=="blur"||c.target.offsetWidth!==0)&&!p.isWindow(f)&&(l=f[m],l&&(f[m]=null),p.event.triggered=s,f[s](),p.event.triggered=b,l&&(f[m]=l)),c.result}return},dispatch:function(c){c=p.event.fix(c||a.event);var d,e,f,g,h,i,j,k,l,m,n=(p._data(this,"events")||{})[c.type]||[],o=n.delegateCount,q=[].slice.call(arguments),r=!c.exclusive&&!c.namespace,s=p.event.special[c.type]||{},t=[];q[0]=c,c.delegateTarget=this;if(s.preDispatch&&s.preDispatch.call(this,c)===!1)return;if(o&&(!c.button||c.type!=="click"))for(f=c.target;f!=this;f=f.parentNode||this)if(f.disabled!==!0||c.type!=="click"){h={},j=[];for(d=0;d<o;d++)k=n[d],l=k.selector,h[l]===b&&(h[l]=p(l,this).index(f)>=0),h[l]&&j.push(k);j.length&&t.push({elem:f,matches:j})}n.length>o&&t.push({elem:this,matches:n.slice(o)});for(d=0;d<t.length&&!c.isPropagationStopped();d++){i=t[d],c.currentTarget=i.elem;for(e=0;e<i.matches.length&&!c.isImmediatePropagationStopped();e++){k=i.matches[e];if(r||!c.namespace&&!k.namespace||c.namespace_re&&c.namespace_re.test(k.namespace))c.data=k.data,c.handleObj=k,g=((p.event.special[k.origType]||{}).handle||k.handler).apply(i.elem,q),g!==b&&(c.result=g,g===!1&&(c.preventDefault(),c.stopPropagation()))}}return s.postDispatch&&s.postDispatch.call(this,c),c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,f,g,h=c.button,i=c.fromElement;return a.pageX==null&&c.clientX!=null&&(d=a.target.ownerDocument||e,f=d.documentElement,g=d.body,a.pageX=c.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=c.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?c.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0),a}},fix:function(a){if(a[p.expando])return a;var b,c,d=a,f=p.event.fixHooks[a.type]||{},g=f.props?this.props.concat(f.props):this.props;a=p.Event(d);for(b=g.length;b;)c=g[--b],a[c]=d[c];return a.target||(a.target=d.srcElement||e),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,f.filter?f.filter(a,d):a},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){p.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=p.extend(new p.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?p.event.trigger(e,null,b):p.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},p.event.handle=p.event.dispatch,p.removeEvent=e.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]=="undefined"&&(a[d]=null),a.detachEvent(d,c))},p.Event=function(a,b){if(this instanceof p.Event)a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?bb:ba):this.type=a,b&&p.extend(this,b),this.timeStamp=a&&a.timeStamp||p.now(),this[p.expando]=!0;else return new p.Event(a,b)},p.Event.prototype={preventDefault:function(){this.isDefaultPrevented=bb;var a=this.originalEvent;if(!a)return;a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=bb;var a=this.originalEvent;if(!a)return;a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=bb,this.stopPropagation()},isDefaultPrevented:ba,isPropagationStopped:ba,isImmediatePropagationStopped:ba},p.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){p.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj,g=f.selector;if(!e||e!==d&&!p.contains(d,e))a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b;return c}}}),p.support.submitBubbles||(p.event.special.submit={setup:function(){if(p.nodeName(this,"form"))return!1;p.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=p.nodeName(c,"input")||p.nodeName(c,"button")?c.form:b;d&&!p._data(d,"_submit_attached")&&(p.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),p._data(d,"_submit_attached",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&p.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(p.nodeName(this,"form"))return!1;p.event.remove(this,"._submit")}}),p.support.changeBubbles||(p.event.special.change={setup:function(){if(V.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")p.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),p.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),p.event.simulate("change",this,a,!0)});return!1}p.event.add(this,"beforeactivate._change",function(a){var b=a.target;V.test(b.nodeName)&&!p._data(b,"_change_attached")&&(p.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&p.event.simulate("change",this.parentNode,a,!0)}),p._data(b,"_change_attached",!0))})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){return p.event.remove(this,"._change"),!V.test(this.nodeName)}}),p.support.focusinBubbles||p.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){p.event.simulate(b,a.target,p.event.fix(a),!0)};p.event.special[b]={setup:function(){c++===0&&e.addEventListener(a,d,!0)},teardown:function(){--c===0&&e.removeEventListener(a,d,!0)}}}),p.fn.extend({on:function(a,c,d,e,f){var g,h;if(typeof a=="object"){typeof c!="string"&&(d=d||c,c=b);for(h in a)this.on(h,c,d,a[h],f);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=ba;else if(!e)return this;return f===1&&(g=e,e=function(a){return p().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=p.guid++)),this.each(function(){p.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,f;if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,p(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if(typeof a=="object"){for(f in a)this.off(f,c,a[f]);return this}if(c===!1||typeof c=="function")d=c,c=b;return d===!1&&(d=ba),this.each(function(){p.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return p(this.context).on(a,this.selector,b,c),this},die:function(a,b){return p(this.context).off(a,this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a||"**",c)},trigger:function(a,b){return this.each(function(){p.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return p.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||p.guid++,d=0,e=function(c){var e=(p._data(this,"lastToggle"+a.guid)||0)%d;return p._data(this,"lastToggle"+a.guid,e+1),c.preventDefault(),b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){p.fn[b]=function(a,c){return c==null&&(c=a,a=null),arguments.length>0?this.on(b,null,a,c):this.trigger(b)},Y.test(b)&&(p.event.fixHooks[b]=p.event.keyHooks),Z.test(b)&&(p.event.fixHooks[b]=p.event.mouseHooks)}),function(a,b){function $(a,b,c,d){c=c||[],b=b||q;var e,f,g,j,k=b.nodeType;if(k!==1&&k!==9)return[];if(!a||typeof a!="string")return c;g=h(b);if(!g&&!d)if(e=L.exec(a))if(j=e[1]){if(k===9){f=b.getElementById(j);if(!f||!f.parentNode)return c;if(f.id===j)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(j))&&i(b,f)&&f.id===j)return c.push(f),c}else{if(e[2])return u.apply(c,t.call(b.getElementsByTagName(a),0)),c;if((j=e[3])&&X&&b.getElementsByClassName)return u.apply(c,t.call(b.getElementsByClassName(j),0)),c}return bk(a,b,c,d,g)}function _(a){return function(b){var c=b.nodeName.toLowerCase();return c==="input"&&b.type===a}}function ba(a){return function(b){var c=b.nodeName.toLowerCase();return(c==="input"||c==="button")&&b.type===a}}function bb(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}function bc(a,b,c,d){var e,g,h,i,j,k,l,m,n,p,r=!c&&b!==q,s=(r?"<s>":"")+a.replace(H,"$1<s>"),u=y[o][s];if(u)return d?0:t.call(u,0);j=a,k=[],m=0,n=f.preFilter,p=f.filter;while(j){if(!e||(g=I.exec(j)))g&&(j=j.slice(g[0].length),h.selector=l),k.push(h=[]),l="",r&&(j=" "+j);e=!1;if(g=J.exec(j))l+=g[0],j=j.slice(g[0].length),e=h.push({part:g.pop().replace(H," "),string:g[0],captures:g});for(i in p)(g=S[i].exec(j))&&(!n[i]||(g=n[i](g,b,c)))&&(l+=g[0],j=j.slice(g[0].length),e=h.push({part:i,string:g.shift(),captures:g}));if(!e)break}return l&&(h.selector=l),d?j.length:j?$.error(a):t.call(y(s,k),0)}function bd(a,b,e,f){var g=b.dir,h=s++;return a||(a=function(a){return a===e}),b.first?function(b){while(b=b[g])if(b.nodeType===1)return a(b)&&b}:f?function(b){while(b=b[g])if(b.nodeType===1&&a(b))return b}:function(b){var e,f=h+"."+c,i=f+"."+d;while(b=b[g])if(b.nodeType===1){if((e=b[o])===i)return b.sizset;if(typeof e=="string"&&e.indexOf(f)===0){if(b.sizset)return b}else{b[o]=i;if(a(b))return b.sizset=!0,b;b.sizset=!1}}}}function be(a,b){return a?function(c){var d=b(c);return d&&a(d===!0?c:d)}:b}function bf(a,b,c){var d,e,g=0;for(;d=a[g];g++)f.relative[d.part]?e=bd(e,f.relative[d.part],b,c):e=be(e,f.filter[d.part].apply(null,d.captures.concat(b,c)));return e}function bg(a){return function(b){var c,d=0;for(;c=a[d];d++)if(c(b))return!0;return!1}}function bh(a,b,c,d){var e=0,f=b.length;for(;e<f;e++)$(a,b[e],c,d)}function bi(a,b,c,d,e,g){var h,i=f.setFilters[b.toLowerCase()];return i||$.error(b),(a||!(h=e))&&bh(a||"*",d,h=[],e),h.length>0?i(h,c,g):[]}function bj(a,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=0,t=a.length,v=S.POS,w=new RegExp("^"+v.source+"(?!"+A+")","i"),x=function(){var a=1,c=arguments.length-2;for(;a<c;a++)arguments[a]===b&&(n[a]=b)};for(;s<t;s++){f=a[s],g="",m=e;for(h=0,i=f.length;h<i;h++){j=f[h],k=j.string;if(j.part==="PSEUDO"){v.exec(""),l=0;while(n=v.exec(k)){o=!0,p=v.lastIndex=n.index+n[0].length;if(p>l){g+=k.slice(l,n.index),l=p,q=[c],J.test(g)&&(m&&(q=m),m=e);if(r=O.test(g))g=g.slice(0,-5).replace(J,"$&*"),l++;n.length>1&&n[0].replace(w,x),m=bi(g,n[1],n[2],q,m,r)}g=""}}o||(g+=k),o=!1}g?J.test(g)?bh(g,m||[c],d,e):$(g,c,d,e?e.concat(m):m):u.apply(d,m)}return t===1?d:$.uniqueSort(d)}function bk(a,b,e,g,h){a=a.replace(H,"$1");var i,k,l,m,n,o,p,q,r,s,v=bc(a,b,h),w=b.nodeType;if(S.POS.test(a))return bj(v,b,e,g);if(g)i=t.call(g,0);else if(v.length===1){if((o=t.call(v[0],0)).length>2&&(p=o[0]).part==="ID"&&w===9&&!h&&f.relative[o[1].part]){b=f.find.ID(p.captures[0].replace(R,""),b,h)[0];if(!b)return e;a=a.slice(o.shift().string.length)}r=(v=N.exec(o[0].string))&&!v.index&&b.parentNode||b,q="";for(n=o.length-1;n>=0;n--){p=o[n],s=p.part,q=p.string+q;if(f.relative[s])break;if(f.order.test(s)){i=f.find[s](p.captures[0].replace(R,""),r,h);if(i==null)continue;a=a.slice(0,a.length-q.length)+q.replace(S[s],""),a||u.apply(e,t.call(i,0));break}}}if(a){k=j(a,b,h),c=k.dirruns++,i==null&&(i=f.find.TAG("*",N.test(a)&&b.parentNode||b));for(n=0;m=i[n];n++)d=k.runs++,k(m)&&e.push(m)}return e}var c,d,e,f,g,h,i,j,k,l,m=!0,n="undefined",o=("sizcache"+Math.random()).replace(".",""),q=a.document,r=q.documentElement,s=0,t=[].slice,u=[].push,v=function(a,b){return a[o]=b||!0,a},w=function(){var a={},b=[];return v(function(c,d){return b.push(c)>f.cacheLength&&delete a[b.shift()],a[c]=d},a)},x=w(),y=w(),z=w(),A="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",C=B.replace("w","w#"),D="([*^$|!~]?=)",E="\\["+A+"*("+B+")"+A+"*(?:"+D+A+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+C+")|)|)"+A+"*\\]",F=":("+B+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+E+")|[^:]|\\\\.)*|.*))\\)|)",G=":(nth|eq|gt|lt|first|last|even|odd)(?:\\(((?:-\\d)?\\d*)\\)|)(?=[^-]|$)",H=new RegExp("^"+A+"+|((?:^|[^\\\\])(?:\\\\.)*)"+A+"+$","g"),I=new RegExp("^"+A+"*,"+A+"*"),J=new RegExp("^"+A+"*([\\x20\\t\\r\\n\\f>+~])"+A+"*"),K=new RegExp(F),L=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,M=/^:not/,N=/[\x20\t\r\n\f]*[+~]/,O=/:not\($/,P=/h\d/i,Q=/input|select|textarea|button/i,R=/\\(?!\\)/g,S={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),NAME:new RegExp("^\\[name=['\"]?("+B+")['\"]?\\]"),TAG:new RegExp("^("+B.replace("w","w*")+")"),ATTR:new RegExp("^"+E),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|nth|last|first)-child(?:\\("+A+"*(even|odd|(([+-]|)(\\d*)n|)"+A+"*(?:([+-]|)"+A+"*(\\d+)|))"+A+"*\\)|)","i"),POS:new RegExp(G,"ig"),needsContext:new RegExp("^"+A+"*[>+~]|"+G,"i")},T=function(a){var b=q.createElement("div");try{return a(b)}catch(c){return!1}finally{b=null}},U=T(function(a){return a.appendChild(q.createComment("")),!a.getElementsByTagName("*").length}),V=T(function(a){return a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!==n&&a.firstChild.getAttribute("href")==="#"}),W=T(function(a){a.innerHTML="<select></select>";var b=typeof a.lastChild.getAttribute("multiple");return b!=="boolean"&&b!=="string"}),X=T(function(a){return a.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!a.getElementsByClassName||!a.getElementsByClassName("e").length?!1:(a.lastChild.className="e",a.getElementsByClassName("e").length===2)}),Y=T(function(a){a.id=o+0,a.innerHTML="<a name='"+o+"'></a><div name='"+o+"'></div>",r.insertBefore(a,r.firstChild);var b=q.getElementsByName&&q.getElementsByName(o).length===2+q.getElementsByName(o+0).length;return e=!q.getElementById(o),r.removeChild(a),b});try{t.call(r.childNodes,0)[0].nodeType}catch(Z){t=function(a){var b,c=[];for(;b=this[a];a++)c.push(b);return c}}$.matches=function(a,b){return $(a,null,null,b)},$.matchesSelector=function(a,b){return $(b,null,null,[a]).length>0},g=$.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(e===1||e===9||e===11){if(typeof a.textContent=="string")return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=g(a)}else if(e===3||e===4)return a.nodeValue}else for(;b=a[d];d++)c+=g(b);return c},h=$.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?b.nodeName!=="HTML":!1},i=$.contains=r.contains?function(a,b){var c=a.nodeType===9?a.documentElement:a,d=b&&b.parentNode;return a===d||!!(d&&d.nodeType===1&&c.contains&&c.contains(d))}:r.compareDocumentPosition?function(a,b){return b&&!!(a.compareDocumentPosition(b)&16)}:function(a,b){while(b=b.parentNode)if(b===a)return!0;return!1},$.attr=function(a,b){var c,d=h(a);return d||(b=b.toLowerCase()),f.attrHandle[b]?f.attrHandle[b](a):W||d?a.getAttribute(b):(c=a.getAttributeNode(b),c?typeof a[b]=="boolean"?a[b]?b:null:c.specified?c.value:null:null)},f=$.selectors={cacheLength:50,createPseudo:v,match:S,order:new RegExp("ID|TAG"+(Y?"|NAME":"")+(X?"|CLASS":"")),attrHandle:V?{}:{href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}},find:{ID:e?function(a,b,c){if(typeof b.getElementById!==n&&!c){var d=b.getElementById(a);return d&&d.parentNode?[d]:[]}}:function(a,c,d){if(typeof c.getElementById!==n&&!d){var e=c.getElementById(a);return e?e.id===a||typeof e.getAttributeNode!==n&&e.getAttributeNode("id").value===a?[e]:b:[]}},TAG:U?function(a,b){if(typeof b.getElementsByTagName!==n)return b.getElementsByTagName(a)}:function(a,b){var c=b.getElementsByTagName(a);if(a==="*"){var d,e=[],f=0;for(;d=c[f];f++)d.nodeType===1&&e.push(d);return e}return c},NAME:function(a,b){if(typeof b.getElementsByName!==n)return b.getElementsByName(name)},CLASS:function(a,b,c){if(typeof b.getElementsByClassName!==n&&!c)return b.getElementsByClassName(a)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(R,""),a[3]=(a[4]||a[5]||"").replace(R,""),a[2]==="~="&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),a[1]==="nth"?(a[2]||$.error(a[0]),a[3]=+(a[3]?a[4]+(a[5]||1):2*(a[2]==="even"||a[2]==="odd")),a[4]=+(a[6]+a[7]||a[2]==="odd")):a[2]&&$.error(a[0]),a},PSEUDO:function(a,b,c){var d,e;if(S.CHILD.test(a[0]))return null;if(a[3])a[2]=a[3];else if(d=a[4])K.test(d)&&(e=bc(d,b,c,!0))&&(e=d.indexOf(")",d.length-e)-d.length)&&(d=d.slice(0,e),a[0]=a[0].slice(0,e)),a[2]=d;return a.slice(0,3)}},filter:{ID:e?function(a){return a=a.replace(R,""),function(b){return b.getAttribute("id")===a}}:function(a){return a=a.replace(R,""),function(b){var c=typeof b.getAttributeNode!==n&&b.getAttributeNode("id");return c&&c.value===a}},TAG:function(a){return a==="*"?function(){return!0}:(a=a.replace(R,"").toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=x[o][a];return b||(b=x(a,new RegExp("(^|"+A+")"+a+"("+A+"|$)"))),function(a){return b.test(a.className||typeof a.getAttribute!==n&&a.getAttribute("class")||"")}},ATTR:function(a,b,c){return b?function(d){var e=$.attr(d,a),f=e+"";if(e==null)return b==="!=";switch(b){case"=":return f===c;case"!=":return f!==c;case"^=":return c&&f.indexOf(c)===0;case"*=":return c&&f.indexOf(c)>-1;case"$=":return c&&f.substr(f.length-c.length)===c;case"~=":return(" "+f+" ").indexOf(c)>-1;case"|=":return f===c||f.substr(0,c.length+1)===c+"-"}}:function(b){return $.attr(b,a)!=null}},CHILD:function(a,b,c,d){if(a==="nth"){var e=s++;return function(a){var b,f,g=0,h=a;if(c===1&&d===0)return!0;b=a.parentNode;if(b&&(b[o]!==e||!a.sizset)){for(h=b.firstChild;h;h=h.nextSibling)if(h.nodeType===1){h.sizset=++g;if(h===a)break}b[o]=e}return f=a.sizset-d,c===0?f===0:f%c===0&&f/c>=0}}return function(b){var c=b;switch(a){case"only":case"first":while(c=c.previousSibling)if(c.nodeType===1)return!1;if(a==="first")return!0;c=b;case"last":while(c=c.nextSibling)if(c.nodeType===1)return!1;return!0}}},PSEUDO:function(a,b,c,d){var e,g=f.pseudos[a]||f.pseudos[a.toLowerCase()];return g||$.error("unsupported pseudo: "+a),g[o]?g(b,c,d):g.length>1?(e=[a,a,"",b],function(a){return g(a,0,e)}):g}},pseudos:{not:v(function(a,b,c){var d=j(a.replace(H,"$1"),b,c);return function(a){return!d(a)}}),enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&!!a.checked||b==="option"&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!f.pseudos.empty(a)},empty:function(a){var b;a=a.firstChild;while(a){if(a.nodeName>"@"||(b=a.nodeType)===3||b===4)return!1;a=a.nextSibling}return!0},contains:v(function(a){return function(b){return(b.textContent||b.innerText||g(b)).indexOf(a)>-1}}),has:v(function(a){return function(b){return $(a,b).length>0}}),header:function(a){return P.test(a.nodeName)},text:function(a){var b,c;return a.nodeName.toLowerCase()==="input"&&(b=a.type)==="text"&&((c=a.getAttribute("type"))==null||c.toLowerCase()===b)},radio:_("radio"),checkbox:_("checkbox"),file:_("file"),password:_("password"),image:_("image"),submit:ba("submit"),reset:ba("reset"),button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&a.type==="button"||b==="button"},input:function(a){return Q.test(a.nodeName)},focus:function(a){var b=a.ownerDocument;return a===b.activeElement&&(!b.hasFocus||b.hasFocus())&&(!!a.type||!!a.href)},active:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b,c){return c?a.slice(1):[a[0]]},last:function(a,b,c){var d=a.pop();return c?a:[d]},even:function(a,b,c){var d=[],e=c?1:0,f=a.length;for(;e<f;e=e+2)d.push(a[e]);return d},odd:function(a,b,c){var d=[],e=c?0:1,f=a.length;for(;e<f;e=e+2)d.push(a[e]);return d},lt:function(a,b,c){return c?a.slice(+b):a.slice(0,+b)},gt:function(a,b,c){return c?a.slice(0,+b+1):a.slice(+b+1)},eq:function(a,b,c){var d=a.splice(+b,1);return c?a:d}}},k=r.compareDocumentPosition?function(a,b){return a===b?(l=!0,0):(!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition:a.compareDocumentPosition(b)&4)?-1:1}:function(a,b){if(a===b)return l=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,h=b.parentNode,i=g;if(g===h)return bb(a,b);if(!g)return-1;if(!h)return 1;while(i)e.unshift(i),i=i.parentNode;i=h;while(i)f.unshift(i),i=i.parentNode;c=e.length,d=f.length;for(var j=0;j<c&&j<d;j++)if(e[j]!==f[j])return bb(e[j],f[j]);return j===c?bb(a,f[j],-1):bb(e[j],b,1)},[0,0].sort(k),m=!l,$.uniqueSort=function(a){var b,c=1;l=m,a.sort(k);if(l)for(;b=a[c];c++)b===a[c-1]&&a.splice(c--,1);return a},$.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},j=$.compile=function(a,b,c){var d,e,f,g=z[o][a];if(g&&g.context===b)return g;d=bc(a,b,c);for(e=0,f=d.length;e<f;e++)d[e]=bf(d[e],b,c);return g=z(a,bg(d)),g.context=b,g.runs=g.dirruns=0,g},q.querySelectorAll&&function(){var a,b=bk,c=/'|\\/g,d=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,e=[],f=[":active"],g=r.matchesSelector||r.mozMatchesSelector||r.webkitMatchesSelector||r.oMatchesSelector||r.msMatchesSelector;T(function(a){a.innerHTML="<select><option selected=''></option></select>",a.querySelectorAll("[selected]").length||e.push("\\["+A+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),a.querySelectorAll(":checked").length||e.push(":checked")}),T(function(a){a.innerHTML="<p test=''></p>",a.querySelectorAll("[test^='']").length&&e.push("[*^$]="+A+"*(?:\"\"|'')"),a.innerHTML="<input type='hidden'/>",a.querySelectorAll(":enabled").length||e.push(":enabled",":disabled")}),e=e.length&&new RegExp(e.join("|")),bk=function(a,d,f,g,h){if(!g&&!h&&(!e||!e.test(a)))if(d.nodeType===9)try{return u.apply(f,t.call(d.querySelectorAll(a),0)),f}catch(i){}else if(d.nodeType===1&&d.nodeName.toLowerCase()!=="object"){var j,k,l,m=d.getAttribute("id"),n=m||o,p=N.test(a)&&d.parentNode||d;m?n=n.replace(c,"\\$&"):d.setAttribute("id",n),j=bc(a,d,h),n="[id='"+n+"']";for(k=0,l=j.length;k<l;k++)j[k]=n+j[k].selector;try{return u.apply(f,t.call(p.querySelectorAll(j.join(",")),0)),f}catch(i){}finally{m||d.removeAttribute("id")}}return b(a,d,f,g,h)},g&&(T(function(b){a=g.call(b,"div");try{g.call(b,"[test!='']:sizzle"),f.push(S.PSEUDO.source,S.POS.source,"!=")}catch(c){}}),f=new RegExp(f.join("|")),$.matchesSelector=function(b,c){c=c.replace(d,"='$1']");if(!h(b)&&!f.test(c)&&(!e||!e.test(c)))try{var i=g.call(b,c);if(i||a||b.document&&b.document.nodeType!==11)return i}catch(j){}return $(c,null,null,[b]).length>0})}(),f.setFilters.nth=f.setFilters.eq,f.filters=f.pseudos,$.attr=p.attr,p.find=$,p.expr=$.selectors,p.expr[":"]=p.expr.pseudos,p.unique=$.uniqueSort,p.text=$.getText,p.isXMLDoc=$.isXML,p.contains=$.contains}(a);var bc=/Until$/,bd=/^(?:parents|prev(?:Until|All))/,be=/^.[^:#\[\.,]*$/,bf=p.expr.match.needsContext,bg={children:!0,contents:!0,next:!0,prev:!0};p.fn.extend({find:function(a){var b,c,d,e,f,g,h=this;if(typeof a!="string")return p(a).filter(function(){for(b=0,c=h.length;b<c;b++)if(p.contains(h[b],this))return!0});g=this.pushStack("","find",a);for(b=0,c=this.length;b<c;b++){d=g.length,p.find(a,this[b],g);if(b>0)for(e=d;e<g.length;e++)for(f=0;f<d;f++)if(g[f]===g[e]){g.splice(e--,1);break}}return g},has:function(a){var b,c=p(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++)if(p.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(bj(this,a,!1),"not",a)},filter:function(a){return this.pushStack(bj(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?bf.test(a)?p(a,this.context).index(this[0])>=0:p.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c,d=0,e=this.length,f=[],g=bf.test(a)||typeof a!="string"?p(a,b||this.context):0;for(;d<e;d++){c=this[d];while(c&&c.ownerDocument&&c!==b&&c.nodeType!==11){if(g?g.index(c)>-1:p.find.matchesSelector(c,a)){f.push(c);break}c=c.parentNode}}return f=f.length>1?p.unique(f):f,this.pushStack(f,"closest",a)},index:function(a){return a?typeof a=="string"?p.inArray(this[0],p(a)):p.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c=typeof a=="string"?p(a,b):p.makeArray(a&&a.nodeType?[a]:a),d=p.merge(this.get(),c);return this.pushStack(bh(c[0])||bh(d[0])?d:p.unique(d))},addBack:function(a){return this.add(a==null?this.prevObject:this.prevObject.filter(a))}}),p.fn.andSelf=p.fn.addBack,p.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return p.dir(a,"parentNode")},parentsUntil:function(a,b,c){return p.dir(a,"parentNode",c)},next:function(a){return bi(a,"nextSibling")},prev:function(a){return bi(a,"previousSibling")},nextAll:function(a){return p.dir(a,"nextSibling")},prevAll:function(a){return p.dir(a,"previousSibling")},nextUntil:function(a,b,c){return p.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return p.dir(a,"previousSibling",c)},siblings:function(a){return p.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return p.sibling(a.firstChild)},contents:function(a){return p.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:p.merge([],a.childNodes)}},function(a,b){p.fn[a]=function(c,d){var e=p.map(this,b,c);return bc.test(a)||(d=c),d&&typeof d=="string"&&(e=p.filter(d,e)),e=this.length>1&&!bg[a]?p.unique(e):e,this.length>1&&bd.test(a)&&(e=e.reverse()),this.pushStack(e,a,k.call(arguments).join(","))}}),p.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),b.length===1?p.find.matchesSelector(b[0],a)?[b[0]]:[]:p.find.matches(a,b)},dir:function(a,c,d){var e=[],f=a[c];while(f&&f.nodeType!==9&&(d===b||f.nodeType!==1||!p(f).is(d)))f.nodeType===1&&e.push(f),f=f[c];return e},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var bl="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",bm=/ jQuery\d+="(?:null|\d+)"/g,bn=/^\s+/,bo=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bp=/<([\w:]+)/,bq=/<tbody/i,br=/<|&#?\w+;/,bs=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,bu=new RegExp("<(?:"+bl+")[\\s/>]","i"),bv=/^(?:checkbox|radio)$/,bw=/checked\s*(?:[^=]|=\s*.checked.)/i,bx=/\/(java|ecma)script/i,by=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,bz={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bA=bk(e),bB=bA.appendChild(e.createElement("div"));bz.optgroup=bz.option,bz.tbody=bz.tfoot=bz.colgroup=bz.caption=bz.thead,bz.th=bz.td,p.support.htmlSerialize||(bz._default=[1,"X<div>","</div>"]),p.fn.extend({text:function(a){return p.access(this,function(a){return a===b?p.text(this):this.empty().append((this[0]&&this[0].ownerDocument||e).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(p.isFunction(a))return this.each(function(b){p(this).wrapAll(a.call(this,b))});if(this[0]){var b=p(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return p.isFunction(a)?this.each(function(b){p(this).wrapInner(a.call(this,b))}):this.each(function(){var b=p(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=p.isFunction(a);return this.each(function(c){p(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(a,this.firstChild)})},before:function(){if(!bh(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=p.clean(arguments);return this.pushStack(p.merge(a,this),"before",this.selector)}},after:function(){if(!bh(this[0]))return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=p.clean(arguments);return this.pushStack(p.merge(this,a),"after",this.selector)}},remove:function(a,b){var c,d=0;for(;(c=this[d])!=null;d++)if(!a||p.filter(a,[c]).length)!b&&c.nodeType===1&&(p.cleanData(c.getElementsByTagName("*")),p.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c);return this},empty:function(){var a,b=0;for(;(a=this[b])!=null;b++){a.nodeType===1&&p.cleanData(a.getElementsByTagName("*"));while(a.firstChild)a.removeChild(a.firstChild)}return this},clone:function(a,b){return a=a==null?!1:a,b=b==null?a:b,this.map(function(){return p.clone(this,a,b)})},html:function(a){return p.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return c.nodeType===1?c.innerHTML.replace(bm,""):b;if(typeof a=="string"&&!bs.test(a)&&(p.support.htmlSerialize||!bu.test(a))&&(p.support.leadingWhitespace||!bn.test(a))&&!bz[(bp.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(bo,"<$1></$2>");try{for(;d<e;d++)c=this[d]||{},c.nodeType===1&&(p.cleanData(c.getElementsByTagName("*")),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){return bh(this[0])?this.length?this.pushStack(p(p.isFunction(a)?a():a),"replaceWith",a):this:p.isFunction(a)?this.each(function(b){var c=p(this),d=c.html();c.replaceWith(a.call(this,b,d))}):(typeof a!="string"&&(a=p(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;p(this).remove(),b?p(b).before(a):p(c).append(a)}))},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){a=[].concat.apply([],a);var e,f,g,h,i=0,j=a[0],k=[],l=this.length;if(!p.support.checkClone&&l>1&&typeof j=="string"&&bw.test(j))return this.each(function(){p(this).domManip(a,c,d)});if(p.isFunction(j))return this.each(function(e){var f=p(this);a[0]=j.call(this,e,c?f.html():b),f.domManip(a,c,d)});if(this[0]){e=p.buildFragment(a,this,k),g=e.fragment,f=g.firstChild,g.childNodes.length===1&&(g=f);if(f){c=c&&p.nodeName(f,"tr");for(h=e.cacheable||l-1;i<l;i++)d.call(c&&p.nodeName(this[i],"table")?bC(this[i],"tbody"):this[i],i===h?g:p.clone(g,!0,!0))}g=f=null,k.length&&p.each(k,function(a,b){b.src?p.ajax?p.ajax({url:b.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):p.error("no ajax"):p.globalEval((b.text||b.textContent||b.innerHTML||"").replace(by,"")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),p.buildFragment=function(a,c,d){var f,g,h,i=a[0];return c=c||e,c=!c.nodeType&&c[0]||c,c=c.ownerDocument||c,a.length===1&&typeof i=="string"&&i.length<512&&c===e&&i.charAt(0)==="<"&&!bt.test(i)&&(p.support.checkClone||!bw.test(i))&&(p.support.html5Clone||!bu.test(i))&&(g=!0,f=p.fragments[i],h=f!==b),f||(f=c.createDocumentFragment(),p.clean(a,c,f,d),g&&(p.fragments[i]=h&&f)),{fragment:f,cacheable:g}},p.fragments={},p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){p.fn[a]=function(c){var d,e=0,f=[],g=p(c),h=g.length,i=this.length===1&&this[0].parentNode;if((i==null||i&&i.nodeType===11&&i.childNodes.length===1)&&h===1)return g[b](this[0]),this;for(;e<h;e++)d=(e>0?this.clone(!0):this).get(),p(g[e])[b](d),f=f.concat(d);return this.pushStack(f,a,g.selector)}}),p.extend({clone:function(a,b,c){var d,e,f,g;p.support.html5Clone||p.isXMLDoc(a)||!bu.test("<"+a.nodeName+">")?g=a.cloneNode(!0):(bB.innerHTML=a.outerHTML,bB.removeChild(g=bB.firstChild));if((!p.support.noCloneEvent||!p.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!p.isXMLDoc(a)){bE(a,g),d=bF(a),e=bF(g);for(f=0;d[f];++f)e[f]&&bE(d[f],e[f])}if(b){bD(a,g);if(c){d=bF(a),e=bF(g);for(f=0;d[f];++f)bD(d[f],e[f])}}return d=e=null,g},clean:function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,q,r,s=b===e&&bA,t=[];if(!b||typeof b.createDocumentFragment=="undefined")b=e;for(f=0;(h=a[f])!=null;f++){typeof h=="number"&&(h+="");if(!h)continue;if(typeof h=="string")if(!br.test(h))h=b.createTextNode(h);else{s=s||bk(b),l=b.createElement("div"),s.appendChild(l),h=h.replace(bo,"<$1></$2>"),i=(bp.exec(h)||["",""])[1].toLowerCase(),j=bz[i]||bz._default,k=j[0],l.innerHTML=j[1]+h+j[2];while(k--)l=l.lastChild;if(!p.support.tbody){m=bq.test(h),n=i==="table"&&!m?l.firstChild&&l.firstChild.childNodes:j[1]==="<table>"&&!m?l.childNodes:[];for(g=n.length-1;g>=0;--g)p.nodeName(n[g],"tbody")&&!n[g].childNodes.length&&n[g].parentNode.removeChild(n[g])}!p.support.leadingWhitespace&&bn.test(h)&&l.insertBefore(b.createTextNode(bn.exec(h)[0]),l.firstChild),h=l.childNodes,l.parentNode.removeChild(l)}h.nodeType?t.push(h):p.merge(t,h)}l&&(h=l=s=null);if(!p.support.appendChecked)for(f=0;(h=t[f])!=null;f++)p.nodeName(h,"input")?bG(h):typeof h.getElementsByTagName!="undefined"&&p.grep(h.getElementsByTagName("input"),bG);if(c){q=function(a){if(!a.type||bx.test(a.type))return d?d.push(a.parentNode?a.parentNode.removeChild(a):a):c.appendChild(a)};for(f=0;(h=t[f])!=null;f++)if(!p.nodeName(h,"script")||!q(h))c.appendChild(h),typeof h.getElementsByTagName!="undefined"&&(r=p.grep(p.merge([],h.getElementsByTagName("script")),q),t.splice.apply(t,[f+1,0].concat(r)),f+=r.length)}return t},cleanData:function(a,b){var c,d,e,f,g=0,h=p.expando,i=p.cache,j=p.support.deleteExpando,k=p.event.special;for(;(e=a[g])!=null;g++)if(b||p.acceptData(e)){d=e[h],c=d&&i[d];if(c){if(c.events)for(f in c.events)k[f]?p.event.remove(e,f):p.removeEvent(e,f,c.handle);i[d]&&(delete i[d],j?delete e[h]:e.removeAttribute?e.removeAttribute(h):e[h]=null,p.deletedIds.push(d))}}}}),function(){var a,b;p.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},a=p.uaMatch(g.userAgent),b={},a.browser&&(b[a.browser]=!0,b.version=a.version),b.chrome?b.webkit=!0:b.webkit&&(b.safari=!0),p.browser=b,p.sub=function(){function a(b,c){return new a.fn.init(b,c)}p.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function c(c,d){return d&&d instanceof p&&!(d instanceof a)&&(d=a(d)),p.fn.init.call(this,c,d,b)},a.fn.init.prototype=a.fn;var b=a(e);return a}}();var bH,bI,bJ,bK=/alpha\([^)]*\)/i,bL=/opacity=([^)]*)/,bM=/^(top|right|bottom|left)$/,bN=/^(none|table(?!-c[ea]).+)/,bO=/^margin/,bP=new RegExp("^("+q+")(.*)$","i"),bQ=new RegExp("^("+q+")(?!px)[a-z%]+$","i"),bR=new RegExp("^([-+])=("+q+")","i"),bS={},bT={position:"absolute",visibility:"hidden",display:"block"},bU={letterSpacing:0,fontWeight:400},bV=["Top","Right","Bottom","Left"],bW=["Webkit","O","Moz","ms"],bX=p.fn.toggle;p.fn.extend({css:function(a,c){return p.access(this,function(a,c,d){return d!==b?p.style(a,c,d):p.css(a,c)},a,c,arguments.length>1)},show:function(){return b$(this,!0)},hide:function(){return b$(this)},toggle:function(a,b){var c=typeof a=="boolean";return p.isFunction(a)&&p.isFunction(b)?bX.apply(this,arguments):this.each(function(){(c?a:bZ(this))?p(this).show():p(this).hide()})}}),p.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bH(a,"opacity");return c===""?"1":c}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":p.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!a||a.nodeType===3||a.nodeType===8||!a.style)return;var f,g,h,i=p.camelCase(c),j=a.style;c=p.cssProps[i]||(p.cssProps[i]=bY(j,i)),h=p.cssHooks[c]||p.cssHooks[i];if(d===b)return h&&"get"in h&&(f=h.get(a,!1,e))!==b?f:j[c];g=typeof d,g==="string"&&(f=bR.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(p.css(a,c)),g="number");if(d==null||g==="number"&&isNaN(d))return;g==="number"&&!p.cssNumber[i]&&(d+="px");if(!h||!("set"in h)||(d=h.set(a,d,e))!==b)try{j[c]=d}catch(k){}},css:function(a,c,d,e){var f,g,h,i=p.camelCase(c);return c=p.cssProps[i]||(p.cssProps[i]=bY(a.style,i)),h=p.cssHooks[c]||p.cssHooks[i],h&&"get"in h&&(f=h.get(a,!0,e)),f===b&&(f=bH(a,c)),f==="normal"&&c in bU&&(f=bU[c]),d||e!==b?(g=parseFloat(f),d||p.isNumeric(g)?g||0:f):f},swap:function(a,b,c){var d,e,f={};for(e in b)f[e]=a.style[e],a.style[e]=b[e];d=c.call(a);for(e in b)a.style[e]=f[e];return d}}),a.getComputedStyle?bH=function(b,c){var d,e,f,g,h=a.getComputedStyle(b,null),i=b.style;return h&&(d=h[c],d===""&&!p.contains(b.ownerDocument,b)&&(d=p.style(b,c)),bQ.test(d)&&bO.test(c)&&(e=i.width,f=i.minWidth,g=i.maxWidth,i.minWidth=i.maxWidth=i.width=d,d=h.width,i.width=e,i.minWidth=f,i.maxWidth=g)),d}:e.documentElement.currentStyle&&(bH=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;return e==null&&f&&f[b]&&(e=f[b]),bQ.test(e)&&!bM.test(b)&&(c=f.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),f.left=b==="fontSize"?"1em":e,e=f.pixelLeft+"px",f.left=c,d&&(a.runtimeStyle.left=d)),e===""?"auto":e}),p.each(["height","width"],function(a,b){p.cssHooks[b]={get:function(a,c,d){if(c)return a.offsetWidth===0&&bN.test(bH(a,"display"))?p.swap(a,bT,function(){return cb(a,b,d)}):cb(a,b,d)},set:function(a,c,d){return b_(a,c,d?ca(a,b,d,p.support.boxSizing&&p.css(a,"boxSizing")==="border-box"):0)}}}),p.support.opacity||(p.cssHooks.opacity={get:function(a,b){return bL.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=p.isNumeric(b)?"alpha(opacity="+b*100+")":"",f=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&p.trim(f.replace(bK,""))===""&&c.removeAttribute){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bK.test(f)?f.replace(bK,e):f+" "+e}}),p(function(){p.support.reliableMarginRight||(p.cssHooks.marginRight={get:function(a,b){return p.swap(a,{display:"inline-block"},function(){if(b)return bH(a,"marginRight")})}}),!p.support.pixelPosition&&p.fn.position&&p.each(["top","left"],function(a,b){p.cssHooks[b]={get:function(a,c){if(c){var d=bH(a,b);return bQ.test(d)?p(a).position()[b]+"px":d}}}})}),p.expr&&p.expr.filters&&(p.expr.filters.hidden=function(a){return a.offsetWidth===0&&a.offsetHeight===0||!p.support.reliableHiddenOffsets&&(a.style&&a.style.display||bH(a,"display"))==="none"},p.expr.filters.visible=function(a){return!p.expr.filters.hidden(a)}),p.each({margin:"",padding:"",border:"Width"},function(a,b){p.cssHooks[a+b]={expand:function(c){var d,e=typeof c=="string"?c.split(" "):[c],f={};for(d=0;d<4;d++)f[a+bV[d]+b]=e[d]||e[d-2]||e[0];return f}},bO.test(a)||(p.cssHooks[a+b].set=b_)});var cd=/%20/g,ce=/\[\]$/,cf=/\r?\n/g,cg=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,ch=/^(?:select|textarea)/i;p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?p.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ch.test(this.nodeName)||cg.test(this.type))}).map(function(a,b){var c=p(this).val();return c==null?null:p.isArray(c)?p.map(c,function(a,c){return{name:b.name,value:a.replace(cf,"\r\n")}}):{name:b.name,value:c.replace(cf,"\r\n")}}).get()}}),p.param=function(a,c){var d,e=[],f=function(a,b){b=p.isFunction(b)?b():b==null?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=p.ajaxSettings&&p.ajaxSettings.traditional);if(p.isArray(a)||a.jquery&&!p.isPlainObject(a))p.each(a,function(){f(this.name,this.value)});else for(d in a)ci(d,a[d],c,f);return e.join("&").replace(cd,"+")};var cj,ck,cl=/#.*$/,cm=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,cn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,co=/^(?:GET|HEAD)$/,cp=/^\/\//,cq=/\?/,cr=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,cs=/([?&])_=[^&]*/,ct=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,cu=p.fn.load,cv={},cw={},cx=["*/"]+["*"];try{cj=f.href}catch(cy){cj=e.createElement("a"),cj.href="",cj=cj.href}ck=ct.exec(cj.toLowerCase())||[],p.fn.load=function(a,c,d){if(typeof a!="string"&&cu)return cu.apply(this,arguments);if(!this.length)return this;var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i,a.length),a=a.slice(0,i)),p.isFunction(c)?(d=c,c=b):c&&typeof c=="object"&&(f="POST"),p.ajax({url:a,type:f,dataType:"html",data:c,complete:function(a,b){d&&h.each(d,g||[a.responseText,b,a])}}).done(function(a){g=arguments,h.html(e?p("<div>").append(a.replace(cr,"")).find(e):a)}),this},p.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){p.fn[b]=function(a){return this.on(b,a)}}),p.each(["get","post"],function(a,c){p[c]=function(a,d,e,f){return p.isFunction(d)&&(f=f||e,e=d,d=b),p.ajax({type:c,url:a,data:d,success:e,dataType:f})}}),p.extend({getScript:function(a,c){return p.get(a,b,c,"script")},getJSON:function(a,b,c){return p.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?cB(a,p.ajaxSettings):(b=a,a=p.ajaxSettings),cB(a,b),a},ajaxSettings:{url:cj,isLocal:cn.test(ck[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":cx},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:cz(cv),ajaxTransport:cz(cw),ajax:function(a,c){function y(a,c,f,i){var k,s,t,u,w,y=c;if(v===2)return;v=2,h&&clearTimeout(h),g=b,e=i||"",x.readyState=a>0?4:0,f&&(u=cC(l,x,f));if(a>=200&&a<300||a===304)l.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(p.lastModified[d]=w),w=x.getResponseHeader("Etag"),w&&(p.etag[d]=w)),a===304?(y="notmodified",k=!0):(k=cD(l,u),y=k.state,s=k.data,t=k.error,k=!t);else{t=y;if(!y||a)y="error",a<0&&(a=0)}x.status=a,x.statusText=""+(c||y),k?o.resolveWith(m,[s,y,x]):o.rejectWith(m,[x,y,t]),x.statusCode(r),r=b,j&&n.trigger("ajax"+(k?"Success":"Error"),[x,l,k?s:t]),q.fireWith(m,[x,y]),j&&(n.trigger("ajaxComplete",[x,l]),--p.active||p.event.trigger("ajaxStop"))}typeof a=="object"&&(c=a,a=b),c=c||{};var d,e,f,g,h,i,j,k,l=p.ajaxSetup({},c),m=l.context||l,n=m!==l&&(m.nodeType||m instanceof p)?p(m):p.event,o=p.Deferred(),q=p.Callbacks("once memory"),r=l.statusCode||{},t={},u={},v=0,w="canceled",x={readyState:0,setRequestHeader:function(a,b){if(!v){var c=a.toLowerCase();a=u[c]=u[c]||a,t[a]=b}return this},getAllResponseHeaders:function(){return v===2?e:null},getResponseHeader:function(a){var c;if(v===2){if(!f){f={};while(c=cm.exec(e))f[c[1].toLowerCase()]=c[2]}c=f[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){return v||(l.mimeType=a),this},abort:function(a){return a=a||w,g&&g.abort(a),y(0,a),this}};o.promise(x),x.success=x.done,x.error=x.fail,x.complete=q.add,x.statusCode=function(a){if(a){var b;if(v<2)for(b in a)r[b]=[r[b],a[b]];else b=a[x.status],x.always(b)}return this},l.url=((a||l.url)+"").replace(cl,"").replace(cp,ck[1]+"//"),l.dataTypes=p.trim(l.dataType||"*").toLowerCase().split(s),l.crossDomain==null&&(i=ct.exec(l.url.toLowerCase()),l.crossDomain=!(!i||i[1]==ck[1]&&i[2]==ck[2]&&(i[3]||(i[1]==="http:"?80:443))==(ck[3]||(ck[1]==="http:"?80:443)))),l.data&&l.processData&&typeof l.data!="string"&&(l.data=p.param(l.data,l.traditional)),cA(cv,l,c,x);if(v===2)return x;j=l.global,l.type=l.type.toUpperCase(),l.hasContent=!co.test(l.type),j&&p.active++===0&&p.event.trigger("ajaxStart");if(!l.hasContent){l.data&&(l.url+=(cq.test(l.url)?"&":"?")+l.data,delete l.data),d=l.url;if(l.cache===!1){var z=p.now(),A=l.url.replace(cs,"$1_="+z);l.url=A+(A===l.url?(cq.test(l.url)?"&":"?")+"_="+z:"")}}(l.data&&l.hasContent&&l.contentType!==!1||c.contentType)&&x.setRequestHeader("Content-Type",l.contentType),l.ifModified&&(d=d||l.url,p.lastModified[d]&&x.setRequestHeader("If-Modified-Since",p.lastModified[d]),p.etag[d]&&x.setRequestHeader("If-None-Match",p.etag[d])),x.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+cx+"; q=0.01":""):l.accepts["*"]);for(k in l.headers)x.setRequestHeader(k,l.headers[k]);if(!l.beforeSend||l.beforeSend.call(m,x,l)!==!1&&v!==2){w="abort";for(k in{success:1,error:1,complete:1})x[k](l[k]);g=cA(cw,l,c,x);if(!g)y(-1,"No Transport");else{x.readyState=1,j&&n.trigger("ajaxSend",[x,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){x.abort("timeout")},l.timeout));try{v=1,g.send(t,y)}catch(B){if(v<2)y(-1,B);else throw B}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var cE=[],cF=/\?/,cG=/(=)\?(?=&|$)|\?\?/,cH=p.now();p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=cE.pop()||p.expando+"_"+cH++;return this[a]=!0,a}}),p.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,h,i=c.data,j=c.url,k=c.jsonp!==!1,l=k&&cG.test(j),m=k&&!l&&typeof i=="string"&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&cG.test(i);if(c.dataTypes[0]==="jsonp"||l||m)return f=c.jsonpCallback=p.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,g=a[f],l?c.url=j.replace(cG,"$1"+f):m?c.data=i.replace(cG,"$1"+f):k&&(c.url+=(cF.test(j)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return h||p.error(f+" was not called"),h[0]},c.dataTypes[0]="json",a[f]=function(){h=arguments},e.always(function(){a[f]=g,c[f]&&(c.jsonpCallback=d.jsonpCallback,cE.push(f)),h&&p.isFunction(g)&&g(h[0]),h=g=b}),"script"}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return p.globalEval(a),a}}}),p.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),p.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=e.head||e.getElementsByTagName("head")[0]||e.documentElement;return{send:function(f,g){c=e.createElement("script"),c.async="async",a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,e){if(e||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||g(200,"success")},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(0,1)}}}});var cI,cJ=a.ActiveXObject?function(){for(var a in cI)cI[a](0,1)}:!1,cK=0;p.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&cL()||cM()}:cL,function(a){p.extend(p.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(p.ajaxSettings.xhr()),p.support.ajax&&p.ajaxTransport(function(c){if(!c.crossDomain||p.support.cors){var d;return{send:function(e,f){var g,h,i=c.xhr();c.username?i.open(c.type,c.url,c.async,c.username,c.password):i.open(c.type,c.url,c.async);if(c.xhrFields)for(h in c.xhrFields)i[h]=c.xhrFields[h];c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)i.setRequestHeader(h,e[h])}catch(j){}i.send(c.hasContent&&c.data||null),d=function(a,e){var h,j,k,l,m;try{if(d&&(e||i.readyState===4)){d=b,g&&(i.onreadystatechange=p.noop,cJ&&delete cI[g]);if(e)i.readyState!==4&&i.abort();else{h=i.status,k=i.getAllResponseHeaders(),l={},m=i.responseXML,m&&m.documentElement&&(l.xml=m);try{l.text=i.responseText}catch(a){}try{j=i.statusText}catch(n){j=""}!h&&c.isLocal&&!c.crossDomain?h=l.text?200:404:h===1223&&(h=204)}}}catch(o){e||f(-1,o)}l&&f(h,j,l,k)},c.async?i.readyState===4?setTimeout(d,0):(g=++cK,cJ&&(cI||(cI={},p(a).unload(cJ)),cI[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var cN,cO,cP=/^(?:toggle|show|hide)$/,cQ=new RegExp("^(?:([-+])=|)("+q+")([a-z%]*)$","i"),cR=/queueHooks$/,cS=[cY],cT={"*":[function(a,b){var c,d,e,f=this.createTween(a,b),g=cQ.exec(b),h=f.cur(),i=+h||0,j=1;if(g){c=+g[2],d=g[3]||(p.cssNumber[a]?"":"px");if(d!=="px"&&i){i=p.css(f.elem,a,!0)||c||1;do e=j=j||".5",i=i/j,p.style(f.elem,a,i+d),j=f.cur()/h;while(j!==1&&j!==e)}f.unit=d,f.start=i,f.end=g[1]?i+(g[1]+1)*c:c}return f}]};p.Animation=p.extend(cW,{tweener:function(a,b){p.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");var c,d=0,e=a.length;for(;d<e;d++)c=a[d],cT[c]=cT[c]||[],cT[c].unshift(b)},prefilter:function(a,b){b?cS.unshift(a):cS.push(a)}}),p.Tween=cZ,cZ.prototype={constructor:cZ,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(p.cssNumber[c]?"":"px")},cur:function(){var a=cZ.propHooks[this.prop];return a&&a.get?a.get(this):cZ.propHooks._default.get(this)},run:function(a){var b,c=cZ.propHooks[this.prop];return this.options.duration?this.pos=b=p.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):cZ.propHooks._default.set(this),this}},cZ.prototype.init.prototype=cZ.prototype,cZ.propHooks={_default:{get:function(a){var b;return a.elem[a.prop]==null||!!a.elem.style&&a.elem.style[a.prop]!=null?(b=p.css(a.elem,a.prop,!1,""),!b||b==="auto"?0:b):a.elem[a.prop]},set:function(a){p.fx.step[a.prop]?p.fx.step[a.prop](a):a.elem.style&&(a.elem.style[p.cssProps[a.prop]]!=null||p.cssHooks[a.prop])?p.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},cZ.propHooks.scrollTop=cZ.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},p.each(["toggle","show","hide"],function(a,b){var c=p.fn[b];p.fn[b]=function(d,e,f){return d==null||typeof d=="boolean"||!a&&p.isFunction(d)&&p.isFunction(e)?c.apply(this,arguments):this.animate(c$(b,!0),d,e,f)}}),p.fn.extend({fadeTo:function(a,b,c,d){return this.filter(bZ).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=p.isEmptyObject(a),f=p.speed(b,c,d),g=function(){var b=cW(this,p.extend({},a),f);e&&b.stop(!0)};return e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=a!=null&&a+"queueHooks",f=p.timers,g=p._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&cR.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem===this&&(a==null||f[c].queue===a)&&(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&p.dequeue(this,a)})}}),p.each({slideDown:c$("show"),slideUp:c$("hide"),slideToggle:c$("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){p.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),p.speed=function(a,b,c){var d=a&&typeof a=="object"?p.extend({},a):{complete:c||!c&&b||p.isFunction(a)&&a,duration:a,easing:c&&b||b&&!p.isFunction(b)&&b};d.duration=p.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in p.fx.speeds?p.fx.speeds[d.duration]:p.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";return d.old=d.complete,d.complete=function(){p.isFunction(d.old)&&d.old.call(this),d.queue&&p.dequeue(this,d.queue)},d},p.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},p.timers=[],p.fx=cZ.prototype.init,p.fx.tick=function(){var a,b=p.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||p.fx.stop()},p.fx.timer=function(a){a()&&p.timers.push(a)&&!cO&&(cO=setInterval(p.fx.tick,p.fx.interval))},p.fx.interval=13,p.fx.stop=function(){clearInterval(cO),cO=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fx.step={},p.expr&&p.expr.filters&&(p.expr.filters.animated=function(a){return p.grep(p.timers,function(b){return a===b.elem}).length});var c_=/^(?:body|html)$/i;p.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){p.offset.setOffset(this,a,b)});var c,d,e,f,g,h,i,j,k,l,m=this[0],n=m&&m.ownerDocument;if(!n)return;return(e=n.body)===m?p.offset.bodyOffset(m):(d=n.documentElement,p.contains(d,m)?(c=m.getBoundingClientRect(),f=da(n),g=d.clientTop||e.clientTop||0,h=d.clientLeft||e.clientLeft||0,i=f.pageYOffset||d.scrollTop,j=f.pageXOffset||d.scrollLeft,k=c.top+i-g,l=c.left+j-h,{top:k,left:l}):{top:0,left:0})},p.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return p.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(p.css(a,"marginTop"))||0,c+=parseFloat(p.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=p.css(a,"position");d==="static"&&(a.style.position="relative");var e=p(a),f=e.offset(),g=p.css(a,"top"),h=p.css(a,"left"),i=(d==="absolute"||d==="fixed")&&p.inArray("auto",[g,h])>-1,j={},k={},l,m;i?(k=e.position(),l=k.top,m=k.left):(l=parseFloat(g)||0,m=parseFloat(h)||0),p.isFunction(b)&&(b=b.call(a,c,f)),b.top!=null&&(j.top=b.top-f.top+l),b.left!=null&&(j.left=b.left-f.left+m),"using"in b?b.using.call(a,j):e.css(j)}},p.fn.extend({position:function(){if(!this[0])return;var a=this[0],b=this.offsetParent(),c=this.offset(),d=c_.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(p.css(a,"marginTop"))||0,c.left-=parseFloat(p.css(a,"marginLeft"))||0,d.top+=parseFloat(p.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(p.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||e.body;while(a&&!c_.test(a.nodeName)&&p.css(a,"position")==="static")a=a.offsetParent;return a||e.body})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);p.fn[a]=function(e){return p.access(this,function(a,e,f){var g=da(a);if(f===b)return g?c in g?g[c]:g.document.documentElement[e]:a[e];g?g.scrollTo(d?p(g).scrollLeft():f,d?f:p(g).scrollTop()):a[e]=f},a,e,arguments.length,null)}}),p.each({Height:"height",Width:"width"},function(a,c){p.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,e){p.fn[e]=function(e,f){var g=arguments.length&&(d||typeof e!="boolean"),h=d||(e===!0||f===!0?"margin":"border");return p.access(this,function(c,d,e){var f;return p.isWindow(c)?c.document.documentElement["client"+a]:c.nodeType===9?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?p.css(c,d,e,h):p.style(c,d,e,h)},c,g?e:b,g,null)}})}),a.jQuery=a.$=p,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return p})})(window);

/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/jquery-ui_1.11.4_jquery-ui.min.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


/*! jQuery UI - v1.11.4 - 2015-03-11
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, draggable.js, droppable.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js, menu.js, progressbar.js, resizable.js, selectable.js, selectmenu.js, slider.js, sortable.js, spinner.js, tabs.js, tooltip.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */

(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,t.href&&a&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap='#"+a+"']")[0],!!o&&i(o)):!1):(/^(input|select|textarea|button|object)$/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function s(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=a(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function a(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",o)}function o(){e.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function r(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}function h(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?o["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}};var l=0,u=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,h={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},a=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}(),void 0):(h[t]=s,void 0)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},h,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var i,s,n=u.call(arguments,1),a=0,o=n.length;o>a;a++)for(i in n[a])s=n[a][i],n[a].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(n){var a="string"==typeof n,o=u.call(arguments,1),r=this;return a?this.each(function(){var i,a=e.data(this,s);return"instance"===n?(r=a,!1):a?e.isFunction(a[n])&&"_"!==n.charAt(0)?(i=a[n].apply(a,o),i!==a&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+n+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+n+"'")}):(o.length&&(n=e.widget.extend.apply(null,[n].concat(o))),this.each(function(){var t=e.data(this,s);t?(t.option(n||{}),t._init&&t._init()):e.data(this,s,new i(n,this))})),r}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=l++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},s=t.split("."),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget;var d=!1;e(document).mouseup(function(){d=!1}),e.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!d){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,n="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),d=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),d=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function t(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function s(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,a,o=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,u=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==n)return n;var t,i,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=s.children()[0];return e("body").append(s),t=a.offsetWidth,s.css("overflow","scroll"),i=a.offsetWidth,t===i&&(i=s[0].clientWidth),s.remove(),n=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),s=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),n="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,a="scroll"===s||"auto"===s&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),s=e.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s||n?i.width():i.outerWidth(),height:s||n?i.height():i.outerHeight()}}},e.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=e.extend({},n);var p,m,g,v,y,b,_=e(n.of),x=e.position.getWithinInfo(n.within),w=e.position.getScrollInfo(x),k=(n.collision||"flip").split(" "),T={};return b=s(_),_[0].preventDefault&&(n.at="left top"),m=b.width,g=b.height,v=b.offset,y=e.extend({},v),e.each(["my","at"],function(){var e,t,i=(n[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",e=d.exec(i[0]),t=d.exec(i[1]),T[this]=[e?e[0]:0,t?t[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===n.at[0]?y.left+=m:"center"===n.at[0]&&(y.left+=m/2),"bottom"===n.at[1]?y.top+=g:"center"===n.at[1]&&(y.top+=g/2),p=t(T.at,m,g),y.left+=p[0],y.top+=p[1],this.each(function(){var s,l,u=e(this),d=u.outerWidth(),c=u.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),D=d+f+i(this,"marginRight")+w.width,S=c+b+i(this,"marginBottom")+w.height,M=e.extend({},y),C=t(T.my,u.outerWidth(),u.outerHeight());"right"===n.my[0]?M.left-=d:"center"===n.my[0]&&(M.left-=d/2),"bottom"===n.my[1]?M.top-=c:"center"===n.my[1]&&(M.top-=c/2),M.left+=C[0],M.top+=C[1],a||(M.left=h(M.left),M.top=h(M.top)),s={marginLeft:f,marginTop:b},e.each(["left","top"],function(t,i){e.ui.position[k[t]]&&e.ui.position[k[t]][i](M,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:c,collisionPosition:s,collisionWidth:D,collisionHeight:S,offset:[p[0]+C[0],p[1]+C[1]],my:n.my,at:n.at,within:x,elem:u})}),n.using&&(l=function(e){var t=v.left-M.left,i=t+m-d,s=v.top-M.top,a=s+g-c,h={target:{element:_,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:M.left,top:M.top,width:d,height:c},horizontal:0>i?"left":t>0?"right":"center",vertical:0>a?"top":s>0?"bottom":"middle"};d>m&&m>r(t+i)&&(h.horizontal="center"),c>g&&g>r(s+a)&&(h.vertical="middle"),h.important=o(r(t),r(i))>o(r(s),r(a))?"horizontal":"vertical",n.using.call(this,e,h)}),u.offset(e.extend(M,{using:l}))})},e.ui.position={fit:{left:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=e.left-t.collisionPosition.marginLeft,h=n-r,l=r+t.collisionWidth-a-n;t.collisionWidth>a?h>0&&0>=l?(i=e.left+h+t.collisionWidth-a-n,e.left+=h-i):e.left=l>0&&0>=h?n:h>l?n+a-t.collisionWidth:n:h>0?e.left+=h:l>0?e.left-=l:e.left=o(e.left-r,e.left)},top:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollTop:s.offset.top,a=t.within.height,r=e.top-t.collisionPosition.marginTop,h=n-r,l=r+t.collisionHeight-a-n;t.collisionHeight>a?h>0&&0>=l?(i=e.top+h+t.collisionHeight-a-n,e.top+=h-i):e.top=l>0&&0>=h?n:h>l?n+a-t.collisionHeight:n:h>0?e.top+=h:l>0?e.top-=l:e.top=o(e.top-r,e.top)}},flip:{left:function(e,t){var i,s,n=t.within,a=n.offset.left+n.scrollLeft,o=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=e.left-t.collisionPosition.marginLeft,u=l-h,d=l+t.collisionWidth-o-h,c="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(i=e.left+c+p+f+t.collisionWidth-o-a,(0>i||r(u)>i)&&(e.left+=c+p+f)):d>0&&(s=e.left-t.collisionPosition.marginLeft+c+p+f-h,(s>0||d>r(s))&&(e.left+=c+p+f))},top:function(e,t){var i,s,n=t.within,a=n.offset.top+n.scrollTop,o=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=e.top-t.collisionPosition.marginTop,u=l-h,d=l+t.collisionHeight-o-h,c="top"===t.my[1],p=c?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(s=e.top+p+f+m+t.collisionHeight-o-a,(0>s||r(u)>s)&&(e.top+=p+f+m)):d>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-h,(i>0||d>r(i))&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,s,n,o,r=document.getElementsByTagName("body")[0],h=document.createElement("div");t=document.createElement(r?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in s)t.style[o]=s[o];t.appendChild(h),i=r||document.documentElement,i.insertBefore(t,i.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",n=e(h).offset().left,a=n>10&&11>n,t.innerHTML="",i.removeChild(t)}()}(),e.ui.position,e.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),0>t.active&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,s=this.headers.length,n=this.headers.index(t.target),a=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:a=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[s-1]}a&&(e(t.target).attr("tabIndex",-1),e(a).attr("tabIndex",0),a.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var t,i=this.options,s=i.heightStyle,n=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=e(this),i=t.uniqueId().attr("id"),s=t.next(),n=s.uniqueId().attr("id");t.attr("aria-controls",n),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===s?(t=n.height(),this.element.siblings(":visible").each(function(){var i=e(this),s=i.css("position");"absolute"!==s&&"fixed"!==s&&(t-=i.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===s&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n[0]===s[0],o=a&&i.collapsible,r=o?e():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:o?e():n,newPanel:r};t.preventDefault(),a&&!i.collapsible||this._trigger("beforeActivate",t,l)===!1||(i.active=o?!1:this.headers.index(n),this.active=a?e():n,this._toggle(l),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,s=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,t):(s.hide(),i.show(),this._toggleComplete(t)),s.attr({"aria-hidden":"true"}),s.prev().attr({"aria-selected":"false","aria-expanded":"false"}),i.length&&s.length?s.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===parseInt(e(this).attr("tabIndex"),10)}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,t,i){var s,n,a,o=this,r=0,h=e.css("box-sizing"),l=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},d=l&&u.down||u,c=function(){o._toggleComplete(i)};return"number"==typeof d&&(a=d),"string"==typeof d&&(n=d),n=n||d.easing||u.easing,a=a||d.duration||u.duration,t.length?e.length?(s=e.show().outerHeight(),t.animate(this.hideProps,{duration:a,easing:n,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(this.showProps,{duration:a,easing:n,complete:c,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?"content-box"===h&&(r+=i.now):"content"!==o.options.heightStyle&&(i.now=Math.round(s-t.outerHeight()-r),r=0)}}),void 0):t.animate(this.hideProps,a,n,c):e.animate(this.showProps,a,n,c)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var i=e(t.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){if(!this.previousFilter){var i=e(t.currentTarget);
i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){var i,s,n,a,o=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:o=!1,s=this.previousFilter||"",n=String.fromCharCode(t.keyCode),a=!1,clearTimeout(this.filterTimer),n===s?a=!0:n=s+n,i=this._filterMenuItems(n),i=a&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(n=String.fromCharCode(t.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(t,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}o&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,i,s=this,n=this.options.icons.submenu,a=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),a.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.parent(),s=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(s),t.attr("aria-labelledby",i.attr("id"))}),t=a.add(this.element),i=t.find(this.options.items),i.not(".ui-menu-item").each(function(){var t=e(this);s._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var i,s;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),s=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,s,n,a,o,r;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=t.outerHeight(),0>n?this.activeMenu.scrollTop(a+n):n+r>o&&this.activeMenu.scrollTop(a+n-o+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(t),this.activeMenu=s},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var s;this.active&&(s="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[t]()),this.focus(i,s)},nextPage:function(t){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),0>i.offset().top-s-n}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(t),void 0)},previousPage:function(t){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-s+n>0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items).first())),void 0):(this.next(t),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)},_filterMenuItems:function(t){var i=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(e.trim(e(this).text()))})}}),e.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,s,n=this.element[0].nodeName.toLowerCase(),a="textarea"===n,o="input"===n;this.isMultiLine=a?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[a||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,s=!0,i=!0,void 0;t=!1,s=!1,i=!1;var a=e.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:t=!0,this._move("previousPage",n);break;case a.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case a.UP:t=!0,this._keyEvent("previous",n);break;case a.DOWN:t=!0,this._keyEvent("next",n);break;case a.ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case a.TAB:this.menu.active&&this.menu.select(n);break;case a.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(t)return t=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),void 0;if(!i){var n=e.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(e){return s?(s=!1,e.preventDefault(),void 0):(this._searchTimeout(e),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(s){s.target===t.element[0]||s.target===i||e.contains(i,s.target)||t.close()})})},menufocus:function(t,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)}),void 0):(n=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:n})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(n.value),s=i.item.attr("aria-label")||n.value,s&&e.trim(s).length&&(this.liveRegion.children().hide(),e("<div>").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,s=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,n){s.xhr&&s.xhr.abort(),s.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(":visible"),s=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!i&&!s)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var s=this;e.each(i,function(e,i){s._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").text(i.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[e](t),void 0):(this.search(null,t),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var s=RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return s.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))}}),e.ui.autocomplete;var c,p="ui-button ui-widget ui-state-default ui-corner-all",f="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",m=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},g=function(t){var i=t.name,s=t.form,n=e([]);return i&&(i=i.replace(/'/g,"\\'"),n=s?e(s).find("[name='"+i+"'][type=radio]"):e("[name='"+i+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),n};e.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,m),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,i=this.options,s="checkbox"===this.type||"radio"===this.type,n=s?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===c&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||e(this).removeClass(n)}).bind("click"+this.eventNamespace,function(e){i.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),s&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return i.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var s=t.element[0];g(s).not(s).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return i.disabled?!1:(e(this).addClass("ui-state-active"),c=this,t.document.one("mouseup",function(){c=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return i.disabled?!1:(e(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(t){return i.disabled?!1:((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(p+" ui-state-active "+f).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),t&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")),void 0):(this._resetButton(),void 0)},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?g(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var t=this.buttonElement.removeClass(f),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,a=[];s.primary||s.secondary?(this.options.text&&a.push("ui-button-text-icon"+(n?"s":s.primary?"-primary":"-secondary")),s.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>"),s.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>"),this.options.text||(a.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):a.push("ui-button-text-only"),t.addClass(a.join(" "))}}),e.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),s=i.filter(":ui-button");i.not(":ui-button").button(),s.button("refresh"),this.buttons=i.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),e.ui.button,e.extend(e.ui,{datepicker:{version:"1.11.4"}});var v;e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return r(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,n,a;s=t.nodeName.toLowerCase(),n="div"===s||"span"===s,t.id||(this.uuid+=1,t.id="dp"+this.uuid),a=this._newInst(e(t),n),a.settings=e.extend({},i||{}),"input"===s?this._connectDatepicker(t,a):n&&this._inlineDatepicker(t,a)},_newInst:function(t,i){var s=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?a(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,n,a,o=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[r?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&t.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(a?e("<img/>").attr({src:a,alt:n,title:n}):n)),t[r?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,s,n,a=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(i=0,s=0,n=0;e.length>n;n++)e[n].length>i&&(i=e[n].length,s=n);return s},a.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),e.input.attr("size",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,s,n,a){var o,h,l,u,d,c=this._dialogInst;return c||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],"datepicker",c)),r(c.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(c,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+u,l/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",c),this},_destroyDatepicker:function(t){var i,s=e(t),n=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty(),v===n&&(v=null))},_enableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,s){var n,a,o,h,l=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):l?"all"===i?e.extend({},l.settings):this._get(l,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(l,"min"),h=this._getMinMaxDate(l,"max"),r(l.settings,n),null!==o&&void 0!==n.dateFormat&&void 0===n.minDate&&(l.settings.minDate=this._formatDate(l,o)),null!==h&&void 0!==n.dateFormat&&void 0===n.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),l),this._autoSize(l),this._setDate(l,a),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,n,a=e.datepicker._getInst(t.target),o=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",a.dpDiv),n[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,n[0]),i=e.datepicker._get(a,"onSelect"),i?(s=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,s,n=e.datepicker._getInst(t.target);
return e.datepicker._get(n,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,n,a,o,h,l,u;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(i,"beforeShow"),a=n?n.apply(t,[t,i]):{},a!==!1&&(r(i.settings,a),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|="fixed"===e(this).css("position"),!o}),h={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),h=e.datepicker._checkOffset(i,h,o),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),u=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",s(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),u):i.dpDiv[l||"show"](l?u:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,v=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,s=this._getNumberOfMonths(t),n=s[1],a=17,r=t.dpDiv.find("."+this._dayOverClass+" a");r.length>0&&o.apply(r.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),t.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,s){var n=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-o:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+r):0),i},_findPos:function(t){for(var i,s=this._getInst(t),n=this._get(s,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,n,a,o=this._curInst;!o||t&&o!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),s=this._get(o,"duration"),n=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[i]||e.effects[i])?o.dpDiv.hide(i,e.datepicker._get(o,"showOptions"),s,n):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,"onClose"),a&&a.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,s){var n=e(t),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+("M"===s?this._get(a,"showCurrentAtPos"):0),s),this._updateDatepicker(a))},_gotoToday:function(t){var i,s=e(t),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var n=e(t),a=this._getInst(n[0]);a["selected"+("M"===s?"Month":"Year")]=a["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(t,i,s,n){var a,o=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(a=this._getInst(o[0]),a.selectedDay=a.currentDay=e("a",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var s,n=e(t),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,"onSelect"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,n,a=this._get(t,"altField");a&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t)),e(a).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,s){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var n,a,o,r,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),d=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,c=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,b=!1,_=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},x=function(e){var t=_(e),s="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n="y"===e?s:1,a=RegExp("^\\d{"+n+","+s+"}"),o=i.substring(h).match(a);if(!o)throw"Missing number at position "+h;return h+=o[0].length,parseInt(o[0],10)},w=function(t,s,n){var a=-1,o=e.map(_(t)?n:s,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var s=t[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(a=t[0],h+=s.length,!1):void 0}),-1!==a)return a+1;throw"Unknown name at position "+h},k=function(){if(i.charAt(h)!==t.charAt(n))throw"Unexpected literal at position "+h;h++};for(n=0;t.length>n;n++)if(b)"'"!==t.charAt(n)||_("'")?k():b=!1;else switch(t.charAt(n)){case"d":v=x("d");break;case"D":w("D",d,c);break;case"o":y=x("o");break;case"m":g=x("m");break;case"M":g=w("M",p,f);break;case"y":m=x("y");break;case"@":r=new Date(x("@")),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"!":r=new Date((x("!")-this._ticksTo1970)/1e4),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"'":_("'")?k():b=!0;break;default:k()}if(i.length>h&&(o=i.substr(h),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),y>-1)for(g=1,v=y;;){if(a=this._getDaysInMonth(m,g-1),a>=v)break;g++,v-=a}if(r=this._daylightSavingAdjust(new Date(m,g-1,v)),r.getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(t){var i=e.length>s+1&&e.charAt(s+1)===t;return i&&s++,i},l=function(e,t,i){var s=""+t;if(h(e))for(;i>s.length;)s="0"+s;return s},u=function(e,t,i,s){return h(e)?s[t]:i[t]},d="",c=!1;if(t)for(s=0;e.length>s;s++)if(c)"'"!==e.charAt(s)||h("'")?d+=e.charAt(s):c=!1;else switch(e.charAt(s)){case"d":d+=l("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),n,a);break;case"o":d+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=l("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),o,r);break;case"y":d+=h("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":h("'")?d+="'":c=!0;break;default:d+=e.charAt(s)}return d},_possibleChars:function(e){var t,i="",s=!1,n=function(i){var s=e.length>t+1&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;e.length>t;t++)if(s)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),a=n,o=this._getFormatConfig(e);try{a=this.parseDate(i,s,o)||n}catch(r){s=t?"":s}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=s?a.getDate():0,e.currentMonth=s?a.getMonth():0,e.currentYear=s?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,s){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=n.getFullYear(),o=n.getMonth(),r=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o));break;case"y":case"Y":a+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o))}l=h.exec(i)}return new Date(a,o,r)},o=null==i||""===i?s:"string"==typeof i?a(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return o=o&&"Invalid Date"==""+o?s:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,n=e.selectedMonth,a=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),n===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),s="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,"M")},next:function(){e.datepicker._adjustDate(s,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,s,n,a,o,r,h,l,u,d,c,p,f,m,g,v,y,b,_,x,w,k,T,D,S,M,C,N,A,P,I,H,z,F,E,O,j,W,L=new Date,R=this._daylightSavingAdjust(new Date(L.getFullYear(),L.getMonth(),L.getDate())),Y=this._get(e,"isRTL"),B=this._get(e,"showButtonPanel"),J=this._get(e,"hideIfNoPrevNext"),q=this._get(e,"navigationAsDateFormat"),K=this._getNumberOfMonths(e),V=this._get(e,"showCurrentAtPos"),U=this._get(e,"stepMonths"),Q=1!==K[0]||1!==K[1],G=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(e,"min"),$=this._getMinMaxDate(e,"max"),Z=e.drawMonth-V,et=e.drawYear;if(0>Z&&(Z+=12,et--),$)for(t=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-K[0]*K[1]+1,$.getDate())),t=X&&X>t?X:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,i=this._get(e,"prevText"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z-U,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":J?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=q?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z+U,1)),this._getFormatConfig(e)):n,a=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":J?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",o=this._get(e,"currentText"),r=this._get(e,"gotoCurrent")&&e.currentDay?G:R,o=q?this.formatDate(o,r,this._getFormatConfig(e)):o,h=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",l=B?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(e,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(Y?"":h)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(e,"showWeek"),c=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),_="",w=0;K[0]>w;w++){for(k="",this.maxRows=4,T=0;K[1]>T;T++){if(D=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),S=" ui-corner-all",M="",Q){if(M+="<div class='ui-datepicker-group",K[1]>1)switch(T){case 0:M+=" ui-datepicker-group-first",S=" ui-corner-"+(Y?"right":"left");break;case K[1]-1:M+=" ui-datepicker-group-last",S=" ui-corner-"+(Y?"left":"right");break;default:M+=" ui-datepicker-group-middle",S=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===w?Y?a:s:"")+(/all|right/.test(S)&&0===w?Y?s:a:"")+this._generateMonthYearHeader(e,Z,et,X,$,w>0||T>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",C=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",x=0;7>x;x++)N=(x+u)%7,C+="<th scope='col'"+((x+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+c[N]+"'>"+p[N]+"</span></th>";for(M+=C+"</tr></thead><tbody>",A=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,A)),P=(this._getFirstDayOfMonth(et,Z)-u+7)%7,I=Math.ceil((P+A)/7),H=Q?this.maxRows>I?this.maxRows:I:I,this.maxRows=H,z=this._daylightSavingAdjust(new Date(et,Z,1-P)),F=0;H>F;F++){for(M+="<tr>",E=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(z)+"</td>":"",x=0;7>x;x++)O=g?g.apply(e.input?e.input[0]:null,[z]):[!0,""],j=z.getMonth()!==Z,W=j&&!y||!O[0]||X&&X>z||$&&z>$,E+="<td class='"+((x+u+6)%7>=5?" ui-datepicker-week-end":"")+(j?" ui-datepicker-other-month":"")+(z.getTime()===D.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===z.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(W?" "+this._unselectableClass+" ui-state-disabled":"")+(j&&!v?"":" "+O[1]+(z.getTime()===G.getTime()?" "+this._currentClass:"")+(z.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(j&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(W?"":" data-handler='selectDay' data-event='click' data-month='"+z.getMonth()+"' data-year='"+z.getFullYear()+"'")+">"+(j&&!v?"&#xa0;":W?"<span class='ui-state-default'>"+z.getDate()+"</span>":"<a class='ui-state-default"+(z.getTime()===R.getTime()?" ui-state-highlight":"")+(z.getTime()===G.getTime()?" ui-state-active":"")+(j?" ui-priority-secondary":"")+"' href='#'>"+z.getDate()+"</a>")+"</td>",z.setDate(z.getDate()+1),z=this._daylightSavingAdjust(z);M+=E+"</tr>"}Z++,Z>11&&(Z=0,et++),M+="</tbody></table>"+(Q?"</div>"+(K[0]>0&&T===K[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=M}_+=k}return _+=l,e._keyEvent=!1,_},_generateMonthYearHeader:function(e,t,i,s,n,a,o,r){var h,l,u,d,c,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",_="";if(a||!g)_+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!h||u>=s.getMonth())&&(!l||n.getMonth()>=u)&&(_+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+r[u]+"</option>");_+="</select>"}if(y||(b+=_+(!a&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",a||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(e,"yearRange").split(":"),c=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?c+parseInt(e,10):parseInt(e,10);return isNaN(t)?c:t},f=p(d[0]),m=Math.max(f,p(d[1]||"")),f=s?Math.max(f,s.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!a&&g&&v?"":"&#xa0;")+_),b+="</div>"},_adjustInstDate:function(e,t,i){var s=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(s,n))+("D"===i?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,n,a)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return s&&n>s?s:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var n=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,s+(0>t?t:n[0]*n[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,s,n=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),o=null,r=null,h=this._get(e,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!o||t.getFullYear()>=o)&&(!r||r>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.4",e.datepicker,e.widget("ui.draggable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var i=this.options;return this._blurActiveElement(t),this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var i=this.document[0];if(this.handleElement.is(t.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(s){}},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper),n=s?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options,a=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,e(a).width()-this.helperProportions.width-this.margins.left,(e(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],s&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)
},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,s,n,a,o=this.options,r=this._isRootNode(this.scrollParent[0]),h=e.pageX,l=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a),"y"===o.axis&&(h=this.originalPageX),"x"===o.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,s){var n=e.extend({},i,{item:s.element});s.sortables=[],e(s.options.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",t,n))})},stop:function(t,i,s){var n=e.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,e.each(s.sortables,function(){var e=this;e.isOver?(e.isOver=0,s.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,n))})},drag:function(t,i,s){e.each(s.sortables,function(){var n=!1,a=this;a.positionAbs=s.positionAbs,a.helperProportions=s.helperProportions,a.offset.click=s.offset.click,a._intersectsWith(a.containerCache)&&(n=!0,e.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==a&&this._intersectsWith(this.containerCache)&&e.contains(a.element[0],this.element[0])&&(n=!1),n})),n?(a.isOver||(a.isOver=1,s._parent=i.helper.parent(),a.currentItem=i.helper.appendTo(a.element).data("ui-sortable-item",!0),a.options._helper=a.options.helper,a.options.helper=function(){return i.helper[0]},t.target=a.currentItem[0],a._mouseCapture(t,!0),a._mouseStart(t,!0,!0),a.offset.click.top=s.offset.click.top,a.offset.click.left=s.offset.click.left,a.offset.parent.left-=s.offset.parent.left-a.offset.parent.left,a.offset.parent.top-=s.offset.parent.top-a.offset.parent.top,s._trigger("toSortable",t),s.dropped=a.element,e.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,a.fromOutside=s),a.currentItem&&(a._mouseDrag(t),i.position=a.position)):a.isOver&&(a.isOver=0,a.cancelHelperRemoval=!0,a.options._revert=a.options.revert,a.options.revert=!1,a._trigger("out",t,a._uiHash(a)),a._mouseStop(t,!0),a.options.revert=a.options._revert,a.options.helper=a.options._helper,a.placeholder&&a.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(t),i.position=s._generatePosition(t,!0),s._trigger("fromSortable",t),s.dropped=!1,e.each(s.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,s){var n=e("body"),a=s.options;n.css("cursor")&&(a._cursor=n.css("cursor")),n.css("cursor",a.cursor)},stop:function(t,i,s){var n=s.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("opacity")&&(a._opacity=n.css("opacity")),n.css("opacity",a.opacity)},stop:function(t,i,s){var n=s.options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var n=s.options,a=!1,o=s.scrollParentNotHidden[0],r=s.document[0];o!==r&&"HTML"!==o.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+o.offsetHeight-t.pageY<n.scrollSensitivity?o.scrollTop=a=o.scrollTop+n.scrollSpeed:t.pageY-s.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=a=o.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+o.offsetWidth-t.pageX<n.scrollSensitivity?o.scrollLeft=a=o.scrollLeft+n.scrollSpeed:t.pageX-s.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=a=o.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(r).scrollTop()<n.scrollSensitivity?a=e(r).scrollTop(e(r).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<n.scrollSensitivity&&(a=e(r).scrollTop(e(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(r).scrollLeft()<n.scrollSensitivity?a=e(r).scrollLeft(e(r).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<n.scrollSensitivity&&(a=e(r).scrollLeft(e(r).scrollLeft()+n.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,s){var n=s.options;s.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var n,a,o,r,h,l,u,d,c,p,f=s.options,m=f.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,y=i.offset.top,b=y+s.helperProportions.height;for(c=s.snapElements.length-1;c>=0;c--)h=s.snapElements[c].left-s.margins.left,l=h+s.snapElements[c].width,u=s.snapElements[c].top-s.margins.top,d=u+s.snapElements[c].height,h-m>v||g>l+m||u-m>b||y>d+m||!e.contains(s.snapElements[c].item.ownerDocument,s.snapElements[c].item)?(s.snapElements[c].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(n=m>=Math.abs(u-b),a=m>=Math.abs(d-y),o=m>=Math.abs(h-v),r=m>=Math.abs(l-g),n&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left)),p=n||a||o||r,"outer"!==f.snapMode&&(n=m>=Math.abs(u-y),a=m>=Math.abs(d-b),o=m>=Math.abs(h-g),r=m>=Math.abs(l-v),n&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[c].snapping&&(n||a||o||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=n||a||o||r||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,s){var n,a=s.options,o=e.makeArray(e(a.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});o.length&&(n=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",n+t)}),this.css("zIndex",n+o.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("zIndex")&&(a._zIndex=n.css("zIndex")),n.css("zIndex",a.zIndex)},stop:function(t,i,s){var n=s.options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}}),e.ui.draggable,e.widget("ui.resizable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return t[s]>0?!0:(t[s]=1,n=t[s]>0,t[s]=0,n)},_create:function(){var t,i,s,n,a,o=this,r=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=e(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;t.length>i;i++)s=e.trim(t[i]),a="ui-resizable-"+s,n=e("<div class='ui-resizable-handle "+a+"'></div>"),n.css({zIndex:r.zIndex}),"se"===s&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(n);this._renderAxis=function(t){var i,s,n,a;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=e(this.handles[i]),this._on(this.handles[i],{mousedown:o._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=e(this.handles[i],this.element),a=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(n,a),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:"se")}),r.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(e(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){r.disabled||o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,s,n=!1;for(i in this.handles)s=e(this.handles[i])[0],(s===t.target||e.contains(s,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var i,s,n,a=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),a.containment&&(i+=e(a.containment).scrollLeft()||0,s+=e(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===n?this.axis+"-resize":n),o.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,s,n=this.originalMousePosition,a=this.axis,o=t.pageX-n.left||0,r=t.pageY-n.top||0,h=this._change[a];return this._updatePrevProperties(),h?(i=h.apply(this,[t,o,r]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,s,n,a,o,r,h,l=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],"left")?0:u.sizeDiff.height,a=s?0:u.sizeDiff.width,o={width:u.helper.width()-a,height:u.helper.height()-n},r=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,h=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(e.extend(o,{top:h,left:r})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,s,n,a,o=this.options;a={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,s=a.minWidth/this.aspectRatio,i=a.maxHeight*this.aspectRatio,n=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),s>a.minHeight&&(a.minHeight=s),a.maxWidth>i&&(a.maxWidth=i),a.maxHeight>n&&(a.maxHeight=n)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,s=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===s&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===s&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,s=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,n=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,o=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,r=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,l=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);return a&&(e.width=t.minWidth),o&&(e.height=t.minHeight),s&&(e.width=t.maxWidth),n&&(e.height=t.maxHeight),a&&l&&(e.left=r-t.minWidth),s&&l&&(e.left=r-t.maxWidth),o&&u&&(e.top=h-t.minHeight),n&&u&&(e.top=h-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],s=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],n=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];4>t;t++)i[t]=parseInt(s[t],10)||0,i[t]+=parseInt(n[t],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},sw:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,s]))},ne:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},nw:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,s]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).resizable("instance"),s=i.options,n=i._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-o},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(h,u&&l?{top:u,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&e(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,s,n,a,o,r,h=e(this).resizable("instance"),l=h.options,u=h.element,d=l.containment,c=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;c&&(h.containerElement=e(c),/document/.test(d)||d===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(c),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,s){i[e]=h._num(t.css("padding"+s))}),h.containerOffset=t.offset(),h.containerPosition=t.position(),h.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},s=h.containerOffset,n=h.containerSize.height,a=h.containerSize.width,o=h._hasScroll(c,"left")?c.scrollWidth:a,r=h._hasScroll(c)?c.scrollHeight:n,h.parentData={element:c,left:s.left,top:s.top,width:o,height:r}))},resize:function(t){var i,s,n,a,o=e(this).resizable("instance"),r=o.options,h=o.containerOffset,l=o.position,u=o._aspectRatio||t.shiftKey,d={top:0,left:0},c=o.containerElement,p=!0;c[0]!==document&&/static/.test(c.css("position"))&&(d=h),l.left<(o._helper?h.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-h.left:o.position.left-d.left),u&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=r.helper?h.left:0),l.top<(o._helper?h.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-h.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?h.top:0),n=o.containerElement.get(0)===o.element.parent().get(0),a=/relative|absolute/.test(o.containerElement.css("position")),n&&a?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-d.left:o.offset.left-h.left)),s=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-d.top:o.offset.top-h.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,u&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,u&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),i=t.options,s=t.containerOffset,n=t.containerPosition,a=t.containerElement,o=e(t.helper),r=o.offset(),h=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l}),t._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),i=t.options;e(i.alsoResize).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})},resize:function(t,i){var s=e(this).resizable("instance"),n=s.options,a=s.originalSize,o=s.originalPosition,r={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0};e(n.alsoResize).each(function(){var t=e(this),s=e(this).data("ui-resizable-alsoresize"),n={},a=t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(a,function(e,t){var i=(s[t]||0)+(r[t]||0);i&&i>=0&&(n[t]=i||null)}),t.css(n)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),i=t.options,s=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,i=e(this).resizable("instance"),s=i.options,n=i.size,a=i.originalSize,o=i.originalPosition,r=i.axis,h="number"==typeof s.grid?[s.grid,s.grid]:s.grid,l=h[0]||1,u=h[1]||1,d=Math.round((n.width-a.width)/l)*l,c=Math.round((n.height-a.height)/u)*u,p=a.width+d,f=a.height+c,m=s.maxWidth&&p>s.maxWidth,g=s.maxHeight&&f>s.maxHeight,v=s.minWidth&&s.minWidth>p,y=s.minHeight&&s.minHeight>f;s.grid=h,v&&(p+=l),y&&(f+=u),m&&(p-=l),g&&(f-=u),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=o.top-c):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=o.left-d):((0>=f-u||0>=p-l)&&(t=i._getPaddingPlusBorderDimensions(this)),f-u>0?(i.size.height=f,i.position.top=o.top-c):(f=u-t.height,i.size.height=f,i.position.top=o.top+a.height-f),p-l>0?(i.size.width=p,i.position.left=o.left-d):(p=l-t.width,i.size.width=p,i.position.left=o.left+a.width-p))}}),e.ui.resizable,e.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,s=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(n){}this._hide(this.uiDialog,this.options.hide,function(){s._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,i){var s=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),a=Math.max.apply(null,n);return a>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",a+1),s=!0),s&&!i&&this._trigger("focus",t),s},open:function(){var t=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"),void 0)},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),this.close(t),void 0;
if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==s[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){n.focus()}),t.preventDefault()):(this._delay(function(){s.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(e.each(i,function(i,s){var n,a;s=e.isFunction(s)?{click:s,text:i}:s,s=e.extend({type:"button"},s),n=s.click,s.click=function(){n.apply(t.element[0],arguments)},a={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,e("<button></button>",s).button(a).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,t(n))},drag:function(e,s){i._trigger("drag",e,t(s))},stop:function(n,a){var o=a.offset.left-i.document.scrollLeft(),r=a.offset.top-i.document.scrollTop();s.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" "+"top"+(r>=0?"+":"")+r,of:i.window},e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,t(a))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,s=this.options,n=s.resizable,a=this.uiDialog.css("position"),o="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:o,start:function(s,n){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,t(n))},resize:function(e,s){i._trigger("resize",e,t(s))},stop:function(n,a){var o=i.uiDialog.offset(),r=o.left-i.document.scrollLeft(),h=o.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" "+"top"+(h>=0?"+":"")+h,of:i.window},e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,t(a))}}).css("position",a)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),i=e.inArray(this,t);-1!==i&&t.splice(i,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,n={};e.each(t,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(s=!0),e in i.resizableRelatedOptions&&(n[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(e,t){var i,s,n=this.uiDialog;"dialogClass"===e&&n.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=n.is(":data(ui-draggable)"),i&&!t&&n.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(s=n.is(":data(ui-resizable)"),s&&!t&&n.resizable("destroy"),s&&"string"==typeof t&&n.resizable("option","handles",t),s||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),e=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),t=Math.max(0,s.minHeight-e),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-e):"none","auto"===s.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),e.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){return arguments.length?(t=arguments[0],void 0):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=e(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,s,n){if(!i.offset)return!1;var a=(t.positionAbs||t.position.absolute).left+t.margins.left,o=(t.positionAbs||t.position.absolute).top+t.margins.top,r=a+t.helperProportions.width,h=o+t.helperProportions.height,l=i.offset.left,u=i.offset.top,d=l+i.proportions().width,c=u+i.proportions().height;switch(s){case"fit":return a>=l&&d>=r&&o>=u&&c>=h;case"intersect":return a+t.helperProportions.width/2>l&&d>r-t.helperProportions.width/2&&o+t.helperProportions.height/2>u&&c>h-t.helperProportions.height/2;case"pointer":return e(n.pageY,u,i.proportions().height)&&e(n.pageX,l,i.proportions().width);case"touch":return(o>=u&&c>=o||h>=u&&c>=h||u>o&&h>c)&&(a>=l&&d>=a||r>=l&&d>=r||l>a&&r>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var s,n,a=e.ui.ddmanager.droppables[t.options.scope]||[],o=i?i.type:null,r=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;a.length>s;s++)if(!(a[s].options.disabled||t&&!a[s].accept.call(a[s].element[0],t.currentItem||t.element))){for(n=0;r.length>n;n++)if(r[n]===a[s].element[0]){a[s].proportions().height=0;continue e}a[s].visible="none"!==a[s].element.css("display"),a[s].visible&&("mousedown"===o&&a[s]._activate.call(a[s],i),a[s].offset=a[s].element.offset(),a[s].proportions({width:a[s].element[0].offsetWidth,height:a[s].element[0].offsetHeight}))}},drop:function(t,i){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,a,o=e.ui.intersect(t,this,this.options.tolerance,i),r=!o&&this.isover?"isout":o&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,a=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===n}),a.length&&(s=e(a[0]).droppable("instance"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},e.ui.droppable;var y="ui-effects-",b=e;e.effects={effect:{}},function(e,t){function i(e,t,i){var s=d[t.type]||{};return null==e?i||!t.def?null:t.def:(e=s.floor?~~e:parseFloat(e),isNaN(e)?t.def:s.mod?(e+s.mod)%s.mod:0>e?0:e>s.max?s.max:e)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(e,a){var o,r=a.re.exec(i),h=r&&a.parse(r),l=a.space||"rgba";return h?(o=s[l](h),s[u[l].cache]=o[u[l].cache],n=s._rgba=o._rgba,!1):t}),n.length?("0,0,0,0"===n.join()&&e.extend(n,a.transparent),s):a[i]}function n(e,t,i){return i=(i+1)%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+6*(t-e)*(2/3-i):e}var a,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],l=e.Color=function(t,i,s,n){return new e.Color.fn.parse(t,i,s,n)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},c=l.support={},p=e("<p>")[0],f=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",c.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),l.fn=e.extend(l.prototype,{parse:function(n,o,r,h){if(n===t)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=e(n).css(o),o=t);var d=this,c=e.type(n),p=this._rgba=[];return o!==t&&(n=[n,o,r,h],c="array"),"string"===c?this.parse(s(n)||a._default):"array"===c?(f(u.rgba.props,function(e,t){p[t.idx]=i(n[t.idx],t)}),this):"object"===c?(n instanceof l?f(u,function(e,t){n[t.cache]&&(d[t.cache]=n[t.cache].slice())}):f(u,function(t,s){var a=s.cache;f(s.props,function(e,t){if(!d[a]&&s.to){if("alpha"===e||null==n[e])return;d[a]=s.to(d._rgba)}d[a][t.idx]=i(n[e],t,!0)}),d[a]&&0>e.inArray(null,d[a].slice(0,3))&&(d[a][3]=1,s.from&&(d._rgba=s.from(d[a])))}),this):t},is:function(e){var i=l(e),s=!0,n=this;return f(u,function(e,a){var o,r=i[a.cache];return r&&(o=n[a.cache]||a.to&&a.to(n._rgba)||[],f(a.props,function(e,i){return null!=r[i.idx]?s=r[i.idx]===o[i.idx]:t})),s}),s},_space:function(){var e=[],t=this;return f(u,function(i,s){t[s.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var s=l(e),n=s._space(),a=u[n],o=0===this.alpha()?l("transparent"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return s=s[a.cache],f(a.props,function(e,n){var a=n.idx,o=r[a],l=s[a],u=d[n.type]||{};null!==l&&(null===o?h[a]=l:(u.mod&&(l-o>u.mod/2?o+=u.mod:o-l>u.mod/2&&(o-=u.mod)),h[a]=i((l-o)*t+o,n)))}),this[n](h)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(t)._rgba;return l(e.map(i,function(e,t){return(1-s)*n[t]+s*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),s=i.pop();return t&&i.push(~~(255*s)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,s=e[0]/255,n=e[1]/255,a=e[2]/255,o=e[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,u=r+h,d=.5*u;return t=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=d?l/u:l/(2-u),[Math.round(t)%360,i,d,null==o?1:o]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],s=e[2],a=e[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*n(r,o,t+1/3)),Math.round(255*n(r,o,t)),Math.round(255*n(r,o,t-1/3)),a]},f(u,function(s,n){var a=n.props,o=n.cache,h=n.to,u=n.from;l.fn[s]=function(s){if(h&&!this[o]&&(this[o]=h(this._rgba)),s===t)return this[o].slice();var n,r=e.type(s),d="array"===r||"object"===r?s:arguments,c=this[o].slice();return f(a,function(e,t){var s=d["object"===r?e:t.idx];null==s&&(s=c[t.idx]),c[t.idx]=i(s,t)}),u?(n=l(u(c)),n[o]=c,n):l(c)},f(a,function(t,i){l.fn[t]||(l.fn[t]=function(n){var a,o=e.type(n),h="alpha"===t?this._hsla?"hsla":"rgba":s,l=this[h](),u=l[i.idx];return"undefined"===o?u:("function"===o&&(n=n.call(this,u),o=e.type(n)),null==n&&i.empty?this:("string"===o&&(a=r.exec(n),a&&(n=u+parseFloat(a[2])*("+"===a[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(t){var i=t.split(" ");f(i,function(t,i){e.cssHooks[i]={set:function(t,n){var a,o,r="";if("transparent"!==n&&("string"!==e.type(n)||(a=s(n)))){if(n=l(a||n),!c.rgba&&1!==n._rgba[3]){for(o="backgroundColor"===i?t.parentNode:t;(""===r||"transparent"===r)&&o&&o.style;)try{r=e.css(o,"backgroundColor"),o=o.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{t.style[i]=n}catch(h){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=l(t.elem,i),t.end=l(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},l.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],function(i,s){t["border"+s+"Color"]=e}),t}},a=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(b),function(){function t(t){var i,s,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,a={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(a[e.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(a[i]=n[i]);return a}function i(t,i){var s,a,o={};for(s in i)a=i[s],t[s]!==a&&(n[s]||(e.fx.step[s]||!isNaN(parseFloat(a)))&&(o[s]=a));return o}var s=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(b.style(e.elem,i,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(n,a,o,r){var h=e.speed(a,o,r);return this.queue(function(){var a,o=e(this),r=o.attr("class")||"",l=h.children?o.find("*").addBack():o;l=l.map(function(){var i=e(this);return{el:i,start:t(this)}}),a=function(){e.each(s,function(e,t){n[t]&&o[t+"Class"](n[t])})},a(),l=l.map(function(){return this.end=t(this.el[0]),this.diff=i(this.start,this.end),this}),o.attr("class",r),l=l.map(function(){var t=this,i=e.Deferred(),s=e.extend({},h,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,s),i.promise()}),e.when.apply(e,l.get()).done(function(){a(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),h.complete.call(o[0])})})},e.fn.extend({addClass:function(t){return function(i,s,n,a){return s?e.effects.animateClass.call(this,{add:i},s,n,a):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,s,n,a){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},s,n,a):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(i,s,n,a,o){return"boolean"==typeof s||void 0===s?n?e.effects.animateClass.call(this,s?{add:i}:{remove:i},n,a,o):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:i},s,n,a)}}(e.fn.toggleClass),switchClass:function(t,i,s,n,a){return e.effects.animateClass.call(this,{add:i,remove:t},s,n,a)}})}(),function(){function t(t,i,s,n){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(n=s,s=i,i={}),e.isFunction(s)&&(n=s,s=null),i&&e.extend(t,i),s=s||i.duration,t.duration=e.fx.off?0:"number"==typeof s?s:s in e.fx.speeds?e.fx.speeds[s]:e.fx.speeds._default,t.complete=n||i.complete,t}function i(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.11.4",save:function(e,t){for(var i=0;t.length>i;i++)null!==t[i]&&e.data(y+t[i],e[0].style[t[i]])},restore:function(e,t){var i,s;for(s=0;t.length>s;s++)null!==t[s]&&(i=e.data(y+t[s]),void 0===i&&(i=""),e.css(t[s],i))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,s;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=e[1]/t.width}return{x:s,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},s=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:t.width(),height:t.height()},a=document.activeElement;try{a.id}catch(o){a=document.body}return t.wrap(s),(t[0]===a||e.contains(t[0],a))&&e(a).focus(),s=t.parent(),"static"===t.css("position")?(s.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,s){i[s]=t.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(n),s.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,s,n){return n=n||{},e.each(i,function(e,i){var a=t.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),e.fn.extend({effect:function(){function i(t){function i(){e.isFunction(a)&&a.call(n[0]),e.isFunction(t)&&t()}var n=e(this),a=s.complete,r=s.mode;(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),i()):o.call(n[0],s,i)}var s=t.apply(this,arguments),n=s.mode,a=s.queue,o=e.effects.effect[s.effect];return e.fx.off||!o?n?this[n](s.duration,s.complete):this.each(function(){s.complete&&s.complete.call(this)}):a===!1?this.each(i):this.queue(a||"fx",i)},show:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(e.fn.show),hide:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(e.fn.hide),toggle:function(e){return function(s){if(i(s)||"boolean"==typeof s)return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),s=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(s=[parseFloat(i),t])}),s}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;((t=Math.pow(2,--i))-1)/11>e;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}(),e.effects,e.effects.effect.blind=function(t,i){var s,n,a,o=e(this),r=/up|down|vertical/,h=/up|left|vertical|horizontal/,l=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(o,t.mode||"hide"),d=t.direction||"up",c=r.test(d),p=c?"height":"width",f=c?"top":"left",m=h.test(d),g={},v="show"===u;o.parent().is(".ui-effects-wrapper")?e.effects.save(o.parent(),l):e.effects.save(o,l),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n=s[p](),a=parseFloat(s.css(f))||0,g[p]=v?n:0,m||(o.css(c?"bottom":"right",0).css(c?"top":"left","auto").css({position:"absolute"}),g[f]=v?a:n+a),v&&(s.css(p,0),m||s.css(f,a+n)),s.animate(g,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===u&&o.hide(),e.effects.restore(o,l),e.effects.removeWrapper(o),i()}})},e.effects.effect.bounce=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"effect"),l="hide"===h,u="show"===h,d=t.direction||"up",c=t.distance,p=t.times||5,f=2*p+(u||l?1:0),m=t.duration/f,g=t.easing,v="up"===d||"down"===d?"top":"left",y="up"===d||"left"===d,b=o.queue(),_=b.length;for((u||l)&&r.push("opacity"),e.effects.save(o,r),o.show(),e.effects.createWrapper(o),c||(c=o["top"===v?"outerHeight":"outerWidth"]()/3),u&&(a={opacity:1},a[v]=0,o.css("opacity",0).css(v,y?2*-c:2*c).animate(a,m,g)),l&&(c/=Math.pow(2,p-1)),a={},a[v]=0,s=0;p>s;s++)n={},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g).animate(a,m,g),c=l?2*c:c/2;l&&(n={opacity:0},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g)),o.queue(function(){l&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}),_>1&&b.splice.apply(b,[1,0].concat(b.splice(_,f+1))),o.dequeue()},e.effects.effect.clip=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"hide"),l="show"===h,u=t.direction||"vertical",d="vertical"===u,c=d?"height":"width",p=d?"top":"left",f={};e.effects.save(o,r),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n="IMG"===o[0].tagName?s:o,a=n[c](),l&&(n.css(c,0),n.css(p,a/2)),f[c]=l?a:0,f[p]=l?0:a/2,n.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){l||o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}})},e.effects.effect.drop=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","opacity","height","width"],o=e.effects.setMode(n,t.mode||"hide"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h?"pos":"neg",d={opacity:r?1:0};e.effects.save(n,a),n.show(),e.effects.createWrapper(n),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(l,"pos"===u?-s:s),d[l]=(r?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.explode=function(t,i){function s(){b.push(this),b.length===d*c&&n()}function n(){p.css({visibility:"visible"}),e(b).remove(),m||p.hide(),i()}var a,o,r,h,l,u,d=t.pieces?Math.round(Math.sqrt(t.pieces)):3,c=d,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/c),y=Math.ceil(p.outerHeight()/d),b=[];for(a=0;d>a;a++)for(h=g.top+a*y,u=a-(d-1)/2,o=0;c>o;o++)r=g.left+o*v,l=o-(c-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-a*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:y,left:r+(m?l*v:0),top:h+(m?u*y:0),opacity:m?0:1}).animate({left:r+(m?0:l*v),top:h+(m?0:u*y),opacity:m?1:0},t.duration||500,t.easing,s)},e.effects.effect.fade=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:i})},e.effects.effect.fold=function(t,i){var s,n,a=e(this),o=["position","top","bottom","left","right","height","width"],r=e.effects.setMode(a,t.mode||"hide"),h="show"===r,l="hide"===r,u=t.size||15,d=/([0-9]+)%/.exec(u),c=!!t.horizFirst,p=h!==c,f=p?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(a,o),a.show(),s=e.effects.createWrapper(a).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],d&&(u=parseInt(d[1],10)/100*n[l?0:1]),h&&s.css(c?{height:0,width:u}:{height:u,width:0}),g[f[0]]=h?n[0]:u,v[f[1]]=h?n[1]:0,s.animate(g,m,t.easing).animate(v,m,t.easing,function(){l&&a.hide(),e.effects.restore(a,o),e.effects.removeWrapper(a),i()})},e.effects.effect.highlight=function(t,i){var s=e(this),n=["backgroundImage","backgroundColor","opacity"],a=e.effects.setMode(s,t.mode||"show"),o={backgroundColor:s.css("backgroundColor")};"hide"===a&&(o.opacity=0),e.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===a&&s.hide(),e.effects.restore(s,n),i()}})},e.effects.effect.size=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],u=["fontSize"],d=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),f=t.restore||"effect"!==p,m=t.scale||"both",g=t.origin||["middle","center"],v=o.css("position"),y=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),s={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===t.mode&&"show"===p?(o.from=t.to||b,o.to=t.from||s):(o.from=t.from||("show"===p?b:s),o.to=t.to||("hide"===p?b:s)),a={from:{y:o.from.height/s.height,x:o.from.width/s.width},to:{y:o.to.height/s.height,x:o.to.width/s.width}},("box"===m||"both"===m)&&(a.from.y!==a.to.y&&(y=y.concat(d),o.from=e.effects.setTransition(o,d,a.from.y,o.from),o.to=e.effects.setTransition(o,d,a.to.y,o.to)),a.from.x!==a.to.x&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,a.from.x,o.from),o.to=e.effects.setTransition(o,c,a.to.x,o.to))),("content"===m||"both"===m)&&a.from.y!==a.to.y&&(y=y.concat(u).concat(l),o.from=e.effects.setTransition(o,u,a.from.y,o.from),o.to=e.effects.setTransition(o,u,a.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),g&&(n=e.effects.getBaseline(g,s),o.from.top=(s.outerHeight-o.outerHeight())*n.y,o.from.left=(s.outerWidth-o.outerWidth())*n.x,o.to.top=(s.outerHeight-o.to.outerHeight)*n.y,o.to.left=(s.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===m||"both"===m)&&(d=d.concat(["marginTop","marginBottom"]).concat(u),c=c.concat(["marginLeft","marginRight"]),l=r.concat(d).concat(c),o.find("*[width]").each(function(){var i=e(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};
f&&e.effects.save(i,l),i.from={height:s.height*a.from.y,width:s.width*a.from.x,outerHeight:s.outerHeight*a.from.y,outerWidth:s.outerWidth*a.from.x},i.to={height:s.height*a.to.y,width:s.width*a.to.x,outerHeight:s.height*a.to.y,outerWidth:s.width*a.to.x},a.from.y!==a.to.y&&(i.from=e.effects.setTransition(i,d,a.from.y,i.from),i.to=e.effects.setTransition(i,d,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=e.effects.setTransition(i,c,a.from.x,i.from),i.to=e.effects.setTransition(i,c,a.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),e.effects.restore(o,y),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,i){var s=parseInt(i,10),n=e?o.to.left:o.to.top;return"auto"===i?n+"px":s+n+"px"})})),e.effects.removeWrapper(o),i()}})},e.effects.effect.scale=function(t,i){var s=e(this),n=e.extend(!0,{},t),a=e.effects.setMode(s,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===a?0:100),r=t.direction||"both",h=t.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},u={y:"horizontal"!==r?o/100:1,x:"vertical"!==r?o/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==a&&(n.origin=h||["middle","center"],n.restore=!0),n.from=t.from||("show"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*u.y,width:l.width*u.x,outerHeight:l.outerHeight*u.y,outerWidth:l.outerWidth*u.x},n.fade&&("show"===a&&(n.from.opacity=0,n.to.opacity=1),"hide"===a&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},e.effects.effect.puff=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"hide"),a="hide"===n,o=parseInt(t.percent,10)||150,r=o/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:a?o:100,from:a?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(t)},e.effects.effect.pulsate=function(t,i){var s,n=e(this),a=e.effects.setMode(n,t.mode||"show"),o="show"===a,r="hide"===a,h=o||"hide"===a,l=2*(t.times||5)+(h?1:0),u=t.duration/l,d=0,c=n.queue(),p=c.length;for((o||!n.is(":visible"))&&(n.css("opacity",0).show(),d=1),s=1;l>s;s++)n.animate({opacity:d},u,t.easing),d=1-d;n.animate({opacity:d},u,t.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&c.splice.apply(c,[1,0].concat(c.splice(p,l+1))),n.dequeue()},e.effects.effect.shake=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","height","width"],o=e.effects.setMode(n,t.mode||"effect"),r=t.direction||"left",h=t.distance||20,l=t.times||3,u=2*l+1,d=Math.round(t.duration/u),c="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},m={},g={},v=n.queue(),y=v.length;for(e.effects.save(n,a),n.show(),e.effects.createWrapper(n),f[c]=(p?"-=":"+=")+h,m[c]=(p?"+=":"-=")+2*h,g[c]=(p?"-=":"+=")+2*h,n.animate(f,d,t.easing),s=1;l>s;s++)n.animate(m,d,t.easing).animate(g,d,t.easing);n.animate(m,d,t.easing).animate(f,d/2,t.easing).queue(function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,u+1))),n.dequeue()},e.effects.effect.slide=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","width","height"],o=e.effects.setMode(n,t.mode||"show"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h,d={};e.effects.save(n,a),n.show(),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(l,u?isNaN(s)?"-"+s:-s:s),d[l]=(r?u?"+=":"-=":u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.transfer=function(t,i){var s=e(this),n=e(t.to),a="fixed"===n.css("position"),o=e("body"),r=a?o.scrollTop():0,h=a?o.scrollLeft():0,l=n.offset(),u={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},d=s.offset(),c=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:d.top-r,left:d.left-h,height:s.innerHeight(),width:s.innerWidth(),position:a?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){c.remove(),i()})},e.widget("ui.progressbar",{version:"1.11.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),this._refreshValue(),void 0)},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),e.widget("ui.selectable",e.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,s=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(s.filter,this.element[0]),this._trigger("start",t),e(s.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=e.data(this,"selectable-item");s.startselected=!0,t.metaKey||t.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",t,{unselecting:s.element}))}),e(t.target).parents().addBack().each(function(){var s,n=e.data(this,"selectable-item");return n?(s=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(s?"ui-unselecting":"ui-selected").addClass(s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",t,{selecting:n.element}):i._trigger("unselecting",t,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,a=this.opos[0],o=this.opos[1],r=t.pageX,h=t.pageY;return a>r&&(i=r,r=a,a=i),o>h&&(i=h,h=o,o=i),this.helper.css({left:a,top:o,width:r-a,height:h-o}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),l=!1;i&&i.element!==s.element[0]&&("touch"===n.tolerance?l=!(i.left>r||a>i.right||i.top>h||o>i.bottom):"fit"===n.tolerance&&(l=i.left>a&&r>i.right&&i.top>o&&h>i.bottom),l?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,s._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",t,{unselected:s.element})}),e(".ui-selecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",t,{selected:s.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),e.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this;this.label=e("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),e("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=e("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,i){e.preventDefault(),t._setSelection(),t._select(i.item.data("ui-selectmenu-item"),e)},focus:function(e,i){var s=i.item.data("ui-selectmenu-item");null!=t.focusIndex&&s.index!==t.focusIndex&&(t._trigger("focus",e,{item:s}),t.isOpen||t._select(s,e)),t.focusIndex=s.index,t.button.attr("aria-activedescendant",t.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find("option");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(t,i){var s=this,n="";e.each(i,function(i,a){a.optgroup!==n&&(e("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(a.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:a.optgroup}).appendTo(t),n=a.optgroup),s._renderItemData(t,a)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,i){var s=e("<li>");return i.disabled&&s.addClass("ui-state-disabled"),this._setText(s,i.label),s.appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var i,s,n=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),n+=":not(.ui-state-disabled)"),s="first"===e||"last"===e?i["first"===e?"prevAll":"nextAll"](n).eq(-1):i[e+"All"](n).eq(0),s.length&&this.menuInstance.focus(t,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?(e=window.getSelection(),e.removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(t))}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection(),e.rangeCount&&(this.range=e.getRangeAt(0))):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(t){var i=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),i=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),i=!1}i&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==i&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&this._resizeButton()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(t){var i=[];t.each(function(t,s){var n=e(s),a=n.parent("optgroup");i.push({element:n,index:t,value:n.val(),label:n.text(),optgroup:a.attr("label")||"",disabled:a.prop("disabled")||n.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),e.widget("ui.slider",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,s=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",o=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),t=n.length;i>t;t++)o.push(a);this.handles=n.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,s,n,a,o,r,h,l,u=this,d=this.options;return d.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(s-u.values(t));(n>i||n===i&&(t===u._lastChangedValue||u.values(t)===d.min))&&(n=i,a=e(this),o=t)}),r=this._start(t,o),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,a.addClass("ui-state-active").focus(),h=a.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-h.left-a.width()/2,top:t.pageY-h.top-a.height()/2-(parseInt(a.css("borderTopWidth"),10)||0)-(parseInt(a.css("borderBottomWidth"),10)||0)+(parseInt(a.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,s,n,a;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/t,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),a=this._valueMin()+s*n,this._trimAlignValue(a)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var s,n,a;this.options.values&&this.options.values.length?(s=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>s||1===t&&s>i)&&(i=s),i!==this.values(t)&&(n=this.values(),n[t]=i,a=this._trigger("slide",e,{handle:this.handles[t],value:i,values:n}),s=this.values(t?0:1),a!==!1&&this.values(t,i))):i!==this.value()&&(a=this._trigger("slide",e,{handle:this.handles[t],value:i}),a!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,i){var s,n,a;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(s=this.options.values,n=arguments[0],a=0;s.length>a;a+=1)s[a]=this._trimAlignValue(n[a]),this._change(null,a);this._refreshValue()},_setOption:function(t,i){var s,n=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(n=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!i),this._super(t,i),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,s;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,s=e-i;return 2*Math.abs(i)>=t&&(s+=i>0?t:-t),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),i=this.options.step,s=Math.floor(+(e-t).toFixed(this._precision())/i)*i;e=s+t,this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var t,i,s,n,a,o=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),u["horizontal"===h.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[l?"animate":"css"](u,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:r.animate}))),t=i}):(s=this.value(),n=this._valueMin(),a=this._valueMax(),i=a!==n?100*((s-n)/(a-n)):0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](u,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(t){var i,s,n,a,o=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),i=this._start(t,o),i===!1))return}switch(a=this.options.step,s=n=this.options.values&&this.options.values.length?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:n=this._valueMin();break;case e.ui.keyCode.END:n=this._valueMax();break;case e.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-a)}this._slide(t,o,n)},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var s=null,n=!1,a=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,a.widgetName+"-item")===a?(s=e(this),!1):void 0}),e.data(t.target,a.widgetName+"-item")===a&&(s=e(t.target)),s?!this.options.handle||i||(e(this.options.handle,s).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(a)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));
return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-this.document.scrollTop()<o.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<o.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),t.pageX-this.document.scrollLeft()<o.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?"next":"prev"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],n):!0)){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&"x"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&s.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!s.length&&t.key&&s.push(t.key+"="),s.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},i.each(function(){s.push(e(t.item||this).attr(t.attribute||"id")||"")}),s},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=e.left,o=a+e.width,r=e.top,h=r+e.height,l=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||s+l>r&&h>s+l,c="y"===this.options.axis||t+u>a&&o>t+u,p=d&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=t&&i,n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return s?this.floating?a&&"right"===a||"down"===n?2:1:n&&("down"===n?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&t||"up"===s&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){r.push(this)}var s,n,a,o,r=[],h=[],l=this._connectWith();if(l&&t)for(s=l.length-1;s>=0;s--)for(a=e(l[s],this.document[0]),n=a.length-1;n>=0;n--)o=e.data(a[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(h.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return e(r)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;t.length>i;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(n=e(c[i],this.document[0]),s=n.length-1;s>=0;s--)a=e.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(d.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a));for(i=d.length-1;i>=0;i--)for(o=d[i][1],r=d[i][0],s=0,l=r.length;l>s;s++)h=e(r[s]),h.data(this.widgetName+"-item",o),u.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item,t||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,s=t.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+s+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===s?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(n)):"tr"===s?t._createTrPlaceholder(t.currentItem,n):"img"===s&&n.attr("src",t.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(e,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(s.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),s.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,i){var s=this;t.children().each(function(){e("<td>&#160;</td>",s.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(t){var i,s,n,a,o,r,h,l,u,d,c=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&e.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,a=null,u=c.floating||this._isFloating(this.currentItem),o=u?"left":"top",r=u?"width":"height",d=u?"clientX":"clientY",s=this.items.length-1;s>=0;s--)e.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[o],l=!1,t[d]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(t[d]-h)&&(n=Math.abs(t[d]-h),a=this.items[s],this.direction=l?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],i=e(n.containment).offset(),s="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(t){var i,s,n=this.options,a=t.pageX,o=t.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(e,t,i,s){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(e,t){function i(e,t,i){return function(s){i._trigger(e,s,t._uiHash(t))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)t||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(s=0;n.length>s;s++)n[s].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}}),e.widget("ui.spinner",{version:"1.11.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;return e.each(["min","max","step"],function(e,s){var n=i.attr(s);void 0!==n&&n.length&&(t[s]=n)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e),void 0)},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:(this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var i=this.options,s=e.ui.keyCode;switch(t.keyCode){case s.UP:return this._repeat(null,1,t),!0;case s.DOWN:return this._repeat(null,-1,t),!0;case s.PAGE_UP:return this._repeat(null,i.page,t),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,s=this.options;return t=null!==s.min?s.min:0,i=e-t,i=Math.round(i/s.step)*s.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==s.max&&e>s.max?s.max:null!==s.min&&s.min>e?s.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,this.element.val(this._format(i)),void 0}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:h(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null===e?!1:e===this._adjustValue(e)},_value:function(e,t){var i;""!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:h(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:h(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:h(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:h(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?(h(this._value).call(this,e),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),e.widget("ui.tabs",{version:"1.11.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var i,s;t=t.cloneNode(!1),i=t.href.replace(e,""),s=location.href.replace(e,"");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return t.hash.length>1&&i===s}}(),_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===t&&(s&&this.tabs.each(function(i,n){return e(n).attr("aria-controls")===s?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:s++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,s--;break;case e.ui.keyCode.END:s=this.anchors.length-1;break;case e.ui.keyCode.HOME:s=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),this._activate(s),void 0;case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),this._activate(s===this.options.active?!1:s),void 0;default:return}t.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),t.ctrlKey||t.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",s)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function s(){return t>n&&(t=0),0>t&&(t=n),t}for(var n=this.tabs.length-1;-1!==e.inArray(s(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):"disabled"===e?(this._setupDisabled(t),void 0):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t),void 0)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,i=this.tabs,s=this.anchors,n=this.panels;
this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,s){var n,a,o,r=e(s).uniqueId().attr("id"),h=e(s).closest("li"),l=h.attr("aria-controls");t._isLocal(s)?(n=s.hash,o=n.substring(1),a=t.element.find(t._sanitizeSelector(n))):(o=h.attr("aria-controls")||e({}).uniqueId()[0].id,n="#"+o,a=t.element.find(n),a.length||(a=t._createPanel(o),a.insertAfter(t.panels[i-1]||t.tablist)),a.attr("aria-live","polite")),a.length&&(t.panels=t.panels.add(a)),l&&h.data("ui-tabs-aria-controls",l),h.attr({"aria-controls":o,"aria-labelledby":r}),a.attr("aria-labelledby",r)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,s=0;i=this.tabs[s];s++)t===!0||-1!==e.inArray(s,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,s=this.element.parent();"fill"===t?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),s=t.css("position");"absolute"!==s&&"fixed"!==s&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n.closest("li"),o=a[0]===s[0],r=o&&i.collapsible,h=r?e():this._getPanelForTab(a),l=s.length?this._getPanelForTab(s):e(),u={oldTab:s,oldPanel:l,newTab:r?e():a,newPanel:h};t.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",t,u)===!1||(i.active=r?!1:this.tabs.index(a),this.active=o?e():a,this.xhr&&this.xhr.abort(),l.length||h.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(a),t),this._toggle(t,u))},_toggle:function(t,i){function s(){a.running=!1,a._trigger("activate",t,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&a.options.show?a._show(o,a.options.show,s):(o.show(),s())}var a=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),n()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&r.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var i,s=this._findActive(t);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var i=this.options.disabled;i!==!1&&(void 0===t?i=!1:(t=this._getIndex(t),i=e.isArray(i)?e.map(i,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,i){return i!==t?i:null})),this._setupDisabled(i))},disable:function(t){var i=this.options.disabled;if(i!==!0){if(void 0===t)i=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,i))return;i=e.isArray(i)?e.merge([t],i).sort():[t]}this._setupDisabled(i)}},load:function(t,i){t=this._getIndex(t);var s=this,n=this.tabs.eq(t),a=n.find(".ui-tabs-anchor"),o=this._getPanelForTab(n),r={tab:n,panel:o},h=function(e,t){"abort"===t&&s.panels.stop(!1,!0),n.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),e===s.xhr&&delete s.xhr};this._isLocal(a[0])||(this.xhr=e.ajax(this._ajaxSettings(a,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.done(function(e,t,n){setTimeout(function(){o.html(e),s._trigger("load",i,r),h(n,t)},1)}).fail(function(e,t){setTimeout(function(){h(e,t)},1)})))},_ajaxSettings:function(t,i,s){var n=this;return{url:t.attr("href"),beforeSend:function(t,a){return n._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:a},s))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),e.widget("ui.tooltip",{version:"1.11.4",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,i){var s=(t.attr("aria-describedby")||"").split(/\s+/);s.push(i),t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(s.join(" ")))},_removeDescribedBy:function(t){var i=t.data("ui-tooltip-id"),s=(t.attr("aria-describedby")||"").split(/\s+/),n=e.inArray(i,s);-1!==n&&s.splice(n,1),t.removeData("ui-tooltip-id"),s=e.trim(s.join(" ")),s?t.attr("aria-describedby",s):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(t,i){var s=this;return"disabled"===t?(this[i?"_disable":"_enable"](),this.options[t]=i,void 0):(this._super(t,i),"content"===t&&e.each(this.tooltips,function(e,t){s._updateContent(t.element)}),void 0)},_disable:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur");n.target=n.currentTarget=s.element[0],t.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,s=e(t?t.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&s.parents().each(function(){var t,s=e(this);s.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,i.close(t,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._registerCloseHandlers(t,s),this._updateContent(s,t))},_updateContent:function(e,t){var i,s=this.options.content,n=this,a=t?t.type:null;return"string"==typeof s?this._open(t,e,s):(i=s.call(e[0],function(i){n._delay(function(){e.data("ui-tooltip-open")&&(t&&(t.type=a),this._open(t,e,i))})}),i&&this._open(t,e,i),void 0)},_open:function(t,i,s){function n(e){l.of=e,o.is(":hidden")||o.position(l)}var a,o,r,h,l=e.extend({},this.options.position);if(s){if(a=this._find(i))return a.tooltip.find(".ui-tooltip-content").html(s),void 0;i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),a=this._tooltip(i),o=a.tooltip,this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(s),this.liveRegion.children().hide(),s.clone?(h=s.clone(),h.removeAttr("id").find("[id]").removeAttr("id")):h=s,e("<div>").html(h).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:n}),n(t)):o.position(e.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval(function(){o.is(":visible")&&(n(l.of),clearInterval(r))},e.fx.interval)),this._trigger("open",t,{tooltip:o})}},_registerCloseHandlers:function(t,i){var s={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var s=e.Event(t);s.currentTarget=i[0],this.close(s,!0)}}};i[0]!==this.element[0]&&(s.remove=function(){this._removeTooltip(this._find(i).tooltip)}),t&&"mouseover"!==t.type||(s.mouseleave="close"),t&&"focusin"!==t.type||(s.focusout="close"),this._on(!0,i,s)},close:function(t){var i,s=this,n=e(t?t.currentTarget:this.element),a=this._find(n);return a?(i=a.tooltip,a.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),a.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(e(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,i){e(i.element).attr("title",i.title),delete s.parents[t]}),a.closing=!0,this._trigger("close",t,{tooltip:i}),a.hiding||(a.closing=!1)),void 0):(n.removeData("ui-tooltip-open"),void 0)},_tooltip:function(t){var i=e("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),s=i.uniqueId().attr("id");return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[s]={element:t,tooltip:i}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur"),a=s.element;n.target=n.currentTarget=a[0],t.close(n,!0),e("#"+i).remove(),a.data("ui-tooltip-title")&&(a.attr("title")||a.attr("title",a.data("ui-tooltip-title")),a.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}})});

/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/jquery.xml2json.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


/*
 ### jQuery XML to JSON Plugin v1.3 - 2013-02-18 ###
 * http://www.fyneworks.com/ - diego@fyneworks.com
	* Licensed under http://en.wikipedia.org/wiki/MIT_License
 ###
 Website: http://www.fyneworks.com/jquery/xml-to-json/
*//*
 # INSPIRED BY: http://www.terracoder.com/
           AND: http://www.thomasfrank.se/xml_to_json.html
											AND: http://www.kawa.net/works/js/xml/objtree-e.html
*//*
 This simple script converts XML (document of code) into a JSON object. It is the combination of 2
 'xml to json' great parsers (see below) which allows for both 'simple' and 'extended' parsing modes.
*/
// Avoid collisions
;if(window.jQuery) (function($){
 
 // Add function to jQuery namespace
 $.extend({
  
  // converts xml documents and xml text to json object
  xml2json: function(xml, extended) {
   if(!xml) return {}; // quick fail
   
   //### PARSER LIBRARY
   // Core function
   function parseXML(node, simple){
    if(!node) return null;
    var txt = '', obj = null, att = null;
    var nt = node.nodeType, nn = jsVar(node.localName || node.nodeName);
    var nv = node.text || node.nodeValue || '';
    /*DBG*/ //if(window.console) console.log(['x2j',nn,nt,nv.length+' bytes']);
    if(node.childNodes){
     if(node.childNodes.length>0){
      /*DBG*/ //if(window.console) console.log(['x2j',nn,'CHILDREN',node.childNodes]);
      $.each(node.childNodes, function(n,cn){
       var cnt = cn.nodeType, cnn = jsVar(cn.localName || cn.nodeName);
       var cnv = cn.text || cn.nodeValue || '';
       /*DBG*/ //if(window.console) console.log(['x2j',nn,'node>a',cnn,cnt,cnv]);
       if(cnt == 8){
        /*DBG*/ //if(window.console) console.log(['x2j',nn,'node>b',cnn,'COMMENT (ignore)']);
        return; // ignore comment node
       }
       else if(cnt == 3 || cnt == 4 || !cnn){
        // ignore white-space in between tags
        if(cnv.match(/^\s+$/)){
         /*DBG*/ //if(window.console) console.log(['x2j',nn,'node>c',cnn,'WHITE-SPACE (ignore)']);
         return;
        };
        /*DBG*/ //if(window.console) console.log(['x2j',nn,'node>d',cnn,'TEXT']);
        txt += cnv.replace(/^\s+/,'').replace(/\s+$/,'');
								// make sure we ditch trailing spaces from markup
       }
       else{
        /*DBG*/ //if(window.console) console.log(['x2j',nn,'node>e',cnn,'OBJECT']);
        obj = obj || {};
        if(obj[cnn]){
         /*DBG*/ //if(window.console) console.log(['x2j',nn,'node>f',cnn,'ARRAY']);
         
									// http://forum.jquery.com/topic/jquery-jquery-xml2json-problems-when-siblings-of-the-same-tagname-only-have-a-textnode-as-a-child
									if(!obj[cnn].length) obj[cnn] = myArr(obj[cnn]);
									obj[cnn] = myArr(obj[cnn]);
         
									obj[cnn][ obj[cnn].length ] = parseXML(cn, true/* simple */);
         obj[cnn].length = obj[cnn].length;
        }
        else{
         /*DBG*/ //if(window.console) console.log(['x2j',nn,'node>g',cnn,'dig deeper...']);
         obj[cnn] = parseXML(cn);
        };
       };
      });
     };//node.childNodes.length>0
    };//node.childNodes
    if(node.attributes){
     if(node.attributes.length>0){
      /*DBG*/ //if(window.console) console.log(['x2j',nn,'ATTRIBUTES',node.attributes])
      att = {}; obj = obj || {};
      $.each(node.attributes, function(a,at){
       var atn = jsVar(at.name), atv = at.value;
       att[atn] = atv;
       if(obj[atn]){
        /*DBG*/ //if(window.console) console.log(['x2j',nn,'attr>',atn,'ARRAY']);
        
								// http://forum.jquery.com/topic/jquery-jquery-xml2json-problems-when-siblings-of-the-same-tagname-only-have-a-textnode-as-a-child
								//if(!obj[atn].length) obj[atn] = myArr(obj[atn]);//[ obj[ atn ] ];
        obj[cnn] = myArr(obj[cnn]);
								
								obj[atn][ obj[atn].length ] = atv;
        obj[atn].length = obj[atn].length;
       }
       else{
        /*DBG*/ //if(window.console) console.log(['x2j',nn,'attr>',atn,'TEXT']);
        obj[atn] = atv;
       };
      });
      //obj['attributes'] = att;
     };//node.attributes.length>0
    };//node.attributes
    if(obj){
     obj = $.extend( (txt!='' ? new String(txt) : {}),/* {text:txt},*/ obj || {}/*, att || {}*/);
     //txt = (obj.text) ? (typeof(obj.text)=='object' ? obj.text : [obj.text || '']).concat([txt]) : txt;
     txt = (obj.text) ? ([obj.text || '']).concat([txt]) : txt;
     if(txt) obj.text = txt;
     txt = '';
    };
    var out = obj || txt;
    //console.log([extended, simple, out]);
    if(extended){
     if(txt) out = {};//new String(out);
     txt = out.text || txt || '';
     if(txt) out.text = txt;
     if(!simple) out = myArr(out);
    };
    return out;
   };// parseXML
   // Core Function End
   // Utility functions
   var jsVar = function(s){ return String(s || '').replace(/-/g,"_"); };
   
			// NEW isNum function: 01/09/2010
			// Thanks to Emile Grau, GigaTecnologies S.L., www.gigatransfer.com, www.mygigamail.com
			function isNum(s){
				// based on utility function isNum from xml2json plugin (http://www.fyneworks.com/ - diego@fyneworks.com)
				// few bugs corrected from original function :
				// - syntax error : regexp.test(string) instead of string.test(reg)
				// - regexp modified to accept  comma as decimal mark (latin syntax : 25,24 )
				// - regexp modified to reject if no number before decimal mark  : ".7" is not accepted
				// - string is "trimmed", allowing to accept space at the beginning and end of string
				var regexp=/^((-)?([0-9]+)(([\.\,]{0,1})([0-9]+))?$)/
				return (typeof s == "number") || regexp.test(String((s && typeof s == "string") ? jQuery.trim(s) : ''));
			};
			// OLD isNum function: (for reference only)
			//var isNum = function(s){ return (typeof s == "number") || String((s && typeof s == "string") ? s : '').test(/^((-)?([0-9]*)((\.{0,1})([0-9]+))?$)/); };
																
   var myArr = function(o){
    
				// http://forum.jquery.com/topic/jquery-jquery-xml2json-problems-when-siblings-of-the-same-tagname-only-have-a-textnode-as-a-child
				//if(!o.length) o = [ o ]; o.length=o.length;
    if(!$.isArray(o)) o = [ o ]; o.length=o.length;
				
				// here is where you can attach additional functionality, such as searching and sorting...
    return o;
   };
   // Utility functions End
   //### PARSER LIBRARY END
   
   // Convert plain text to xml
   if(typeof xml=='string') xml = $.text2xml(xml);
   
   // Quick fail if not xml (or if this is a node)
   if(!xml.nodeType) return;
   if(xml.nodeType == 3 || xml.nodeType == 4) return xml.nodeValue;
   
   // Find xml root node
   var root = (xml.nodeType == 9) ? xml.documentElement : xml;
   
   // Convert xml to json
   var out = parseXML(root, true /* simple */);
   
   // Clean-up memory
   xml = null; root = null;
   
   // Send output
   return out;
  },
  
  // Convert text to XML DOM
  text2xml: function(str) {
   // NOTE: I'd like to use jQuery for this, but jQuery makes all tags uppercase
   //return $(xml)[0];
   
   /* prior to jquery 1.9 */
   /*
   var out;
   try{
    var xml = ((!$.support.opacity && !$.support.style))?new ActiveXObject("Microsoft.XMLDOM"):new DOMParser();
    xml.async = false;
   }catch(e){ throw new Error("XML Parser could not be instantiated") };
   try{
    if((!$.support.opacity && !$.support.style)) out = (xml.loadXML(str))?xml:false;
    else out = xml.parseFromString(str, "text/xml");
   }catch(e){ throw new Error("Error parsing XML string") };
   return out;
   */

   /* jquery 1.9+ */
   return $.parseXML(str);
  }
		
 }); // extend $

})(jQuery);


/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/formatting.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


// JS Object: ToFmt
// Author: David Mosley, E-mail: David.Mosley@fundp.ac.be or davmos@fcmail.com
// August 1998.
// http://www.chimie.fundp.ac.be/javas/js_format.html
// Contains a limited set of formatting routines for
// use in JavaScript scripts.
// Feel free to use this code in your scripts. I would be grateful if you
// could keep this header intact. 
// Please let me know if you find the code useful.
// Please report any bugs you find or improvements you make to the script. 
// The code has been tested, but no guarantee can be made of it functioning
// correctly. Use is entirely at your own risk.
// 
// Summary of methods
// fmt00(): Tags leading zero onto numbers 0 - 9.
// Particularly useful for displaying results from Date methods.
//
// fmtF(w,d): formats in a style similar to Fortran's Fw.d, where w is the
// width of the field and d is the number of figures after the decimal
// point. 
// The result is aligned to the right of the field.  The default
// padding character is a space " ". This can be modified using the 
// setSpacer(string) method of ToFmt. 
// If the result will not fit in the field , the field will be returned
// containing w asterisks.
//
// fmtE(w,d): formats in a style similar to Fortran's Ew.d, where w is the
// width of the field and d is the number of figures after the decimal
// point. 
// The result is aligned to the right of the field.  The default
// padding character is a space " ". This can be modified using the 
// setSpacer(string) method of ToFmt. 
// If the result will not fit in the field , the field will be returned
// containing w asterisks.
//
// fmtI(w): formats in a style similar to Fortran's Iw, where w is the
// width of the field.
// Floating point values are truncated (rounded down) for integer
// representation.
// The result is aligned to the right of the field.  The default
// padding character is a space " ". This can be modified using the 
// setSpacer(string) method of ToFmt. 
// If the result will not fit in the field , the field will be returned
// containing w asterisks.

function ToFmt(x){
 this.x=x;
 this.fmt00 = fmt00;
 this.fmtF = fmtF;
 this.fmtE=fmtE;
 this.fmtI=fmtI;
 this.spacer=" ";
 this.setSpacer=setSpacer;
}

function fmt00(){
 // fmt00: Tags leading zero onto numbers 0 - 9.
 // Particularly useful for displaying results from Date methods.
 //
 if (parseInt(this.x) < 0) var neg = true;
 if (Math.abs(parseInt(this.x)) < 10){
  this.x = "0"+ Math.abs(this.x);
 }
 if (neg) this.x = "-"+this.x;
 return this.x;
}

function fmtF(w,d){

 // fmtF: formats in a style similar to Fortran's Fw.d, where w is the
 // width of the field and d is the number of figures after the decimal
 // point. 
 // The result is aligned to the right of the field.  The default
 // padding character is a space " ". This can be modified using the 
 // setSpacer(string) method of ToFmt. 
 // If the result will not fit in the field , the field will be returned
 // containing w asterisks.
 var width=w;
 var dpls=d;
 var lt1=false;
 var len=this.x.toString().length;
 var junk;
 var res="";
// First check for valid format request
 if ( width < (dpls+2)){
  window.alert("Illegal format specified : w = " + d +
               " w = " + d +
                "\nUsage: [ToFmt].fmtF(w,d)" +
                "\nWidth (w) of field must be greater or equal to the number " +
                "\nof digits to the right of the decimal point (d) + 2");
  junk = filljunk(width);
  return junk;
 }
// Work with absolute value
 var absx=Math.abs(this.x);
// Nasty fix to deal with numbers < 1 and problems with leading zeros!
 if ((absx < 1) && (absx > 0)){
  lt1 = true;
  absx+=10;
 }
// Get postion of decimal point
 var pt_pos = absx.toString().indexOf(".");
 if ( pt_pos == -1){
  res+= absx;
  res+= ".";
  for (var i = 0; i < dpls; i++){
   res += 0;
  }  
 }
 else{
  res = Math.round(absx * Math.pow(10,dpls));
  res=res.toString();
  if (res.length == 
      Math.round(Math.floor(absx * Math.pow(10,dpls))).toString().length){ 
   res = res.substring(0,pt_pos) + "." + 
         res.substring(pt_pos,res.length);
  }
  else{
   pt_pos++;
   res = res.substring(0,pt_pos) + "." + 
          res.substring(pt_pos,res.length);
  } 
// Remove leading 1 from  numbers < 1 (Nasty fix!)
  if (lt1) {
   res=res.substring(1,res.length);
  }
 }
 // Final formatting statements
 // Reinsert - sign for negative numbers
 if (this.x < 0)res = "-"+res;
 // Check whether the result fits in the width of the field specified
 if (res.length > width){
  res=filljunk(width);
 }
 // If necessary, pad from the left with the spacer string
 else if (res.length < width){
  var res_bl="";
  for (var i = 0; i < (width - res.length); i++){
   res_bl += this.spacer ;
  } 
  res = res_bl + res;
 }
 return res;
}

function fmtE(w,d){

 // fmtE: formats in a style similar to Fortran's Ew.d, where w is the
 // width of the field and d is the number of figures after the decimal
 // point. 
 // The result is aligned to the right of the field.  The default
 // padding character is a space " ". This can be modified using the 
 // setSpacer(string) method of ToFmt. 
 // If the result will not fit in the field , the field will be returned
 // containing w asterisks.
 //
 var width=w;
 var dpls=d;
 var e="E+";
 var len=this.x.toString().length;
 var pow10;
 var xp10;
 var junk;
 var res="";
// First check for valid format request
 if ( width < (dpls+5)){
  window.alert("Illegal format specified : w = " + d +
               " w = " + d +
                "\nUsage: [ToFmt].fmtE(w,d)" +
                "\nWidth (w) of field must be greater or equal to the number " +
                "\nof digits to the right of the decimal point (d) + 6");
  junk = filljunk(w);
  return junk;
 }
// Work with absolute value
 var absx=Math.abs(this.x);
// Get postion of decimal point
 var pt_pos = absx.toString().indexOf(".");
// For x=0
 if (absx == 0){
  res +="0.";
  for (var i=0; i< dpls; i++){
   res += "0";
  }
  res  += "E+00";
 }
// For abs(x) >= 1 
 else if (absx >= 1.0){
  pow10=1;
  xp10 = absx;
  while (xp10 >= 1.){
   pow10++;
   xp10 /= 10;
  }
  res = Math.round(xp10 * Math.pow(10,dpls));
  res=res.toString();
  if (res.length == 
      Math.round(Math.floor(xp10 * Math.pow(10,dpls))).toString().length){ 
    pow10--;
  }
  res = "0." + res.substring(0,dpls) + e + (new ToFmt(pow10)).fmt00();
 }
// For abs(x) < 1
 else if (absx < 1.0){
  pow10=1;
  xp10 = absx;
  while (xp10 < 1.){
   pow10--;
   xp10 *= 10;
  }
  res = Math.round(xp10/10 * Math.pow(10,dpls));
  res=res.toString();
  if (res.length != 
      Math.round(Math.floor(xp10/10 * Math.pow(10,dpls))).toString().length){ 
    pow10++;
  }
  if (pow10 < 0) e = "E-";
  res = "0." + res.substring(0,dpls) + e + (new ToFmt(Math.abs(pow10))).fmt00();
 }
 
 if (this.x < 0)res = "-"+res;
 if (res.length > width){
  res=filljunk(width);
 }
 else if (res.length < width){
  var res_bl="";
  for (var i = 0; i < (width - res.length); i++){
   res_bl += this.spacer ;
  } 
  res = res_bl + res;
 }
 return res;
 
}

function fmtI(w){

 // fmtI: formats in a style similar to Fortran's Iw, where w is the
 // width of the field.
 // Floating point values are truncated (rounded down) for integer
 // representation.
 // The result is aligned to the right of the field.  The default
 // padding character is a space " ". This can be modified using the 
 // setSpacer(string) method of ToFmt. 
 // If the result will not fit in the field , the field will be returned
 // containing w asterisks.
 var width=w;
 var lt0=false;
 var len=this.x.toString().length;
 var junk;
 var res="";
// Work with absolute value
 var absx = Math.abs(this.x);

// Test for < 0
 if (parseInt(this.x) < 0){
  lt0 = true;
 }
 res = Math.round(Math.floor((absx))).toString();
 if (lt0){
  res = "-"+res;
 }
 if (res.length > width){
  res=filljunk(width);
 }
 else if (res.length < width){
  var res_bl="";
  for (var i = 0; i < (width - res.length); i++){
   res_bl += this.spacer ;
  } 
  res = res_bl + res;
 }
 return res;
}

function filljunk(lenf){
 // Fills field of length lenf with asterisks
 var str="";
 for (var i=0; i < lenf; i++){
  str +="*";
 }
 return str;
}

function setSpacer(spc){
 var spc;
 this.spacer=spc;
 return this.spacer;
}


/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/simulation.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


/*
function generateSimulationFunction1(modelStr) {
    var model = JSON.parse(modelStr);
    var dynamicFunctionCode = generateSimulationFunction2(model);
    return dynamicFunctionCode;
}
*/






// This is the function for generating simulation code.   The functions following it are private
// functions, defined within the scope of this function, down to 
//   }; // End of SYSTO.generateSimulationFunction

SYSTO.generateSimulationFunction = function (model) {

    var nodeList = model.nodes;

        assignInarcsAndOutarcsForEachNode(model);
        if (isEmpty(nodeList)) {
            return;
        }

        for (nodeId in nodeList) {
            var node = nodeList[nodeId];
            if (!node.workspace) node.workspace = {};
            var equation = getEquation(node);
            if (equation !== '') {
                //nodeCheckAll(node.equation);  // TODO
                //node.equation.jstext = makeJavascriptEquation(node.equation);  // TODO
                var tokenArray = tokenise(equation);
                node.workspace.tokenArray = JSON.parse(JSON.stringify(tokenArray));  // I.e. *before* turning into Javascript
                tokenArray = turnIntoPureJavascript(tokenArray);
                node.workspace.jsequation = makeJavascriptEquation(tokenArray);
            }
        }

        var result = myTopologicalSort(model, ['stock', 'valve', 'variable']);
        console.debug('\n==============================================');
        console.debug(result);
        if (result.status === 'OK') {
            var sortedDynamicArray = result.sortedNodeArray;
        } else {
             return {status:'error', message:result.message, path:SYSTO.addToPath(result.path,'generateSimulationFunction()')};
        }

        model.simulationDataStructures = buildSimulationDataStructures(model);
        console.debug(model.simulationDataStructures);

        if (model.scenarios && model.scenarios.default && model.scenarios.default.simulation_settings) {
            var integrationMethod = model.scenarios.default.simulation_settings.integration_method;
        } else {
            integrationMethod = 'euler1';
        }
        if (SYSTO.plugins && SYSTO.plugins.codeGenerator && SYSTO.plugins.codeGenerator[integrationMethod]) {
            // OK: do nothing
        } else if (SYSTO.plugins && SYSTO.plugins.codeGenerator && SYSTO.plugins.codeGenerator['euler1']) {
            integrationMethod = 'euler1';
        } else {
            alert('INTERNAL ERROR.   No integration code has been supplied for this web page.');
            return;
        }

        model.dynamicFunctionCode = generateSimulationCode(integrationMethod, model, sortedDynamicArray,
            model.simulationDataStructures);

        resultsObject = SYSTO.simulate(model);
        //console.debug(resultsObject);
        //model.results = JSON.parse(JSON.stringify(resultsObject.results));
        //model.resultStats = JSON.parse(JSON.stringify(resultsObject.resultStats));

        return {status:'OK', function:'SYSTO.generateSimulationFunction'};



    //=====================================================================
    // TOPOLOGICAL SORTING

    function myTopologicalSort(model, includeNodeTypes) {

        graph = [];   // This holds the "adjacency list" for each node
        index = {};  // This is to allow the index number to be found from the node's id.
        sortedNodeArray = [];

        var nodeList = model.nodes;
        var arcList = model.arcs;

        // First, number the nodes
        var i = 0;
        for (nodeId in nodeList) {
            if (nodeList.hasOwnProperty(nodeId)) {
                node = nodeList[nodeId];
                if (includeNodeTypes.indexOf(node.type)>=0) {
                    //if (node.type === 'stock' && isEmpty(node.getInarcs(['influence']))) continue; // Hack!
                    index[node.id] = i;
                    graph.push({node:node, edges:{}});
                    i += 1;
                }
            }
        }

        // Now, insert the adjacencies
        var n = graph.length;
        for (var i=0; i<n; i++) {
            var adjacencies = [];
            for (var arcId in arcList) {
                if (arcList.hasOwnProperty(arcId)) {
                    var arc = arcList[arcId];
                    if (arc.type === 'influence' && arc.start_node_id === graph[i].node.id) {
                        adjacencies.push(index[arc.end_node_id]);
                    }
                }
            }
            graph[i].edges = adjacencies;
        }
        
        // Acknowledgement: https://github.com/robrighter/javascript-topological-sort
        // We now do the topological sort...

	    try{
		    var solution = topologicalSort(graph);
            var n = solution.length;
            for (i=0; i<n; i++) {
                sortedNodeArray[i] = graph[solution[i]].node;
            }
	    }catch(e){
		    if (e === "You have a cycle!!") {
                solution = 'cycle';
                alert('Sadly, there is s a problem with your model - a circular loop of influence arrows.   Even more sadly, I cannot tell you which variables are involved, so you will need to find it for yourself!');
                return {status:'error', message:'circular influences', path:SYSTO.addToPath([],'myTopologicalSort()')};
		    } else {
                solution = 'unidentified error';
                alert('I have come across a major error - not your fault - which is preventing me sorting the variables into evaluation order.   Sorry, but I cannot proceed to prepare the model for simulation.');
                return {status:'error', message:'unidentified error', path:SYSTO.addToPath([],'myTopologicalSort()')};
		    }
	    }

        // ... and use this to create the sorted array of nodes.
        var n = solution.length;
        for (i=0; i<n; i++) {
            sortedNodeArray[i] = graph[solution[i]].node;
        }

        return {status:'OK', sortedNodeArray:sortedNodeArray};
    }




    //    Copyright 2012 Rob Righter (@robrighter)
    // 
    //    Licensed under the Apache License, Version 2.0 (the "License");
    //    you may not use this file except in compliance with the License.
    //    You may obtain a copy of the License at
    // 
    //        http://www.apache.org/licenses/LICENSE-2.0
    // 
    //    Unless required by applicable law or agreed to in writing, software
    //    distributed under the License is distributed on an "AS IS" BASIS,
    //    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    //    See the License for the specific language governing permissions and
    //    limitations under the License.


    function topologicalSort(graph) {
	    var numberOfNodes = graph.length;
	    var processed = [];
	    var unprocessed = [];
	    var queue = [];
	
	    function iterate(arr, callback){
		    var i;
		    for(i=0;i<arr.length;i++){
			    callback(arr[i], i);
		    }
	    }
	
	    function processList(){
		    for(var i=0; i<unprocessed.length; i++){
			    var nodeid = unprocessed[i];
			    if(graph[nodeid].indegrees === 0){
				    queue.push(nodeid);
				    unprocessed.splice(i, 1); //Remove this node, its all done.
				    i--;//decrement i since we just removed that index from the iterated list;
			    }
		    }
		
		    processStartingPoint(queue.shift());
		    if(processed.length<numberOfNodes){
			    processList();
		    }
	    }


	    function processStartingPoint(nodeId){
		    if(nodeId == undefined){
			    throw "You have a cycle!!";
		    }
		    iterate(graph[nodeId].edges, function(e){
			    graph[e].indegrees--;
		    });
		    processed.push(nodeId);
	    }


	    function populateIndegreesAndUnprocessed(){
		    iterate(graph, function(node, nodeId){
			    unprocessed.push(nodeId);
			    if(!node.hasOwnProperty('indegrees')){
				    node.indegrees = 0
			    }
			    iterate(node.edges, function(e){
				    if(!graph[e].hasOwnProperty('indegrees')){
					    graph[e].indegrees = 1
				    }
				    else{
					    graph[e].indegrees = graph[e].indegrees + 1;
				    }
			    });
		    });
	    }
	
	    populateIndegreesAndUnprocessed();
	    processList();
	    return processed;
    }
    // End of: Copyright 2012 Rob Righter (@robrighter)






    //=====================================================================
    // BUILD SIMULATION DATA STRUCTURES

    function buildSimulationDataStructures(model) {
        var node;
        var nodeId;
        var arc;
        var arcId;
        var nStock;
        var valveNode;

        mode = 'pointer';
        
        var stocks = [];
        var variables = [];
        var inflows = [];
        var outflows = [];
        var parameters = [];
        var initialStockArray = [];   // TODO: check on difference between 'stocks' and 'initialStockArray'

        var nodeList = model.nodes;
        var arcList = model.arcs;

        // Create efficient lookup for model node labels (for when checking variables in equations)
        if (!model.workspace) model.workspace = {};
        for (var nodeId in nodeList) {
            var node = nodeList[nodeId];
            var label = node.label.replace(' ','_');
            model.workspace[label] = true;
        }

        for (var nodeId in nodeList) {
            if (nodeList.hasOwnProperty(nodeId)) {
                if (!node.workspace) node.workspace = {};
                var node = nodeList[nodeId];
                node.workspace.nodeSimProperties = getNodeSimProperties(model, node);
           }
        }

        for (var nodeId in nodeList) {
            if (nodeList.hasOwnProperty(nodeId)) {
                var node = nodeList[nodeId];
                //if (isParameter(node)) {
                if (node.workspace.nodeSimProperties.simStage === 'initial') {
                    parameters.push(node);
                }
            }
        }

        for (var nodeId in nodeList) {
            if (nodeList.hasOwnProperty(nodeId)) {
                var node = nodeList[nodeId];
                if (node.type === 'stock') {
                    initialStockArray.push(node);
                }
            }
        }

        // Build up the list of state variables
        for (nodeId in nodeList) {
        if (nodeList.hasOwnProperty(nodeId)) {
            node = nodeList[nodeId];
            if (node.type=='stock') {
                stocks.push(node);
            }
        }}
        nStock = stocks.length;

        // Build up list of inflows and ouflows for each state variable
        // TODO: replace this with Node.getInarcs['flow'] and Node.getOutarcs['flow'].
        inflows = [];
        outflows = [];
        for (i=0; i<nStock; i++) {
            node = stocks[i];
            ins = [];
            outs = [];
            for (arcId in arcList) {
            if (arcList.hasOwnProperty(arcId)) {
                arc = arcList[arcId];
                if (arc.type === 'flow') {
                    if (node.id === arc.end_node_id) {
                       valveNodeId = nodeList[arc.node_id];
                       ins.push(valveNodeId);
                    } else if (node.id === arc.start_node_id) {
                       valveNodeId = nodeList[arc.node_id];
                       outs.push(valveNodeId);
                    }
                }
            }}
            inflows[i] = ins;
            outflows[i] = outs;
        }

        return {
            stocks:stocks, 
            variables:variables, 
            parameters:parameters,
            initialStockArray:initialStockArray, 
            inflows:inflows,
            outflows:outflows
        };
    }



    // Node types (relevant to simulation)
    // I stock, with numeric constant initial value
    // I stock, with initial value calculated from constants
    // I parameter or flow, with value a simple numeric constant
    // I parameter or flow, with value some sort of expression (e.g. 5*7) expressed in pure numeric terms
    // I parameter or flow, calculated from other parameters
    // D exogenous variable, calculated from SIMTIME
    // D intermediate (calculated) variable
    // D calculated flow


    // Note that we analyse the node's equation as the token array, *not* as the equation text string.

    function getNodeSimProperties(model, node) {
        if (node.workspace && node.workspace.tokenArray) {
            var tokenArray = node.workspace.tokenArray;
            var nTokens = tokenArray.length;
            if (nTokens === 0) return {complete:false};

            // It's a simple numeric constant
            if (nTokens === 1 && tokenArray[0].type === 'number') {
                return {complete:true, simStage:'initial', simCategory:'simple_numeric_constant'};

            // It's a compound numeric constant
            } else if (!hasStockFlowOrVariable(model, tokenArray) && !hasDynamicFunction(tokenArray) && !hasDynamicSpecialVariable(tokenArray)) {
                return {complete:true, simStage:'initial', simCategory:'compound_numeric_constant'};

            // It's a dynamic variable
            } else if (hasStockFlowOrVariable(model, tokenArray) || hasDynamicFunction(tokenArray) || hasDynamicSpecialVariable(tokenArray)) {
                return {complete:true, simStage:'dynamic', simCategory:'time_varying'};

            } else {
                return {error:true};
            }

        } else {
            return {complete:false};
        }    
    }
               


    function hasStockFlowOrVariable(model, tokenArray) {
        var nodeList = model.nodes;

        for (var i=0; i<tokenArray.length; i++) {
            if (tokenArray[i].type === 'name') {
                if (model.workspace[tokenArray[i].value]) {  // Cool trick!
                    return true;
                } else if (tokenArray[i] === 'SIMTIME') {
                    return true;
                }
            }
        }
        return false;
    }


    function hasDynamicFunction(tokenArray) {
        var dynamicFunctions = {
            rand_var:true
        };
        for (var i=0; i<tokenArray.length-1; i++) {  // The -1 is because we are checking for a function
            if (dynamicFunctions[tokenArray[i].value] && tokenArray[i+1].value === '(') {
                return true;
            }
        }
        return false;
    }


    function hasDynamicSpecialVariable(tokenArray) {
        var dynamicSpecialVariable = {
            SIMTIME:true
        };
        for (var i=0; i<tokenArray.length; i++) {  
            if (dynamicSpecialVariable[tokenArray[i].value]) {
                return true;
            }
        }
        return false;
    }



       // The dynamic part of the generated simulation code can be executed either within a
       // standard time loop, or inside setInterval().  The former is used to generate results
       // as fast as possible, when no user interactivity is required.   The latter is used
       // to allow the for animation of the results and/or user interaction during the simulation.
       // For this reason, the dynamic part of the generated simulation code is put into a separate
       // string variable, which is then either wrapped up in a simulation 'for' statement, or 
       // provided as the first argument for setInterval().

       // Note that all the code inside setInterval() has to be without line-breaks,
       // so don't put any '\n' in when generating it!

       // See http://dev.opera.com/articles/view/efficient-javascript/?page=2#timeouts for improving the
       // efficiency of setInterval.


    function generateSimulationCode(integrationMethod, model, sortedDynamicArray, simulationDataStructures) {
        var codeGeneratorFunction = SYSTO.plugins.codeGenerator[integrationMethod];
        var dynamicFunctionCode = codeGeneratorFunction(model, sortedDynamicArray, simulationDataStructures)
        return dynamicFunctionCode;
    }

}; // End of SYSTO.generateSimulationFunction


// ============================ SIMULATION ==============================

SYSTO.simulateMultiple = function (modelIdArray) {
    for (var i=0; i<modelIdArray.length; i++) {
        var modelId = modelIdArray[i];
        var model = SYSTO.models[modelId];
        if (model) {
            SYSTO.simulate(model);
        }
    }
};


SYSTO.simulate = function (model) {

    if (!model.workspace) model.workspace = {};
    if (model.workspace.modelChanged) {
        model.workspace.modelChanged = false;
        //var result = generateSimulationFunction(model);
        var result = SYSTO.generateSimulationFunction(model);
        if (result.status === 'error') {
            return {status:'error', message:result.message, path:result.path.push('SYSTO.simulate()')};
        }
        // Not sure if the following trigger ever needed at this point, but included just in case...
        // Jan 2015 Commented out, and it does not seem to have stopped anything working...
        //SYSTO.trigger('simulation.js', 'SYSTO.simulate()', 'change_model_listener', 'click', [{oldModelId:'',newModelId:SYSTO.state.currentModelId}]);
    }
        
    // Starting the clock here rather than for the evaluate function itself, since this
    // is the real time cost for each run.
    var startClockTime = new Date();

    var simulationDataStructures = model.simulationDataStructures;
    var dynamicFunctionCode = model.dynamicFunctionCode;

    var nodeList = model.nodes;
    var arcList = model.arcs;

    var parameters = simulationDataStructures.parameters;
    var stocks = simulationDataStructures.stocks;
    var initialStockArray = simulationDataStructures.initialStockArray;

    var nParameter = parameters.length;
    var nStock = stocks.length;
    var nInitialStock = initialStockArray.length;

    var m = {};

    var stockIdArray = [];
    var dstockIdArray = [];
    var stockLabelArray = [];
    var dstockLabelArray = [];
    for (i = 0; i < nStock; i++) {
        var nodeId = stocks[i].id;
        var node = nodeList[nodeId];
        stockIdArray.push(nodeId);
        dstockIdArray.push('d_'+nodeId);
        stockLabelArray.push(node.label);
        dstockLabelArray.push('d_'+node.label);
        m[node.label] = parseFloat(node.workspace.jsequation);
    }

    for (i = 0; i < nParameter; i++) {
        nodeId = parameters[i].id;
        node = nodeList[nodeId];
        m[node.label] = parseFloat(node.workspace.jsequation);
    }

    var parameterValues = {};
    var stockValues = {};
    var initialStockValues = {};

    for (i = 0; i < nInitialStock; i++) {
        nodeId = initialStockArray[i].id;
        initialStockValues[nodeId] = parseFloat(nodeList[nodeId].workspace.jsequation);
    }

    for (i = 0; i < nStock; i++) {
        nodeId = stocks[i].id;
        stockValues[nodeId] = parseFloat(nodeList[nodeId].workspace.jsequation);
    }

    for (i = 0; i < nParameter; i++) {
        nodeId = parameters[i].id;
        parameterValues[nodeId] = parseFloat(nodeList[nodeId].workspace.jsequation);
    }


    // TODO: have a fall-back in case the runcontrol widget is not available.
    var simSettings = model.scenarios.default.simulation_settings;
    var startTime = simSettings.start_time;
    var endTime = simSettings.end_time;
    var nstep = simSettings.nstep;     
    if (!startTime) startTime = 0;   // These should not be needed!
    if (!endTime) endTime = 100;
    if (!nstep) nstep = 100;
    var settings = {startTime:startTime, endTime:endTime, nstep:nstep};

    var evaluateDynamicBlock = new Function ("settings", "inputValues", dynamicFunctionCode);

    var inputValues = {};
    inputValues.parameterValues = parameterValues;
    inputValues.initialStockValues = initialStockValues;

    try {
        var startEvalClockTime = new Date();
        var results = evaluateDynamicBlock(settings, inputValues);

        var endEvalClockTime = new Date();
        if (!SYSTO.state.totalSimulationTime) {
            SYSTO.state.totalSimulationTime = (endEvalClockTime-startEvalClockTime)/1000;
        } else {
            SYSTO.state.totalSimulationTime += (endEvalClockTime-startEvalClockTime)/1000;
        }
        if (!SYSTO.state.nRuns) {
            SYSTO.state.nRuns = 1;
        } else {
            SYSTO.state.nRuns += 1;
        }
        var meanRunsPerSecond = Math.round(10*SYSTO.state.nRuns/SYSTO.state.totalSimulationTime)/10;
        $('#n_runs').text(SYSTO.state.nRuns);
        $('#total_time').text(Math.round(10000*SYSTO.state.totalSimulationTime)/10000);
        $('#rps').text(meanRunsPerSecond);

        I_HAVE_results = true;

        var sorted_labels = [];
        var sorted_node_labels = [];    // Temporary - needs to hold multiple runs

        for (node_label in results) {
        if (results.hasOwnProperty(node_label)) {
            sorted_labels.push(node_label);
        }}
        sorted_labels.sort(function(a, b){
            if (a==='Time') {return -1}
            else if (b==='Time') {return 1}
            var nameA=a.toLowerCase(), nameB=b.toLowerCase()
            if (nameA < nameB) {return -1} 
            else if (nameA > nameB) {return 1}
            else {return 0}
        });

        irun = 1;
        sorted_node_labels['Run'+irun] = sorted_labels;

        var resultStats = {};
        for (nodeId in results) {
            if (results.hasOwnProperty(nodeId)) {
                if (nodeId === 'Time') continue;
                if (nodeId === 'currentValues') continue;
                var node = nodeList[nodeId];
                if (node) {
                    resultStats[nodeId] = {};
                    // From John Resig: http://ejohn.org/blog/fast-javascript-maxmin/
                    // And see note in global area of graphogram.js.
                    resultStats[nodeId].min = Math.min.apply(Math, results[nodeId]);
                    resultStats[nodeId].max = Math.max.apply(Math, results[nodeId]);
                }
            }
        }

        // Temporary measure
        SYSTO.results = results;            
        SYSTO.resultStats = resultStats;

        // Not sure why I do this here...
        model.results = results;            
        model.resultStats = resultStats;

        var endClockTime = new Date();
        var runTime = endClockTime-startClockTime;
        var evaluationTime = endEvalClockTime-startEvalClockTime;
        var simSequence = SYSTO.state.simulationRunSequenceNumber;
        if (SYSTO.state.simulationTimings[simSequence]) {
            var simTimingObject = SYSTO.state.simulationTimings[simSequence];
            simTimingObject.nRuns += 1;
            simTimingObject.cumRunTime += runTime;
            simTimingObject.aveRunTime =  simTimingObject.cumRunTime/simTimingObject.nRuns;
            simTimingObject.cumEvaluationTime += evaluationTime;
            simTimingObject.aveEvaluationTime =  simTimingObject.cumEvaluationTime/simTimingObject.nRuns;
        }


    return {status:'OK'};
    } 
    catch (err) {
        SYSTO.trigger({
            file: 'simulation.js)',
            action: 'SYSTO.simulate(): try running model',
            event_type: 'message_listener',
            parameters: {message: 'Model is not runnable'}});

        return {status:'error'};
    }
};





function simulateMany(input) {
    this.nodeList[input.inputId].equation.text = input.inputValue;
    this.nodeList[input.inputId].equation.jstext = input.inputValue;
    this.SYSTO.simulate();
}




// This function allows for the fact that an equation has been stored in two
// different places: node.equation and node.extras.equation.text.

function getEquation(node) {
    if (node.equation && node.equation !== '') {
        return node.equation;
    } else if (node.extras && node.extras.equation && node.extras.equation.value &&
            node.extras.equation.value !== '') {
        return node.extras.equation.value;
    } else {
        return '';
    }
}



// tokens.js
// 2010-02-23

// (c) 2006 Douglas Crockford

// Produce an array of simple token objects from a string.
// A simple token object contains these members:
//      type: 'name', 'string', 'number', 'operator'
//      value: string or number value of the token
//      from: index of first character of the token
//      to: index of the last character + 1

// Comments of the // type are ignored.

// Operators are by default single characters. Multicharacter
// operators can be made by supplying a string of prefix and
// suffix characters.
// characters. For example,
//      '<>+-&', '=>&:'
// will match any of these:
//      <=  >>  >>>  <>  >=  +: -: &: &&: &&
function tokenise(text) {

    if (!text) {
        return [];
    }

    var expression = text.toString();

    var prefix = '<>+-&';
    var suffix = '=>&:';
    var c;                      // The current character.
    var from;                   // The index of the start of the token.
    var i = 0;                  // The index of the current character.
    var length = expression.length;
    var n;                      // The number value.
    var q;                      // The quote character.
    var str;                    // The string value.

    var result = [];            // An array to hold the results.

    var make = function (type, value) {

// Make a token object.

        return {
            type: type,
            value: value,
            from: from,
            to: i
        };
    };

// Begin tokenization. If the source string is empty, return nothing.

    if (expression == '') {
        return [];
    }

// If prefix and suffix strings are not provided, supply defaults.

    if (typeof prefix !== 'string') {
        prefix = '<>+-&';
    }
    if (typeof suffix !== 'string') {
        suffix = '=>&:';
    }


// Loop through this text, one character at a time.

    c = expression.charAt(i);
    while (c) {
        from = i;

// Ignore whitespace.

        if (c <= ' ') {
            i += 1;
            c = expression.charAt(i);

// name.

        } else if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z')) {
            str = c;
            i += 1;
            for (;;) {
                c = expression.charAt(i);
                if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z') ||
                        (c >= '0' && c <= '9') || c === '_') {
                    str += c;
                    i += 1;
                } else {
                    break;
                }
            }
            result.push(make('name', str));

// number.

// A number cannot start with a decimal point. It must start with a digit,
// possibly '0'.

        } else if (c >= '0' && c <= '9') {
            str = c;
            i += 1;

// Look for more digits.

            for (;;) {
                c = expression.charAt(i);
                if (c < '0' || c > '9') {
                    break;
                }
                i += 1;
                str += c;
            }

// Look for a decimal fraction part.

            if (c === '.') {
                i += 1;
                str += c;
                for (;;) {
                    c = expression.charAt(i);
                    if (c < '0' || c > '9') {
                        break;
                    }
                    i += 1;
                    str += c;
                }
            }

// Look for an exponent part.

            if (c === 'e' || c === 'E') {
                i += 1;
                str += c;
                c = expression.charAt(i);
                if (c === '-' || c === '+') {
                    i += 1;
                    str += c;
                    c = expression.charAt(i);
                }
                if (c < '0' || c > '9') {
                    make('number', str).error("Bad exponent");
                }
                do {
                    i += 1;
                    str += c;
                    c = expression.charAt(i);
                } while (c >= '0' && c <= '9');
            }

// Make sure the next character is not a letter.

            if (c >= 'a' && c <= 'z') {
                str += c;
                i += 1;
                console.debug('ERROR:    '+str);
                make('number', str).error("Bad number");
            }

// Convert the string value to a number. If it is finite, then it is a good
// token.

            n = +str;
            if (isFinite(n)) {
                result.push(make('number', n));
            } else {
                make('number', str).error("Bad number");
            }

// string

        } else if (c === '\'' || c === '"') {
            str = '';
            q = c;
            i += 1;
            for (;;) {
                c = expression.charAt(i);
                if (c < ' ') {
                    make('string', str).error(c === '\n' || c === '\r' || c === '' ?
                        "Unterminated string." :
                        "Control character in string.", make('', str));
                }

// Look for the closing quote.

                if (c === q) {
                    break;
                }

// Look for escapement.

                if (c === '\\') {
                    i += 1;
                    if (i >= length) {
                        make('string', str).error("Unterminated string");
                    }
                    c = expression.charAt(i);
                    switch (c) {
                    case 'b':
                        c = '\b';
                        break;
                    case 'f':
                        c = '\f';
                        break;
                    case 'n':
                        c = '\n';
                        break;
                    case 'r':
                        c = '\r';
                        break;
                    case 't':
                        c = '\t';
                        break;
                    case 'u':
                        if (i >= length) {
                            make('string', str).error("Unterminated string");
                        }
                        c = parseInt(expression.substr(i + 1, 4), 16);
                        if (!isFinite(c) || c < 0) {
                            make('string', str).error("Unterminated string");
                        }
                        c = String.fromCharCode(c);
                        i += 4;
                        break;
                    }
                }
                str += c;
                i += 1;
            }
            i += 1;
            result.push(make('string', str));
            c = expression.charAt(i);

// comment.

        } else if (c === '/' && expression.charAt(i + 1) === '/') {
            i += 1;
            for (;;) {
                c = expression.charAt(i);
                if (c === '\n' || c === '\r' || c === '') {
                    break;
                }
                i += 1;
            }

// combining

        } else if (prefix.indexOf(c) >= 0) {
            str = c;
            i += 1;
            while (true) {
                c = expression.charAt(i);
                if (i >= length || suffix.indexOf(c) < 0) {
                    break;
                }
                str += c;
                i += 1;
            }
            result.push(make('operator', str));

// single-character operator

        } else {
            i += 1;
            result.push(make('operator', c));
            c = expression.charAt(i);
        }
    }
    tokenArray = result;

    return tokenArray;
};




// Currently (Aug 2012) the only job of this method is to substitute
// the Javascript ternary operators (? and :) in place of the Simile/
// Similette ones (if, then, else, elseif).    The substitution is:
// 'if' --> '' (i.e. it's dropped altogether)
// 'then' --> '?'
// 'else' --> ':'
// 'elseif' --> ':'
// Amazingly, that's all you need to do in order to get a proper Javascript expression.

// OK, I've now added and, or etc.

function turnIntoPureJavascript(tokenArray) {

    var nToken = tokenArray.length;
    for (var iToken = 0; iToken < nToken; iToken ++) {
        var token = tokenArray[iToken];
        var term = token.value;
        if (SYSTO.functions[term]) {
            token.jsvalue = SYSTO.functions[term].javascript;
        } else if (term === 'if') {
            token.jsvalue = '';
        } else if (term === 'then') {
            token.jsvalue = '?';
        } else if (term === 'elseif') {
            token.jsvalue = ':';
        } else if (term === 'else') {
            token.jsvalue = ':';
        } else if (term === 'and') {
            token.jsvalue = '&&';
        } else if (term === 'or') {
            token.jsvalue = '||';
        } else {
            token.jsvalue = token.value;
        }
    }
    //console.debug(tokenArray);
    return tokenArray;
}





function makeJavascriptEquation(tokenArray) {

    var text = '';
    for (var i=0; i<tokenArray.length; i++) {
        var token = tokenArray[i];
        //tokenString = token.jsvalue.toString();
        tokenString = ''+token.jsvalue;
        if (tokenString.search(/[a-zA-Z][a-zA-Z0-9_]*/) >= 0) {
            //tokenString = 'm.'+token.value;
            tokenString = token.jsvalue;
        }
        text += tokenString;
/*
        // Add in space after token, where necessary (principally, keywords).
        if (tokenString==='and' || tokenString==='or' || tokenString==='then' || tokenString=='else' || tokenString==='elseif' || tokenString==='if' || tokenString==='not') {
            text += ' ';
        }
*/
    }
    return text;
};


/*
for (var t=startTime+1; t<=endTime; t++) {

        if (integrationMethod === 'euler') {
            for (istep=0; istep<nstep; istep++) {
                GLOBAL_simTime = t + tstep*istep;
                stateVarValues = this.stateVarUpdate(stateVarValues, rateVarValues, 1, tstep);
                rateVarValues = evaluateDynamicBlock(parameterValues,stateVarValues);
            }

        } else if (integrationMethod === 'rungekutta4') {
            // Based on http://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods
            for (istep=1; istep<=nstep; istep++) {
                GLOBAL_simTime = t + tstep*(istep-1);
                var stateVarValues1 = this.stateVarUpdate(stateVarValues, rateVarValues, 0.5, tstep);
                var rateVarValues2 = evaluateDynamicBlock(parameterValues,stateVarValues1);
                var stateVarValues2 = this.stateVarUpdate(stateVarValues, rateVarValues2, 0.5, tstep);
                var rateVarValues3 = evaluateDynamicBlock(parameterValues,stateVarValues2);
                var stateVarValues3 = this.stateVarUpdate(stateVarValues, rateVarValues3, 1, tstep);
                var rateVarValues4 = evaluateDynamicBlock(parameterValues,stateVarValues3);
                for (stateVar in stateVarValues) {               
                if (stateVarValues.hasOwnProperty(stateVar)) {
                    rateVar = 'd_'+stateVar;          // TODO - change to use of ID rather than label for rateVar! [Later: why?]
                    stateVarValues[stateVar] += tstep*(rateVarValues[rateVar] + 
                                       2*rateVarValues2[rateVar] + 
                                       2*rateVarValues3[rateVar] + 
                                       rateVarValues4[rateVar])/6;
                }}
                rateVarValues = evaluateDynamicBlock(parameterValues,stateVarValues);
            }

        } else if (integrationMethod === 'dopri') {
           // Dormand-Prince-Runge-Kutta integrator with adaptive time-stepping
           // See http://www.numericjs.com/documentation.html: "Solving ODEs", and dump at botoom of this page.
        }
*/



// Checking model for errors, runnability etc.

SYSTO.checkModel = function (model) {
    var resultObject1 = SYSTO.checkAllVariables(model);

    if (resultObject1.status === 'OK') {
        return {status:'OK'};
    } else {
        return {status:'error', message:resultObject1.message};
    }
};




SYSTO.checkAllVariables = function (model) {

    var status = 'OK';
    var message = '';
    
    var nodeList = model.nodes;
    for (var nodeId in nodeList) {
        var node = nodeList[nodeId];
        if (node.type === 'cloud') continue;
        node.set_state = 'set';
        var object = SYSTO.checkEquation(model, node);
        if (object.status === 'error') {
            status = 'error';
            node.set_state = 'unset';
            message += 'nodeId:'+nodeId+'; node label:'+node.label+'; checks:\n'+JSON.stringify(object.checkObject,null,4) + '\n\n';
        }
    }
    return {status:status, message:message};
};




/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/action.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */



// Constructor function for the Action object.

Action = function (model, type, argList) {

    // This is a tricky way of getting the action infrastructure created.  The sensible
    // place would be in Systo core code.   Any thoughts on just how bad it is to do it here?
    if (!model.actionArray) {
        model.actionArray = [];
        model.actionArray[0] = 'start';
        model.currentAction = null;     // Should only need one of these (i.e. the action object
        model.currentActionIndex = 0;   // itself, or its array index).
        model.previousAction = 'none';
        model.selectedNodes = [];
        model.deletedNodeList = {};
        model.deletedArcList = {};
    }


    if (model.previousAction !== 'undo') {
        model.currentActionIndex += 1;
    }
    this.index = model.currentActionIndex;   // Note: the action array index starts at 1, not 0!
                                             // Note also that we do *not* use the actionArray.length
                                             // property, since we might have done some undos.

    this.type = type;
    this.model = model;
    this.argList = argList;
    this.dateTime = new Date();

    // array.splice(index1, index2, item) is an array method which removes the elements
    // from 'index1' to 'index2' inclusive, and adds in the element 'item'.  So this 
    // clears out all the unwanted actions from the current position to the end of the
    // action array, and adds in the current action.   Note that the only time that 
    // actions can be removed is when the user has done 'undo' one or more times.
    model.actionArray.splice(this.index, model.actionArray.length, this);

    model.previousAction = 'none';
    model.currentAction = this;
};

// Remaining actions to handle:
//   change_label
//   change_equation



Action.prototype.doAction = function (requiredAction) {

    console.debug('\n+++++++++ doAction currentActionIndex = '+this.model.currentActionIndex+': '+this.type);
    console.debug(this.model.actionArray);
    //var message = this.model.currentActionIndex+'. Do '+this.type;
    //$('.message_listener').trigger('click',[message]);
    var arc;
    var model = this.model;
    var args = this.argList;
    var endNode;
    var interNode;
    var json;
    var midx, midy;
    var node;
    var startNode;
    var thisFun;
    var modelChangedActions = {
        create_node:true, 
        create_arc:true,
        delete_selected:true,
        set_equation:true,
        set_node_label:true,
        load_model:true};

    // Tidy up
    //model.currentDiagram.assignLabel();
    //$('.label_input').remove();

    var that = this;
    var languageId = model.meta.language;
    var language = SYSTO.languages[languageId];

    if (modelChangedActions[this.type]) {
        model.workspace.modelChanged = true;
        model.workspace.modelRunnable = false;
    }

    var map = {
        'create_node': function () {
            // First, check that the node has not been placed on or "near to" an existing one.
            var hitResult = hitNode(model, args.diagramx, args.diagramy, 40,30);
            if (hitResult.you_are_on_a_node) {
                alert('ERROR - NODE OVERLAP\nYou cannot place one node on top of another');
                return;
            }

            // Now we can create the node...
            var newNode = createNode(args.mode, args.nodeId, {x:args.diagramx, y:args.diagramy});
            model.nodes[args.nodeId] = newNode;
            SYSTO.trigger({
                file: 'action.js', 
                action: 'doAction: create_node', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
            SYSTO.revertToPointer();
        },

        'create_arc': function () {
            console.debug('create_arc start');
            // First, check that this arc is not a duplicate (same start and end nodes)
            // Jan 2015 Removed this constraint, now that 2+ arrows between the sane 2 nodes can be 
            // distinguished.
/*
            console.debug('creating arc...'+args.type+','+args.start_node_id+','+args.end_node_id);
            if (arcExists(model, args.type, args.start_node_id, args.end_node_id)) {
                alert('ERROR: ILLEGAL ARROW\nIn the language '+languageId+', you are not allowed to draw a second '+args.type+' arrow between the same two nodes in the same direction');
                delete model.nodes.dot1;
                delete model.nodes.drawing_arc_start_node;
                delete model.arcs.drawing_arc;
                SYSTO.trigger({
                    file: 'action.js', 
                    action: 'doAction: create_arc - abort1', 
                    event_type: 'modified_model_event', 
                    parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
                });
                return;
            }
*/

            // Second, check that this action is valid, according to the language rules.
            if (args.start_node_exists) {
                var startNode = model.nodes[args.start_node_id];
                var startNodeTypeId = startNode.type;
            } else {
                var startNodeTypeId = 'canvas';
            }
            if (args.end_node_exists) {
                var endNode = model.nodes[args.end_node_id];
                var endNodeTypeId = endNode.type;
            } else {
                var endNodeTypeId = 'canvas';
            }
            var arcType = language.ArcType[args.type];
            var rules = arcType.rules;
            if (rules[startNodeTypeId][endNodeTypeId]) {
                //alert('OK');
            } else {
                alert('ERROR: ILLEGAL ARROW\nIn the language '+languageId+', you are not allowed to draw a '+args.type+' arrow between '+startNodeTypeId+' and '+endNodeTypeId+'.');
                delete model.nodes.dot1;
                delete model.nodes.drawing_arc_start_node;
                delete model.arcs.drawing_arc;
                SYSTO.trigger({
                    file: 'action.js', 
                    action: 'doAction: create_arc - abort2', 
                    event_type: 'modified_model_event', 
                    parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
                return;
            }

            // Third, check that the arc does not go from and to the same node
            // (This may in future be allowed, with a property set in the language, but not currently)
            if (args.start_node_id === args.end_node_id) {
                 alert('ILLEGAL ARROW\nYou are not allowed to draw an arrow to the same node it started on');
                delete model.nodes.dot1;
                delete model.nodes.drawing_arc_start_node;
                delete model.arcs.drawing_arc;
                SYSTO.trigger({
                    file: 'action.js', 
                    action: 'doAction: create_arc abort3', 
                    event_type: 'modified_model_event', 
                    parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
                return;
            }

            // Now we can create the arc...

            // Create the start node if this arc type requires one and it does not already exist.
            if (args.start_node_exists) {
                var startNode = model.nodes[args.start_node_id];
            } else {
                var startNodeId = getNewNodeId(model, 'cloud');
                startNode = createNode('cloud', startNodeId, args.startPoint);
                model.nodes[startNodeId] = startNode;
            }

            // Create the end node if this arc type requires one and it does not already exist.
            if (args.end_node_exists) {
                var endNode = model.nodes[args.end_node_id];
            } else {
                var endNodeId = getNewNodeId(model, 'cloud');
                endNode = createNode('cloud', endNodeId, args.endPoint);
                model.nodes[endNodeId] = endNode;
            }

            // Create the arc itself.
            arc = createArc(languageId, args.type, args.arc_id, startNode.id, endNode.id);
            model.arcs[arc.id] = arc;

            // 'unset' the end node if the arc is an influence...
            // !! This is a temporrary hack.  Clearly, this should be handled as a property
            // of the arc type in the language definition.
            if (args.type === 'influence') {
                endNode.set_state = 'unset';
            }

            // Create the intermediate node if this arc type has one.
            var arcType = language.ArcType[arc.type];
            if (arcType.internode_type) {
                midx = (startNode.centrex + endNode.centrex) / 2;    // This only works for straight arcs!
                midy = (startNode.centrey + endNode.centrey) / 2;
                var internodeId = getNewNodeId(model, arcType.internode_type);
                interNode = createNode(arcType.internode_type, internodeId, {x:midx, y:midy});
                arc.node_id = interNode.id;
                interNode.arc_id = arc.id;
                model.nodes[interNode.id] = interNode;
            }
            SYSTO.trigger({
                file: 'action.js', 
                action: 'doAction: create_arc', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
            SYSTO.revertToPointer();
            assignInarcsAndOutarcsForEachNode(model);
        },

        // Note: we need to handle node and arc *objects*, not IDs, to allow
        // for a possible re-do.
        'delete_selected': function () {
            for (nodeId in args.deleteNodeList) {
                delete model.nodes[nodeId];
            }

            for (arcId in args.deleteArcList) {
                var arc = model.arcs[arcId];
                if (arc.type === 'influence') {   // TODO: put property for this in language definition!!
                    var endNode = model.nodes[arc.end_node_id];
                    if (endNode) endNode.set_state = 'unset';   // Check for existence, since might no longer exist.
                }
                delete model.arcs[arcId];
            }
            SYSTO.trigger({
                file: 'action.js', 
                action: 'doAction: delete_selected', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
        },

        'move_selected_nodes': function () {

            // Check for overlap.    However, this should not be encountered, since this should be 
            // be being continuously checked during a drag. TODO: put continuous collision detection into diagram.
            // Also, if you are dragging one or more nodes, you don't want them to jump back to their
            // starting position if an overlap occurs (which is why we should do the continuous checking...)
            var moveTest = nodeOnNode(model, args.moveNodeIdArray, args.dragMovex, args.dragMovey, 40, 30);
            if (moveTest.result) {
                alert('ERROR - NODE ON NODE\nSorry: you cannot move one node on top of another one.');
                return;
            }

            for (var i=0; i<args.moveNodeIdArray.length; i++) {
                var nodeId = args.moveNodeIdArray[i];
                node = model.nodes[nodeId];
                node.centrex += args.dragMovex;
                node.centrey += args.dragMovey;
            }
            console.debug('**************  '+SYSTO.state.packageId+'; '+model.meta.id);
            
            SYSTO.trigger({
                file: 'action.js', 
                action: 'doAction: move_selected_nodes', 
                event_type: 'modified_model_event', 
                //parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
                parameters: {packageId:'package1', modelId:model.meta.id}
            });
        },

        'set_label_shift': function () {
            node = model.nodes[args.nodeId];
            node.text_shiftx = args.shiftx;
            node.text_shifty = args.shifty;
            SYSTO.trigger({
                file: 'action.js', 
                action: 'doAction: set_label_shift', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
        },

        'set_node_label': function () {
            node = model.nodes[args.nodeId];
            if (SYSTO.reservedWords[args.newLabel]) {
                alert('ERROR - '+args.newLabel+' is a reserved word.');
                return;
            }
            node.label = args.newLabel;
            SYSTO.trigger({
                file: 'action.js', 
                action: 'doAction: set_node_label', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
        },

        'set_arc_curvature': function () {
            arc = model.arcs[args.arcId];
            arc.curvature = args.curvature;
            arc.along = args.along;
            SYSTO.trigger({
                file: 'action.js', 
                action: 'doAction: set_arc_curvature', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
        },

        'set_equation': function () {
            node = model.nodes[args.nodeId];
            node.extras.equation.value = args.equation;
            node.set_state = 'set';
            SYSTO.trigger({
                file: 'action.js', 
                action: 'doAction: set_equation', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
                // Not normally needed, but left
                // in for if/when I include a display of the node equation on the diagram.
                // Actually, *is* needed to show chang in colour of a set node.
        },

        'load_model': function () {
            json = args.json;
            model = JSON.parse(json);
            model.loadModel(model);
            SYSTO.trigger({
                file: 'action.js', 
                action: 'doAction: load_mode', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
        }
    };

    thisFun = map[this.type];

    //SYSTO.state.tutorial.showInstruction = true;

    if (thisFun) {
        if (SYSTO.tutorials && SYSTO.state.tutorial && SYSTO.tutorials[SYSTO.state.tutorial.currentId] && SYSTO.state.tutorial.status === 'running') {
            var tutorialId = SYSTO.state.tutorial.currentId;
            var tutorialActionArray = SYSTO.tutorials[tutorialId].actionArray;
            var requiredAction = tutorialActionArray[this.index-1];
            var errorArray = validateAction(requiredAction, this);
            if (errorArray.length === 0) {
                thisFun();
                SYSTO.trigger({
                    file: 'action.js', 
                    action: 'doAction: tutorial', 
                    event_type: 'next_action_listener', 
                    parameters: {
                        packageId: SYSTO.state.packageId, 
                        modelId: model.meta.id,
                        nextActionString: nextActionString,
                        tutorialId: tutorialId,
                        index: this.index,
                        istep: this.index+1 // This is wrong, since tutorial step number does not
                                // necessarily start at action index 1.   //TODO :fix.
                                // The step incremeneting should be handled here, rather than in
                                // the individual widget(s) not least because there might be more than
                                // one of them), but does need to allow for the above.
                    }
                });

                SYSTO.trigger({
                    file: 'action.js', 
                    action: 'doAction: tutorial', 
                    event_type: 'modified_model_event', 
                    parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
                });
                return true;
            } else {   // ERROR
                SYSTO.trigger({
                    file: 'action.js', 
                    action: 'doAction: tutorial', 
                    event_type: 'incorrect_action_listener', 
                    parameters: {
                        packageId: SYSTO.state.packageId, 
                        modelId: model.meta.id,
                        errorArray: errorArray,
                        nextActionString: nextActionString,
                        tutorialId: tutorialId,
                        index: this.index,
                        istep: this.index+1 // This is wrong, since tutorial step number does not
                                // necessarily start at action index 1.   //TODO :fix.
                                // The step incremeneting should be handled here, rather than in
                                // the individual widget(s) not least because there might be more than
                                // one of them), but does need to allow for the above.
                    }
                });
                model.currentActionIndex -= 1;
                SYSTO.revertToPointer();
                return false;
            }
        } else {
            thisFun();
            SYSTO.saveModelToLocalStorage('current');
            return true;
        }
    }
        //SYSTO.trigger('action.js',this.type, 'action_listener', 'click', [this.index]);
    //}
    //model.render();
};


Action.prototype.undoAction = function () {
    console.debug('\n---------- undoAction currentActionIndex = '+this.model.currentActionIndex+': '+this.type);
    console.debug(this.model.actionArray);
    //var message = this.model.currentActionIndex+'. Undo '+this.type;
    //$('.message_listener').trigger('click',[message]);
    var arc;
    var arcId;
    var model = this.model;
    var args = this.argList;
    var matches;
    var node;
    var thisFun;
    var type;
    var modelChangedActions = {
        create_node:true, 
        create_arc:true,
        delete_selected:true,
        set_equation:true,
        set_node_label:true,
        load_model:true};

    // Tidy up
    //model.currentDiagram.assignLabel();
    //$('.label_input').remove();

    var that = this;

    if (modelChangedActions[this.type]) {
        model.workspace.modelChanged = true;
    }

    var map = {
        'create_node': function () {
            delete model.nodes[args.nodeId];
            SYSTO.trigger({
                file: 'action.js', 
                action: 'undoAction: create_node', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
            $('.labelEdit').css('display','none');
        },

        'create_arc': function () {
            var arc = model.arcs[args.arc_id];

            // Delete the start node, but ***only if it did not already exist when this arc was created***.
            if (!args.start_node_exists) {
                delete model.nodes[arc.start_node_id];
            }

            // Delete the end node, but ***only if it did not already exist when this arc was created***.
            if (!args.end_node_exists) {
                delete model.nodes[arc.end_node_id];
            }

            // Delete the arc itself.
            delete model.arcs[args.arc_id];

            // Delete the internode, if this arc has one.
            if (arc.node_id) {
                delete model.nodes[arc.node_id];
            }
            SYSTO.trigger({
                file: 'action.js', 
                action: 'undoAction: create_arc', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
            assignInarcsAndOutarcsForEachNode(model);
        },

        'delete_selected': function () {
            for (nodeId in args.deleteNodeList) {
                model.nodes[nodeId] = args.deleteNodeList[nodeId];
            }

            for (arcId in args.deleteArcList) {
                model.arcs[arcId] = args.deleteArcList[arcId];
            }
            SYSTO.trigger({
                file: 'action.js', 
                action: 'undoAction: delete_selected', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
        },

        'move_selected_nodes': function () {
            for (var i=0; i<args.moveNodeIdArray.length; i++) {
                var nodeId = args.moveNodeIdArray[i];
                node = model.nodes[nodeId];
                node.centrex -= args.dragMovex;
                node.centrey -= args.dragMovey;
            }
            SYSTO.trigger({
                file: 'action.js', 
                action: 'undoAction: move_selected_nodes', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
        },

        'set_label_shift': function () {
            node = model.nodes[args.nodeId];
            node.text_shiftx = args.oldShiftx;
            node.text_shifty = args.oldShifty;
            SYSTO.trigger({
                file: 'action.js', 
                action: 'undoAction: set_label_shift', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
        },

        'set_node_label': function () {
            node = model.nodes[args.nodeId];
            node.label = args.oldLabel;
            SYSTO.trigger({
                file: 'action.js', 
                action: 'undoAction: set_node_label', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
        },

        'set_arc_curvature': function () {
            arc = model.arcs[args.arcId];
            arc.curvature = args.oldCurvature;
            arc.along = args.oldAlong;
            SYSTO.trigger({
                file: 'action.js', 
                action: 'undoAction: set_arc_curvature', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
        },

        'set_equation': function () {
            node = model.nodes[args.nodeId];
            node.extras.equation.value = args.oldEquation;
            SYSTO.trigger({
                file: 'action.js', 
                action: 'doAction: set_equation', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
                // Not normally needed, but left
                // in for if/when I include a display of the node equation on the diagram.
        },

        'load_model': function () {
            var arcId;
            var nodeId;

            for (nodeId in this.nodeList) {
            if (this.nodeList.hasOwnProperty(nodeId)) {
                matches = nodeId.match(/([a-z]+|[0-9]+)/gi);
                type = matches[0];
                NodeType[type].counter = 0;
            }}

            for (arcId in this.arcList) {
            if (this.arcList.hasOwnProperty(arcId)) {
                matches = arcId.match(/([a-z]+|[0-9]+)/gi);
                type = matches[0];
                ArcType[type].counter = 0;
            }}
            model.nodes = {};
            model.arcs = {};
            SYSTO.trigger({
                file: 'action.js', 
                action: 'undoAction: load_model', 
                event_type: 'modified_model_event', 
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
            });
        }
    };

    thisFun = map[this.type];

    //if (thisFun) {
    //    thisFun();
    //}



    if (thisFun) {
        if (SYSTO.tutorials && SYSTO.state.tutorial && SYSTO.tutorials[SYSTO.state.tutorial.currentId] && SYSTO.state.tutorial.status === 'running') {
            var tutorialActionArray = SYSTO.tutorials[SYSTO.state.tutorial.currentId].actionArray;
            //var requiredAction = tutorialActionArray[this.index-1];
            //var errorArray = validateAction(requiredAction, this);
            this.index -= 1;
            //model.currentActionIndex -= 1;
            //if (errorArray.length === 0) {
            if (true) {
                thisFun();
                if (this.index < tutorialActionArray.length) {
                    var nextRequiredAction = tutorialActionArray[this.index];
                    var nextActionString = getNextActionString_1(model, nextRequiredAction);
                    var istep = this.index+1;
                    var colour = 'yellow';
                    $('.tutorial_action_number').html('<b>Tutorial step '+istep+'</b>');
                    $('.tutorial_instruction').css('background',colour).html(nextActionString)
                          .animate( { height: "hide" }, 1, name )
                          .animate( { height: "show" }, 1000, name );
                    $('#step'+this.index+' div').css('background','#d0ffd0');
                    $('#step'+this.index+' button').css('display','none');
                    $('#step'+istep+' div').css('background','yellow');
                    $('#step'+istep+' button').css('display', 'inline-block');
                } else {
                    alert('Congratulations!\nYou have successfully completed the tutorial.\nNow click the "Run" button in the Run Control panel to run the model.\nThen, move the sliders to change the initial and input values.');
                    delete SYSTO.state.tutorial;
                }
                SYSTO.trigger({
                    file: 'action.js', 
                    action: 'doAction: tutorial', 
                    event_type: 'modified_model_event', 
                    parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id}
                });
                return true;
            } else {
                console.debug('\n**** ERROR ****');
                console.debug(errorArray);
                console.debug('**** ERROR ****\n');
                alert('Sorry, incorrect action - please try again.\n'+JSON.stringify(errorArray));
                model.currentActionIndex -= 1;
                SYSTO.revertToPointer();
                return false;
            }
        } else {
            thisFun();
            SYSTO.saveModelToLocalStorage('current');
            return true;
        }
    }
};





function createNode(nodeTypeId, newNodeId, modelCoords) {
    var languageId = SYSTO.state.languageId;
    var nodeType = SYSTO.languages[languageId].NodeType[nodeTypeId];  // TODO: fix this!
    var defaultMinMax = {
        stock:{min:0,max:100},
        variable:{min:0,max:1},
        valve:{min:0,max:10}};
    if (defaultMinMax[nodeTypeId]) {
        var defaultMin = defaultMinMax[nodeTypeId].min;
        var defaultMax = defaultMinMax[nodeTypeId].max;
    } else {
        defaultMin = 0;
        defaultMax = 100;
    }

    //This is a lazy way of doing what should be done by using the 'default_label_root' property of
    // the system_dynamics langiage for the 'valve' nodeType.' 
    var label = newNodeId.replace('valve','flow');

    return {
        id:newNodeId, 
        type:nodeTypeId, 
        label:label, 
        centrex:modelCoords.x, 
        centrey:modelCoords.y, 
        text_shiftx:nodeType.text_shiftx, 
        text_shifty:nodeType.text_shifty, 
        select_state:'normal',
        set_state:'unset',
        extras:{
            equation:{type:'long_text', default_value:'', value:''}, 
            min_value:{type:'short_text', default_value:defaultMin, value:defaultMin}, 
            max_value:{type:'short_text', default_value:defaultMax, value:defaultMax}, 
            documentation:{type:'long_text', default_value:'', value:''}, 
            comments:{type:'long_text', default_value:'', value:''}}};
}



function createArc(languageId, typeId, newArcId, startNodeId, endNodeId) {
    var language = SYSTO.languages[languageId];
    var type = language.ArcType[typeId];
    return {
        id: newArcId,
        type: typeId,
        label: newArcId,
        start_node_id: startNodeId,
        end_node_id: endNodeId,
        curvature: type.curvature,
        along: type.along,
        select_state: 'normal',
        set_state: 'unset'};
}





function getNewNodeId(model, requiredNodeType) {
    var nodeList = model.nodes;

    var imax = 0;
    for (var nodeId in nodeList) {
        var matches = nodeId.match(/([a-z]+|[0-9]+)/gi);
        var thisNodeType = matches[0];
        if (thisNodeType === requiredNodeType) {
            var i = parseInt(matches[1]);
            if (i > imax) {
                imax = i;
            }
        }
    }
    inew = imax+1;
    return requiredNodeType+inew;
}



function getNewArcId(model, requiredArcType) {
    var arcList = model.arcs;

    var imax = 0;
    for (var arcId in arcList) {
        var matches = arcId.match(/([a-z]+|[0-9]+)/gi);
        var thisArcType = matches[0];
        if (thisArcType === requiredArcType) {
            var i = parseInt(matches[1]);
            if (i > imax) {
                imax = i;
            }
        }
    }
    inew = imax+1;
    return requiredArcType+inew;
}



function hitNode(model, diagramx, diagramy, tolerancex, tolerancey) {

    var nodeList = model.nodes;
    for (var nodeId in nodeList) {
        var node = nodeList[nodeId];
        if (Math.abs(node.centrex-diagramx)<tolerancex && Math.abs(node.centrey-diagramy)<tolerancey) {
            return {you_are_on_a_node:true, hitNodeId:nodeId};
        }
    }
    return {you_are_on_a_node:false};
}


function nodeOnNode(model, moveNodeIdArray, dragMovex, dragMovey, tolerancex, tolerancey) {

    var nodeList = model.nodes;
    for (var nodeId in nodeList) {
        var node = nodeList[nodeId];
        var len = moveNodeIdArray.length;
        for (var i=0; i<len; i++) {
            moveNode = nodeList[moveNodeIdArray[i]];
            if (nodeId === moveNode.id) continue;
            if (Math.abs(node.centrex-(moveNode.centrex+dragMovex))<tolerancex && 
                    Math.abs(node.centrey-(moveNode.centrey+dragMovey))<tolerancey) {
                return {result:true, moveNodeId:moveNode.id, staticNodeId:nodeId};
            }
        }
    }
    return {result:false};
}
            


// We pass in arcType for the time when the modelling language allows us to
// specify whether 2 or more arcs can exist between the same two nodes.
function arcExists(model, arcType, startNodeId, endNodeId) {
    for (var arcId in model.arcs) {
        var arc = model.arcs[arcId];
        var startNodeId1 = arc.start_node_id;
        var endNodeId1 = arc.end_node_id;
        if (startNodeId === startNodeId1 && endNodeId === endNodeId1) {
            return true;
        }
    }
    return false;
}


// ==================================================================================
// START OF TUTORIAL FUNCTIONS


// 18 March 2014
// Put the following tutorial-related fnctions here.
// They had previously been in tutorial.js and tutorial_step.js, but are common to both.
// This creates a problem for doAction etc, which refers to them.
// Also, having them in tutorial_step.js means that there is a separate instance for
// each widget instance (I think), which is unnecessarily wasteful.

// Basically, the way that tutorials are handled, and their integration with 'action', 
// needs to be refactored.

function tutorialStep(widget) {
    var model = SYSTO.models[SYSTO.state.currentModelId];
    var tutorialId = SYSTO.state.tutorial.currentId;
    var tutorialActionArray = SYSTO.tutorials[tutorialId].actionArray;
    var requiredAction = tutorialActionArray[model.currentActionIndex];
    var action = new Action(model, requiredAction.type, requiredAction.argList);
    action.doAction();
}



// This function advances the tutorial through a number of steps.
// This means that, as far as the user is concerned, the tutorial can start on a partially-
// completed model.  For example, building a biggish model could be be split into several
// consecutive tutorials, with teh second one starting where the first ended.

// Arguably, this should not be seen as a tutorial function at all, but a generic Systo 
// method for running through the logged steps for building a model - i.e. the redo/undo
// stack.   
// TODO: Think this through.

function tutorialAdvance(startStep, endStep) {
    //var model = SYSTO.models[SYSTO.state.currentModelId];
    //var tutorialId = SYSTO.state.tutorial.currentId;

    if (startStep === 0) return;
    var result = SYSTO.createNewModel_1({languageId:'system_dynamics'});
    var modelId = result.modelId;
    var model = SYSTO.models[modelId];
    var tutorialId = 'tank';
    var tutorialActionArray = SYSTO.tutorials[tutorialId].actionArray;

    model.currentActionIndex = startStep;
    if (tutorialActionArray.length < endStep) {
        endStep = tutorialActionArray.length;
    }

/*
    for (var index=startStep-1; index<=endStep; index+=1) {
        var requiredAction = tutorialActionArray[index];
        var action = new Action(model, requiredAction.type, requiredAction.argList);
        action.doAction();
    }
*/
/*
timer = setInterval(function() {
  elem.style.left = ( left += 2 ) + "px";
  // clear the timer at 400px to stop the animation
  if ( left == 400 ) {
    clearInterval( timer );
  }
}, 10);
*/
    //SYSTO.state.tutorial.showInstruction = false;

    var index = 0;
    var timer = setInterval(function() {
        var requiredAction = tutorialActionArray[index];
        var action = new Action(model, requiredAction.type, requiredAction.argList);
        action.doAction();
        index += 1;
        if (index>endStep) {
            SYSTO.state.tutorial.showInstruction = true;
            clearInterval(timer);
        }
    }, 500);
}


function tutorialPlay(widget) {
    var model = SYSTO.models[SYSTO.state.currentModelId];
    var tutorialId = SYSTO.state.tutorial.currentId;
    var tutorialActionArray = SYSTO.tutorials[tutorialId].actionArray;

    model.currentActionIndex = 1;

    setInterval(function(){
        var requiredAction = tutorialActionArray[model.currentActionIndex];
        var action = new Action(model, requiredAction.type, requiredAction.argList);
        action.doAction();
    },5000);
}




function tutorialBack(widget) {
    alert('Back');
}




function tutorialForward(widget) {
    alert('Forward');
}





function validateAction(requiredAction, actualAction) {

    if (requiredAction.type !== actualAction.type) {
        return 'Required action is '+requiredAction.type+'\nYour action was '+actualAction.type;
    } 

    var requiredArgList = requiredAction.argList;
    var actualArgList = actualAction.argList;
    var model = SYSTO.models[SYSTO.state.currentModelId];
    var errorArray = []; // Where possible, we can record more than one error.

    var map = {
        'create_node': function () {
            if (requiredArgList.mode !== actualArgList.mode) {
                errorArray.push('Required node type is '+requiredArgList.mode+'.   You tried to add a '+actualArgList.mode);
            }
            if (Math.abs(requiredArgList.diagramx-actualArgList.diagramx) >20 || 
                    Math.abs(requiredArgList.diagramy-actualArgList.diagramy) >20) {
                errorArray.push('You need to add the node near the shown position');
            }
        },

        'create_arc': function () { 
            if (requiredArgList.type !== actualArgList.type) {
                errorArray.push('Required arrow type is '+requiredArgList.type+
                    '.  You tried to add a '+actualArgList.type);
            }
            if (requiredArgList.start_node_id === null && actualArgList.start_node_id !== null) {
                errorArray.push('The arrow should start from a blank area of the screen.  '+
                    'You tried to start from '+model.nodes[actualArgList.start_node_id].label);
            } else if (requiredArgList.start_node_id !== actualArgList.start_node_id) {
                errorArray.push('The arrow should start at '+actualArgList.start_node_id+
                    '.  You tried to start it from '+model.nodes[actualArgList.start_node_id].label);
            }
            if (requiredArgList.end_node_id === null && actualArgList.end_node_id !== null) {
                errorArray.push('The arrow should end in a blank area of the screen.  '+
                    'You tried to end it on '+model.nodes[actualArgList.start_node_id].label);
            } else if (requiredArgList.end_node_id !== actualArgList.end_node_id) {
                errorArray.push('The arrow should end at '+actualArgList.end_node_id+
                    '.  You tried to end it at '+model.nodes[actualArgList.end_node_id].label);
            }
        },

        // deleteNodeList, deleteArcList
        'delete_selected': function () {
            nNodeReq = SYSTO.nProperties(requiredArgList.deleteNodeList);
            nNodeAct = SYSTO.nProperties(actualArgList.deleteNodeList);
            nArcReq = SYSTO.nProperties(requiredArgList.deleteArcList);
            nArcAct = SYSTO.nProperties(actualArgList.deleteArcList);

            if (nNodeReq !== nNodeAct) {
                errorArray.push('You are trying to delete the wrong number of nodes.');
            } else {
                var nodesOK = true;
                for (var nodeId in requiredArgList.deleteNodeList) {
                    if (actualArgList.deleteNodeList[nodeId]) continue
                    nodesOK = false;
                    errorArray.push('You are not deleting the right node(s).');
                    break;
                }
            }


            if (nArcReq !== nArcAct) {
                errorArray.push('You are trying to delete the wrong number of arrows.');
            } else {
                var arcsOK = true;
                for (var arcId in requiredArgList.deleteArcList) {
                    if (actualArgList.deleteArcList[arcId]) continue
                    narcsOK = false;
                    errorArray.push('You are not deleting the right arrow(s).');
                    break;
                }
            }

        },

        'move_selected_nodes': function () {
            nNodeReq = SYSTO.nProperties(requiredArgList.moveNodeIdArray);
            nNodeAct = SYSTO.nProperties(actualArgList.moveNodeIdArray);

            if (nNodeReq !== nNodeAct) {
                errorArray.push('You are trying to move the wrong number of nodes.');
/*     TODO: Needs work!!
            } else {
                var nodesOK = true;
                for (var nodeId in nNodeReq) {
                    if (nNodeAct[nodeId]) continue
                    nodesOK = false;
                    errorArray.push('You are not moving the right node(s).');
                    break;
                }
                if (nodesOK) {
                    for (var i=0; i<args.moveNodeIdArray.length; i++) {
                        var nodeId = args.moveNodeIdArray[i];
                        node = model.nodes[nodeId];
                        node.centrex += args.dragMovex;
                        node.centrey += args.dragMovey;
                    }
                }
*/
            }


        },

        'set_label_shift': function () {
            var dx = requiredArgList.shiftx - actualArgList.shiftx;
            var dy = requiredArgList.shifty - actualArgList.shifty;
            if (Math.abs(dx)>30 || Math.abs(dy)>30) {
                errorArray.push('You have not moved the label to the right position.');
            }
        },

        'set_node_label': function () {
            if (requiredArgList.newLabel !== actualArgList.newLabel) {
                errorArray.push('You were asked to change the label for '+actualArgList.oldLabel+
                    ' to '+requiredArgList.newLabel+' but you tried to change it to '+actualArgList.newLabel+'.');
            }
        },

        // TODO: This is ridiculous like this. Change it to a position on the screen.
        'set_arc_curvature': function () {
            var diff = requiredArgList.curvature !== actualArgList.curvature;
            if (Math.abs(diff) >0.1) {
                errorArray.push('You were asked to change the curvature '+
                    ' to '+requiredArgList.curvature+' but you tried to change it to '+actualArgList.curvature+'.');
            }
        },

        'set_equation': function () {
            if (requiredArgList.equation !== actualArgList.equation) {
                var label = model.nodes[actualArgList.nodeId].label;
                errorArray.push('You were asked to change the equation for '+label+
                    ' to '+requiredArgList.equation+' but you tried to change it to '+actualArgList.equation+'.');
            }
        },

        'load_model': function () {
            //Not (yet) implemented
        }
    };


    thisFun = map[requiredAction.type];
    if (thisFun) {
        thisFun();
    } else {
        alert('INTERNAL ERROR (not your fault): unrecognised requireAction.type in jquery.tutorial.js : validateAction()');
    }

    if (errorArray.length === 0) {
        //SYSTO.trigger('jquery.tutorial.js', 'create_arc', 'diagram_marker_listener',
        //      'click', [false, {x:0,y:0}]);
        SYSTO.trigger({
            file: 'jquery.action.js',
            action: 'validateAction()',
            event_type: 'diagram_marker_listener',
            parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id, show:false, coords:{x:0, y:0}}
        });
    }
    return errorArray;

}




function getNextActionString_1(model, requiredAction) {
    var nextActionString;
    var argList = requiredAction.argList;

    var map = {
        'create_node': function () {
            //SYSTO.trigger('jquery.tutorial_step.js', 'create_node', 'diagram_marker_listener', 
                //'click', [true,{x:argList.diagramx,y:argList.diagramy}]);
            SYSTO.trigger({
                file: 'jquery.action.js',
                action: 'getNextActionString_1(): create_node',
                event_type: 'diagram_marker_listener',
                parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id, show:true, coords:{x:argList.diagramx, y:argList.diagramy}}
            });
            nextActionString = 'Add '+SYSTO.a_or_an(argList.mode)+' <b>'+argList.mode+'</b> at the position shown.';
        },

        'create_arc': function () { // TODO: this needs work...
            if (argList.start_node_id === null) {
                //SYSTO.trigger('jquery.tutorial_step.js', 'create_arc', 'diagram_marker_listener',
                //    'click', [true, {x:argList.startPoint.x,y:argList.startPoint.y}]);
                SYSTO.trigger({
                    file: 'jquery.action.js',
                    action: 'getNextActionString_1(): create_arc/1',
                    event_type: 'diagram_marker_listener',
                    parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id, show:true, coords:{x:argList.startPoint.x, y:argList.startPoint.y}}
                });
                nextActionString = 'Add '+SYSTO.a_or_an(argList.type)+' <b>'+argList.type+
                    '</b> arrow from the position shown to <b>'+
                    argList.end_node_label+'</b>';
            } else if (argList.end_node_id === null) {
                //SYSTO.trigger('jquery.tutorial_step.js', 'create_arc', 'diagram_marker_listener',
                //   'click', [true, {x:argList.endPoint.x,y:argList.endPoint.y}]);
                SYSTO.trigger({
                    file: 'jquery.action.js',
                    action: 'getNextActionString_1(): create_arc/2',
                    event_type: 'diagram_marker_listener',
                    parameters: {packageId:SYSTO.state.packageId, modelId:model.meta.id, show:true, coords:{x:argList.endPoint.x, y:argList.endPoint.y}}
                });
                nextActionString = 'Add '+SYSTO.a_or_an(argList.type)+' <b>'+argList.type+'</b> arrow from <b>'+
                    argList.start_node_label+'</b> to the position shown';
            } else {
                nextActionString = 'Add '+SYSTO.a_or_an(argList.type)+' <b>'+argList.type+'</b> arrow from <b>'+
                    argList.start_node_label+'</b> to <b>'+
                    argList.end_node_label;
            }
        },

        'delete_selected': function () {
            nextActionString = 'delete_selected';
        },

        'move_selected_nodes': function () {
            nextActionString = 'move_selected_nodes';
        },

        'set_label_shift': function () {
            nextActionString = 'set_label_shift';
        },

        'set_node_label': function () {
            var label = argList.oldLabel.replace('valve','flow');
            nextActionString = 'Change label of <br/><b>'+label+'</b><br/> to <b><br/>'+argList.newLabel+'</b>';
        },

        'set_arc_curvature': function () {
            nextActionString = 'set_arc_curvature';
        },

        'set_equation': function () {
            console.debug(JSON.stringify(argList));
            if (argList.type === 'stock') {
                nextEquationString = 'Double-click on the <b>'+argList.nodeLabel+
                    '</b> symbol, and enter an initial value of <br/><b>'+argList.equation+'</b><br/> in the equation box.';
            } else {
                if (isNumericConstant(argList.equation)) {
                    nextActionString = 'Double-click on the '+argList.nodeLabel+
                        ' symbol, and enter the value<br/><b>'+argList.equation+'</b><br/> in the equation box.';
                } else {
                    nextActionString = 'Double-click on the '+argList.nodeLabel+
                        ' symbol, and enter the expression <br/><b>'+argList.equation+'</b><br/> in the equation box.';
                }
            }
        },

        'load_model': function () {
            nextActionString = 'load_model';
        }
    };

        //default:
        //    var getNextGuidanceString = 'Action not recognised: requiredAction.type: '+requiredAction.mode+': '+JSON.stringify(argList);
    //}


    thisFun = map[requiredAction.type];
    if (thisFun) {
        thisFun();
    } else {
        alert('INTERNAL ERROR (not your fault): unrecognised requireAction.type in jquery.tutorial_step.js : getgetNextGuidanceString()');
    }

    return nextActionString;
}


// Jan 2015 - only just started on this.
// TODO: complete (i.e. add a guidance note for each action type)

function getNextGuidanceString(model, requiredAction) {

    var getNextGuidanceString;
    var argList = requiredAction.argList;

    var map = {
        'create_node': function () {
            getNextGuidanceString = 'To add a '+argList.mode+' to the model:\n'+
            '- click on the '+argList.mode+' button in the toolbar; then\n'+
            '- click in the diagram window where you want the '+argList.mode+' to be placed.';
        },

        'create_arc': function () { 
            getNextGuidanceString = 'To add a '+argList.type+' to the model:\n'+
            '- click on the '+argList.type+' button in the toolbar;\n'+
            '- move the mouse to where you want the '+argList.type+' to start;\n'+
            '- press mouse button down, and drag to where you want the '+argList.type+' to end; then\n'+
            '- release the mouse button.'
        },

        'delete_selected': function () {
            getNextGuidanceString = 'To delete a symbol from the model:\n'+
            '- select the symbol by clicking on it; then\n'+
            '- press the delete key on youe keyboard.';
        },

        'move_selected_nodes': function () {
            getNextGuidanceString = 'To delete a symbol from the model:\n'+
            '- select the symbol by clicking on it; then\n'+
            '- press the delete key on youe keyboard.';
        },

        'set_label_shift': function () {
            getNextGuidanceString = 'set_label_shift';
        },

        'set_node_label': function () {
            getNextGuidanceString = 'Set label of '+argList.oldLabel+' to '+argList.newLabel;
        },

        'set_arc_curvature': function () {
            getNextGuidanceString = 'set_arc_curvature';
        },

        'set_equation': function () {
            getNextGuidanceString = 'Enter equation '+argList.equation+' for '+argList.nodeLabel;
        },

        'load_model': function () {
            getNextGuidanceString = 'load_model';
        }
    };


        //default:
        //    var getNextGuidanceString = 'Action not recognised: requiredAction.type: '+requiredAction.mode+': '+JSON.stringify(argList);
    //}


    thisFun = map[requiredAction.type];
    if (thisFun) {
        thisFun();
    } else {
        alert('INTERNAL ERROR (not your fault): unrecognised requireAction.type in jquery.tutorial_step.js : getgetNextGuidanceString()');
    }


    return getNextGuidanceString;
}

// END OF TUTORIAL FUNCTIONS
// ====================================================================================



/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/equation.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


// This first form is for checking equations where these have already been assigned,
// e.g. when loading a model.

SYSTO.checkEquation = function (model, node) {  
    equationString = node.extras.equation.value;
    if (typeof equationString === 'number') {
        var equationString = equationString.toString();
    }
    var result = SYSTO.checkEquationString (model, node, equationString);
    return result;
}


// This form is for checking an equation string which may not have already been given to
// the node (e.g. when entering it in an equation dialogue).

SYSTO.checkEquationString = function (model, node, equationString) {
    var checkObject = {};
    checkObject.checkEquationPropertyExists = SYSTO.checkEquationPropertyExists(node);
    if (checkObject.checkEquationPropertyExists.status === 'OK') {
        var tokenArray = SYSTO.tokenise(equationString);
        checkObject.checkNonempty = SYSTO.checkNonempty(equationString);
        if (checkObject.checkNonempty.status === 'OK') {
            checkObject.checkFunctions = SYSTO.checkFunctions(tokenArray),
            checkObject.checkVariables1 = SYSTO.checkVariables1(model, node, tokenArray),
            checkObject.checkVariables2 = SYSTO.checkVariables2(model, node, tokenArray),
            checkObject.checkVariables3 = SYSTO.checkVariables3(model, node, tokenArray),
            checkObject.checkDatatype = SYSTO.checkDatatype(model, node, tokenArray),
            checkObject.checkBrackets = SYSTO.checkBrackets(tokenArray),
            checkObject.checkValidJavascript = SYSTO.checkValidJavascript(equationString)
        }
    };
    //console.debug(node.label+': '+JSON.stringify(checkObject,null,4));

    var ok = true;
    for (checkId in checkObject) {
        var check = checkObject[checkId];
        if (check.status !== 'OK') {
            ok = false;
            break;
        }
    }

    if (ok) {
        return {status:'OK'};
    } else {
        return {status: 'error',
            checkObject: checkObject};
    }
};
         




SYSTO.checkEquationPropertyExists = function (node) {
    if (node.extras) {
        if (node.extras.equation) {
            //if (node.extras.equation.value) {
                return {status:'OK'};
            //} else {
            //    return {status: 'error',
            //            reason: 'no node.extras.equation.value',
            //            message: 'Internal error: no node.extras.equation.value'};
            //}
        } else {
            return {status: 'error',
                    reason: 'no node.extras.equation',
                    message: 'Internal error: no node.extras.equation'};
        }
    } else {
        return {status: 'error',
            reason: 'no node.extras',
            message: 'Internal error: no node.extras'};
    }
};




SYSTO.checkNonempty = function (equationString) {
    if (equationString !== '') {
        return {status:'OK'};
    } else {
        return {status: 'error',
                reason: 'empty_equation_string',
                message: 'The equation string is empty - no equation has been entered'};
    }
};



// This flags up all words in the equation that look like a function name, but
// which are not recognised as a function.
// This could be a typo, or the user thinks that something is a function name
// when in fact it's not a valid Systo function.
// TODO: Handle user-defined functions.

SYSTO.checkFunctions = function(tokenArray) {
    //console.debug('Starting: Equation.prototype.checkFunctions()');
    var errorTokenArray = [];
    var errorWordList = {};
    var validFunctionArray = ['abs','exp', 'log', 'min','max', 'pow', 'time', 'interp', 'interp_wrap', 'irand_var'];

    var nToken = tokenArray.length;
    for (var iToken = 0; iToken < nToken-1; iToken ++) {
        var token = tokenArray[iToken];
        var token1 = tokenArray[iToken+1];
        if (token.type === 'name' && token1.value === '(' ) {
            ok = false;
            if (SYSTO.functions[token.value]) {   // The function ID in SYSTO.functions *must* be the
                            // permitted function name in equations, since we check validity by direct look-up.
                ok = true;
                break;
            }
            if (!ok) {
                errorTokenArray.push(token);
                errorWordList[token.value] = true;   // Trick: store as an object  
                                               // property to avoid having to check for duplicates.
            }
        }
    }
    if (errorTokenArray.length === 0) {
        return {status:'OK'};
    } else {
        return {status: 'error',
                reason: 'invalid_function',
                message: 'The equation includes one or more invalid function names:',
                errorTokenArray: errorTokenArray,
                errorWordList: errorWordList};
    }
};



// This function flags up all variables in the equation which are not node labels in 
// the model.
// This is probably the result of a typo.

SYSTO.checkVariables1 = function (model, node, tokenArray) {

    var nodeList = model.nodes;
    var errorTokenArray = [];  // This is the bag of all error tokens (imcludes duplicates)
    var errorWordList = {};   // This is the set of all error tokens (excludes duplicates)

    var nToken = tokenArray.length;
    for (var iToken = 0; iToken < nToken; iToken ++) {
        var token = tokenArray[iToken];
        if (iToken < nToken-1) {
            var nextToken = tokenArray[iToken+1];
        } else {
            nextToken = {value:''};
        }
        if (token.type === 'name' && nextToken.value !== '(' ) {
            if (!SYSTO.isNodeLabel(model, token.value) && !SYSTO.reservedWords[token.value]) {
                errorTokenArray.push(token);
                errorWordList[token.value] = true;
            }
        }
    }
    if (errorTokenArray.length === 0) {
        return {status:'OK'};
    } else {
        return {status: 'error',
                reason: 'invalid_variable',
                message: 'The equation includes one or more variables which are not in the model:',
                errorTokenArray: errorTokenArray,
                errorWordList: errorWordList};
    }
};



// This flags up all variables which are not the label of nodes in the influence list.
// This probably reflects an error in drawing the model diagram - the user forgot to
// draw an influence arrow.

SYSTO.checkVariables2 = function (model, node, tokenArray) {

    var nodeList = model.nodes;
    var errorTokenArray = [];  // This is the bag of all error tokens (imcludes duplicates)
    var errorWordList = {};   // This is the set of all error tokens (excludes duplicates)
    var influencingNodes = SYSTO.getNodeInfluences(model, node);

    var nToken = tokenArray.length;
    for (var iToken = 0; iToken < nToken; iToken ++) {
        var token = tokenArray[iToken];
        if (iToken < nToken-1) {
            var token1 = tokenArray[iToken+1];
        } else {
            token1 = {value:''};
        }
        if (token.type === 'name' && SYSTO.isNodeLabel(model, token.value) && token1.value !== '(' ) {
            var ok = false;
            for (nodeId1 in influencingNodes) {
                node1 = influencingNodes[nodeId1];
                if (token.value === node1.label) {
                    ok = true;
                    break;
                }
            }

            // Trick: store as an object property to avoid having to check for duplicates.
            if (!ok) {
                errorTokenArray.push(token);
                errorWordList[token.value] = true;
            }
        }
    }
    if (errorTokenArray.length === 0) {
        return {status:'OK'};
    } else {
        return {status: 'error',
                reason: 'variable_without_influence',
                message: 'The equation includes one or more variables which are not shown as '+
                         'influencing this variable:',
                errorTokenArray: errorTokenArray,
                errorWordList: errorWordList};
    }
};




// This flags up all variables which are listed as an influence but which are
// not in the equation.    

SYSTO.checkVariables3 = function (model, node, tokenArray) {

    var nodeList = model.nodes;
    var errorWordList = {};   // This is the set of all error words (excludes duplicates)
    var influencingNodeList = SYSTO.getNodeInfluences(model, node);

    //console.debug(tokenArray);
    //console.debug(influencingNodeList);

    // TODO: The following is crude, crude, crude: improve it.
    var nToken = tokenArray.length;
    for (var influencingNodeId in influencingNodeList) {
        var ok = false;
        var influencingNode = influencingNodeList[influencingNodeId];
        for (var iToken = 0; iToken < nToken; iToken ++) {
            var token = tokenArray[iToken];
            if (iToken < nToken-1) {
                var token1 = tokenArray[iToken+1];
            } else {
                token1 = {value:''};
            }
            if (token.type === 'name' && token1.value !== '('  && SYSTO.isNodeLabel(model, token.value)) {
                if (token.value === influencingNode.label) {
                    ok = true;
                    break;
                }
            }
        }
        if (!ok) {
            errorWordList[influencingNode.label] = true;
        }
    }
    if (isEmpty(errorWordList)) {
        return {status:'OK'};
    } else {
        return {status: 'error',
                reason: 'influence_without_variable',
                message: 'The node has one or more influences which do not have '+
                         'a corresponding variable in the equation:',
                errorWordList: errorWordList};
    }
};




// This is a very preliminary check - basically only does the check if the
// 'equation' is a simple value.   If it's an expression, we can
// perform this check only by:
// - evaluating the expression; or
// - performing a check on the datatypes of all the terms and functions in the expression...

SYSTO.checkDatatype = function (model, node, tokenArray) {

    var nodeList = model.nodes;
    var errorWordList = {};   // This is the set of all error words (excludes duplicates)
    var influencingNodeList = SYSTO.getNodeInfluences(model, node);

    //console.debug(tokenArray);
    //console.debug(influencingNodeList);
    var nToken = tokenArray.length;

    if (nToken === 1) {
        var token = tokenArray[0];
        if (!node.extras.datatype || node.extras.datatype.typeId === 'numeric') {
            if (token.type === 'number' || token.type === 'name') {   // TODO: Remove simple check for
                        // 'name', and replace it with a check of the datatype of the named variable.
                return {status: 'OK'};
            } else {
                return {status: 'error',
                        reason: 'invalid datatype',
                        message: 'The value for this variable has datatype '+token.type+' but '+
                            ' should be numeric.'};
            }
        } else if (node.extras.datatype.typeId === 'enumerated_type') {
            if (token.type === 'name') {
                if (model.enumerated_types[node.extras.datatype.enumerated_type_id][token.value]) {
                    return {status: 'OK'}
                }
            } else {
                return {status: 'error',
                        reason: 'invalid enumerated-type value',
                        message: 'This variable is defined as being of enumerated type '                        
                                +node.extras.datatype.enumerated_type_id+
                                ', but the value provided is not a possible value for this '+
                                'enumerated type.'};
            }
        }                
           
    } else {
        return {status: 'OK'};
    }
};



SYSTO.checkBrackets = function (tokenArray) {
    var counter = 0;

    var error = false;
    for (var i=0; i<tokenArray.length; i++) {
        var token = tokenArray[i];
        if (token.type === 'operator') {
            if (token.value === '(') {
                counter += 1;
            } else if (token.value === ')') {
                if (counter === 0) {
                    var error = true;
                    break;
                }
                counter -= 1;
            }
        }
    }
    if (error) {
        return {status:'error', 
                reason:'mismatched_brackets',
                message:'No left bracket before a right bracket.'};
    } else if (counter === -1) {
        return {status:'error', 
                reason:'mismatched_brackets',
                message:'There is 1 right bracket too many.'};
    } else if (counter === 1) {
        return {status:'error', 
                reason:'mismatched_brackets',
                message:'There is 1 left bracket too many.'};
    } else if (counter < -1) {
        return {status:'error', 
                reason:'mismatched_brackets',
                message:'There are '+Math.abs(counter)+' too many right brackets'};
    } else if (counter > 1) {
        return {status:'error', 
                reason:'mismatched_brackets',
                message:'There are '+Math.abs(counter)+' too many left brackets'};
    } else {
        return {status:'OK'};
    }

};



SYSTO.checkParse = function (equationString) {

    var myParse = SYSTO.make_parse();
    //console.debug(myParse);
    var parseJsonString, result, tree;

    try {
        //console.debug('try '+equationString);
        tree = myParse(equationString);
        //console.debug(tree);
        parseJsonString = JSON.stringify(tree, ['key', 'name', 'message', 'from', 'to',
            'value', 'arity', 'first', 'second', 'third', 'fourth'], 4);
        result = {status:'OK'};

    } catch (e) {
        //console.debug('catch '+equationString);
        //console.debug(e);
        //console.debug(e.arguments[1].arity);
        parseJsonString = JSON.stringify(e, ['name', 'message', 'arguments', 'from', 'to', 'key',
                'value', 'arity', 'first', 'second', 'third', 'fourth'], 4);
        var args = e.arguments[1];
        //string = args.arity+';'+args.from+'-'+args.to;
        return {status: 'error',
                reason: 'parse_error',
                message:parseJsonString, 
                from:args.from,
                to:args.to};
    }
};



SYSTO.checkValidJavascript = function(equationString) {
    var tokenArray = SYSTO.tokenise(equationString);
    tokenArray = turnIntoPureJavascript(tokenArray);
    equationString = makeJavascriptEquation(tokenArray);

    try {
        var fun = new Function(equationString);
        return {status: 'OK'};
    }
    catch(err) {
        return {status: 'error',
                reason: 'invalid_javascript',
                message: 'There is a syntax error in the equation.'};
    }

};


// ================================================================= SYSTO.tokenise()
// tokens.js
// 2010-02-23

// (c) 2006 Douglas Crockford

// Produce an array of simple token objects from a string.
// A simple token object contains these members:
//      type: 'name', 'string', 'number', 'operator'
//      value: string or number value of the token
//      from: index of first character of the token
//      to: index of the last character + 1

// Comments of the // type are ignored.

// Operators are by default single characters. Multicharacter
// operators can be made by supplying a string of prefix and
// suffix characters.
// characters. For example,
//      '<>+-&', '=>&:'
// will match any of these:
//      <=  >>  >>>  <>  >=  +: -: &: &&: &&

SYSTO.tokenise = function (expression) {

    if (!expression || expression === '') {
        return [];
    }

    var prefix = '<>+-&';
    var suffix = '=>&:';
    var c;                      // The current character.
    var from;                   // The index of the start of the token.
    var i = 0;                  // The index of the current character.
    var length = expression.length;
    var n;                      // The number value.
    var q;                      // The quote character.
    var str;                    // The string value.

    var result = [];            // An array to hold the results.

    var make = function (type, value) {

// Make a token object.

        return {
            type: type,
            value: value,
            from: from,
            to: i
        };
    };

// Begin tokenization. If the source string is empty, return nothing.

    if (expression == '') {
        return [];
    }

// If prefix and suffix strings are not provided, supply defaults.

    if (typeof prefix !== 'string') {
        prefix = '<>+-&';
    }
    if (typeof suffix !== 'string') {
        suffix = '=>&:';
    }


// Loop through this text, one character at a time.

    c = expression.charAt(i);
    while (c) {
        from = i;

// Ignore whitespace.

        if (c <= ' ') {
            i += 1;
            c = expression.charAt(i);

// name.

        } else if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z')) {
            str = c;
            i += 1;
            for (;;) {
                c = expression.charAt(i);
                if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z') ||
                        (c >= '0' && c <= '9') || c === '_') {
                    str += c;
                    i += 1;
                } else {
                    break;
                }
            }
            result.push(make('name', str));

// number.

// A number cannot start with a decimal point. It must start with a digit,
// possibly '0'.

        } else if (c >= '0' && c <= '9') {
            str = c;
            i += 1;

// Look for more digits.

            for (;;) {
                c = expression.charAt(i);
                if (c < '0' || c > '9') {
                    break;
                }
                i += 1;
                str += c;
            }

// Look for a decimal fraction part.

            if (c === '.') {
                i += 1;
                str += c;
                for (;;) {
                    c = expression.charAt(i);
                    if (c < '0' || c > '9') {
                        break;
                    }
                    i += 1;
                    str += c;
                }
            }

// Look for an exponent part.

            if (c === 'e' || c === 'E') {
                i += 1;
                str += c;
                c = expression.charAt(i);
                if (c === '-' || c === '+') {
                    i += 1;
                    str += c;
                    c = expression.charAt(i);
                }
                if (c < '0' || c > '9') {
                    make('number', str).error("Bad exponent");
                }
                do {
                    i += 1;
                    str += c;
                    c = expression.charAt(i);
                } while (c >= '0' && c <= '9');
            }

// Make sure the next character is not a letter.

            if (c >= 'a' && c <= 'z') {
                str += c;
                i += 1;
                make('number', str).error("Bad number");
            }

// Convert the string value to a number. If it is finite, then it is a good
// token.

            n = +str;
            if (isFinite(n)) {
                result.push(make('number', n));
            } else {
                make('number', str).error("Bad number");
            }

// string

        } else if (c === '\'' || c === '"') {
            str = '';
            q = c;
            i += 1;
            for (;;) {
                c = expression.charAt(i);
                if (c < ' ') {
                    make('string', str).error(c === '\n' || c === '\r' || c === '' ?
                        "Unterminated string." :
                        "Control character in string.", make('', str));
                }

// Look for the closing quote.

                if (c === q) {
                    break;
                }

// Look for escapement.

                if (c === '\\') {
                    i += 1;
                    if (i >= length) {
                        make('string', str).error("Unterminated string");
                    }
                    c = expression.charAt(i);
                    switch (c) {
                    case 'b':
                        c = '\b';
                        break;
                    case 'f':
                        c = '\f';
                        break;
                    case 'n':
                        c = '\n';
                        break;
                    case 'r':
                        c = '\r';
                        break;
                    case 't':
                        c = '\t';
                        break;
                    case 'u':
                        if (i >= length) {
                            make('string', str).error("Unterminated string");
                        }
                        c = parseInt(expression.substr(i + 1, 4), 16);
                        if (!isFinite(c) || c < 0) {
                            make('string', str).error("Unterminated string");
                        }
                        c = String.fromCharCode(c);
                        i += 4;
                        break;
                    }
                }
                str += c;
                i += 1;
            }
            i += 1;
            result.push(make('string', str));
            c = expression.charAt(i);

// comment.

        } else if (c === '/' && expression.charAt(i + 1) === '/') {
            i += 1;
            for (;;) {
                c = expression.charAt(i);
                if (c === '\n' || c === '\r' || c === '') {
                    break;
                }
                i += 1;
            }

// combining

        } else if (prefix.indexOf(c) >= 0) {
            str = c;
            i += 1;
            while (true) {
                c = expression.charAt(i);
                if (i >= length || suffix.indexOf(c) < 0) {
                    break;
                }
                str += c;
                i += 1;
            }
            result.push(make('operator', str));

// single-character operator

        } else {
            i += 1;
            result.push(make('operator', c));
            c = expression.charAt(i);
        }
    }
    tokenArray = result;

    return tokenArray;  
};




// ================================================================= SYSTO.make_parse()
// parse.js
// Parser for Simplified JavaScript written in Simplified JavaScript
// From Top Down Operator Precedence
// http://javascript.crockford.com/tdop/index.html
// Douglas Crockford
// 2010-06-26

SYSTO.make_parse = function () {
    //console.debug('Starting make_parse()');
    var scope;
    var symbol_table = {};
    var token;
    var tokens;
    var token_nr;

    var itself = function () {
        return this;
    };

    var original_scope = {
        define: function (n) {
            var t = this.def[n.value];
            if (typeof t === "object") {
                n.error(t.reserved ? "Already reserved." : "Already defined.");
            }
            this.def[n.value] = n;
            n.reserved = false;
            n.nud      = itself;
            n.led      = null;
            n.std      = null;
            n.lbp      = 0;
            n.scope    = scope;
            return n;
        },
        find: function (n) {
            var e = this, o;
            while (true) {
                o = e.def[n];
                if (o && typeof o !== 'function') {
                    return e.def[n];
                }
                e = e.parent;
                if (!e) {
                    o = symbol_table[n];
                    return o && typeof o !== 'function' ? o : symbol_table["(name)"];
                }
            }
        },
        pop: function () {
            scope = this.parent;
        },
        reserve: function (n) {
            if (n.arity !== "name" || n.reserved) {
                return;
            }
            var t = this.def[n.value];
            if (t) {
                if (t.reserved) {
                    return;
                }
                if (t.arity === "name") {
                    n.error("Already defined.");
                }
            }
            this.def[n.value] = n;
            n.reserved = true;
        }
    };

    var new_scope = function () {
        var s = scope;
        scope = Object.create(original_scope);
        scope.def = {};
        scope.parent = s;
        return scope;
    };

    var advance = function (id) {
        var a, o, t, v;
        if (id && token.id !== id) {
            token.error("Expected '" + id + "'.");
        }
        if (token_nr >= tokens.length) {
            token = symbol_table["(end)"];
            return;
        }
        t = tokens[token_nr];
        token_nr += 1;
        v = t.value;
        a = t.type;
        if (a === "name") {
            o = scope.find(v);
        } else if (a === "operator") {
            o = symbol_table[v];
            if (!o) {
                t.error("Unknown operator.");
            }
        } else if (a === "string" || a ===  "number") {
            o = symbol_table["(literal)"];
            a = "literal";
        } else {
            t.error("Unexpected token.");
        }
        token = Object.create(o);
        token.from  = t.from;
        token.to    = t.to;
        token.value = v;
        token.arity = a;
        return token;
    };

    var expression = function (rbp) {
        var left;
        var t = token;
        advance();
        left = t.nud();
        while (rbp < token.lbp) {
            t = token;
            advance();
            left = t.led(left);
        }
        return left;
    };

    var statement = function () {
        var n = token, v;

        if (n.std) {
            advance();
            scope.reserve(n);
            return n.std();
        }
        v = expression(0);
        if (!v.assignment && v.id !== "(") {
            v.error("Bad expression statement.");
        }
        advance(";");
        return v;
    };

    var statements = function () {
        var a = [], s;
        while (true) {
            if (token.id === "}" || token.id === "(end)") {
                break;
            }
            s = statement();
            if (s) {
                a.push(s);
            }
        }
        return a.length === 0 ? null : a.length === 1 ? a[0] : a;
    };

    var block = function () {
        var t = token;
        advance("{");
        return t.std();
    };

    var original_symbol = {
        nud: function () {
            this.error("Undefined.");
        },
        led: function (left) {
            this.error("Missing operator.");
        }
    };

    var symbol = function (id, bp) {
        var s = symbol_table[id];
        bp = bp || 0;
        if (s) {
            if (bp >= s.lbp) {
                s.lbp = bp;
            }
        } else {
            s = Object.create(original_symbol);
            s.id = s.value = id;
            s.lbp = bp;
            symbol_table[id] = s;
        }
        return s;
    };

    var constant = function (s, v) {
        var x = symbol(s);
        x.nud = function () {
            scope.reserve(this);
            this.value = symbol_table[this.id].value;
            this.arity = "literal";
            return this;
        };
        x.value = v;
        return x;
    };

    var infix = function (id, bp, led) {
        var s = symbol(id, bp);
        s.led = led || function (left) {
            this.first = left;
            this.second = expression(bp);
            this.arity = "binary";
            return this;
        };
        return s;
    };

    var infixr = function (id, bp, led) {
        var s = symbol(id, bp);
        s.led = led || function (left) {
            this.first = left;
            this.second = expression(bp - 1);
            this.arity = "binary";
            return this;
        };
        return s;
    };

    var assignment = function (id) {
        return infixr(id, 10, function (left) {
            if (left.id !== "." && left.id !== "[" && left.arity !== "name") {
                left.error("Bad lvalue.");
            }
            this.first = left;
            this.second = expression(9);
            this.assignment = true;
            this.arity = "binary";
            return this;
        });
    };

    var prefix = function (id, nud) {
        var s = symbol(id);
        s.nud = nud || function () {
            scope.reserve(this);
            this.first = expression(70);
            this.arity = "unary";
            return this;
        };
        return s;
    };

    var stmt = function (s, f) {
        var x = symbol(s);
        x.std = f;
        return x;
    };

    symbol("(end)");
    symbol("(name)");
    symbol(":");
    symbol(";");
    symbol(")");
    symbol("]");
    symbol("}");
    symbol(",");
    symbol("else");

    constant("true", true);
    constant("false", false);
    constant("null", null);
    constant("pi", 3.141592653589793);
    constant("Object", {});
    constant("Array", []);

    symbol("(literal)").nud = itself;

    symbol("this").nud = function () {
        scope.reserve(this);
        this.arity = "this";
        return this;
    };

    assignment("=");
    assignment("+=");
    assignment("-=");

    infix("?", 20, function (left) {
        this.first = left;
        this.second = expression(0);
        advance(":");
        this.third = expression(0);
        this.arity = "ternary";
        return this;
    });

    infixr("&&", 30);
    infixr("||", 30);

    infixr("==", 40);
    infixr("!==", 40);
    infixr("<", 40);
    infixr("<=", 40);
    infixr(">", 40);
    infixr(">=", 40);

    infix("+", 50);
    infix("-", 50);

    infix("*", 60);
    infix("/", 60);

    infix(".", 80, function (left) {
        this.first = left;
        if (token.arity !== "name") {
            token.error("Expected a property name.");
        }
        token.arity = "literal";
        this.second = token;
        this.arity = "binary";
        advance();
        return this;
    });

    infix("[", 80, function (left) {
        this.first = left;
        this.second = expression(0);
        this.arity = "binary";
        advance("]");
        return this;
    });

    infix("(", 80, function (left) {
        var a = [];
        if (left.id === "." || left.id === "[") {
            this.arity = "ternary";
            this.first = left.first;
            this.second = left.second;
            this.third = a;
        } else {
            this.arity = "binary";
            this.first = left;
            this.second = a;
            if ((left.arity !== "unary" || left.id !== "function") &&
                    left.arity !== "name" && left.id !== "(" &&
                    left.id !== "&&" && left.id !== "||" && left.id !== "?") {
                left.error("Expected a variable name.");
            }
        }
        if (token.id !== ")") {
            while (true) {
                a.push(expression(0));
                if (token.id !== ",") {
                    break;
                }
                advance(",");
            }
        }
        advance(")");
        return this;
    });


    prefix("!");
    prefix("-");
    prefix("typeof");

    prefix("(", function () {
        var e = expression(0);
        advance(")");
        return e;
    });

    prefix("function", function () {
        var a = [];
        new_scope();
        if (token.arity === "name") {
            scope.define(token);
            this.name = token.value;
            advance();
        }
        advance("(");
        if (token.id !== ")") {
            while (true) {
                if (token.arity !== "name") {
                    token.error("Expected a parameter name.");
                }
                scope.define(token);
                a.push(token);
                advance();
                if (token.id !== ",") {
                    break;
                }
                advance(",");
            }
        }
        this.first = a;
        advance(")");
        advance("{");
        this.second = statements();
        advance("}");
        this.arity = "function";
        scope.pop();
        return this;
    });

    prefix("[", function () {
        var a = [];
        if (token.id !== "]") {
            while (true) {
                a.push(expression(0));
                if (token.id !== ",") {
                    break;
                }
                advance(",");
            }
        }
        advance("]");
        this.first = a;
        this.arity = "unary";
        return this;
    });

    prefix("{", function () {
        var a = [], n, v;
        if (token.id !== "}") {
            while (true) {
                n = token;
                if (n.arity !== "name" && n.arity !== "literal") {
                    token.error("Bad property name.");
                }
                advance();
                advance(":");
                v = expression(0);
                v.key = n.value;
                a.push(v);
                if (token.id !== ",") {
                    break;
                }
                advance(",");
            }
        }
        advance("}");
        this.first = a;
        this.arity = "unary";
        return this;
    });


    stmt("{", function () {
        new_scope();
        var a = statements();
        advance("}");
        scope.pop();
        return a;
    });

    stmt("var", function () {
        var a = [], n, t;
        while (true) {
            n = token;
            if (n.arity !== "name") {
                n.error("Expected a new variable name.");
            }
            scope.define(n);
            advance();
            if (token.id === "=") {
                t = token;
                advance("=");
                t.first = n;
                t.second = expression(0);
                t.arity = "binary";
                a.push(t);
            }
            if (token.id !== ",") {
                break;
            }
            advance(",");
        }
        advance(";");
        return a.length === 0 ? null : a.length === 1 ? a[0] : a;
    });

    stmt("if", function () {
        advance("(");
        this.first = expression(0);
        advance(")");
        this.second = block();
        if (token.id === "else") {
            scope.reserve(token);
            advance("else");
            this.third = token.id === "if" ? statement() : block();
        } else {
            this.third = null;
        }
        this.arity = "statement";
        return this;
    });

    stmt("return", function () {
        if (token.id !== ";") {
            this.first = expression(0);
        }
        advance(";");
        if (token.id !== "}") {
            token.error("Unreachable statement.");
        }
        this.arity = "statement";
        return this;
    });

    stmt("break", function () {
        advance(";");
        if (token.id !== "}") {
            token.error("Unreachable statement.");
        }
        this.arity = "statement";
        return this;
    });

    stmt("while", function () {
        advance("(");
        this.first = expression(0);
        advance(")");
        this.second = block();
        this.arity = "statement";
        return this;
    });

    return function (source0) {
        // What I am doing here, down to
        //     tokens = source.tokens();
        // is to create 'var' statements for each identifier (variable or function name) in
        // the source expression (source0).   I do this by tokenising it, to extract 
        // all the identifiers, add the 'var' statments onto the start of the source0 string
        // to make source itself, then tokenise that to make the tokens array which will actually
        // be processed by the parser.    This is a crude alternative to what I should be doing,
        // which is to modify the actual parser to not require that all identifiers are first
        // declared.
        //console.debug('Starting: return function(source0)');
        var tokens0 = source0.tokens('=<>!+-*&|/%^', '=<>&|');
        //console.debug(source0);
        //console.debug(tokens0);
        var source = '';
        var nameList = {};   // Making the names into object properties is a simple way of eliminating duplicates.
        for (var i=0;i<tokens0.length;i++) {
            if (tokens0[i].type === 'name') {
                nameList[tokens0[i].value] = '';
            }
        }
        for (var name in nameList) {
            if (nameList.hasOwnProperty(name)) {     // This is necessary to avoid the 'error' property.
                source += 'var '+name+';';
            }
        }
        //source += 'function min(a,b) {};';
        //source += 'function max(a,b) {};';
        //source += 'function exp(a) {};';

        modelList['model1'].equationOffset = 10 + source.length;   // This is the offset which needs to be subtracted from all
                                                // character positions to allow for the generated var statements.
        //console.debug(modelList['model1'].equationOffset);
        source += 'var xxxx ='+source0+';';
        tokens = source.tokens('=<>!+-*&|/%^', '=<>&|');
        //console.debug('===');
        //console.debug(source);
        //console.debug(tokens);
        token_nr = 0;
        new_scope();
        advance();
        var s = statements();
        advance("(end)");
        scope.pop();
        return s;
    };
};


/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/functions.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


// =================================================================
// =================================================================
// Functions are part of the global SYSTO object - to avoid polluting the global namespace.
// Note that xxxx is an object, not a property with a funcion value, so that we can attach
// other information about each function.

/* Object structure:
    For a Math function:
    log: {                     // name is same as Systo name...
        display:'log(x)',       // display name in documenation etc
        systo:'log',            // same as containing property name...
        javascript:'Math.log',  // the text that will be substituted into generated code
        arity:1,                // number of arguments (for syntax checking)
        description:'Natural log of x'}   // text in documentation etc.
 
    For a function defined in Systo (note the additional property f):
    fmod: {
        display:'fmod(x)',
        systo:'fmod',
        javascript:'fmod.f',
        arity:2,
        description:'fmod(x,y) is the remainder when x is divided by y',
        f: function (x,y) {return y/x-Math.floor(y/x);}}

As mentioned above, the various properties for the SYSTO.functions object literal *must*
be the same as the permitted function name used in equations.   The reason for this is that,
when checking an equation for errors, we do it by direct lookup (e.g. does 
if (SYSTO.functions[function_name_being_checked]) {...}
actually exist?  This replaces the previous method (where I looped over an *array* of functions).
I could still use that approach - for (functionId in SYSTO.functions) {...}
but it's quicker and neater to use direct look-up.
*/


//function irand_var(n) {return Math.min(n,Math.floor(1+n*Math.random()));}

SYSTO.functions = {
    abs: {
        display:'abs(x)', 
        systo:'abs', 
        javascript:'Math.abs', 
        arity:1, 
        description:'The absolute value of x'},

    ceil: {
        display:'ceil(x)', 
        systo:'ceil', 
        javascript:'Math.ceil', 
        arity:1, 
        description:'Round value up to nearest whole number'},

    exp: {
        display:'exp(x)', 
        systo:'exp', 
        javascript:'Math.exp', 
        arity:1, 
        description:'e raised to the power x'},

    floor: {
        display:'floor(x)', 
        systo:'floor', 
        javascript:'Math.floor', 
        arity:1, 
        description:'Round value down to nearest whole number'},

    fmod: {
        display:'fmod(x)',
        systo:'fmod',
        javascript:'fmod.f',
        arity:2,
        description:'fmod(x,y) is the remainder when x is divided by y',
        f: function (x,y) {return y/x-Math.floor(y/x);}},

    hypot: {
        display:'hypot(x)',
        systo:'hypot',
        javascript:'SYSTO.functions.hypot.f',
        arity:2,
        description:'the length of the hypotenuse of a right-angle triangle with sides x and y',
        f: function (x,y) {return Math.sqrt(x*x+y*y);}},

    int: {
        display:'int(x)', 
        systo:'int', 
        javascript:'Math.floor', 
        arity:1, 
        description:'Round value up to nearest whole number'},

    interp: {
        display:'interp(x,XYarray)', 
        systo:'interp', 
        javascript:'SYSTO.functions.interp.f', 
        arity:2, 
        description:'Interpolation of a tabulated function represented by an array of [x,y] values.    E.g. interp(2,[[0,10],[4,20],[5,50]]) --> 15.',
        f: function (x,xyArray) {
            var n = xyArray.length;
            if (x <= xyArray[0][0]) {   
                return xyArray[0][1];
            } else if (x >= xyArray[n-1][0]) {
                return xyArray[n-1][1];
            } else {
                for (var i = 1; i<n; i++) {
                    if (x < xyArray[i][0]) {
                        var xlow = xyArray[i-1][0];
                        var xhigh = xyArray[i][0];
                        var ylow = xyArray[i-1][1];
                        var yhigh = xyArray[i][1];
                        return ylow + (yhigh-ylow)*(x-xlow)/(xhigh-xlow);
                    }
                }
            }
        }},

    interp_wrap: {
        display:'interp_wrap(x,XYarray)', 
        systo:'interp_wrap', 
        javascript:'SYSTO.functions.interp_wrap.f', 
        arity:2, 
        description:'Interpolation of a tabulated function represented by an array of [x,y] values.    E.g. interp(2,[[0,10],[4,20],[5,50]]) --> 15.',
        f: function (x,xyArray) {
            var n = xyArray.length;
            var xmin = xyArray[0][0];
            var xmax = xyArray[n-1][0];
            x = x % (xmax-xmin);
            for (var i = 1; i<n; i++) {
                if (x < xyArray[i][0]) {
                    var xlow = xyArray[i-1][0];
                    var xhigh = xyArray[i][0];
                    var ylow = xyArray[i-1][1];
                    var yhigh = xyArray[i][1];
                    return ylow + (yhigh-ylow)*(x-xlow)/(xhigh-xlow);
                }
            }}},

    interpXY: {
        display:'interpXY(x,Xarray, Yarray)', 
        systo:'interpXY', 
        javascript:'SYSTO.functions.interpXY.f', 
        arity:3, 
        description:'Interpolation of a tabulated function represented by an array of x values and an array of y values.    E.g. interp(2,[0,4,5],[10,20,50]) --> 15.',
        f: function (x,xArray, yArray) {
            var n = xArray.length;
            if (x <= xArray[0]) {   
                return yArray[0];
            } else if (x >= xArray[n-1]) {
                return yArray[n-1];
            } else {
                for (var i = 1; i<n; i++) {
                    if (x < xArray[i]) {
                        var xlow = xArray[i-1];
                        var xhigh = xArray[i];
                        var ylow = yArray[i-1];
                        var yhigh = yArray[i];
                        return ylow + (yhigh-ylow)*(x-xlow)/(xhigh-xlow);
                    }
                }
            }}},

    area_under_XY: {
        display:'area_under_XY(x,Xarray, Yarray)', 
        systo:'area_under_XY', 
        javascript:'SYSTO.functions.area_under_XY.f', 
        arity:3, 
        description:'The area under a tabulated function represented by an array of x values and an array of y values.    E.g. area_under_XY(0,4,[0,4,5],[10,20,50]) --> 60.',
        f: function (xStart, xEnd, xArray, yArray) {
            var xArray1 = [];
            var yArray1 = [];
            function interpXY1(x,xArray, yArray) {
                var n = xArray.length;
                if (x <= xArray[0]) {   
                    return {index:0, y:yArray[0]};
                } else if (x >= xArray[n-1]) {
                    return {index:n-1, y:yArray[n-1]};
                } else {
                    for (var i = 1; i<n; i++) {
                        if (x <= xArray[i]) {
                            var xlow = xArray[i-1];
                            var xhigh = xArray[i];
                            var ylow = yArray[i-1];
                            var yhigh = yArray[i];
                            return {index:i, y:ylow + (yhigh-ylow)*(x-xlow)/(xhigh-xlow)};
                        }
                    }
                }
            }
            var resultStart = interpXY1(xStart, xArray, yArray);
            var indexStart = resultStart.index;
            var yStart = resultStart.y;
            xArray1[0] = xStart;
            yArray1[0] = yStart;
            var resultEnd = interpXY1(xEnd, xArray, yArray);
            var indexEnd = resultEnd.index;
            var yEnd = resultEnd.y;
            var n = indexEnd-indexStart+1;
            xArray1[n+1] = xEnd;
            yArray1[n+1] = yEnd;
            if (n > 0) {
                for (var i=1; i<=n; i++) {
                    var index = indexStart+i-1;
                    xArray1[i] = xArray[index];
                    yArray1[i] = yArray[index];
                }
            }
            var area = 0;
            for (var i=0; i<xArray1.length-1; i++) {
                area += (yArray1[i]+yArray1[i+1])/2 * (xArray1[i+1]-xArray1[i]);
            }     
            return area;
            }},

    log: {
        display:'log(x)', 
        systo:'log', 
        javascript:'Math.log', 
        arity:1, 
        description:'Natural log of x'},

    log10: {
        display:'log10(x)', 
        systo:'log10', 
        javascript:'SYSTO.functions.log10.f', 
        arity:1, 
        description:'Log to base 10 of x',
        f: function (x) {return Math.log(x)/Math.LN10;}},

    max: {
        display:'max(x,y)', 
        systo:'max', 
        javascript:'Math.max', 
        arity:2, 
        description:'The maximum of x and y'},

    min: {
        display:'min(x,y)', 
        systo:'min', 
        javascript:'Math.min', 
        arity:2, 
        description:'The minimum of x and y'},

    pow: {
        display:'pow(x,y)', 
        systo:'pow', 
        javascript:'Math.pow', 
        arity:2, 
        description:'x raised to the power y'},
/*
Thes 4 functions need writing - current text is placeholder only...
    spikes: {
        display:'pulse(amount, firsttime, repeatinterval)', 
        systo:'pulse', 
        javascript:'SYSTO.functions.pulse.f, 
        arity:3, 
        description:'a value produced at time starttime and every repeatinterval thereafter',
        f: function (amount,firstTime,repeatInterval) {
            if (Math.abs(100-firstTime) < 0.000001) {
                return amount;   // TODO: should be amount*GLOBAL.timeStep!! And handle repeatInterval!!
            } else {
                return 0;
            }}},

    pulses: {
        display:'pulse(amount, duration, firsttime, repeatinterval)', 
        systo:'pulse', 
        javascript:'SYSTO.functions.pulse.f, 
        arity:3, 
        description:'a value produced at time starttime and every repeatinterval thereafter',
        f: function (amount,duration, firstTime,repeatInterval) {
            if (TIME > start && TIME < end) {
                if (Systo.fmod(TIME-start, repeat) < width) return amount;
            }
            return 0 
            }}},

    ramp: {
        display:'ramp(amount, firsttime, repeatinterval)', 
        systo:'ramp', 
        javascript:'SYSTO.functions.ramp.f, 
        arity:3, 
        description:'a value produced at time starttime and every repeatinterval thereafter',
        f: function (amount,firstTime,repeatInterval) {
            if (Math.abs(100-firstTime) < 0.000001) {
                return amount;   // TODO: should be amount*GLOBAL.timeStep!! And handle repeatInterval!!
            } else {
                return 0;
            }}},

    step: {
        display:'step(amount, firsttime, repeatinterval)', 
        systo:'step', 
        javascript:'SYSTO.functions.step.f, 
        arity:3, 
        description:'a value produced at time starttime and every repeatinterval thereafter',
        f: function (amount,firstTime,repeatInterval) {
            if (Math.abs(100-firstTime) < 0.000001) {
                return amount;   // TODO: should be amount*GLOBAL.timeStep!! And handle repeatInterval!!
            } else {
                return 0;
            }}},
*/

    rand_const: {
        display:'rand_var(a,b)', 
        systo:'rand_var', 
        javascript:'SYSTO.functions.rand_var.f', 
        arity:2, 
        description:'a random value sampled from a rectangular probability distribution between a and b.  Only at SIMTIME=0 (the name ensures that it is called just oncem during the "initial" simStage',
        f: function (x,y) {return x+(y-x)*Math.random();}},

    rand_var: {
        display:'rand_var(a,b)', 
        systo:'rand_var', 
        javascript:'SYSTO.functions.rand_var.f', 
        arity:2, 
        description:'a random value sampled from a rectangular probability distribution between a and b',
        f: function (x,y) {return x+(y-x)*Math.random();}},

    irand_var: {
        display:'irand_var(n)', 
        systo:'irand_var', 
        javascript:'SYSTO.functions.irand_var.f', 
        arity:1, 
        description:'a random integer, with equal probability of 1 to n',
        f: function (n) {return Math.min(n,Math.floor(1+n*Math.random()));}},

    irandselect_var: {
        display:'irandselect_var(n)', 
        systo:'irandselect_var', 
        javascript:'SYSTO.functions.irandselect_var.f', 
        arity:1, 
        description:'a random integer, with probability determined by an array',
        f: function (probarray) {
            var sum = 0;
            for (var i=0; i<probarray.length; i++) {
                sum += probarray[i];
            }
            var probarraycum = [0];
            for (i=1; i<=probarray.length; i++) {
                probarraycum[i] = probarraycum[i-1]+probarray[i-1]/sum;
            }
            var rand = Math.random();
            for (i=1; i<probarraycum.length; i++) {
                if (rand < probarraycum[i]) {
                    return i;
                }
            }
            return probarray.length;
        }},

    round: {
        display:'round(x)', 
        systo:'round', 
        javascript:'Math.round', 
        arity:1, 
        description:'Round x to the nearest whole number'},

    sign: {
        display:'sign(x)', 
        systo:'sign', 
        javascript:'SYSTO.functions.sign.f', 
        arity:1, 
        description:'Square root of x',
        f: function (x) {return x>=0?1:-1;}},

    sqrt: {
        display:'sqrt(x)', 
        systo:'sqrt', 
        javascript:'Math.sqrt', 
        arity:1, 
        description:'Square root of x'},

    // stop: {f: function (x) Should be easy enough to provide.

    time: {f: function () {return SYSTO.simTime;}}, // GLOBAL_simTime is a global variable. 

    // Trigonmetric functions

    acos: {        
        display:'acos(x)', 
        systo:'acos', 
        javascript:'Math.acos', 
        arity:1, 
        description:'Arccos of x'},

    asin: {
        display:'asin(x)', 
        systo:'asin', 
        javascript:'Math.asin', 
        arity:1, 
        description:'Arcsine of x'},

    atan: {
        display:'atan(x)', 
        systo:'atan', 
        javascript:'Math.atan', 
        arity:1, 
        description:'Arctan of x'},

    atan2: {
        display:'atan2(x,y)', 
        systo:'atan2', 
        javascript:'Math.atan2', 
        arity:2, 
        description:'Arctan of angle with sides x and y'},

    cos: {
        display:'cos(x)', 
        systo:'cos', 
        javascript:'Math.cos', 
        arity:1, 
        description:'Cosine of x'},

    sin: {
        display:'sin(x)', 
        systo:'sin', 
        javascript:'Math.sin', 
        arity:1, 
        description:'Sine of x'},

    tannnn: {
        display:'tan(x)', 
        systo:'tan', 
        javascript:'Math.tan', 
        arity:1, 
        description:'Tan of x'},

    string_length: {
        display:'string_length(x)', 
        systo:'string_length', 
        javascript:'SYSTO.functions.string_length.f', 
        arity:1, 
        description:'string_length of x',
        f: function (x) {var str = x.toString(); len = str.length; return len;}},
/*
    string_makeobject: {
        display:'string_makeobject(x)', 
        systo:'string_makeobject', 
        javascript:'SYSTO.functions.string_makeobject.f', 
        arity:1, 
        description:'string_makeobject of x',
        f: function (x) {return JSON.parse(x);}},

    object_nproperties: {
        display:'object_nproperties(x)', 
        systo:'object_nproperties', 
        javascript:'SYSTO.functions.object_nproperties.f', 
        arity:1, 
        description:'number of properties of the object x',
        f: function (object) {
            var n = 0;
            for (var objectId in object) {
                n+=1;
            }
            return n;
        }},

    string_nproperties: {
        display:'string_nproperties(x)', 
        systo:'string_nproperties', 
        javascript:'SYSTO.functions.string_nproperties.f', 
        arity:1, 
        description:'number of properties of the string-represented object x',
        f: function (stringObject) {
            var object = JSON.parse(stringObject);
            var n = 0;
            for (var objectId in object) {
                n+=1;
            }
            return n;
        }},
*/
};




/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/FileSaver.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


/*! FileSaver.js
 *  A saveAs() FileSaver implementation.
 *  2014-01-24
 *
 *  By Eli Grey, http://eligrey.com
 *  License: X11/MIT
 *    See LICENSE.md
 */

/*global self */
/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */

/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */

var saveAs = saveAs
  // IE 10+ (native saveAs)
  || (typeof navigator !== "undefined" &&
      navigator.msSaveOrOpenBlob && navigator.msSaveOrOpenBlob.bind(navigator))
  // Everyone else
  || (function(view) {
	"use strict";
	// IE <10 is explicitly unsupported
	if (typeof navigator !== "undefined" &&
	    /MSIE [1-9]\./.test(navigator.userAgent)) {
		return;
	}
	var
		  doc = view.document
		  // only get URL when necessary in case BlobBuilder.js hasn't overridden it yet
		, get_URL = function() {
			return view.URL || view.webkitURL || view;
		}
		, URL = view.URL || view.webkitURL || view
		, save_link = doc.createElementNS("http://www.w3.org/1999/xhtml", "a")
		, can_use_save_link = !view.externalHost && "download" in save_link
		, click = function(node) {
			var event = doc.createEvent("MouseEvents");
			event.initMouseEvent(
				"click", true, false, view, 0, 0, 0, 0, 0
				, false, false, false, false, 0, null
			);
			node.dispatchEvent(event);
		}
		, webkit_req_fs = view.webkitRequestFileSystem
		, req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem
		, throw_outside = function(ex) {
			(view.setImmediate || view.setTimeout)(function() {
				throw ex;
			}, 0);
		}
		, force_saveable_type = "application/octet-stream"
		, fs_min_size = 0
		, deletion_queue = []
		, process_deletion_queue = function() {
			var i = deletion_queue.length;
			while (i--) {
				var file = deletion_queue[i];
				if (typeof file === "string") { // file is an object URL
					URL.revokeObjectURL(file);
				} else { // file is a File
					file.remove();
				}
			}
			deletion_queue.length = 0; // clear queue
		}
		, dispatch = function(filesaver, event_types, event) {
			event_types = [].concat(event_types);
			var i = event_types.length;
			while (i--) {
				var listener = filesaver["on" + event_types[i]];
				if (typeof listener === "function") {
					try {
						listener.call(filesaver, event || filesaver);
					} catch (ex) {
						throw_outside(ex);
					}
				}
			}
		}
		, FileSaver = function(blob, name) {
			// First try a.download, then web filesystem, then object URLs
			var
				  filesaver = this
				, type = blob.type
				, blob_changed = false
				, object_url
				, target_view
				, get_object_url = function() {
					var object_url = get_URL().createObjectURL(blob);
					deletion_queue.push(object_url);
					return object_url;
				}
				, dispatch_all = function() {
					dispatch(filesaver, "writestart progress write writeend".split(" "));
				}
				// on any filesys errors revert to saving with object URLs
				, fs_error = function() {
					// don't create more object URLs than needed
					if (blob_changed || !object_url) {
						object_url = get_object_url(blob);
					}
					if (target_view) {
						target_view.location.href = object_url;
					} else {
						window.open(object_url, "_blank");
					}
					filesaver.readyState = filesaver.DONE;
					dispatch_all();
				}
				, abortable = function(func) {
					return function() {
						if (filesaver.readyState !== filesaver.DONE) {
							return func.apply(this, arguments);
						}
					};
				}
				, create_if_not_found = {create: true, exclusive: false}
				, slice
			;
			filesaver.readyState = filesaver.INIT;
			if (!name) {
				name = "download";
			}
			if (can_use_save_link) {
				object_url = get_object_url(blob);
				// FF for Android has a nasty garbage collection mechanism
				// that turns all objects that are not pure javascript into 'deadObject'
				// this means `doc` and `save_link` are unusable and need to be recreated
				// `view` is usable though:
				doc = view.document;
				save_link = doc.createElementNS("http://www.w3.org/1999/xhtml", "a");
				save_link.href = object_url;
				save_link.download = name;
				var event = doc.createEvent("MouseEvents");
				event.initMouseEvent(
					"click", true, false, view, 0, 0, 0, 0, 0
					, false, false, false, false, 0, null
				);
				save_link.dispatchEvent(event);
				filesaver.readyState = filesaver.DONE;
				dispatch_all();
				return;
			}
			// Object and web filesystem URLs have a problem saving in Google Chrome when
			// viewed in a tab, so I force save with application/octet-stream
			// http://code.google.com/p/chromium/issues/detail?id=91158
			if (view.chrome && type && type !== force_saveable_type) {
				slice = blob.slice || blob.webkitSlice;
				blob = slice.call(blob, 0, blob.size, force_saveable_type);
				blob_changed = true;
			}
			// Since I can't be sure that the guessed media type will trigger a download
			// in WebKit, I append .download to the filename.
			// https://bugs.webkit.org/show_bug.cgi?id=65440
			if (webkit_req_fs && name !== "download") {
				name += ".download";
			}
			if (type === force_saveable_type || webkit_req_fs) {
				target_view = view;
			}
			if (!req_fs) {
				fs_error();
				return;
			}
			fs_min_size += blob.size;
			req_fs(view.TEMPORARY, fs_min_size, abortable(function(fs) {
				fs.root.getDirectory("saved", create_if_not_found, abortable(function(dir) {
					var save = function() {
						dir.getFile(name, create_if_not_found, abortable(function(file) {
							file.createWriter(abortable(function(writer) {
								writer.onwriteend = function(event) {
									target_view.location.href = file.toURL();
									deletion_queue.push(file);
									filesaver.readyState = filesaver.DONE;
									dispatch(filesaver, "writeend", event);
								};
								writer.onerror = function() {
									var error = writer.error;
									if (error.code !== error.ABORT_ERR) {
										fs_error();
									}
								};
								"writestart progress write abort".split(" ").forEach(function(event) {
									writer["on" + event] = filesaver["on" + event];
								});
								writer.write(blob);
								filesaver.abort = function() {
									writer.abort();
									filesaver.readyState = filesaver.DONE;
								};
								filesaver.readyState = filesaver.WRITING;
							}), fs_error);
						}), fs_error);
					};
					dir.getFile(name, {create: false}, abortable(function(file) {
						// delete file if it already exists
						file.remove();
						save();
					}), abortable(function(ex) {
						if (ex.code === ex.NOT_FOUND_ERR) {
							save();
						} else {
							fs_error();
						}
					}));
				}), fs_error);
			}), fs_error);
		}
		, FS_proto = FileSaver.prototype
		, saveAs = function(blob, name) {
			return new FileSaver(blob, name);
		}
	;
	FS_proto.abort = function() {
		var filesaver = this;
		filesaver.readyState = filesaver.DONE;
		dispatch(filesaver, "abort");
	};
	FS_proto.readyState = FS_proto.INIT = 0;
	FS_proto.WRITING = 1;
	FS_proto.DONE = 2;

	FS_proto.error =
	FS_proto.onwritestart =
	FS_proto.onprogress =
	FS_proto.onwrite =
	FS_proto.onabort =
	FS_proto.onerror =
	FS_proto.onwriteend =
		null;

	view.addEventListener("unload", process_deletion_queue, false);
	saveAs.unload = function() {
		process_deletion_queue();
		view.removeEventListener("unload", process_deletion_queue, false);
	};
	return saveAs;
}(
	   typeof self !== "undefined" && self
	|| typeof window !== "undefined" && window
	|| this.content
));
// `self` is undefined in Firefox for Android content script context
// while `this` is nsIContentFrameMessageManager
// with an attribute `content` that corresponds to the window

if (typeof module !== "undefined" && module !== null) {
  module.exports = saveAs;
} else if ((typeof define !== "undefined" && define !== null) && (define.amd != null)) {
  define([], function() {
    return saveAs;
  });
}


/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/process_query_string.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


SYSTO.processQueryString = function(queryString) {
    var queryString1 = queryString.replace(/\+/g, ' ');
    var queryObject = ptq(queryString1);

    if (queryObject.initial && queryObject.initial.length == 1) {
        var initialModelId = queryObject.initial[0];
        SYSTO.state.initialModelId = initialModelId;
    } else {
        initialModelId = null;
    }

    var modelsFromUrl = [];
    if (queryObject.modelurl && queryObject.modelurl.length>0) {
        var modelUrls = queryObject.modelurl;   // Note: this is an array of
            // 1 *or more* model URLs
        for (var i=0; i<modelUrls.length; i++) {
            var modelUrl = modelUrls[i];
            if (modelUrl.substring(0,7) === 'http://') {
                SYSTO.loadModelFromUrl(modelUrl);
            } else {
                console.debug('\nWARNING: expected a model URL in the URL query string, '+
                    'but instead got '+modelUrl);
            }
        }
    } else {
        modelUrls = null;
    }

    if (queryObject.myexid && queryObject.myexid.length>0) {
        var myexids = queryObject.myexid;   // Note: this is an array of
            // 1 *or more* myExperiment workflow IDs.
        for (var i=0; i<myexids.length; i++) {
            var myexid = myexids[i];
            var modelUrl = 'http://www.myexperiment.org/workflows/'+myexid+'/download';
            SYSTO.loadModelFromUrl(modelUrl);
        }
    } else {
        modelUrls = null;
    }

    // Experimental bit, for passing a model in highly-compacted form in the URL query string.
    if (queryObject.compact && queryObject.compact.length==1) {
        var resultObject = SYSTO.decompress(queryObject.compact[0]);
        var modelId = 'compact';
        SYSTO.state.currentModelId = modelId;
        SYSTO.models[SYSTO.state.currentModelId] = {
            meta:{
                language:'system_dynamics',
                id:SYSTO.state.currentModelId,
                name:'noname'},
            nodes:resultObject.nodeList,
            arcs:resultObject.arcList
        };
        initialModelId = modelId;
    }

    // The URL parameter 'initial' can refer either to a Systolite 
    // built-in model, or to a model referenced using the URL parameter 'modelurl', 
    // or to a model passed in minified form.
    if (queryObject.initial && queryObject.initial.length == 1) {
        initialModelId = queryObject.initial[0];
        if (!SYSTO.models[initialModelId]) {
            console.debug('WARNING: a model with the ID "'+modelId+'" in the URL '+
                'query string does not currently exist.');
        }
    }

    return initialModelId;
};


/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/go.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


/*
 * GoJS v1.6.0-beta3 JavaScript Library for HTML Diagrams
 * Northwoods Software, http://www.nwoods.com/
 * GoJS and Northwoods Software are registered trademarks of Northwoods Software Corporation.
 * Copyright (C) 1998-2016 by Northwoods Software Corporation.  All Rights Reserved.
 * THIS SOFTWARE IS LICENSED.  THE LICENSE AGREEMENT IS AT: http://www.gojs.net/1.6.0-beta3/doc/license.html.
 */
(function(window) { var g,ea={};if(!window.document||void 0===window.document.createElement("canvas").getContext)throw window.console&&window.console.log("The HTML Canvas element is not supported in this browser,or this browser is in Compatibility mode."),Error("The HTML Canvas element is not supported in this browser,or this browser is in Compatibility mode.");if(!Object.defineProperty)throw Error("GoJS requires a newer version of JavaScript");
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),f=Math.max(8,16-(c-a)),h=window.setTimeout(function(){b(c+f)},f);a=c+f;return h});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(a){window.clearTimeout(a)})})();ea.Debug=null;
var v={fd:1,Gc:2,Tc:4,Sc:8,Um:void 0!==window.navigator&&0<window.navigator.userAgent.indexOf("534.30")&&0<window.navigator.userAgent.indexOf("Android"),OH:void 0!==window.navigator&&0<window.navigator.userAgent.indexOf("MSIE 10.0"),PH:void 0!==window.navigator&&0<window.navigator.userAgent.indexOf("Trident/7"),qK:void 0!==window.navigator&&0<window.navigator.userAgent.indexOf("Edge/"),Vm:void 0!==window.navigator&&void 0!==window.navigator.platform&&0<=window.navigator.platform.toUpperCase().indexOf("MAC"),
tE:void 0!==window.navigator&&void 0!==window.navigator.platform&&null!==window.navigator.platform.match(/(iPhone|iPod|iPad)/i),ND:function(a,b,c){var d=-1;return function(){var e=this,f=arguments;-1!==d&&v.clearTimeout(d);d=v.setTimeout(function(){d=-1;c||a.apply(e,f)},b);c&&!d&&a.apply(e,f)}},setTimeout:function(a,b){return window.setTimeout(a,b)},clearTimeout:function(a){window.clearTimeout(a)},createElement:function(a){return window.document.createElement(a)},k:function(a){throw Error(a);},I:function(a,
b){if(a.Ea){var c="The object is frozen, so its properties cannot be set: "+a.toString();void 0!==b&&(c+="  to value: "+b);v.k(c)}},C:function(a,b,c,d){a instanceof b||(c=v.getTypeName(c),void 0!==d&&(c+="."+d),v.Ad(a,b,c))},j:function(a,b,c,d){typeof a!==b&&(c=v.getTypeName(c),void 0!==d&&(c+="."+d),v.Ad(a,b,c))},Te:function(a,b,c){"number"===typeof a&&isFinite(a)||(b=v.getTypeName(b),void 0!==c&&(b+="."+c),v.k(b+" must be a real number type, and not NaN or Infinity: "+a))},qb:function(a,b,c,d){a instanceof
fa&&a.je===b||(c=v.getTypeName(c),void 0!==d&&(c+="."+d),v.Ad(a,"a constant of class "+v.nf(b),c))},QJ:function(a,b){"string"===typeof a?ga(a)||v.k('Color "'+a+'" is not a valid color string for '+b):a instanceof ha||v.k("Value for "+b+" must be a color string or a Brush, not "+a)},Ad:function(a,b,c,d){b=v.getTypeName(b);c=v.getTypeName(c);void 0!==d&&(c+="."+d);"string"===typeof a?v.k(c+" value is not an instance of "+b+': "'+a+'"'):v.k(c+" value is not an instance of "+b+": "+a)},ua:function(a,
b,c,d){c=v.getTypeName(c);void 0!==d&&(c+="."+d);v.k(c+" is not in the range "+b+": "+a)},dd:function(a){v.k(v.nf(a)+" constructor cannot take any arguments.")},Ka:function(a){v.k("Collection was modified during iteration: "+a.toString()+"\n  Perhaps you should iterate over a copy of the collection,\n  or you could collect items to be removed from the collection after the iteration.")},trace:function(a){window.console&&window.console.log(a)},Wa:function(a){return"object"===typeof a&&null!==a},isArray:function(a){return Array.isArray(a)||
a instanceof NodeList||a instanceof HTMLCollection},QH:function(a){return Array.isArray(a)},oz:function(a,b,c){v.isArray(a)||v.Ad(a,"Array or NodeList or HTMLCollection",b,c)},Va:function(a){return a.length},$k:function(a){return Array.prototype.slice.call(a)},Pa:function(a,b){Array.isArray(a);return a[b]},xD:function(a,b,c){Array.isArray(a)?a[b]=c:v.k("Cannot replace an object in an HTMLCollection or NodeList at "+b)},nz:function(a,b){if(Array.isArray(a))return a.indexOf(b);for(var c=a.length,d=
0;d<c;d++)if(a[d]===b)return d;return-1},Mi:function(a,b,c){Array.isArray(a)?b>=a.length?a.push(c):a.splice(b,0,c):v.k("Cannot insert an object into an HTMLCollection or NodeList: "+c+" at "+b)},Th:function(a,b){Array.isArray(a)?b>=a.length?a.pop():a.splice(b,1):v.k("Cannot remove an object from an HTMLCollection or NodeList at "+b)},Lx:[],M:function(){var a=v.Lx.pop();return void 0===a?new w:a},Rb:function(a,b){var c=v.Lx.pop();if(void 0===c)return new w(a,b);c.x=a;c.y=b;return c},v:function(a){v.Lx.push(a)},
$A:[],El:function(){var a=v.$A.pop();return void 0===a?new ia:a},Wj:function(a){v.$A.push(a)},Mx:[],Uf:function(){var a=v.Mx.pop();return void 0===a?new z:a},ek:function(a,b,c,d){var e=v.Mx.pop();if(void 0===e)return new z(a,b,c,d);e.x=a;e.y=b;e.width=c;e.height=d;return e},fc:function(a){v.Mx.push(a)},aB:[],nh:function(){var a=v.aB.pop();return void 0===a?new ja:a},Xe:function(a){v.aB.push(a)},Nx:null,q:function(){var a=v.Nx;return null!==a?(v.Nx=null,a):new ka},s:function(a){a.reset();v.Nx=a},ZA:[],
jb:function(){var a=v.ZA.pop();return void 0===a?[]:a},ra:function(a){a.length=0;v.ZA.push(a)},qh:Object.freeze([]),Il:1,cc:function(a){a.__gohashid=v.Il++},ht:function(a){var b=a.__gohashid;void 0===b&&(b=v.Il++,a.__gohashid=b);return b},cd:function(a){return a.__gohashid},ga:function(a,b){b.Ux=a;ea[a]=b},Ga:function(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a},Uh:function(a){a.hG=!0},defineProperty:function(a,b,c,d,e){v.j(a,"function","Util.defineProperty:classfunc");
v.j(b,"object","Util.defineProperty:propobj");v.j(c,"function","Util.defineProperty:getter");v.j(d,"function","Util.defineProperty:setter");for(var f in b){b=b[f];c={get:c,set:d};if(void 0!==e)for(var h in e)c[h]=e[h];Object.defineProperty(a.prototype,f,c);e=Object.getOwnPropertyDescriptor(a.prototype,f);b&&e&&Object.defineProperty(a.prototype,b,e);break}},rJ:!1,u:function(a,b,c,d){v.j(a,"function","Util.defineReadOnlyProperty:classfunc");v.j(b,"object","Util.defineReadOnlyProperty:propobj");v.j(c,
"function","Util.defineReadOnlyProperty:getter");for(var e in b){var f=b[e];b={get:c,set:function(a){v.k('The property "'+f+'" is read-only and cannot be set to '+a)}};if(void 0!==d)for(var h in d)b[h]=d[h];Object.defineProperty(a.prototype,e,b);d=Object.getOwnPropertyDescriptor(a.prototype,e);f&&d&&Object.defineProperty(a.prototype,f,d);break}},Jd:function(a,b){for(var c in b)b[c]=!0;a.prototype.AC=b},getTypeName:function(a){return void 0===a?"":"string"===typeof a?a:"function"===typeof a?v.nf(a):
null===a?"*":""},nf:function(a){if("function"===typeof a){if(a.Ux)return a.Ux;if(a.name)return a.name;var b=a.toString(),c=b.indexOf("("),b=b.substring(9,c).trim();if(""!==b)return a.Ux=b}else if("object"===typeof a&&a.constructor)return v.nf(a.constructor);return typeof a},p:function(a,b,c){v.j(a,"function","Util.defineEnumValue:classfunc");v.j(b,"string","Util.defineEnumValue:name");v.j(c,"number","Util.defineEnumValue:num");c=new fa(a,b,c);Object.freeze(c);a[b]=c;var d=a.fu;d instanceof ma||(d=
new ma("string",fa),a.fu=d);d.add(b,c);return c},kb:function(a,b){if(!a||!b)return null;var c=void 0;try{"function"===typeof b?c=b(a):"function"===typeof a.getAttribute?(c=a.getAttribute(b),null===c&&(c=void 0)):c=a[b]}catch(d){}return c},Ha:function(a,b,c){if(a&&b)try{"function"===typeof b?b(a,c):"function"===typeof a.setAttribute?a.setAttribute(b,c):a[b]=c}catch(d){}},Rt:function(a,b){v.j(a,"object","Setting properties requires Objects as arguments");v.j(b,"object","Setting properties requires Objects as arguments");
var c=a instanceof C,d=a instanceof E,e;for(e in b){""===e&&v.k("Setting properties requires non-empty property names");var f=a,h=e;if(c||d){var k=e.indexOf(".");if(0<k){var l=e.substring(0,k);if(c)f=a.Yd(l);else if(f=a[l],void 0===f||null===f)f=a.wb[l];v.Wa(f)?h=e.substr(k+1):v.k("Unable to find object named: "+l+" in "+a.toString()+" when trying to set property: "+e)}}if("_"!==h[0]&&!v.Lz(f,h))if(d&&"ModelChanged"===h){a.uG(b[h]);continue}else if(d&&"Changed"===h){a.zm(b[h]);continue}else if(d&&
v.Lz(a.wb,h))f=a.wb;else if(d&&na(a,h)){a.iz(h,b[h]);continue}else if(a instanceof F&&"Changed"===h){a.zm(b[h]);continue}else v.k('Trying to set undefined property "'+h+'" on object: '+f.toString());f[h]=b[e];"_"===h[0]&&(k=f.Nl,v.isArray(k)||(k=[],f.Nl=k),k.push(h))}},Lz:function(a,b){if(a.hasOwnProperty(b))return!0;for(var c=Object.getPrototypeOf(a);c&&c!==Function;){if(c.hasOwnProperty(b))return!0;var d=c.AC;if(d&&d[b])return!0;c=Object.getPrototypeOf(c)}return!1},BD:function(a,b){if(!v.Wa(b)||
b instanceof Element||b instanceof CanvasRenderingContext2D||b instanceof oa||b instanceof pa)return"";var c="",d;for(d in b)if("string"!==typeof d)""===c&&(c=b+"\n"),c+="  "+d+" is not a string property\n";else if("_"!==d.charAt(0)&&!(2>=d.length)){var e=v.kb(b,d);null===e||"function"===typeof e||v.Lz(b,d)||(""===c&&(c=b+"\n"),c+='  unknown property "'+d+'" has value: '+e+" at "+a+"\n")}return c},tw:function(a,b){if(null!==b&&"number"!==typeof b&&"string"!==typeof b&&"boolean"!==typeof b&&"function"!==
typeof b)if(void 0!==v.cd(b)){if(!v.Mv.contains(b))if(v.Mv.add(b),v.ov.add(v.BD(a,b)),b instanceof G||b instanceof H||b instanceof ma)for(var c=b.i;c.next();)v.tw(a+"["+c.key+"]",c.value);else for(c in b){var d=v.kb(b,c);if(void 0!==d&&null!==d&&v.Wa(d)&&d!==b.AC){if(b instanceof ra){if(d===b.sj)continue}else if(b instanceof C){if("data"===c||d===b.uh)continue;if("itemArray"===c||d===b.si)continue;if(b instanceof J&&d===b.Mk)continue}else if(!(b instanceof E))if(b instanceof sa){if("archetypeGroupData"===
c||d===b.Qx)continue}else if(b instanceof ua){if("archetypeLinkData"===c||d===b.Sx)continue;if("archetypeLabelNodeData"===c||d===b.Rx)continue}else if(b instanceof va){if("archetypeNodeData"===c||d===b.sk)continue}else if(b instanceof F){if("nodeDataArray"===c||d===b.kf)continue;if("linkDataArray"===c||d===b.jf||d===b.cm)continue;if(d===b.rc)continue;if(d===b.yh)continue}else if(b instanceof wa||b instanceof ya||b instanceof Aa)continue;v.tw(a+"."+c,d)}}}else if(Array.isArray(b))for(c=0;c<b.length;c++)v.tw(a+
"["+c+"]",b[c]);else v.ov.add(v.BD(a,b))},check:function(a){void 0===v.Mv?v.Mv=new H(Object):v.Mv.clear();v.ov=new Ba;v.tw("",a);a=v.ov.toString();v.ov=null;return a},BI:function(a){for(var b=[],c=0;256>c;c++)b[c]=c;for(var d=0,e=0,c=0;256>c;c++)d=(d+b[c]+119)%256,e=b[c],b[c]=b[d],b[d]=e;for(var d=c=0,f="",h=0;h<a.length;h++)c=(c+1)%256,d=(d+b[c])%256,e=b[c],b[c]=b[d],b[d]=e,f+=String.fromCharCode(a.charCodeAt(h)^b[(b[c]+b[d])%256]);return f},CH:function(a){for(var b=[],c=0;256>c;c++)b["0123456789abcdef".charAt(c>>
4)+"0123456789abcdef".charAt(c&15)]=String.fromCharCode(c);a.length%2&&(a="0"+a);for(var d=[],e=0,c=0;c<a.length;c+=2)d[e++]=b[a.substr(c,2)];a=d.join("");return""===a?"0":a},og:function(a){return v.BI(v.CH(a))},Gl:null,adym:"7da71ca0ad381e90",GG:"@COLOR1",HG:"@COLOR2"};
v.Gl=function(){var a=window.document.createElement("canvas"),b=a.getContext("2d");b[v.og("7ca11abfd022028846")]=v.og("398c3597c01238");for(var c=["5da73c80a3330d854f9e5e671d6633","32ab5ff3b26f42dc0ed90f22412913b54ae6247590da4bb21c324ba3a84e385776","54a702f3e53909c447824c6706603faf4cfb236cdfda5de14c134ba1a95a2d4c7cc6f93c1387","74bf19bce72555874c86"],d=1;5>d;d++)b[v.og("7ca11abfd7330390")](v.og(c[d-1]),10,15*d+0);b[v.og("7ca11abfd022028846")]=v.og("39f046ebb36e4b");for(d=1;5>d;d++)b[v.og("7ca11abfd7330390")](v.og(c[d-
1]),10,15*d+0);if(4!==c.length||"5"!==c[0][0]||"7"!==c[3][0])v.p=function(a,b){var c=new fa(a,b,2);Object.freeze(c);a[b]=c;var d=a.fu;d instanceof ma||(d=new ma("string",fa),a.fu=d);d.add(b,c);return c};return a}();function fa(a,b,c){v.cc(this);this.jB=a;this.Ob=b;this.mG=c}fa.prototype.toString=function(){return v.nf(this.jB)+"."+this.Ob};v.u(fa,{je:"classType"},function(){return this.jB});v.u(fa,{name:"name"},function(){return this.Ob});v.u(fa,{value:"value"},function(){return this.mG});var Da;
fa.findName=Da=function(a,b){if(void 0===b||null===b||""===b)return null;v.j(a,"function","findName:classfunc");v.j(b,"string","EnumValue.findName:name");var c=a.fu;return c instanceof ma?c.la(b):null};function Ba(){this.hB=[]}Ba.prototype.toString=function(){return this.hB.join("")};Ba.prototype.add=function(a){""!==a&&this.hB.push(a)};function pa(){}
function Fa(a){void 0===a&&(a=42);this.seed=a;this.Ex=48271;this.eu=2147483647;this.XA=this.eu/this.Ex;this.PF=this.eu%this.Ex;this.LF=1/this.eu;this.random()}Fa.prototype.random=function(){var a=this.seed%this.XA*this.Ex-this.seed/this.XA*this.PF;this.seed=0<a?a:a+this.eu;return this.seed*this.LF};function Ha(){}v.u(Ha,{i:"iterator"},function(){return this});Ha.prototype.reset=Ha.prototype.reset=function(){};Ha.prototype.next=Ha.prototype.hasNext=Ha.prototype.next=function(){return!1};
Ha.prototype.first=Ha.prototype.first=function(){return null};Ha.prototype.any=function(){return!1};Ha.prototype.all=function(){return!0};Ha.prototype.each=function(){return this};Ha.prototype.map=function(){return this};Ha.prototype.filter=function(){return this};Ha.prototype.concat=function(a){return a.i};v.u(Ha,{count:"count"},function(){return 0});Ha.prototype.xf=function(){};Ha.prototype.toString=function(){return"EmptyIterator"};var Ia=new Ha;function Ja(a){this.key=-1;this.value=a}
v.Jd(Ja,{key:!0,value:!0});v.u(Ja,{i:"iterator"},function(){return this});Ja.prototype.reset=Ja.prototype.reset=function(){this.key=-1};Ja.prototype.next=Ja.prototype.hasNext=Ja.prototype.next=function(){return-1===this.key?(this.key=0,!0):!1};Ja.prototype.first=Ja.prototype.first=function(){this.key=0;return this.value};Ja.prototype.any=function(a){this.key=-1;return a(this.value)};Ja.prototype.all=function(a){this.key=-1;return a(this.value)};
Ja.prototype.each=function(a){this.key=-1;a(this.value);return this};Ja.prototype.map=function(a){return new Ja(a(this.value))};Ja.prototype.filter=function(a){return a(this.value)?new Ja(this.value):Ia};Ja.prototype.concat=function(a){return new Ka(this,a.i)};v.u(Ja,{count:"count"},function(){return 1});Ja.prototype.xf=function(){this.value=null};Ja.prototype.toString=function(){return"SingletonIterator("+this.value+")"};function Ka(a,b){this.Ek=a;this.Fk=b;this.iu=!1}v.Jd(Ka,{key:!0,value:!0});
v.u(Ka,{i:"iterator"},function(){return this});Ka.prototype.reset=Ka.prototype.reset=function(){this.Ek.reset();this.Fk.reset();this.iu=!1};Ka.prototype.next=Ka.prototype.hasNext=Ka.prototype.next=function(){if(!this.iu){var a=this.Ek;if(a.next())return this.key=a.key,this.value=a.value,!0;this.iu=!0}return this.iu&&(a=this.Fk,a.next())?(this.key=a.key,this.value=a.value,!0):!1};Ka.prototype.first=Ka.prototype.first=function(){this.reset();return this.next()?this.value:null};
Ka.prototype.any=function(a){return this.Ek.any(a)||this.Fk.any(a)?!0:!1};Ka.prototype.all=function(a){return this.Ek.all(a)&&this.Fk.all(a)?!0:!1};Ka.prototype.each=function(a){this.Ek.each(a);this.Fk.each(a);return this};Ka.prototype.map=function(a){return new Ka(this.Ek.map(a),this.Fk.map(a))};Ka.prototype.filter=function(a){return new Ka(this.Ek.filter(a),this.Fk.filter(a))};Ka.prototype.concat=function(a){return new Ka(this,a.i)};v.u(Ka,{count:"count"},function(){return this.Ek.count+this.Fk.count});
Ka.prototype.xf=function(){this.value=this.key=null};Ka.prototype.toString=function(){return"ConcatIterator()"};function La(a){this.qc=a;this.Ih=null;this.reset()}v.Jd(La,{key:!0,value:!0});v.u(La,{i:"iterator"},function(){return this});v.defineProperty(La,{$m:"predicate"},function(){return this.Ih},function(a){this.Ih=a});La.prototype.reset=La.prototype.reset=function(){var a=this.qc;a.Wb=null;this.cb=a.F;this.Ic=-1};
La.prototype.next=La.prototype.hasNext=La.prototype.next=function(){var a=this.qc;if(a.F!==this.cb){if(0>this.key)return!1;v.Ka(a)}var a=a.n,b=a.length,c=++this.Ic,d=this.Ih;if(null!==d)for(;c<b;){var e=a[c];if(d(e))return this.key=this.Ic=c,this.value=e,!0;c++}else{if(c<b)return this.key=c,this.value=a[c],!0;this.xf()}return!1};
La.prototype.first=La.prototype.first=function(){var a=this.qc;this.cb=a.F;this.Ic=0;var a=a.n,b=a.length,c=this.Ih;if(null!==c){for(var d=0;d<b;){var e=a[d];if(c(e))return this.key=this.Ic=d,this.value=e;d++}return null}return 0<b?(e=a[0],this.key=0,this.value=e):null};La.prototype.any=function(a){var b=this.qc;b.Wb=null;var c=b.F;this.Ic=-1;for(var d=b.n,e=d.length,f=this.Ih,h=0;h<e;h++){var k=d[h];if(null===f||f(k)){if(a(k))return!0;b.F!==c&&v.Ka(b)}}return!1};
La.prototype.all=function(a){var b=this.qc;b.Wb=null;var c=b.F;this.Ic=-1;for(var d=b.n,e=d.length,f=this.Ih,h=0;h<e;h++){var k=d[h];if(null===f||f(k)){if(!a(k))return!1;b.F!==c&&v.Ka(b)}}return!0};La.prototype.each=function(a){var b=this.qc;b.Wb=null;var c=b.F;this.Ic=-1;for(var d=b.n,e=d.length,f=this.Ih,h=0;h<e;h++){var k=d[h];if(null===f||f(k))a(k),b.F!==c&&v.Ka(b)}return this};
La.prototype.map=function(a){var b=this.qc;b.Wb=null;var c=b.F;this.Ic=-1;for(var d=[],e=b.n,f=e.length,h=this.Ih,k=0;k<f;k++){var l=e[k];if(null===h||h(l))d.push(a(l)),b.F!==c&&v.Ka(b)}a=new G;a.n=d;a.wc();return a.i};La.prototype.filter=function(a){var b=this.qc;b.Wb=null;var c=b.F;this.Ic=-1;for(var d=[],e=b.n,f=e.length,h=this.Ih,k=0;k<f;k++){var l=e[k];if(null===h||h(l))a(l)&&d.push(l),b.F!==c&&v.Ka(b)}a=new G(b.ia);a.n=d;a.wc();return a.i};
La.prototype.concat=function(a){this.qc.Wb=null;return new Ka(this,a.i)};v.u(La,{count:"count"},function(){var a=this.Ih;if(null!==a){for(var b=0,c=this.qc.n,d=c.length,e=0;e<d;e++)a(c[e])&&b++;return b}return this.qc.n.length});La.prototype.xf=function(){this.key=-1;this.value=null;this.cb=-1;this.Ih=null;this.qc.Wb=this};La.prototype.toString=function(){return"ListIterator@"+this.Ic+"/"+this.qc.count};function Ma(a){this.qc=a;this.reset()}v.Jd(Ma,{key:!0,value:!0});v.u(Ma,{i:"iterator"},function(){return this});
Ma.prototype.reset=Ma.prototype.reset=function(){var a=this.qc;a.qj=null;this.cb=a.F;this.Ic=a.n.length};Ma.prototype.next=Ma.prototype.hasNext=Ma.prototype.next=function(){var a=this.qc;if(a.F!==this.cb){if(0>this.key)return!1;v.Ka(a)}var b=--this.Ic;if(0<=b)return this.key=b,this.value=a.n[b],!0;this.xf();return!1};Ma.prototype.first=Ma.prototype.first=function(){var a=this.qc;this.cb=a.F;var b=a.n;this.Ic=a=b.length-1;return 0<=a?(b=b[a],this.key=a,this.value=b):null};
Ma.prototype.any=function(a){var b=this.qc;b.qj=null;var c=b.F,d=b.n,e=d.length;this.Ic=e;for(e-=1;0<=e;e--){if(a(d[e]))return!0;b.F!==c&&v.Ka(b)}return!1};Ma.prototype.all=function(a){var b=this.qc;b.qj=null;var c=b.F,d=b.n,e=d.length;this.Ic=e;for(e-=1;0<=e;e--){if(!a(d[e]))return!1;b.F!==c&&v.Ka(b)}return!0};Ma.prototype.each=function(a){var b=this.qc;b.qj=null;var c=b.F,d=b.n,e=d.length;this.Ic=e;for(e-=1;0<=e;e--)a(d[e]),b.F!==c&&v.Ka(b);return this};
Ma.prototype.map=function(a){var b=this.qc;b.qj=null;var c=b.F,d=[],e=b.n,f=e.length;this.Ic=f;for(f-=1;0<=f;f--)d.push(a(e[f])),b.F!==c&&v.Ka(b);a=new G;a.n=d;a.wc();return a.i};Ma.prototype.filter=function(a){var b=this.qc;b.qj=null;var c=b.F,d=[],e=b.n,f=e.length;this.Ic=f;for(f-=1;0<=f;f--){var h=e[f];a(h)&&d.push(h);b.F!==c&&v.Ka(b)}a=new G(b.ia);a.n=d;a.wc();return a.i};Ma.prototype.concat=function(a){this.qc.qj=null;return new Ka(this,a.i)};v.u(Ma,{count:"count"},function(){return this.qc.n.length});
Ma.prototype.xf=function(){this.key=-1;this.value=null;this.cb=-1;this.qc.qj=this};Ma.prototype.toString=function(){return"ListIteratorBackwards("+this.Ic+"/"+this.qc.count+")"};
function G(a){v.cc(this);this.Ea=!1;this.n=[];this.F=0;this.qj=this.Wb=null;void 0===a||null===a?this.ia=null:"string"===typeof a?"object"===a||"string"===a||"number"===a||"boolean"===a||"function"===a?this.ia=a:v.ua(a,"the string 'object', 'number', 'string', 'boolean', or 'function'","List constructor: type"):"function"===typeof a?this.ia=a===Object?"object":a===String?"string":a===Number?"number":a===Boolean?"boolean":a===Function?"function":a:v.ua(a,"null, a primitive type name, or a class type",
"List constructor: type")}v.ga("List",G);G.prototype.wc=function(){var a=this.F;a++;999999999<a&&(a=0);this.F=a};G.prototype.freeze=G.prototype.freeze=function(){this.Ea=!0;return this};G.prototype.thaw=G.prototype.Na=function(){this.Ea=!1;return this};G.prototype.toString=function(){return"List("+v.getTypeName(this.ia)+")#"+v.cd(this)};G.prototype.add=G.prototype.push=G.prototype.add=function(a){null!==a&&(v.I(this,a),this.n.push(a),this.wc())};
G.prototype.addAll=G.prototype.Yc=function(a){if(null===a)return this;v.I(this);var b=this.n;if(v.isArray(a))for(var c=v.Va(a),d=0;d<c;d++){var e=v.Pa(a,d);b.push(e)}else for(a=a.i;a.next();)e=a.value,b.push(e);this.wc();return this};G.prototype.clear=G.prototype.clear=function(){v.I(this);this.n.length=0;this.wc()};G.prototype.contains=G.prototype.has=G.prototype.contains=function(a){return null===a?!1:-1!==this.n.indexOf(a)};
G.prototype.indexOf=G.prototype.indexOf=function(a){return null===a?-1:this.n.indexOf(a)};G.prototype.elt=G.prototype.get=G.prototype.ha=function(a){var b=this.n;(0>a||a>=b.length)&&v.ua(a,"0 <= i < length",G,"elt:i");return b[a]};G.prototype.setElt=G.prototype.set=G.prototype.zg=function(a,b){var c=this.n;(0>a||a>=c.length)&&v.ua(a,"0 <= i < length",G,"setElt:i");v.I(this,a);c[a]=b};G.prototype.first=G.prototype.first=function(){var a=this.n;return 0===a.length?null:a[0]};
G.prototype.last=G.prototype.Nd=function(){var a=this.n,b=a.length;return 0<b?a[b-1]:null};G.prototype.pop=G.prototype.pop=function(){v.I(this);var a=this.n;return 0<a.length?a.pop():null};G.prototype.any=function(a){for(var b=this.n,c=this.F,d=b.length,e=0;e<d;e++){if(a(b[e]))return!0;this.F!==c&&v.Ka(this)}return!1};G.prototype.all=function(a){for(var b=this.n,c=this.F,d=b.length,e=0;e<d;e++){if(!a(b[e]))return!1;this.F!==c&&v.Ka(this)}return!0};
G.prototype.each=function(a){for(var b=this.n,c=this.F,d=b.length,e=0;e<d;e++)a(b[e]),this.F!==c&&v.Ka(this);return this};G.prototype.map=function(a){for(var b=new G,c=[],d=this.n,e=this.F,f=d.length,h=0;h<f;h++)c.push(a(d[h])),this.F!==e&&v.Ka(this);b.n=c;b.wc();return b};G.prototype.filter=function(a){for(var b=new G(this.ia),c=[],d=this.n,e=this.F,f=d.length,h=0;h<f;h++){var k=d[h];a(k)&&c.push(k);this.F!==e&&v.Ka(this)}b.n=c;b.wc();return b};G.prototype.concat=function(a){return this.copy().Yc(a)};
G.prototype.insertAt=G.prototype.xd=function(a,b){0>a&&v.ua(a,">= 0",G,"insertAt:i");v.I(this,a);var c=this.n;a>=c.length?c.push(b):c.splice(a,0,b);this.wc();return!0};G.prototype.remove=G.prototype["delete"]=G.prototype.remove=function(a){if(null===a)return!1;v.I(this,a);var b=this.n;a=b.indexOf(a);if(-1===a)return!1;a===b.length-1?b.pop():b.splice(a,1);this.wc();return!0};
G.prototype.removeAt=G.prototype.Rc=function(a){var b=this.n;(0>a||a>=b.length)&&v.ua(a,"0 <= i < length",G,"removeAt:i");v.I(this,a);a===b.length-1?b.pop():b.splice(a,1);this.wc()};G.prototype.removeRange=G.prototype.removeRange=function(a,b){var c=this.n;(0>a||a>=c.length)&&v.ua(a,"0 <= from < length",G,"elt:from");(0>b||b>=c.length)&&v.ua(b,"0 <= to < length",G,"elt:to");v.I(this,a);var d=c.slice((b||a)+1||c.length);c.length=0>a?c.length+a:a;c.push.apply(c,d);this.wc()};
G.prototype.copy=function(){var a=new G(this.ia),b=this.n;0<b.length&&(a.n=Array.prototype.slice.call(b));return a};G.prototype.toArray=G.prototype.ed=function(){for(var a=this.n,b=this.count,c=Array(b),d=0;d<b;d++)c[d]=a[d];return c};G.prototype.toSet=G.prototype.wF=function(){for(var a=new H(this.ia),b=this.n,c=this.count,d=0;d<c;d++)a.add(b[d]);return a};G.prototype.sort=G.prototype.sort=function(a){v.I(this);this.n.sort(a);this.wc();return this};
G.prototype.sortRange=G.prototype.Fp=function(a,b,c){var d=this.n,e=d.length;void 0===b&&(b=0);void 0===c&&(c=e);v.I(this);var f=c-b;if(1>=f)return this;(0>b||b>=e-1)&&v.ua(b,"0 <= from < length",G,"sortRange:from");if(2===f)return c=d[b],e=d[b+1],0<a(c,e)&&(d[b]=e,d[b+1]=c,this.wc()),this;if(0===b)if(c>=e)d.sort(a);else for(f=d.slice(0,c),f.sort(a),a=0;a<c;a++)d[a]=f[a];else if(c>=e)for(f=d.slice(b),f.sort(a),a=b;a<e;a++)d[a]=f[a-b];else for(f=d.slice(b,c),f.sort(a),a=b;a<c;a++)d[a]=f[a-b];this.wc();
return this};G.prototype.reverse=G.prototype.reverse=function(){v.I(this);this.n.reverse();this.wc();return this};v.u(G,{count:"count"},function(){return this.n.length});v.u(G,{size:"size"},function(){return this.n.length});v.u(G,{length:"length"},function(){return this.n.length});v.u(G,{i:"iterator"},function(){if(0>=this.n.length)return Ia;var a=this.Wb;return null!==a?(a.reset(),a):new La(this)});
v.u(G,{Wm:"iteratorBackwards"},function(){if(0>=this.n.length)return Ia;var a=this.qj;return null!==a?(a.reset(),a):new Ma(this)});function Oa(a){this.Kh=a;this.reset()}v.Jd(Oa,{key:!0,value:!0});v.u(Oa,{i:"iterator"},function(){return this});Oa.prototype.reset=Oa.prototype.reset=function(){var a=this.Kh;a.Wb=null;this.cb=a.F;this.bb=null};
Oa.prototype.next=Oa.prototype.hasNext=Oa.prototype.next=function(){var a=this.Kh;if(a.F!==this.cb){if(null===this.key)return!1;v.Ka(a)}var b=this.bb,b=null===b?a.Aa:b.Ua;if(null!==b)return this.bb=b,this.value=b.value,this.key=b.key,!0;this.xf();return!1};Oa.prototype.first=Oa.prototype.first=function(){var a=this.Kh;this.cb=a.F;a=a.Aa;if(null!==a){this.bb=a;var b=a.value;this.key=a.key;return this.value=b}return null};
Oa.prototype.any=function(a){var b=this.Kh;b.Wb=null;var c=b.F;this.bb=null;for(var d=b.Aa;null!==d;){if(a(d.value))return!0;b.F!==c&&v.Ka(b);d=d.Ua}return!1};Oa.prototype.all=function(a){var b=this.Kh;b.Wb=null;var c=b.F;this.bb=null;for(var d=b.Aa;null!==d;){if(!a(d.value))return!1;b.F!==c&&v.Ka(b);d=d.Ua}return!0};Oa.prototype.each=function(a){var b=this.Kh;b.Wb=null;var c=b.F;this.bb=null;for(var d=b.Aa;null!==d;)a(d.value),b.F!==c&&v.Ka(b),d=d.Ua;return this};
Oa.prototype.map=function(a){var b=this.Kh;b.Wb=null;for(var c=new G,d=b.F,e=b.Aa;null!==e;)c.add(a(e.value)),b.F!==d&&v.Ka(b),e=e.Ua;return c.i};Oa.prototype.filter=function(a){var b=this.Kh;b.Wb=null;for(var c=new G(b.ia),d=b.F,e=b.Aa;null!==e;){var f=e.value;a(f)&&c.add(f);b.F!==d&&v.Ka(b);e=e.Ua}return c.i};Oa.prototype.concat=function(a){this.Kh.Wb=null;return new Ka(this,a.i)};v.u(Oa,{count:"count"},function(){return this.Kh.hd});
Oa.prototype.xf=function(){this.value=this.key=null;this.cb=-1;this.Kh.Wb=this};Oa.prototype.toString=function(){return null!==this.bb?"SetIterator@"+this.bb.value:"SetIterator"};
function H(a){v.cc(this);this.Ea=!1;void 0===a||null===a?this.ia=null:"string"===typeof a?"object"===a||"string"===a||"number"===a?this.ia=a:v.ua(a,"the string 'object', 'number' or 'string'","Set constructor: type"):"function"===typeof a?this.ia=a===Object?"object":a===String?"string":a===Number?"number":a:v.ua(a,"null, a primitive type name, or a class type","Set constructor: type");this.jd={};this.hd=0;this.Wb=null;this.F=0;this.Eh=this.Aa=null}v.ga("Set",H);
H.prototype.wc=function(){var a=this.F;a++;999999999<a&&(a=0);this.F=a};H.prototype.freeze=H.prototype.freeze=function(){this.Ea=!0;return this};H.prototype.thaw=H.prototype.Na=function(){this.Ea=!1;return this};H.prototype.toString=function(){return"Set("+v.getTypeName(this.ia)+")#"+v.cd(this)};
H.prototype.add=H.prototype.add=function(a){if(null===a)return!1;v.I(this,a);var b=a;v.Wa(a)&&(b=v.ht(a));return void 0===this.jd[b]?(this.hd++,a=new Qa(a,a),this.jd[b]=a,b=this.Eh,null===b?this.Aa=a:(a.lo=b,b.Ua=a),this.Eh=a,this.wc(),!0):!1};H.prototype.addAll=H.prototype.Yc=function(a){if(null===a)return this;v.I(this);if(v.isArray(a))for(var b=v.Va(a),c=0;c<b;c++)this.add(v.Pa(a,c));else for(a=a.i;a.next();)this.add(a.value);return this};
H.prototype.contains=H.prototype.has=H.prototype.contains=function(a){if(null===a)return!1;var b=a;return v.Wa(a)&&(b=v.cd(a),void 0===b)?!1:void 0!==this.jd[b]};H.prototype.containsAll=function(a){if(null===a)return!0;for(a=a.i;a.next();)if(!this.contains(a.value))return!1;return!0};H.prototype.containsAny=function(a){if(null===a)return!0;for(a=a.i;a.next();)if(this.contains(a.value))return!0;return!1};H.prototype.first=H.prototype.first=function(){var a=this.Aa;return null===a?null:a.value};
H.prototype.any=function(a){for(var b=this.F,c=this.Aa;null!==c;){if(a(c.value))return!0;this.F!==b&&v.Ka(this);c=c.Ua}return!1};H.prototype.all=function(a){for(var b=this.F,c=this.Aa;null!==c;){if(!a(c.value))return!1;this.F!==b&&v.Ka(this);c=c.Ua}return!0};H.prototype.each=function(a){for(var b=this.F,c=this.Aa;null!==c;)a(c.value),this.F!==b&&v.Ka(this),c=c.Ua;return this};H.prototype.map=function(a){for(var b=new H,c=this.F,d=this.Aa;null!==d;)b.add(a(d.value)),this.F!==c&&v.Ka(this),d=d.Ua;return b};
H.prototype.filter=function(a){for(var b=new H(this.ia),c=this.F,d=this.Aa;null!==d;){var e=d.value;a(e)&&b.add(e);this.F!==c&&v.Ka(this);d=d.Ua}return b};H.prototype.concat=function(a){return this.copy().Yc(a)};
H.prototype.remove=H.prototype["delete"]=H.prototype.remove=function(a){if(null===a)return!1;v.I(this,a);var b=a;if(v.Wa(a)&&(b=v.cd(a),void 0===b))return!1;a=this.jd[b];if(void 0===a)return!1;var c=a.Ua,d=a.lo;null!==c&&(c.lo=d);null!==d&&(d.Ua=c);this.Aa===a&&(this.Aa=c);this.Eh===a&&(this.Eh=d);delete this.jd[b];this.hd--;this.wc();return!0};
H.prototype.removeAll=H.prototype.tA=function(a){if(null===a)return this;v.I(this);if(v.isArray(a))for(var b=v.Va(a),c=0;c<b;c++)this.remove(v.Pa(a,c));else for(a=a.i;a.next();)this.remove(a.value);return this};H.prototype.retainAll=function(a){if(null===a||0===this.count)return this;v.I(this);var b=new H(this.ia);b.Yc(a);a=[];for(var c=this.i;c.next();){var d=c.value;b.contains(d)||a.push(d)}this.tA(a);return this};
H.prototype.clear=H.prototype.clear=function(){v.I(this);this.jd={};this.hd=0;this.Eh=this.Aa=null;this.wc()};H.prototype.copy=function(){var a=new H(this.ia),b=this.jd,c;for(c in b)a.add(b[c].value);return a};H.prototype.toArray=H.prototype.ed=function(){var a=Array(this.hd),b=this.jd,c=0,d;for(d in b)a[c]=b[d].value,c++;return a};H.prototype.toList=function(){var a=new G(this.ia),b=this.jd,c;for(c in b)a.add(b[c].value);return a};v.u(H,{count:"count"},function(){return this.hd});
v.u(H,{size:"size"},function(){return this.hd});v.u(H,{i:"iterator"},function(){if(0>=this.hd)return Ia;var a=this.Wb;return null!==a?(a.reset(),a):new Oa(this)});function Ra(a){this.Da=a;this.reset()}v.Jd(Ra,{key:!0,value:!0});v.u(Ra,{i:"iterator"},function(){return this});Ra.prototype.reset=Ra.prototype.reset=function(){this.cb=this.Da.F;this.bb=null};
Ra.prototype.next=Ra.prototype.hasNext=Ra.prototype.next=function(){var a=this.Da;if(a.F!==this.cb){if(null===this.key)return!1;v.Ka(a)}var b=this.bb,b=null===b?a.Aa:b.Ua;if(null!==b)return this.bb=b,this.value=this.key=a=b.key,!0;this.xf();return!1};Ra.prototype.first=Ra.prototype.first=function(){var a=this.Da;this.cb=a.F;a=a.Aa;return null!==a?(this.bb=a,this.value=this.key=a=a.key):null};
Ra.prototype.any=function(a){var b=this.Da,c=b.F;this.bb=null;for(var d=b.Aa;null!==d;){if(a(d.key))return!0;b.F!==c&&v.Ka(b);d=d.Ua}return!1};Ra.prototype.all=function(a){var b=this.Da,c=b.F;this.bb=null;for(var d=b.Aa;null!==d;){if(!a(d.key))return!1;b.F!==c&&v.Ka(b);d=d.Ua}return!0};Ra.prototype.each=function(a){var b=this.Da,c=b.F;this.bb=null;for(var d=b.Aa;null!==d;)a(d.key),b.F!==c&&v.Ka(b),d=d.Ua;return this};
Ra.prototype.map=function(a){var b=this.Da,c=b.F;this.bb=null;for(var d=new G,e=b.Aa;null!==e;)d.add(a(e.key)),b.F!==c&&v.Ka(b),e=e.Ua;return d.i};Ra.prototype.filter=function(a){var b=this.Da,c=b.F;this.bb=null;for(var d=new G(b.ti),e=b.Aa;null!==e;){var f=e.key;a(f)&&d.add(f);b.F!==c&&v.Ka(b);e=e.Ua}return d.i};Ra.prototype.concat=function(a){return new Ka(this,a.i)};v.u(Ra,{count:"count"},function(){return this.Da.hd});Ra.prototype.xf=function(){this.value=this.key=null;this.cb=-1};
Ra.prototype.toString=function(){return null!==this.bb?"MapKeySetIterator@"+this.bb.value:"MapKeySetIterator"};function Sa(a){v.cc(this);this.Ea=!0;this.Da=a}v.Ga(Sa,H);Sa.prototype.freeze=function(){return this};Sa.prototype.Na=function(){return this};Sa.prototype.toString=function(){return"MapKeySet("+this.Da.toString()+")"};Sa.prototype.add=Sa.prototype.set=Sa.prototype.add=function(){v.k("This Set is read-only: "+this.toString());return!1};
Sa.prototype.contains=Sa.prototype.has=Sa.prototype.contains=function(a){return this.Da.contains(a)};Sa.prototype.remove=Sa.prototype["delete"]=Sa.prototype.remove=function(){v.k("This Set is read-only: "+this.toString());return!1};Sa.prototype.clear=Sa.prototype.clear=function(){v.k("This Set is read-only: "+this.toString())};Sa.prototype.first=Sa.prototype.first=function(){var a=this.Da.Aa;return null!==a?a.key:null};
Sa.prototype.any=function(a){for(var b=this.Da.Aa;null!==b;){if(a(b.key))return!0;b=b.Ua}return!1};Sa.prototype.all=function(a){for(var b=this.Da.Aa;null!==b;){if(!a(b.key))return!1;b=b.Ua}return!0};Sa.prototype.each=function(a){for(var b=this.Da.Aa;null!==b;)a(b.key),b=b.Ua;return this};Sa.prototype.map=function(a){for(var b=new H,c=this.Da.Aa;null!==c;)b.add(a(c.key)),c=c.Ua;return b};
Sa.prototype.filter=function(a){for(var b=new H(this.Da.ti),c=this.Da.Aa;null!==c;){var d=c.key;a(d)&&b.add(d);c=c.Ua}return b};Sa.prototype.concat=function(a){return this.wF().Yc(a)};Sa.prototype.copy=function(){return new Sa(this.Da)};Sa.prototype.toSet=Sa.prototype.wF=function(){var a=new H(this.Da.ti),b=this.Da.jd,c;for(c in b)a.add(b[c].key);return a};Sa.prototype.toArray=Sa.prototype.ed=function(){var a=this.Da.jd,b=Array(this.Da.hd),c=0,d;for(d in a)b[c]=a[d].key,c++;return b};
Sa.prototype.toList=function(){var a=new G(this.ia),b=this.Da.jd,c;for(c in b)a.add(b[c].key);return a};v.u(Sa,{count:"count"},function(){return this.Da.hd});v.u(Sa,{size:"size"},function(){return this.Da.hd});v.u(Sa,{i:"iterator"},function(){return 0>=this.Da.hd?Ia:new Ra(this.Da)});function Ua(a){this.Da=a;this.reset()}v.Jd(Ua,{key:!0,value:!0});v.u(Ua,{i:"iterator"},function(){return this});Ua.prototype.reset=Ua.prototype.reset=function(){var a=this.Da;a.rj=null;this.cb=a.F;this.bb=null};
Ua.prototype.next=Ua.prototype.hasNext=Ua.prototype.next=function(){var a=this.Da;if(a.F!==this.cb){if(null===this.key)return!1;v.Ka(a)}var b=this.bb,b=null===b?a.Aa:b.Ua;if(null!==b)return this.bb=b,this.value=b.value,this.key=b.key,!0;this.xf();return!1};Ua.prototype.first=Ua.prototype.first=function(){var a=this.Da;this.cb=a.F;a=a.Aa;if(null!==a){this.bb=a;var b=a.value;this.key=a.key;return this.value=b}return null};
Ua.prototype.any=function(a){var b=this.Da;b.rj=null;var c=b.F;this.bb=null;for(var d=b.Aa;null!==d;){if(a(d.value))return!0;b.F!==c&&v.Ka(b);d=d.Ua}return!1};Ua.prototype.all=function(a){var b=this.Da;b.rj=null;var c=b.F;this.bb=null;for(var d=b.Aa;null!==d;){if(!a(d.value))return!1;b.F!==c&&v.Ka(b);d=d.Ua}return!0};Ua.prototype.each=function(a){var b=this.Da;b.rj=null;var c=b.F;this.bb=null;for(var d=b.Aa;null!==d;)a(d.value),b.F!==c&&v.Ka(b),d=d.Ua;return this};
Ua.prototype.map=function(a){var b=this.Da;b.rj=null;var c=b.F;this.bb=null;for(var d=new G,e=b.Aa;null!==e;)d.add(a(e.value)),b.F!==c&&v.Ka(b),e=e.Ua;return d.i};Ua.prototype.filter=function(a){var b=this.Da;b.rj=null;var c=b.F;this.bb=null;for(var d=new G(b.ti),e=b.Aa;null!==e;){var f=e.value;a(f)&&d.add(f);b.F!==c&&v.Ka(b);e=e.Ua}return d.i};Ua.prototype.concat=function(a){this.Da.rj=null;return new Ka(this,a.i)};v.u(Ua,{count:"count"},function(){return this.Da.hd});
Ua.prototype.xf=function(){this.value=this.key=null;this.cb=-1;this.Da.rj=this};Ua.prototype.toString=function(){return null!==this.bb?"MapValueSetIterator@"+this.bb.value:"MapValueSetIterator"};function Qa(a,b){this.key=a;this.value=b;this.lo=this.Ua=null}v.Jd(Qa,{key:!0,value:!0});Qa.prototype.toString=function(){return"{"+this.key+":"+this.value+"}"};function Va(a){this.Da=a;this.reset()}v.Jd(Va,{key:!0,value:!0});v.u(Va,{i:"iterator"},function(){return this});
Va.prototype.reset=Va.prototype.reset=function(){var a=this.Da;a.Wb=null;this.cb=a.F;this.bb=null};Va.prototype.next=Va.prototype.hasNext=Va.prototype.next=function(){var a=this.Da;if(a.F!==this.cb){if(null===this.key)return!1;v.Ka(a)}var b=this.bb,b=null===b?a.Aa:b.Ua;if(null!==b)return this.bb=b,this.key=b.key,this.value=b.value,!0;this.xf();return!1};
Va.prototype.first=Va.prototype.first=function(){var a=this.Da;this.cb=a.F;a=a.Aa;return null!==a?(this.bb=a,this.key=a.key,this.value=a.value,a):null};Va.prototype.any=function(a){var b=this.Da;b.Wb=null;var c=b.F;this.bb=null;for(var d=b.Aa;null!==d;){if(a(d))return!0;b.F!==c&&v.Ka(b);d=d.Ua}return!1};Va.prototype.all=function(a){var b=this.Da;b.Wb=null;var c=b.F;this.bb=null;for(var d=b.Aa;null!==d;){if(!a(d))return!1;b.F!==c&&v.Ka(b);d=d.Ua}return!0};
Va.prototype.each=function(a){var b=this.Da;b.Wb=null;var c=b.F;this.bb=null;for(var d=b.Aa;null!==d;)a(d),b.F!==c&&v.Ka(b),d=d.Ua;return this};Va.prototype.map=function(a){var b=this.Da;b.Wb=null;var c=b.F;this.bb=null;for(var d=new G,e=b.Aa;null!==e;)d.add(a(e)),b.F!==c&&v.Ka(b),e=e.Ua;return d.i};Va.prototype.filter=function(a){var b=this.Da;b.Wb=null;var c=b.F;this.bb=null;for(var d=new G,e=b.Aa;null!==e;)a(e)&&d.add(e),b.F!==c&&v.Ka(b),e=e.Ua;return d.i};
Va.prototype.concat=function(a){this.Da.Wb=null;return new Ka(this,a.i)};v.u(Va,{count:"count"},function(){return this.Da.hd});Va.prototype.xf=function(){this.value=this.key=null;this.cb=-1;this.Da.Wb=this};Va.prototype.toString=function(){return null!==this.bb?"MapIterator@"+this.bb:"MapIterator"};
function ma(a,b){v.cc(this);this.Ea=!1;void 0===a||null===a?this.ti=null:"string"===typeof a?"object"===a||"string"===a||"number"===a?this.ti=a:v.ua(a,"the string 'object', 'number' or 'string'","Map constructor: keytype"):"function"===typeof a?this.ti=a===Object?"object":a===String?"string":a===Number?"number":a:v.ua(a,"null, a primitive type name, or a class type","Map constructor: keytype");void 0===b||null===b?this.zs=null:"string"===typeof b?"object"===b||"string"===b||"boolean"===b||"number"===
b||"function"===b?this.zs=b:v.ua(b,"the string 'object', 'number', 'string', 'boolean', or 'function'","Map constructor: valtype"):"function"===typeof b?this.zs=b===Object?"object":b===String?"string":b===Number?"number":b===Boolean?"boolean":b===Function?"function":b:v.ua(b,"null, a primitive type name, or a class type","Map constructor: valtype");this.jd={};this.hd=0;this.rj=this.Wb=null;this.F=0;this.Eh=this.Aa=null}v.ga("Map",ma);
ma.prototype.wc=function(){var a=this.F;a++;999999999<a&&(a=0);this.F=a};ma.prototype.freeze=ma.prototype.freeze=function(){this.Ea=!0;return this};ma.prototype.thaw=ma.prototype.Na=function(){this.Ea=!1;return this};ma.prototype.toString=function(){return"Map("+v.getTypeName(this.ti)+","+v.getTypeName(this.zs)+")#"+v.cd(this)};
ma.prototype.add=ma.prototype.set=ma.prototype.add=function(a,b){v.I(this,a);var c=a;v.Wa(a)&&(c=v.ht(a));var d=this.jd[c];if(void 0===d)return this.hd++,d=new Qa(a,b),this.jd[c]=d,c=this.Eh,null===c?this.Aa=d:(d.lo=c,c.Ua=d),this.Eh=d,this.wc(),!0;d.value=b;return!1};ma.prototype.addAll=ma.prototype.Yc=function(a){if(null===a)return this;if(v.isArray(a))for(var b=v.Va(a),c=0;c<b;c++){var d=v.Pa(a,c);this.add(d.key,d.value)}else for(a=a.i;a.next();)this.add(a.key,a.value);return this};
ma.prototype.first=ma.prototype.first=function(){return this.Aa};ma.prototype.any=function(a){for(var b=this.F,c=this.Aa;null!==c;){if(a(c))return!0;this.F!==b&&v.Ka(this);c=c.Ua}return!1};ma.prototype.all=function(a){for(var b=this.F,c=this.Aa;null!==c;){if(!a(c))return!1;this.F!==b&&v.Ka(this);c=c.Ua}return!0};ma.prototype.each=function(a){for(var b=this.F,c=this.Aa;null!==c;)a(c),this.F!==b&&v.Ka(this),c=c.Ua;return this};
ma.prototype.map=function(a){for(var b=new ma(this.ti),c=this.F,d=this.Aa;null!==d;)b.add(d.key,a(d)),this.F!==c&&v.Ka(this),d=d.Ua;return b};ma.prototype.filter=function(a){for(var b=new ma(this.ti,this.zs),c=this.F,d=this.Aa;null!==d;)a(d)&&b.add(d.key,d.value),this.F!==c&&v.Ka(this),d=d.Ua;return b};ma.prototype.concat=function(a){return this.copy().Yc(a)};ma.prototype.contains=ma.prototype.has=ma.prototype.contains=function(a){var b=a;return v.Wa(a)&&(b=v.cd(a),void 0===b)?!1:void 0!==this.jd[b]};
ma.prototype.getValue=ma.prototype.get=ma.prototype.la=function(a){var b=a;if(v.Wa(a)&&(b=v.cd(a),void 0===b))return null;a=this.jd[b];return void 0===a?null:a.value};
ma.prototype.remove=ma.prototype["delete"]=ma.prototype.remove=function(a){if(null===a)return!1;v.I(this,a);var b=a;if(v.Wa(a)&&(b=v.cd(a),void 0===b))return!1;a=this.jd[b];if(void 0===a)return!1;var c=a.Ua,d=a.lo;null!==c&&(c.lo=d);null!==d&&(d.Ua=c);this.Aa===a&&(this.Aa=c);this.Eh===a&&(this.Eh=d);delete this.jd[b];this.hd--;this.wc();return!0};ma.prototype.clear=ma.prototype.clear=function(){v.I(this);this.jd={};this.hd=0;this.Eh=this.Aa=null;this.wc()};
ma.prototype.copy=function(){var a=new ma(this.ti,this.zs),b=this.jd,c;for(c in b){var d=b[c];a.add(d.key,d.value)}return a};ma.prototype.toArray=ma.prototype.ed=function(){var a=this.jd,b=Array(this.hd),c=0,d;for(d in a){var e=a[d];b[c]=new Qa(e.key,e.value);c++}return b};ma.prototype.toKeySet=ma.prototype.Yi=function(){return new Sa(this)};v.u(ma,{count:"count"},function(){return this.hd});v.u(ma,{size:"size"},function(){return this.hd});
v.u(ma,{i:"iterator"},function(){if(0>=this.count)return Ia;var a=this.Wb;return null!==a?(a.reset(),a):new Va(this)});v.u(ma,{zK:"iteratorKeys"},function(){return 0>=this.count?Ia:new Ra(this)});v.u(ma,{zE:"iteratorValues"},function(){if(0>=this.count)return Ia;var a=this.rj;return null!==a?(a.reset(),a):new Ua(this)});function w(a,b){void 0===a?this.y=this.x=0:(this.x=a,this.y=b);this.Ea=!1}v.ga("Point",w);v.Uh(w);v.Jd(w,{x:!0,y:!0});w.prototype.assign=function(a){this.x=a.x;this.y=a.y};
w.prototype.setTo=w.prototype.m=function(a,b){this.x=a;this.y=b;return this};w.prototype.set=w.prototype.set=function(a){this.I();this.x=a.x;this.y=a.y;return this};w.prototype.copy=function(){var a=new w;a.x=this.x;a.y=this.y;return a};g=w.prototype;g.Ma=function(){this.Ea=!0;Object.freeze(this);return this};g.aa=function(){return Object.isFrozen(this)?this:this.copy().freeze()};g.freeze=function(){this.Ea=!0;return this};
g.Na=function(){Object.isFrozen(this)&&v.k("cannot thaw constant: "+this);this.Ea=!1;return this};g.I=function(a){if(this.Ea){var b="The Point is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v.k(b)}};w.parse=function(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));return new w(c,e)}return new w};
w.stringify=function(a){return a instanceof w?a.x.toString()+" "+a.y.toString():a.toString()};w.prototype.toString=function(){return"Point("+this.x+","+this.y+")"};w.prototype.equals=w.prototype.L=function(a){return a instanceof w?this.x===a.x&&this.y===a.y:!1};w.prototype.equalTo=w.prototype.Bw=function(a,b){return this.x===a&&this.y===b};w.prototype.equalsApprox=w.prototype.Ie=function(a){return K.D(this.x,a.x)&&K.D(this.y,a.y)};
w.prototype.add=w.prototype.add=function(a){this.I();this.x+=a.x;this.y+=a.y;return this};w.prototype.subtract=w.prototype.Yt=function(a){this.I();this.x-=a.x;this.y-=a.y;return this};w.prototype.offset=w.prototype.offset=function(a,b){this.I();this.x+=a;this.y+=b;return this};
w.prototype.rotate=w.prototype.rotate=function(a){this.I();if(0===a)return this;var b=this.x,c=this.y;if(0===b&&0===c)return this;var d=0,e=0;360<=a?a-=360:0>a&&(a+=360);90===a?(d=0,e=1):180===a?(d=-1,e=0):270===a?(d=0,e=-1):(a=a*Math.PI/180,d=Math.cos(a),e=Math.sin(a));this.x=d*b-e*c;this.y=e*b+d*c;return this};w.prototype.scale=w.prototype.scale=function(a,b){this.x*=a;this.y*=b;return this};w.prototype.distanceSquaredPoint=w.prototype.Tj=function(a){var b=a.x-this.x;a=a.y-this.y;return b*b+a*a};
w.prototype.distanceSquared=w.prototype.Po=function(a,b){var c=a-this.x,d=b-this.y;return c*c+d*d};w.prototype.normalize=w.prototype.normalize=function(){this.I();var a=this.x,b=this.y,c=Math.sqrt(a*a+b*b);0<c&&(this.x=a/c,this.y=b/c);return this};w.prototype.directionPoint=w.prototype.Wg=function(a){return Wa(a.x-this.x,a.y-this.y)};w.prototype.direction=w.prototype.direction=function(a,b){return Wa(a-this.x,b-this.y)};
function Wa(a,b){if(0===a)return 0<b?90:0>b?270:0;if(0===b)return 0<a?0:180;if(isNaN(a)||isNaN(b))return 0;var c=180*Math.atan(Math.abs(b/a))/Math.PI;0>a?c=0>b?c+180:180-c:0>b&&(c=360-c);return c}w.prototype.projectOntoLineSegment=function(a,b,c,d){K.Ym(a,b,c,d,this.x,this.y,this);return this};w.prototype.projectOntoLineSegmentPoint=function(a,b){K.Ym(a.x,a.y,b.x,b.y,this.x,this.y,this);return this};w.prototype.snapToGrid=function(a,b,c,d){K.Xs(this.x,this.y,a,b,c,d,this);return this};
w.prototype.snapToGridPoint=function(a,b){K.Xs(this.x,this.y,a.x,a.y,b.width,b.height,this);return this};w.prototype.setRectSpot=w.prototype.St=function(a,b){this.I();this.x=a.x+b.x*a.width+b.offsetX;this.y=a.y+b.y*a.height+b.offsetY;return this};w.prototype.setSpot=w.prototype.Ut=function(a,b,c,d,e){this.I();this.x=a+e.x*c+e.offsetX;this.y=b+e.y*d+e.offsetY;return this};w.prototype.transform=function(a){a.xb(this);return this};function Xa(a,b){b.Xh(a);return a}var Ya;
w.distanceLineSegmentSquared=Ya=function(a,b,c,d,e,f){var h=e-c,k=f-d,l=h*h+k*k;c-=a;d-=b;var m=-c*h-d*k;if(0>=m||m>=l)return h=e-a,k=f-b,Math.min(c*c+d*d,h*h+k*k);a=h*d-k*c;return a*a/l};var Za;w.distanceSquared=Za=function(a,b,c,d){a=c-a;b=d-b;return a*a+b*b};var $a;w.direction=$a=function(a,b,c,d){a=c-a;b=d-b;if(0===a)return 0<b?90:0>b?270:0;if(0===b)return 0<a?0:180;if(isNaN(a)||isNaN(b))return 0;d=180*Math.atan(Math.abs(b/a))/Math.PI;0>a?d=0>b?d+180:180-d:0>b&&(d=360-d);return d};
w.prototype.isReal=w.prototype.H=function(){return isFinite(this.x)&&isFinite(this.y)};function ia(a,b){void 0===a?this.height=this.width=0:(this.width=a,this.height=b);this.Ea=!1}v.ga("Size",ia);v.Uh(ia);v.Jd(ia,{width:!0,height:!0});ia.prototype.assign=function(a){this.width=a.width;this.height=a.height};ia.prototype.setTo=ia.prototype.m=function(a,b){this.width=a;this.height=b;return this};ia.prototype.set=ia.prototype.set=function(a){this.I();this.width=a.width;this.height=a.height;return this};
ia.prototype.copy=function(){var a=new ia;a.width=this.width;a.height=this.height;return a};g=ia.prototype;g.Ma=function(){this.Ea=!0;Object.freeze(this);return this};g.aa=function(){return Object.isFrozen(this)?this:this.copy().freeze()};g.freeze=function(){this.Ea=!0;return this};g.Na=function(){Object.isFrozen(this)&&v.k("cannot thaw constant: "+this);this.Ea=!1;return this};
g.I=function(a){if(this.Ea){var b="The Size is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v.k(b)}};ia.parse=function(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));return new ia(c,e)}return new ia};ia.stringify=function(a){return a instanceof ia?a.width.toString()+" "+a.height.toString():a.toString()};
ia.prototype.toString=function(){return"Size("+this.width+","+this.height+")"};ia.prototype.equals=ia.prototype.L=function(a){return a instanceof ia?this.width===a.width&&this.height===a.height:!1};ia.prototype.equalTo=ia.prototype.Bw=function(a,b){return this.width===a&&this.height===b};ia.prototype.equalsApprox=ia.prototype.Ie=function(a){return K.D(this.width,a.width)&&K.D(this.height,a.height)};ia.prototype.isReal=ia.prototype.H=function(){return isFinite(this.width)&&isFinite(this.height)};
function z(a,b,c,d){void 0===a?this.height=this.width=this.y=this.x=0:a instanceof w?b instanceof w?(this.x=Math.min(a.x,b.x),this.y=Math.min(a.y,b.y),this.width=Math.abs(a.x-b.x),this.height=Math.abs(a.y-b.y)):b instanceof ia?(this.x=a.x,this.y=a.y,this.width=b.width,this.height=b.height):v.k("Incorrect arguments supplied to Rect constructor"):(this.x=a,this.y=b,this.width=c,this.height=d);this.Ea=!1}v.ga("Rect",z);v.Uh(z);v.Jd(z,{x:!0,y:!0,width:!0,height:!0});
z.prototype.assign=function(a){this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height};function eb(a,b,c){a.width=b;a.height=c}z.prototype.setTo=z.prototype.m=function(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d;return this};z.prototype.set=z.prototype.set=function(a){this.I();this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height;return this};z.prototype.setPoint=z.prototype.vf=function(a){this.I();this.x=a.x;this.y=a.y;return this};
z.prototype.setSize=function(a){this.I();this.width=a.width;this.height=a.height;return this};z.prototype.copy=function(){var a=new z;a.x=this.x;a.y=this.y;a.width=this.width;a.height=this.height;return a};g=z.prototype;g.Ma=function(){this.Ea=!0;Object.freeze(this);return this};g.aa=function(){return Object.isFrozen(this)?this:this.copy().freeze()};g.freeze=function(){this.Ea=!0;return this};g.Na=function(){Object.isFrozen(this)&&v.k("cannot thaw constant: "+this);this.Ea=!1;return this};
g.I=function(a){if(this.Ea){var b="The Rect is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v.k(b)}};z.parse=function(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));for(var f=0;""===a[b];)b++;(d=a[b++])&&(f=parseFloat(d));for(var h=0;""===a[b];)b++;(d=a[b++])&&(h=parseFloat(d));return new z(c,e,f,h)}return new z};
z.stringify=function(a){return a instanceof z?a.x.toString()+" "+a.y.toString()+" "+a.width.toString()+" "+a.height.toString():a.toString()};z.prototype.toString=function(){return"Rect("+this.x+","+this.y+","+this.width+","+this.height+")"};z.prototype.equals=z.prototype.L=function(a){return a instanceof z?this.x===a.x&&this.y===a.y&&this.width===a.width&&this.height===a.height:!1};z.prototype.equalTo=z.prototype.Bw=function(a,b,c,d){return this.x===a&&this.y===b&&this.width===c&&this.height===d};
z.prototype.equalsApprox=z.prototype.Ie=function(a){return K.D(this.x,a.x)&&K.D(this.y,a.y)&&K.D(this.width,a.width)&&K.D(this.height,a.height)};z.prototype.containsPoint=z.prototype.Ca=function(a){return this.x<=a.x&&this.x+this.width>=a.x&&this.y<=a.y&&this.y+this.height>=a.y};z.prototype.containsRect=z.prototype.Sj=function(a){return this.x<=a.x&&a.x+a.width<=this.x+this.width&&this.y<=a.y&&a.y+a.height<=this.y+this.height};
z.prototype.contains=z.prototype.contains=function(a,b,c,d){void 0===c&&(c=0);void 0===d&&(d=0);return this.x<=a&&a+c<=this.x+this.width&&this.y<=b&&b+d<=this.y+this.height};z.prototype.reset=function(){this.I();this.height=this.width=this.y=this.x=0};z.prototype.offset=z.prototype.offset=function(a,b){this.I();this.x+=a;this.y+=b;return this};z.prototype.inflate=z.prototype.Kf=function(a,b){return jb(this,b,a,b,a)};
z.prototype.addMargin=z.prototype.hw=function(a){return jb(this,a.top,a.right,a.bottom,a.left)};z.prototype.subtractMargin=z.prototype.cJ=function(a){return jb(this,-a.top,-a.right,-a.bottom,-a.left)};z.prototype.grow=function(a,b,c,d){return jb(this,a,b,c,d)};function jb(a,b,c,d,e){a.I();var f=a.width;c+e<=-f?(a.x+=f/2,a.width=0):(a.x-=e,a.width+=c+e);c=a.height;b+d<=-c?(a.y+=c/2,a.height=0):(a.y-=b,a.height+=b+d);return a}z.prototype.intersectRect=function(a){return pb(this,a.x,a.y,a.width,a.height)};
z.prototype.intersect=function(a,b,c,d){return pb(this,a,b,c,d)};function pb(a,b,c,d,e){a.I();var f=Math.max(a.x,b),h=Math.max(a.y,c);b=Math.min(a.x+a.width,b+d);c=Math.min(a.y+a.height,c+e);a.x=f;a.y=h;a.width=Math.max(0,b-f);a.height=Math.max(0,c-h);return a}z.prototype.intersectsRect=z.prototype.tg=function(a){return this.mE(a.x,a.y,a.width,a.height)};
z.prototype.intersects=z.prototype.mE=function(a,b,c,d){var e=this.width,f=this.x;if(Infinity!==e&&Infinity!==c&&(e+=f,c+=a,isNaN(c)||isNaN(e)||f>c||a>e))return!1;a=this.height;c=this.y;return Infinity!==a&&Infinity!==d&&(a+=c,d+=b,isNaN(d)||isNaN(a)||c>d||b>a)?!1:!0};function qb(a,b){var c=a.width,d=b.width+10+10,e=a.x,f=b.x-10;if(e>d+f||f>c+e)return!1;c=a.height;d=b.height+10+10;e=a.y;f=b.y-10;return e>d+f||f>c+e?!1:!0}z.prototype.unionPoint=z.prototype.Zi=function(a){return rb(this,a.x,a.y,0,0)};
z.prototype.unionRect=z.prototype.bi=function(a){return rb(this,a.x,a.y,a.width,a.height)};z.prototype.union=z.prototype.FF=function(a,b,c,d){this.I();void 0===c&&(c=0);void 0===d&&(d=0);return rb(this,a,b,c,d)};function rb(a,b,c,d,e){var f=Math.min(a.x,b),h=Math.min(a.y,c);b=Math.max(a.x+a.width,b+d);c=Math.max(a.y+a.height,c+e);a.x=f;a.y=h;a.width=b-f;a.height=c-h;return a}
z.prototype.setSpot=z.prototype.Ut=function(a,b,c){this.I();this.x=a-c.offsetX-c.x*this.width;this.y=b-c.offsetY-c.y*this.height;return this};var sb;z.contains=sb=function(a,b,c,d,e,f,h,k){void 0===h&&(h=0);void 0===k&&(k=0);return a<=e&&e+h<=a+c&&b<=f&&f+k<=b+d};z.intersects=function(a,b,c,d,e,f,h,k){c+=a;h+=e;if(a>h||e>c)return!1;a=d+b;k+=f;return b>k||f>a?!1:!0};v.defineProperty(z,{left:"left"},function(){return this.x},function(a){this.I(a);this.x=a});
v.defineProperty(z,{top:"top"},function(){return this.y},function(a){this.I(a);this.y=a});v.defineProperty(z,{right:"right"},function(){return this.x+this.width},function(a){this.I(a);this.x+=a-(this.x+this.width)});v.defineProperty(z,{bottom:"bottom"},function(){return this.y+this.height},function(a){this.I(a);this.y+=a-(this.y+this.height)});v.defineProperty(z,{position:"position"},function(){return new w(this.x,this.y)},function(a){this.I(a);this.x=a.x;this.y=a.y});
v.defineProperty(z,{size:"size"},function(){return new ia(this.width,this.height)},function(a){this.I(a);this.width=a.width;this.height=a.height});v.defineProperty(z,{Zk:"center"},function(){return new w(this.x+this.width/2,this.y+this.height/2)},function(a){this.I(a);this.x=a.x-this.width/2;this.y=a.y-this.height/2});v.defineProperty(z,{oa:"centerX"},function(){return this.x+this.width/2},function(a){this.I(a);this.x=a-this.width/2});
v.defineProperty(z,{va:"centerY"},function(){return this.y+this.height/2},function(a){this.I(a);this.y=a-this.height/2});z.prototype.isReal=z.prototype.H=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)};z.prototype.isEmpty=function(){return 0===this.width&&0===this.height};
function tb(a,b,c,d){void 0===a?this.left=this.bottom=this.right=this.top=0:void 0===b?this.left=this.bottom=this.right=this.top=a:void 0===c?(d=b,this.top=a,this.right=b,this.bottom=a,this.left=d):void 0!==d?(this.top=a,this.right=b,this.bottom=c,this.left=d):v.k("Invalid arguments to Margin constructor");this.Ea=!1}v.ga("Margin",tb);v.Uh(tb);v.Jd(tb,{top:!0,right:!0,bottom:!0,left:!0});tb.prototype.assign=function(a){this.top=a.top;this.right=a.right;this.bottom=a.bottom;this.left=a.left};
tb.prototype.setTo=tb.prototype.m=function(a,b,c,d){this.I();this.top=a;this.right=b;this.bottom=c;this.left=d;return this};tb.prototype.set=tb.prototype.set=function(a){this.I();this.top=a.top;this.right=a.right;this.bottom=a.bottom;this.left=a.left;return this};tb.prototype.copy=function(){var a=new tb;a.top=this.top;a.right=this.right;a.bottom=this.bottom;a.left=this.left;return a};g=tb.prototype;g.Ma=function(){this.Ea=!0;Object.freeze(this);return this};
g.aa=function(){return Object.isFrozen(this)?this:this.copy().freeze()};g.freeze=function(){this.Ea=!0;return this};g.Na=function(){Object.isFrozen(this)&&v.k("cannot thaw constant: "+this);this.Ea=!1;return this};g.I=function(a){if(this.Ea){var b="The Margin is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v.k(b)}};
tb.parse=function(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=NaN;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));if(isNaN(c))return new tb;for(var e=NaN;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));if(isNaN(e))return new tb(c);for(var f=NaN;""===a[b];)b++;(d=a[b++])&&(f=parseFloat(d));if(isNaN(f))return new tb(c,e);for(var h=NaN;""===a[b];)b++;(d=a[b++])&&(h=parseFloat(d));return isNaN(h)?new tb(c,e):new tb(c,e,f,h)}return new tb};
tb.stringify=function(a){return a instanceof tb?a.top.toString()+" "+a.right.toString()+" "+a.bottom.toString()+" "+a.left.toString():a.toString()};tb.prototype.toString=function(){return"Margin("+this.top+","+this.right+","+this.bottom+","+this.left+")"};tb.prototype.equals=tb.prototype.L=function(a){return a instanceof tb?this.top===a.top&&this.right===a.right&&this.bottom===a.bottom&&this.left===a.left:!1};
tb.prototype.equalTo=tb.prototype.Bw=function(a,b,c,d){return this.top===a&&this.right===b&&this.bottom===c&&this.left===d};tb.prototype.equalsApprox=tb.prototype.Ie=function(a){return K.D(this.top,a.top)&&K.D(this.right,a.right)&&K.D(this.bottom,a.bottom)&&K.D(this.left,a.left)};tb.prototype.isReal=tb.prototype.H=function(){return isFinite(this.top)&&isFinite(this.right)&&isFinite(this.bottom)&&isFinite(this.left)};function ja(){this.m11=1;this.m21=this.m12=0;this.m22=1;this.dy=this.dx=0}v.Uh(ja);
v.Jd(ja,{m11:!0,m12:!0,m21:!0,m22:!0,dx:!0,dy:!0});ja.prototype.set=ja.prototype.set=function(a){this.m11=a.m11;this.m12=a.m12;this.m21=a.m21;this.m22=a.m22;this.dx=a.dx;this.dy=a.dy;return this};ja.prototype.copy=function(){var a=new ja;a.m11=this.m11;a.m12=this.m12;a.m21=this.m21;a.m22=this.m22;a.dx=this.dx;a.dy=this.dy;return a};ja.prototype.toString=function(){return"Transform("+this.m11+","+this.m12+","+this.m21+","+this.m22+","+this.dx+","+this.dy+")"};
ja.prototype.equals=ja.prototype.L=function(a){return a instanceof ja?this.m11===a.m11&&this.m12===a.m12&&this.m21===a.m21&&this.m22===a.m22&&this.dx===a.dx&&this.dy===a.dy:!1};ja.prototype.isIdentity=ja.prototype.nt=function(){return 1===this.m11&&0===this.m12&&0===this.m21&&1===this.m22&&0===this.dx&&0===this.dy};ja.prototype.reset=ja.prototype.reset=function(){this.m11=1;this.m21=this.m12=0;this.m22=1;this.dy=this.dx=0;return this};
ja.prototype.multiply=ja.prototype.multiply=function(a){var b=this.m12*a.m11+this.m22*a.m12,c=this.m11*a.m21+this.m21*a.m22,d=this.m12*a.m21+this.m22*a.m22,e=this.m11*a.dx+this.m21*a.dy+this.dx,f=this.m12*a.dx+this.m22*a.dy+this.dy;this.m11=this.m11*a.m11+this.m21*a.m12;this.m12=b;this.m21=c;this.m22=d;this.dx=e;this.dy=f;return this};
ja.prototype.multiplyInverted=ja.prototype.JE=function(a){var b=1/(a.m11*a.m22-a.m12*a.m21),c=a.m22*b,d=-a.m12*b,e=-a.m21*b,f=a.m11*b,h=b*(a.m21*a.dy-a.m22*a.dx),k=b*(a.m12*a.dx-a.m11*a.dy);a=this.m12*c+this.m22*d;b=this.m11*e+this.m21*f;e=this.m12*e+this.m22*f;f=this.m11*h+this.m21*k+this.dx;h=this.m12*h+this.m22*k+this.dy;this.m11=this.m11*c+this.m21*d;this.m12=a;this.m21=b;this.m22=e;this.dx=f;this.dy=h;return this};
ja.prototype.invert=ja.prototype.Pz=function(){var a=1/(this.m11*this.m22-this.m12*this.m21),b=-this.m12*a,c=-this.m21*a,d=this.m11*a,e=a*(this.m21*this.dy-this.m22*this.dx),f=a*(this.m12*this.dx-this.m11*this.dy);this.m11=this.m22*a;this.m12=b;this.m21=c;this.m22=d;this.dx=e;this.dy=f;return this};
ja.prototype.rotate=ja.prototype.rotate=function(a,b,c){360<=a?a-=360:0>a&&(a+=360);if(0===a)return this;this.translate(b,c);var d=0,e=0;90===a?(d=0,e=1):180===a?(d=-1,e=0):270===a?(d=0,e=-1):(e=a*Math.PI/180,d=Math.cos(e),e=Math.sin(e));a=this.m12*d+this.m22*e;var f=this.m11*-e+this.m21*d,h=this.m12*-e+this.m22*d;this.m11=this.m11*d+this.m21*e;this.m12=a;this.m21=f;this.m22=h;this.translate(-b,-c);return this};
ja.prototype.translate=ja.prototype.translate=function(a,b){this.dx+=this.m11*a+this.m21*b;this.dy+=this.m12*a+this.m22*b;return this};ja.prototype.scale=ja.prototype.scale=function(a,b){void 0===b&&(b=a);this.m11*=a;this.m12*=a;this.m21*=b;this.m22*=b;return this};ja.prototype.transformPoint=ja.prototype.xb=function(a){var b=a.x,c=a.y;a.x=b*this.m11+c*this.m21+this.dx;a.y=b*this.m12+c*this.m22+this.dy;return a};
ja.prototype.invertedTransformPoint=ja.prototype.Xh=function(a){var b=1/(this.m11*this.m22-this.m12*this.m21),c=-this.m12*b,d=this.m11*b,e=b*(this.m12*this.dx-this.m11*this.dy),f=a.x,h=a.y;a.x=f*this.m22*b+h*-this.m21*b+b*(this.m21*this.dy-this.m22*this.dx);a.y=f*c+h*d+e;return a};
ja.prototype.transformRect=ja.prototype.DF=function(a){var b=a.x,c=a.y,d=b+a.width,e=c+a.height,f=this.m11,h=this.m12,k=this.m21,l=this.m22,m=this.dx,n=this.dy,p=b*f+c*k+m,q=b*h+c*l+n,r=d*f+c*k+m,c=d*h+c*l+n,s=b*f+e*k+m,b=b*h+e*l+n,f=d*f+e*k+m,d=d*h+e*l+n,e=p,h=q,p=Math.min(p,r),e=Math.max(e,r),h=Math.min(h,c),q=Math.max(q,c),p=Math.min(p,s),e=Math.max(e,s),h=Math.min(h,b),q=Math.max(q,b),p=Math.min(p,f),e=Math.max(e,f),h=Math.min(h,d),q=Math.max(q,d);a.x=p;a.y=h;a.width=e-p;a.height=q-h;return a};
function L(a,b,c,d){void 0===a?this.offsetY=this.offsetX=this.y=this.x=0:(void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),this.x=a,this.y=b,this.offsetX=c,this.offsetY=d);this.Ea=!1}v.ga("Spot",L);v.Uh(L);v.Jd(L,{x:!0,y:!0,offsetX:!0,offsetY:!0});L.prototype.assign=function(a){this.x=a.x;this.y=a.y;this.offsetX=a.offsetX;this.offsetY=a.offsetY};L.prototype.setTo=L.prototype.m=function(a,b,c,d){this.I();this.x=a;this.y=b;this.offsetX=c;this.offsetY=d;return this};
L.prototype.set=L.prototype.set=function(a){this.I();this.x=a.x;this.y=a.y;this.offsetX=a.offsetX;this.offsetY=a.offsetY;return this};L.prototype.copy=function(){var a=new L;a.x=this.x;a.y=this.y;a.offsetX=this.offsetX;a.offsetY=this.offsetY;return a};g=L.prototype;g.Ma=function(){this.Ea=!0;Object.freeze(this);return this};g.aa=function(){return Object.isFrozen(this)?this:this.copy().freeze()};g.freeze=function(){this.Ea=!0;return this};
g.Na=function(){Object.isFrozen(this)&&v.k("cannot thaw constant: "+this);this.Ea=!1;return this};g.I=function(a){if(this.Ea){var b="The Spot is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v.k(b)}};function ub(a,b){a.x=NaN;a.y=NaN;a.offsetX=b;return a}var wb;
L.parse=wb=function(a){if("string"===typeof a){a=a.trim();if("None"===a)return xb;if("TopLeft"===a)return zb;if("Top"===a||"TopCenter"===a||"MiddleTop"===a)return Ab;if("TopRight"===a)return Gb;if("Left"===a||"LeftCenter"===a||"MiddleLeft"===a)return Jb;if("Center"===a)return Kb;if("Right"===a||"RightCenter"===a||"MiddleRight"===a)return Lb;if("BottomLeft"===a)return Rb;if("Bottom"===a||"BottomCenter"===a||"MiddleBottom"===a)return Ub;if("BottomRight"===a)return Vb;if("TopSide"===a)return Wb;if("LeftSide"===
a)return Xb;if("RightSide"===a)return Yb;if("BottomSide"===a)return Zb;if("TopBottomSides"===a)return $b;if("LeftRightSides"===a)return ac;if("TopLeftSides"===a)return bc;if("TopRightSides"===a)return ic;if("BottomLeftSides"===a)return lc;if("BottomRightSides"===a)return mc;if("NotTopSide"===a)return nc;if("NotLeftSide"===a)return oc;if("NotRightSide"===a)return pc;if("NotBottomSide"===a)return wc;if("AllSides"===a)return xc;if("Default"===a)return yc;a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;
var d=a[b++];void 0!==d&&0<d.length&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;d=a[b++];void 0!==d&&0<d.length&&(e=parseFloat(d));for(var f=0;""===a[b];)b++;d=a[b++];void 0!==d&&0<d.length&&(f=parseFloat(d));for(var h=0;""===a[b];)b++;d=a[b++];void 0!==d&&0<d.length&&(h=parseFloat(d));return new L(c,e,f,h)}return new L};L.stringify=function(a){return a instanceof L?a.yd()?a.x.toString()+" "+a.y.toString()+" "+a.offsetX.toString()+" "+a.offsetY.toString():a.toString():a.toString()};
L.prototype.toString=function(){return this.yd()?0===this.offsetX&&0===this.offsetY?"Spot("+this.x+","+this.y+")":"Spot("+this.x+","+this.y+","+this.offsetX+","+this.offsetY+")":this.L(xb)?"None":this.L(zb)?"TopLeft":this.L(Ab)?"Top":this.L(Gb)?"TopRight":this.L(Jb)?"Left":this.L(Kb)?"Center":this.L(Lb)?"Right":this.L(Rb)?"BottomLeft":this.L(Ub)?"Bottom":this.L(Vb)?"BottomRight":this.L(Wb)?"TopSide":this.L(Xb)?"LeftSide":this.L(Yb)?"RightSide":this.L(Zb)?"BottomSide":this.L($b)?"TopBottomSides":this.L(ac)?
"LeftRightSides":this.L(bc)?"TopLeftSides":this.L(ic)?"TopRightSides":this.L(lc)?"BottomLeftSides":this.L(mc)?"BottomRightSides":this.L(nc)?"NotTopSide":this.L(oc)?"NotLeftSide":this.L(pc)?"NotRightSide":this.L(wc)?"NotBottomSide":this.L(xc)?"AllSides":this.L(yc)?"Default":"None"};L.prototype.equals=L.prototype.L=function(a){return a instanceof L?(this.x===a.x||isNaN(this.x)&&isNaN(a.x))&&(this.y===a.y||isNaN(this.y)&&isNaN(a.y))&&this.offsetX===a.offsetX&&this.offsetY===a.offsetY:!1};
L.prototype.opposite=function(){return new L(.5-(this.x-.5),.5-(this.y-.5),-this.offsetX,-this.offsetY)};L.prototype.includesSide=function(a){if(!this.ap()||!a.ap())return!1;a=a.offsetY;return(this.offsetY&a)===a};L.prototype.isSpot=L.prototype.yd=function(){return!isNaN(this.x)&&!isNaN(this.y)};L.prototype.isNoSpot=L.prototype.me=function(){return isNaN(this.x)||isNaN(this.y)};L.prototype.isSide=L.prototype.ap=function(){return this.me()&&1===this.offsetX&&0!==this.offsetY};
L.prototype.isDefault=L.prototype.Oc=function(){return isNaN(this.x)&&isNaN(this.y)&&-1===this.offsetX&&0===this.offsetY};var xb;L.None=xb=ub(new L(0,0,0,0),0).Ma();var yc;L.Default=yc=ub(new L(0,0,-1,0),-1).Ma();var zb;L.TopLeft=zb=(new L(0,0,0,0)).Ma();var Ab;L.TopCenter=Ab=(new L(.5,0,0,0)).Ma();var Gb;L.TopRight=Gb=(new L(1,0,0,0)).Ma();var Jb;L.LeftCenter=Jb=(new L(0,.5,0,0)).Ma();var Kb;L.Center=Kb=(new L(.5,.5,0,0)).Ma();var Lb;L.RightCenter=Lb=(new L(1,.5,0,0)).Ma();var Rb;
L.BottomLeft=Rb=(new L(0,1,0,0)).Ma();var Ub;L.BottomCenter=Ub=(new L(.5,1,0,0)).Ma();var Vb;L.BottomRight=Vb=(new L(1,1,0,0)).Ma();var zc;L.MiddleTop=zc=Ab;var Ac;L.MiddleLeft=Ac=Jb;var Bc;L.MiddleRight=Bc=Lb;var Cc;L.MiddleBottom=Cc=Ub;L.Top=Ab;L.Left=Jb;L.Right=Lb;L.Bottom=Ub;var Wb;L.TopSide=Wb=ub(new L(0,0,1,v.fd),1).Ma();var Xb;L.LeftSide=Xb=ub(new L(0,0,1,v.Gc),1).Ma();var Yb;L.RightSide=Yb=ub(new L(0,0,1,v.Tc),1).Ma();var Zb;L.BottomSide=Zb=ub(new L(0,0,1,v.Sc),1).Ma();var $b;
L.TopBottomSides=$b=ub(new L(0,0,1,v.fd|v.Sc),1).Ma();var ac;L.LeftRightSides=ac=ub(new L(0,0,1,v.Gc|v.Tc),1).Ma();var bc;L.TopLeftSides=bc=ub(new L(0,0,1,v.fd|v.Gc),1).Ma();var ic;L.TopRightSides=ic=ub(new L(0,0,1,v.fd|v.Tc),1).Ma();var lc;L.BottomLeftSides=lc=ub(new L(0,0,1,v.Sc|v.Gc),1).Ma();var mc;L.BottomRightSides=mc=ub(new L(0,0,1,v.Sc|v.Tc),1).Ma();var nc;L.NotTopSide=nc=ub(new L(0,0,1,v.Gc|v.Tc|v.Sc),1).Ma();var oc;L.NotLeftSide=oc=ub(new L(0,0,1,v.fd|v.Tc|v.Sc),1).Ma();var pc;
L.NotRightSide=pc=ub(new L(0,0,1,v.fd|v.Gc|v.Sc),1).Ma();var wc;L.NotBottomSide=wc=ub(new L(0,0,1,v.fd|v.Gc|v.Tc),1).Ma();var xc;L.AllSides=xc=ub(new L(0,0,1,v.fd|v.Gc|v.Tc|v.Sc),1).Ma();function Dc(){this.$e=[1,0,0,1,0,0]}Dc.prototype.copy=function(){var a=new Dc;a.$e[0]=this.$e[0];a.$e[1]=this.$e[1];a.$e[2]=this.$e[2];a.$e[3]=this.$e[3];a.$e[4]=this.$e[4];a.$e[5]=this.$e[5];return a};function Hc(a){this.type=a;this.r2=this.y2=this.x2=this.r1=this.y1=this.x1=0;this.ED=[]}
Hc.prototype.addColorStop=function(a,b){this.ED.push({offset:a,color:b})};
function Ic(a,b,c){this.fillStyle="#000000";this.font="10px sans-serif";this.globalAlpha=1;this.lineCap="butt";this.Xw=0;this.lineJoin="miter";this.lineWidth=1;this.miterLimit=10;this.shadowBlur=0;this.shadowColor="rgba(0, 0, 0, 0)";this.shadowOffsetY=this.shadowOffsetX=0;this.strokeStyle="#000000";this.textAlign="start";this.document=b||document;this.VD=c;this.Uw=null;this.path=[];this.Qi=new Dc;this.stack=[];this.of=[];this.zw=a;this.uI="http://www.w3.org/2000/svg";this.width=this.zw.width;this.height=
this.zw.height;this.Cl=Jc(this,"svg",{width:this.width+"px",height:this.height+"px",sL:"0 0 "+this.zw.width+" "+this.zw.height});this.Cl.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg");this.Cl.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");Kc(this,1,0,0,1,0,0);a=v.Il++;b=Jc(this,"clipPath",{id:"mainClip"+a});b.appendChild(Jc(this,"rect",{x:0,y:0,width:this.width,height:this.height}));this.Cl.appendChild(b);this.of[0].setAttributeNS(null,
"clip-path","url(#mainClip"+a+")")}g=Ic.prototype;g.arc=function(a,b,c,d,e,f){Sc(this,a,b,c,d,e,f)};g.beginPath=function(){this.path=[]};g.bezierCurveTo=function(a,b,c,d,e,f){this.path.push(["C",a,b,c,d,e,f])};g.clearRect=function(){};g.clip=function(){Tc(this,"clipPath",this.path,new Dc)};g.closePath=function(){this.path.push(["z"])};g.createLinearGradient=function(a,b,c,d){var e=new Hc("linear");e.x1=a;e.y1=b;e.x2=c;e.y2=d;return e};g.createPattern=function(){};
g.createRadialGradient=function(a,b,c,d,e,f){var h=new Hc("radial");h.x1=a;h.y1=b;h.r1=c;h.x2=d;h.y2=e;h.r2=f;return h};
g.drawImage=function(a,b,c,d,e,f,h,k,l){a=[b,c,d,e,f,h,k,l,a];b=this.Qi;e=a[8];c="";e instanceof HTMLCanvasElement&&(c=e.toDataURL());e instanceof HTMLImageElement&&(c=e.src);c={x:0,y:0,width:a[6],height:a[7],href:c};d="";f=a[6]/a[2];h=a[7]/a[3];if(0!==a[4]||0!==a[5])d+=" translate("+a[4]+", "+a[5]+")";if(1!==f||1!==h)d+=" scale("+f+", "+h+")";if(0!==a[0]||0!==a[1])d+=" translate("+-a[0]+", "+-a[1]+")";if(0!==a[0]||0!==a[1]||a[2]!==e.naturalWidth||a[3]!==e.naturalHeight)e="CLIP"+v.Il++,f=Jc(this,
"clipPath",{id:e}),f.appendChild(Jc(this,"rect",{x:a[0],y:a[1],width:a[2],height:a[3]})),this.Cl.appendChild(f),c["clip-path"]="url(#"+e+")";Uc(this,"image",c,b,d);this.addElement("image",c)};g.fill=function(){Tc(this,"fill",this.path,this.Qi)};g.fillRect=function(a,b,c,d){Vc(this,"fill",[a,b,c,d],this.Qi)};
g.fillText=function(a,b,c){a=[a,b,c];b=this.textAlign;"left"===b?b="start":"right"===b?b="end":"center"===b&&(b="middle");b={x:a[1],y:a[2],style:"font: "+this.font,"text-anchor":b};Uc(this,"fill",b,this.Qi);this.addElement("text",b,a[0])};g.lineTo=function(a,b){this.path.push(["L",a,b])};g.moveTo=function(a,b){this.path.push(["M",a,b])};g.quadraticCurveTo=function(a,b,c,d){this.path.push(["Q",a,b,c,d])};g.rect=function(a,b,c,d){this.path.push(["M",a,b],["L",a+c,b],["L",a+c,b+d],["L",a,b+d],["z"])};
g.restore=function(){this.Qi=this.stack.pop();this.path=this.stack.pop();var a=this.stack.pop();this.fillStyle=a.fillStyle;this.font=a.font;this.globalAlpha=a.globalAlpha;this.lineCap=a.lineCap;this.Xw=a.Xw;this.lineJoin=a.lineJoin;this.lineWidth=a.lineWidth;this.miterLimit=a.miterLimit;this.shadowBlur=a.shadowBlur;this.shadowColor=a.shadowColor;this.shadowOffsetX=a.shadowOffsetX;this.shadowOffsetY=a.shadowOffsetY;this.strokeStyle=a.strokeStyle;this.textAlign=a.textAlign};
g.save=function(){this.stack.push({fillStyle:this.fillStyle,font:this.font,globalAlpha:this.globalAlpha,lineCap:this.lineCap,Xw:this.Xw,lineJoin:this.lineJoin,lineWidth:this.lineWidth,miterLimit:this.miterLimit,shadowBlur:this.shadowBlur,shadowColor:this.shadowColor,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY,strokeStyle:this.strokeStyle,textAlign:this.textAlign});for(var a=[],b=0;b<this.path.length;b++)a.push(this.path[b]);this.stack.push(a);this.stack.push(this.Qi.copy())};
g.setTransform=function(a,b,c,d,e,f){1===a&&0===b&&0===c&&1===d&&0===e&&0===f||Kc(this,a,b,c,d,e,f)};g.scale=function(){};g.stroke=function(){Tc(this,"stroke",this.path,this.Qi)};g.strokeRect=function(a,b,c,d){Vc(this,"stroke",[a,b,c,d],this.Qi)};function Jc(a,b,c,d){a=a.document.createElementNS(a.uI,b);if(v.Wa(c))for(var e in c)a.setAttributeNS("href"===e?"http://www.w3.org/1999/xlink":"",e,c[e]);void 0!==d&&(a.textContent=d);return a}
g.addElement=function(a,b,c){a=Jc(this,a,b,c);0<this.of.length?this.of[this.of.length-1].appendChild(a):this.Cl.appendChild(a);return this.Uw=a};
function Uc(a,b,c,d,e){1!==a.globalAlpha&&(c.opacity=a.globalAlpha);"fill"===b?(/^rgba\(/.test(a.fillStyle)?(a=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(a.fillStyle),c.fill="rgb("+a[1]+","+a[2]+","+a[3]+")",c["fill-opacity"]=a[4]):c.fill=a.fillStyle instanceof Hc?Wc(a,a.fillStyle):a.fillStyle,c.stroke="none"):"stroke"===b&&(c.fill="none",/^rgba\(/.test(a.strokeStyle)?(b=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(a.strokeStyle),
c.stroke="rgb("+b[1]+","+b[2]+","+b[3]+")",c["stroke-opacity"]=b[4]):c.stroke=a.strokeStyle instanceof Hc?Wc(a,a.strokeStyle):a.strokeStyle,c["stroke-width"]=a.lineWidth,c["stroke-linecap"]=a.lineCap,c["stroke-linejoin"]=a.lineJoin,c["stroke-miterlimit"]=a.miterLimit);d=d.$e;d="matrix("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")";void 0!==e&&(d+=e);c.transform=d}
function Wc(a,b){var c="GRAD"+v.Il++,d;if("linear"===b.type)d={x1:b.x1,x2:b.x2,y1:b.y1,y2:b.y2,id:c,gradientUnits:"userSpaceOnUse"},d=Jc(a,"linearGradient",d);else if("radial"===b.type)d={x1:b.x1,x2:b.x2,y1:b.y1,y2:b.y2,r1:b.r1,r2:b.r2,id:c},d=Jc(a,"radialGradient",d);else throw Error("invalid gradient");for(var e=b.ED,f=e.length,h=[],k=0;k<f;k++){var l=e[k],m=l.color,l={offset:l.offset,"stop-color":m};/^rgba\(/.test(m)&&(m=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(m),
l["stop-color"]="rgb("+m[1]+","+m[2]+","+m[3]+")",l["stop-opacity"]=m[4]);h.push(l)}h.sort(function(a,b){return a.offset>b.offset?1:-1});for(k=0;k<f;k++)d.appendChild(Jc(a,"stop",h[k]));a.Cl.appendChild(d);return"url(#"+c+")"}function Vc(a,b,c,d){c={x:c[0],y:c[1],width:c[2],height:c[3]};Uc(a,b,c,d);a.addElement("rect",c)}
function Tc(a,b,c,d){for(var e=[],f=0;f<c.length;f++){var h=v.$k(c[f]),k=[h.shift()];if("A"===k[0])k.push(h.shift()+","+h.shift(),h.shift(),h.shift()+","+h.shift(),h.shift()+","+h.shift());else for(;h.length;)k.push(h.shift()+","+h.shift());e.push(k.join(" "))}c={d:e.join(" ")};Uc(a,b,c,d);"clipPath"===b?(b="CLIP"+v.Il++,d=Jc(a,"clipPath",{id:b}),d.appendChild(Jc(a,"path",c)),a.Cl.appendChild(d),0<a.of.length&&a.of[a.of.length-1].setAttributeNS(null,"clip-path","url(#"+b+")")):a.addElement("path",
c)}function Sc(a,b,c,d,e,f,h){var k=Math.abs(e-f);if(e!==f){var l=b+d*Math.cos(f);f=c+d*Math.sin(f);k>=2*Math.PI?(Sc(a,b,c,d,e,e+Math.PI,h),Sc(a,b,c,d,e+Math.PI,e+2*Math.PI,h),a.path.push(["M",l,f])):(b+=d*Math.cos(e),c+=d*Math.sin(e),k=180*k/Math.PI,e=h?0:1,h=180<=k===!!h?0:1,0!==a.path.length?a.path.push(["L",b,c]):a.path.push(["M",b,c]),a.path.push(["A",d,d,k,h,e,l,f]))}}function Kc(a,b,c,d,e,f,h){var k=new Dc;k.$e=[b,c,d,e,f,h];b={};Uc(a,"g",b,k);k=a.addElement("g",b);a.of.push(k)}
g.Ya=function(){if(0!==this.shadowOffsetX||0!==this.shadowOffsetY||0!==this.shadowBlur){var a="SHADOW"+v.Il++,b=this.addElement("filter",{id:a,x:"-100%",y:"-100%",width:"300%",height:"300%"},null),c,d,e,f,h;c=Jc(this,"feGaussianBlur",{"in":"SourceAlpha",result:"blur",iL:this.shadowBlur/2});d=Jc(this,"feFlood",{"in":"blur",result:"flood","flood-color":this.shadowColor});e=Jc(this,"feComposite",{"in":"flood",in2:"blur",operator:"in",result:"comp"});f=Jc(this,"feOffset",{"in":"comp",result:"offsetBlur",
dx:this.shadowOffsetX,dy:this.shadowOffsetY});h=Jc(this,"feMerge",{});h.appendChild(Jc(this,"feMergeNode",{"in":"offsetBlur"}));h.appendChild(Jc(this,"feMergeNode",{"in":"SourceGraphic"}));b.appendChild(c);b.appendChild(d);b.appendChild(e);b.appendChild(f);b.appendChild(h);0<this.of.length&&this.of[this.of.length-1].setAttributeNS(null,"filter","url(#"+a+")")}};
function oa(a,b){this.ownerDocument=void 0===b?document:b;var c=this.ownerDocument.createElement("canvas");c.tabIndex=0;this.Kd=c;c.getContext&&c.getContext("2d")||v.k("Browser does not support HTML Canvas Element");this.NG=c.getContext("2d");c.W=a;Object.seal(this)}g=oa.prototype;g.getContext=function(){return this.NG};g.toDataURL=function(a,b){return this.Kd.toDataURL(a,b)};g.getBoundingClientRect=function(){return this.Kd.getBoundingClientRect()};g.focus=function(){return this.Kd.focus()};
g.addEventListener=function(a,b,c){this.Kd.addEventListener(a,b,c)};g.removeEventListener=function(a,b,c){this.Kd.removeEventListener(a,b,c)};v.defineProperty(oa,{width:"width"},function(){return this.Kd.width},function(a){this.Kd.width=a});v.defineProperty(oa,{height:"height"},function(){return this.Kd.height},function(a){this.Kd.height=a});v.defineProperty(oa,{style:"style"},function(){return this.Kd.style},function(a){this.Kd.style=a});
var K={za:4*((Math.sqrt(2)-1)/3),fk:(new w(0,0)).Ma(),SF:(new z(0,0,0,0)).Ma(),Mp:(new tb(0,0,0,0)).Ma(),QF:(new tb(2,2,2,2)).Ma(),RF:(new ia(Infinity,Infinity)).Ma(),NF:(new w(-Infinity,-Infinity)).Ma(),MF:(new w(Infinity,Infinity)).Ma(),Np:(new ia(0,0)).Ma(),Ix:(new ia(1,1)).Ma(),Lp:(new ia(6,6)).Ma(),Fx:(new ia(8,8)).Ma(),OF:(new w(NaN,NaN)).Ma(),Jx:new pa,aj:new pa,YA:null,sqrt:function(a){if(0>=a)return 0;var b=K.YA;if(null===b){for(var b=[],c=0;2E3>=c;c++)b[c]=Math.sqrt(c);K.YA=b}return 1>a?
(c=1/a,2E3>=c?1/b[c|0]:Math.sqrt(a)):2E3>=a?b[a|0]:Math.sqrt(a)},D:function(a,b){var c=a-b;return.5>c&&-.5<c},sb:function(a,b){var c=a-b;return 5E-8>c&&-5E-8<c},zd:function(a,b,c,d,e,f,h){0>=e&&(e=1E-6);var k=0,l=0,m=0,n=0;a<c?(l=a,k=c):(l=c,k=a);b<d?(n=b,m=d):(n=d,m=b);if(a===c)return n<=h&&h<=m&&a-e<=f&&f<=a+e;if(b===d)return l<=f&&f<=k&&b-e<=h&&h<=b+e;k+=e;l-=e;if(l<=f&&f<=k&&(m+=e,n-=e,n<=h&&h<=m))if(k-l>m-n)if(a-c>e||c-a>e){if(f=(d-b)/(c-a)*(f-a)+b,f-e<=h&&h<=f+e)return!0}else return!0;else if(b-
d>e||d-b>e){if(h=(c-a)/(d-b)*(h-b)+a,h-e<=f&&f<=h+e)return!0}else return!0;return!1},rw:function(a,b,c,d,e,f,h,k,l,m,n,p){if(K.zd(a,b,h,k,p,c,d)&&K.zd(a,b,h,k,p,e,f))return K.zd(a,b,h,k,p,m,n);var q=(a+c)/2,r=(b+d)/2,s=(c+e)/2,t=(d+f)/2;e=(e+h)/2;f=(f+k)/2;d=(q+s)/2;c=(r+t)/2;var s=(s+e)/2,t=(t+f)/2,u=(d+s)/2,x=(c+t)/2;return K.rw(a,b,q,r,d,c,u,x,l,m,n,p)||K.rw(u,x,s,t,e,f,h,k,l,m,n,p)},DG:function(a,b,c,d,e,f,h,k,l){var m=(c+e)/2,n=(d+f)/2;l.x=(((a+c)/2+m)/2+(m+(e+h)/2)/2)/2;l.y=(((b+d)/2+n)/2+(n+
(f+k)/2)/2)/2;return l},CG:function(a,b,c,d,e,f,h,k){var l=(c+e)/2,m=(d+f)/2;return $a(((a+c)/2+l)/2,((b+d)/2+m)/2,(l+(e+h)/2)/2,(m+(f+k)/2)/2)},Fo:function(a,b,c,d,e,f,h,k,l,m){if(K.zd(a,b,h,k,l,c,d)&&K.zd(a,b,h,k,l,e,f))rb(m,a,b,0,0),rb(m,h,k,0,0);else{var n=(a+c)/2,p=(b+d)/2,q=(c+e)/2,r=(d+f)/2;e=(e+h)/2;f=(f+k)/2;d=(n+q)/2;c=(p+r)/2;var q=(q+e)/2,r=(r+f)/2,s=(d+q)/2,t=(c+r)/2;K.Fo(a,b,n,p,d,c,s,t,l,m);K.Fo(s,t,q,r,e,f,h,k,l,m)}return m},De:function(a,b,c,d,e,f,h,k,l,m){if(K.zd(a,b,h,k,l,c,d)&&
K.zd(a,b,h,k,l,e,f))0===m.length&&(m.push(a),m.push(b)),m.push(h),m.push(k);else{var n=(a+c)/2,p=(b+d)/2,q=(c+e)/2,r=(d+f)/2;e=(e+h)/2;f=(f+k)/2;d=(n+q)/2;c=(p+r)/2;var q=(q+e)/2,r=(r+f)/2,s=(d+q)/2,t=(c+r)/2;K.De(a,b,n,p,d,c,s,t,l,m);K.De(s,t,q,r,e,f,h,k,l,m)}return m},mA:function(a,b,c,d,e,f,h,k,l,m){if(K.zd(a,b,e,f,m,c,d))return K.zd(a,b,e,f,m,k,l);var n=(a+c)/2,p=(b+d)/2;c=(c+e)/2;d=(d+f)/2;var q=(n+c)/2,r=(p+d)/2;return K.mA(a,b,n,p,q,r,h,k,l,m)||K.mA(q,r,c,d,e,f,h,k,l,m)},aL:function(a,b,c,
d,e,f,h){h.x=((a+c)/2+(c+e)/2)/2;h.y=((b+d)/2+(d+f)/2)/2;return h},lA:function(a,b,c,d,e,f,h,k){if(K.zd(a,b,e,f,h,c,d))rb(k,a,b,0,0),rb(k,e,f,0,0);else{var l=(a+c)/2,m=(b+d)/2;c=(c+e)/2;d=(d+f)/2;var n=(l+c)/2,p=(m+d)/2;K.lA(a,b,l,m,n,p,h,k);K.lA(n,p,c,d,e,f,h,k)}return k},rp:function(a,b,c,d,e,f,h,k){if(K.zd(a,b,e,f,h,c,d))0===k.length&&(k.push(a),k.push(b)),k.push(e),k.push(f);else{var l=(a+c)/2,m=(b+d)/2;c=(c+e)/2;d=(d+f)/2;var n=(l+c)/2,p=(m+d)/2;K.rp(a,b,l,m,n,p,h,k);K.rp(n,p,c,d,e,f,h,k)}return k},
Ms:function(a,b,c,d,e,f,h,k,l,m,n,p,q,r){0>=q&&(q=1E-6);if(K.zd(a,b,h,k,q,c,d)&&K.zd(a,b,h,k,q,e,f)){var s=(a-h)*(m-p)-(b-k)*(l-n);if(0===s)return!1;q=((a*k-b*h)*(l-n)-(a-h)*(l*p-m*n))/s;s=((a*k-b*h)*(m-p)-(b-k)*(l*p-m*n))/s;if((l>n?l-n:n-l)<(m>p?m-p:p-m)){if(h=l=0,b<k?(l=b,h=k):(l=k,h=b),s<l||s>h)return!1}else if(a<h?l=a:(l=h,h=a),q<l||q>h)return!1;r.x=q;r.y=s;return!0}var s=(a+c)/2,t=(b+d)/2;c=(c+e)/2;d=(d+f)/2;e=(e+h)/2;f=(f+k)/2;var u=(s+c)/2,x=(t+d)/2;c=(c+e)/2;d=(d+f)/2;var y=(u+c)/2,A=(x+d)/
2,B=(n-l)*(n-l)+(p-m)*(p-m),I=!1;K.Ms(a,b,s,t,u,x,y,A,l,m,n,p,q,r)&&(b=(r.x-l)*(r.x-l)+(r.y-m)*(r.y-m),b<B&&(B=b,I=!0));a=r.x;s=r.y;K.Ms(y,A,c,d,e,f,h,k,l,m,n,p,q,r)&&(b=(r.x-l)*(r.x-l)+(r.y-m)*(r.y-m),b<B?I=!0:(r.x=a,r.y=s));return I},Ns:function(a,b,c,d,e,f,h,k,l,m,n,p,q){var r=0;0>=q&&(q=1E-6);if(K.zd(a,b,h,k,q,c,d)&&K.zd(a,b,h,k,q,e,f)){q=(a-h)*(m-p)-(b-k)*(l-n);if(0===q)return r;var s=((a*k-b*h)*(l-n)-(a-h)*(l*p-m*n))/q,t=((a*k-b*h)*(m-p)-(b-k)*(l*p-m*n))/q;if(s>=n)return r;if((l>n?l-n:n-l)<
(m>p?m-p:p-m)){if(a=l=0,b<k?(l=b,a=k):(l=k,a=b),t<l||t>a)return r}else if(a<h?(l=a,a=h):l=h,s<l||s>a)return r;0<q?r++:0>q&&r--}else{var s=(a+c)/2,t=(b+d)/2,u=(c+e)/2,x=(d+f)/2;e=(e+h)/2;f=(f+k)/2;d=(s+u)/2;c=(t+x)/2;var u=(u+e)/2,x=(x+f)/2,y=(d+u)/2,A=(c+x)/2,r=r+K.Ns(a,b,s,t,d,c,y,A,l,m,n,p,q),r=r+K.Ns(y,A,u,x,e,f,h,k,l,m,n,p,q)}return r},Ym:function(a,b,c,d,e,f,h){if(K.sb(a,c)){var k=0;c=0;b<d?(k=b,c=d):(k=d,c=b);d=f;if(d<k)return h.x=a,h.y=k,!1;if(d>c)return h.x=a,h.y=c,!1;h.x=a;h.y=d;return!0}if(K.sb(b,
d)){a<c?k=a:(k=c,c=a);d=e;if(d<k)return h.x=k,h.y=b,!1;if(d>c)return h.x=c,h.y=b,!1;h.x=d;h.y=b;return!0}k=((a-e)*(a-c)+(b-f)*(b-d))/((c-a)*(c-a)+(d-b)*(d-b));if(-5E-6>k)return h.x=a,h.y=b,!1;if(1.000005<k)return h.x=c,h.y=d,!1;h.x=a+k*(c-a);h.y=b+k*(d-b);return!0},bh:function(a,b,c,d,e,f,h,k,l){if(K.D(a,c)&&K.D(b,d))return l.x=a,l.y=b,!1;if(K.sb(e,h)){if(K.sb(a,c))return K.Ym(a,b,c,d,e,f,l),!1;f=(d-b)/(c-a)*(e-a)+b;return K.Ym(a,b,c,d,e,f,l)}k=(k-f)/(h-e);if(K.sb(a,c)){f=k*(a-e)+f;c=h=0;b<d?(h=b,
c=d):(h=d,c=b);if(f<h)return l.x=a,l.y=h,!1;if(f>c)return l.x=a,l.y=c,!1;l.x=a;l.y=f;return!0}h=(d-b)/(c-a);if(K.sb(k,h))return K.Ym(a,b,c,d,e,f,l),!1;e=(h*a-k*e+f-b)/(h-k);if(K.sb(h,0)){a<c?h=a:(h=c,c=a);if(e<h)return l.x=h,l.y=b,!1;if(e>c)return l.x=c,l.y=b,!1;l.x=e;l.y=b;return!0}f=h*(e-a)+b;return K.Ym(a,b,c,d,e,f,l)},BK:function(a,b,c,d,e){return K.bh(c.x,c.y,d.x,d.y,a.x,a.y,b.x,b.y,e)},kK:function(a,b,c,d,e,f,h,k,l,m){function n(c,d){var e=(c-a)*(c-a)+(d-b)*(d-b);e<p&&(p=e,l.x=c,l.y=d)}var p=
Infinity;n(l.x,l.y);var q=0,r=0,s=0,t=0;e<h?(q=e,r=h):(q=h,r=e);f<k?(s=e,t=h):(s=h,t=e);q=(r-q)/2+m;m=(t-s)/2+m;e=(e+h)/2;f=(f+k)/2;if(0===q||0===m)return l;if(.5>(c>a?c-a:a-c)){q=1-(c-e)*(c-e)/(q*q);if(0>q)return l;q=Math.sqrt(q);d=-m*q+f;n(c,m*q+f);n(c,d)}else{c=(d-b)/(c-a);d=1/(q*q)+c*c/(m*m);k=2*c*(b-c*a)/(m*m)-2*c*f/(m*m)-2*e/(q*q);q=k*k-4*d*(2*c*a*f/(m*m)-2*b*f/(m*m)+f*f/(m*m)+e*e/(q*q)-1+(b-c*a)*(b-c*a)/(m*m));if(0>q)return l;q=Math.sqrt(q);m=(-k+q)/(2*d);n(m,c*m-c*a+b);q=(-k-q)/(2*d);n(q,
c*q-c*a+b)}return l},ml:function(a,b,c,d,e,f,h,k,l){var m=1E21,n=a,p=b;if(K.bh(a,b,a,d,e,f,h,k,l)){var q=(l.x-e)*(l.x-e)+(l.y-f)*(l.y-f);q<m&&(m=q,n=l.x,p=l.y)}K.bh(c,b,c,d,e,f,h,k,l)&&(q=(l.x-e)*(l.x-e)+(l.y-f)*(l.y-f),q<m&&(m=q,n=l.x,p=l.y));K.bh(a,b,c,b,e,f,h,k,l)&&(q=(l.x-e)*(l.x-e)+(l.y-f)*(l.y-f),q<m&&(m=q,n=l.x,p=l.y));K.bh(a,d,c,d,e,f,h,k,l)&&(q=(l.x-e)*(l.x-e)+(l.y-f)*(l.y-f),q<m&&(m=q,n=l.x,p=l.y));l.x=n;l.y=p;return 1E21>m},Mw:function(a,b,c){var d=b.x,e=b.y,f=c.x,h=c.y,k=a.left,l=a.right,
m=a.top,n=a.bottom;return d===f?(f=a=0,e<h?(a=e,f=h):(a=h,f=e),k<=d&&d<=l&&a<=n&&f>=m):e===h?(d<f?a=d:(a=f,f=d),m<=e&&e<=n&&a<=l&&f>=k):a.Ca(b)||a.Ca(c)||K.Lw(k,m,l,m,d,e,f,h)||K.Lw(l,m,l,n,d,e,f,h)||K.Lw(l,n,k,n,d,e,f,h)||K.Lw(k,n,k,m,d,e,f,h)?!0:!1},Lw:function(a,b,c,d,e,f,h,k){return 0>=K.vw(a,b,c,d,e,f)*K.vw(a,b,c,d,h,k)&&0>=K.vw(e,f,h,k,a,b)*K.vw(e,f,h,k,c,d)},vw:function(a,b,c,d,e,f){c-=a;d-=b;a=e-a;b=f-b;f=a*d-b*c;0===f&&(f=a*c+b*d,0<f&&(f=(a-c)*c+(b-d)*d,0>f&&(f=0)));return 0>f?-1:0<f?1:0},
Et:function(a){0>a&&(a+=360);360<=a&&(a-=360);return a},MD:function(a,b,c,d,e,f){var h=Math.PI;f||(d*=h/180,e*=h/180);f=d<e?1:-1;var k=[],l=h/2,m=d;for(d=Math.min(2*h,Math.abs(e-d));1E-5<d;)e=m+f*Math.min(d,l),k.push(K.TG(c,m,e,a,b)),d-=Math.abs(e-m),m=e;return k},TG:function(a,b,c,d,e){var f=(c-b)/2,h=a*Math.cos(f),k=a*Math.sin(f),l=-k,m=h*h+l*l,n=m+h*h+l*k,m=4/3*(Math.sqrt(2*m*n)-n)/(h*k-l*h),k=h-m*l,h=l+m*h,l=-h,m=f+b,f=Math.cos(m),m=Math.sin(m);return[d+a*Math.cos(b),e+a*Math.sin(b),d+k*f-h*m,
e+k*m+h*f,d+k*f-l*m,e+k*m+l*f,d+a*Math.cos(c),e+a*Math.sin(c)]},Xs:function(a,b,c,d,e,f,h){c=Math.floor((a-c)/e)*e+c;d=Math.floor((b-d)/f)*f+d;var k=c;c+e-a<e/2&&(k=c+e);a=d;d+f-b<f/2&&(a=d+f);h.m(k,a);return h},eE:function(a,b){var c=Math.max(a,b),d=Math.min(a,b),e=1,f=1;do e=c%d,c=f=d,d=e;while(0<e);return f},bH:function(a,b,c,d){var e=0>c,f=0>d,h=0,k=h=0;a<b?(h=1,k=0):(h=0,k=1);var l=0,m=0,n=0,l=0===h?a:b,m=0===h?c:d;if(0===h?e:f)m=-m;h=k;n=0===h?c:d;if(0===h?e:f)n=-n;return K.cH(l,0===h?a:b,m,
n,0,0)},cH:function(a,b,c,d,e,f){e=0;if(0<d)if(0<c){f=a*a;e=b*b;a*=c;var h=b*d,k=-e+h,l=-e+Math.sqrt(a*a+h*h);b=k;for(var m=0;9999999999>m;++m){b=.5*(k+l);if(b===k||b===l)break;var n=a/(b+f),p=h/(b+e),n=n*n+p*p-1;if(0<n)k=b;else if(0>n)l=b;else break}c=f*c/(b+f)-c;d=e*d/(b+e)-d;e=Math.sqrt(c*c+d*d)}else e=Math.abs(d-b);else d=a*a-b*b,e=a*c,e<d?(d=e/d,e=a*d,f=b*Math.sqrt(Math.abs(1-d*d)),c=e-c,e=Math.sqrt(c*c+f*f)):e=Math.abs(c-a);return e}};
function Xc(a){1<arguments.length&&v.k("Geometry constructor can take at most one optional argument, the Geometry type.");v.cc(this);this.Ea=!1;void 0===a&&(a=cd);this.ia=a;this.Db=this.yb=this.xc=this.tc=0;this.hj=new G(dd);this.Pu=this.hj.F;this.Au=(new z).freeze();this.Za=!0;this.Fi=zb;this.Gi=Vb;this.Tn=this.Vn=NaN;this.mi=ed}v.ga("Geometry",Xc);v.Uh(Xc);
Xc.prototype.copy=function(){var a=new Xc;a.ia=this.ia;a.tc=this.tc;a.xc=this.xc;a.yb=this.yb;a.Db=this.Db;for(var b=this.hj.n,c=b.length,d=a.hj,e=0;e<c;e++){var f=b[e].copy();d.add(f)}a.Pu=this.Pu;a.Au.assign(this.Au);a.Za=this.Za;a.Fi=this.Fi.aa();a.Gi=this.Gi.aa();a.Vn=this.Vn;a.Tn=this.Tn;a.mi=this.mi;return a};var fd;Xc.Line=fd=v.p(Xc,"Line",0);var gd;Xc.Rectangle=gd=v.p(Xc,"Rectangle",1);var hd;Xc.Ellipse=hd=v.p(Xc,"Ellipse",2);var cd;Xc.Path=cd=v.p(Xc,"Path",3);
Xc.prototype.Ma=function(){this.freeze();Object.freeze(this);return this};Xc.prototype.freeze=function(){this.Ea=!0;var a=this.Ub;a.freeze();for(var a=a.n,b=a.length,c=0;c<b;c++)a[c].freeze();return this};Xc.prototype.Na=function(){Object.isFrozen(this)&&v.k("cannot thaw constant: "+this);this.Ea=!1;var a=this.Ub;a.Na();for(var a=a.n,b=a.length,c=0;c<b;c++)a[c].Na();return this};
Xc.prototype.equalsApprox=Xc.prototype.Ie=function(a){if(!(a instanceof Xc))return!1;if(this.type!==a.type)return this.type===fd&&a.type===cd?rd(this,a):a.type===fd&&this.type===cd?rd(a,this):!1;if(this.type===cd){var b=this.Ub.n;a=a.Ub.n;var c=b.length;if(c!==a.length)return!1;for(var d=0;d<c;d++)if(!b[d].Ie(a[d]))return!1;return!0}return K.D(this.Ia,a.Ia)&&K.D(this.Ja,a.Ja)&&K.D(this.J,a.J)&&K.D(this.K,a.K)};
function rd(a,b){if(a.type!==fd||b.type!==cd)return!1;if(1===b.Ub.count){var c=b.Ub.ha(0);if(1===c.vb.count&&K.D(a.Ia,c.Ia)&&K.D(a.Ja,c.Ja)&&(c=c.vb.ha(0),c.type===sd&&K.D(a.J,c.J)&&K.D(a.K,c.K)))return!0}return!1}var td;Xc.stringify=td=function(a){return a.toString()};
Xc.prototype.toString=function(a){void 0===a&&(a=-1);switch(this.type){case fd:return 0>a?"M"+this.Ia.toString()+" "+this.Ja.toString()+"L"+this.J.toString()+" "+this.K.toString():"M"+this.Ia.toFixed(a)+" "+this.Ja.toFixed(a)+"L"+this.J.toFixed(a)+" "+this.K.toFixed(a);case gd:var b=new z(this.Ia,this.Ja,0,0);b.FF(this.J,this.K,0,0);return 0>a?"M"+b.x.toString()+" "+b.y.toString()+"H"+b.right.toString()+"V"+b.bottom.toString()+"H"+b.left.toString()+"z":"M"+b.x.toFixed(a)+" "+b.y.toFixed(a)+"H"+b.right.toFixed(a)+
"V"+b.bottom.toFixed(a)+"H"+b.left.toFixed(a)+"z";case hd:b=new z(this.Ia,this.Ja,0,0);b.FF(this.J,this.K,0,0);if(0>a){var c=b.left.toString()+" "+(b.y+b.height/2).toString(),d=b.right.toString()+" "+(b.y+b.height/2).toString();return"M"+c+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+d+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+c}c=b.left.toFixed(a)+" "+(b.y+b.height/2).toFixed(a);d=b.right.toFixed(a)+" "+(b.y+b.height/2).toFixed(a);return"M"+c+"A"+(b.width/
2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+d+"A"+(b.width/2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+c;case cd:for(var b="",c=this.Ub.n,d=c.length,e=0;e<d;e++){var f=c[e];0<e&&(b+=" x ");f.mt&&(b+="F ");b+=f.toString(a)}return b;default:return this.type.toString()}};
Xc.fillPath=function(a){"string"!==typeof a&&v.Ad(a,"string",Xc,"fillPath:str");a=a.split(/[Xx]/);for(var b=a.length,c="",d=0;d<b;d++)var e=a[d],c=null!==e.match(/[Ff]/)?0===d?c+e:c+("X"+(" "===e[0]?"":" ")+e):c+((0===d?"":"X ")+"F"+(" "===e[0]?"":" ")+e);return c};var ud;
Xc.parse=ud=function(a,b){function c(){return m>=t-1?!0:null!==l[m+1].match(/[A-Za-z]/)}function d(){m++;return l[m]}function e(){var a=new w(parseFloat(d()),parseFloat(d()));n===n.toLowerCase()&&(a.x=s.x+a.x,a.y=s.y+a.y);return a}function f(){return s=e()}function h(){return r=e()}function k(){return"c"!==p.toLowerCase()&&"s"!==p.toLowerCase()?s:new w(2*s.x-r.x,2*s.y-r.y)}void 0===b&&(b=!1);"string"!==typeof a&&v.Ad(a,"string",Xc,"parse:str");a=a.replace(/,/gm," ");a=a.replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFf])([UuBbMmZzLlHhVvCcSsQqTtAaFf])/gm,
"$1 $2");a=a.replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFf])([UuBbMmZzLlHhVvCcSsQqTtAaFf])/gm,"$1 $2");a=a.replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFf])([^\s])/gm,"$1 $2");a=a.replace(/([^\s])([UuBbMmZzLlHhVvCcSsQqTtAaFf])/gm,"$1 $2");a=a.replace(/([0-9])([+\-])/gm,"$1 $2");a=a.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");a=a.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");a=a.replace(/[\s\r\t\n]+/gm," ");a=a.replace(/^\s+|\s+$/g,"");for(var l=a.split(" "),m=-1,n="",p="",q=new w(0,0),r=new w(0,0),s=new w(0,
0),t=l.length,u=v.q(),x=!1,y=!1,A=!0;!(m>=t-1);)if(p=n,n=d(),""!==n)switch(n.toUpperCase()){case "X":A=!0;y=x=!1;break;case "M":var B=f();null===u.Sb||!0===A?(M(u,B.x,B.y,x,!1,!y),A=!1):u.moveTo(B.x,B.y);for(q=s;!c();)B=f(),u.lineTo(B.x,B.y);break;case "L":for(;!c();)B=f(),u.lineTo(B.x,B.y);break;case "H":for(;!c();)s=B=new w((n===n.toLowerCase()?s.x:0)+parseFloat(d()),s.y),u.lineTo(s.x,s.y);break;case "V":for(;!c();)s=B=new w(s.x,(n===n.toLowerCase()?s.y:0)+parseFloat(d())),u.lineTo(s.x,s.y);break;
case "C":for(;!c();){var I=e(),D=h(),B=f();O(u,I.x,I.y,D.x,D.y,B.x,B.y)}break;case "S":for(;!c();)I=k(),D=h(),B=f(),O(u,I.x,I.y,D.x,D.y,B.x,B.y);break;case "Q":for(;!c();)D=h(),B=f(),vd(u,D.x,D.y,B.x,B.y);break;case "T":for(;!c();)r=D=k(),B=f(),vd(u,D.x,D.y,B.x,B.y);break;case "B":for(;!c();){var B=parseFloat(d()),I=parseFloat(d()),D=parseFloat(d()),V=parseFloat(d()),ba=parseFloat(d()),U=ba,N=!1;c()||(U=parseFloat(d()),c()||(N=0!==parseFloat(d())));n===n.toLowerCase()&&(D+=s.x,V+=s.y);u.arcTo(B,I,
D,V,ba,U,N)}break;case "A":for(;!c();)I=Math.abs(parseFloat(d())),D=Math.abs(parseFloat(d())),V=parseFloat(d()),ba=!!parseFloat(d()),U=!!parseFloat(d()),B=f(),wd(u,I,D,V,ba,U,B.x,B.y);break;case "Z":B=u.o.Ub.n[u.o.Ub.length-1];P(u);s=q;break;case "F":B="";for(I=1;l[m+I];)if(null!==l[m+I].match(/[Uu]/))I++;else if(null===l[m+I].match(/[A-Za-z]/))I++;else{B=l[m+I];break}B.match(/[Mm]/)?x=!0:xd(u);break;case "U":B="";for(I=1;l[m+I];)if(null!==l[m+I].match(/[Ff]/))I++;else if(null===l[m+I].match(/[A-Za-z]/))I++;
else{B=l[m+I];break}B.match(/[Mm]/)?y=!0:u.Ya(!1)}q=u.o;v.s(u);if(b)for(u=q.Ub.i;u.next();)B=u.value,B.mt=!0;return q};function yd(a,b){for(var c=a.length,d=v.M(),e=0;e<c;e++){var f=a[e];d.x=f[0];d.y=f[1];b.xb(d);f[0]=d.x;f[1]=d.y;d.x=f[2];d.y=f[3];b.xb(d);f[2]=d.x;f[3]=d.y;d.x=f[4];d.y=f[5];b.xb(d);f[4]=d.x;f[5]=d.y;d.x=f[6];d.y=f[7];b.xb(d);f[6]=d.x;f[7]=d.y}v.v(d)}
Xc.prototype.Tz=function(){if(this.Za||this.Pu!==this.Ub.F)return!0;for(var a=this.Ub.n,b=a.length,c=0;c<b;c++)if(a[c].Tz())return!0;return!1};Xc.prototype.PA=function(){this.Za=!1;this.Pu=this.Ub.F;for(var a=this.Ub.n,b=a.length,c=0;c<b;c++)a[c].PA()};Xc.prototype.Ug=function(){var a=this.Au;a.Na();isNaN(this.Vn)||isNaN(this.Tn)?a.m(0,0,0,0):a.m(0,0,this.Vn,this.Tn);zd(this,a,!1);rb(a,0,0,0,0);a.freeze()};
Xc.prototype.computeBoundsWithoutOrigin=Xc.prototype.KG=function(){var a=new z;zd(this,a,!0);return a};
function zd(a,b,c){switch(a.type){case fd:case gd:case hd:c?b.m(a.tc,a.xc,0,0):rb(b,a.tc,a.xc,0,0);rb(b,a.yb,a.Db,0,0);break;case cd:var d=a.Ub;a=d.n;for(var d=d.length,e=0;e<d;e++){var f=a[e];c&&0===e?b.m(f.Ia,f.Ja,0,0):rb(b,f.Ia,f.Ja,0,0);for(var h=f.vb.n,k=h.length,l=f.Ia,m=f.Ja,n=0;n<k;n++){var p=h[n];switch(p.type){case sd:case Ad:l=p.J;m=p.K;rb(b,l,m,0,0);break;case Bd:K.Fo(l,m,p.ic,p.Qc,p.ih,p.jh,p.J,p.K,.5,b);l=p.J;m=p.K;break;case Cd:K.lA(l,m,p.ic,p.Qc,p.J,p.K,.5,b);l=p.J;m=p.K;break;case Dd:case Fd:var q=
p.type===Dd?Gd(p,f):Hd(p,f,l,m),r=q.length;if(0===r){l=p.oa;m=p.va;rb(b,l,m,0,0);break}for(var p=null,s=0;s<r;s++)p=q[s],K.Fo(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],.5,b);null!==p&&(l=p[6],m=p[7]);break;default:v.k("Unknown Segment type: "+p.type)}}}break;default:v.k("Unknown Geometry type: "+a.type)}}Xc.prototype.normalize=Xc.prototype.normalize=function(){v.I(this);var a=this.KG();this.offset(-a.x,-a.y);return new w(-a.x,-a.y)};
Xc.prototype.offset=Xc.prototype.offset=function(a,b){v.I(this);this.transform(1,0,0,1,a,b);return this};Xc.prototype.scale=Xc.prototype.scale=function(a,b){v.I(this);this.transform(a,0,0,b,0,0);return this};Xc.prototype.rotate=Xc.prototype.rotate=function(a,b,c){v.I(this);void 0===b&&(b=0);void 0===c&&(c=0);var d=v.nh();d.reset();d.rotate(a,b,c);this.transform(d.m11,d.m12,d.m21,d.m22,d.dx,d.dy);v.Xe(d);return this};
Xc.prototype.transform=Xc.prototype.transform=function(a,b,c,d,e,f){var h=0,k=0;switch(this.type){case fd:case gd:case hd:h=this.tc;k=this.xc;this.tc=h*a+k*c+e;this.xc=h*b+k*d+f;h=this.yb;k=this.Db;this.yb=h*a+k*c+e;this.Db=h*b+k*d+f;break;case cd:for(var l=this.Ub.n,m=l.length,n=0;n<m;n++){var p=l[n],h=p.Ia,k=p.Ja;p.Ia=h*a+k*c+e;p.Ja=h*b+k*d+f;for(var p=p.vb.n,q=p.length,r=0;r<q;r++){var s=p[r];switch(s.type){case sd:case Ad:h=s.J;k=s.K;s.J=h*a+k*c+e;s.K=h*b+k*d+f;break;case Bd:h=s.ic;k=s.Qc;s.ic=
h*a+k*c+e;s.Qc=h*b+k*d+f;h=s.ih;k=s.jh;s.ih=h*a+k*c+e;s.jh=h*b+k*d+f;h=s.J;k=s.K;s.J=h*a+k*c+e;s.K=h*b+k*d+f;break;case Cd:h=s.ic;k=s.Qc;s.ic=h*a+k*c+e;s.Qc=h*b+k*d+f;h=s.J;k=s.K;s.J=h*a+k*c+e;s.K=h*b+k*d+f;break;case Dd:h=s.oa;k=s.va;s.oa=h*a+k*c+e;s.va=h*b+k*d+f;0!==b&&(h=180*Math.atan2(b,a)/Math.PI,0>h&&(h+=360),s.Ne+=h);0>a&&(s.Ne=180-s.Ne,s.Sf=-s.Sf);0>d&&(s.Ne=-s.Ne,s.Sf=-s.Sf);s.radiusX*=Math.sqrt(a*a+c*c);void 0!==s.radiusY&&(s.radiusY*=Math.sqrt(b*b+d*d));break;case Fd:h=s.J;k=s.K;s.J=h*
a+k*c+e;s.K=h*b+k*d+f;0!==b&&(h=180*Math.atan2(b,a)/Math.PI,0>h&&(h+=360),s.$i+=h);0>a&&(s.$i=180-s.$i,s.ql=!s.ql);0>d&&(s.$i=-s.$i,s.ql=!s.ql);s.radiusX*=Math.sqrt(a*a+c*c);s.radiusY*=Math.sqrt(b*b+d*d);break;default:v.k("Unknown Segment type: "+s.type)}}}}this.Za=!0;return this};
Xc.prototype.Ca=function(a,b,c,d){var e=a.x,f=a.y,h=this.pb.x-20;a=a.y;for(var k=0,l=0,m=0,n=0,p=0,q=0,r=this.Ub.n,s=r.length,t=0;t<s;t++){var u=r[t];if(u.mt){if(c&&u.Ca(e,f,b))return!0;for(var x=u.vb,l=u.Ia,m=u.Ja,y=l,A=m,B=x.n,I=0;I<=x.length;I++){var D,V;I!==x.length?(D=B[I],V=D.type,p=D.J,q=D.K):(V=sd,p=y,q=A);switch(V){case Ad:n=Id(e,f,h,a,l,m,y,A);if(isNaN(n))return!0;k+=n;y=p;A=q;break;case sd:n=Id(e,f,h,a,l,m,p,q);if(isNaN(n))return!0;k+=n;break;case Bd:n=K.Ns(l,m,D.ic,D.Qc,D.ih,D.jh,p,q,
h,a,e,f,.5);k+=n;break;case Cd:n=K.Ns(l,m,(l+2*D.ic)/3,(m+2*D.Qc)/3,(D.ic+2*p)/3,(D.ic+2*p)/3,p,q,h,a,e,f,.5);k+=n;break;case Dd:case Fd:V=D.type===Dd?Gd(D,u):Hd(D,u,l,m);var ba=V.length;if(0===ba){n=Id(e,f,h,a,l,m,D.oa,D.va);if(isNaN(n))return!0;k+=n;break}for(var U=null,N=0;N<ba;N++){U=V[N];if(0===N){n=Id(e,f,h,a,l,m,U[0],U[1]);if(isNaN(n))return!0;k+=n}n=K.Ns(U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],h,a,e,f,.5);k+=n}null!==U&&(p=U[6],q=U[7]);break;default:v.k("Unknown Segment type: "+D.type)}l=
p;m=q}if(0!==k)return!0;k=0}else if(u.Ca(e,f,d?b:b+2))return!0}return 0!==k};function Id(a,b,c,d,e,f,h,k){if(K.zd(e,f,h,k,.05,a,b))return NaN;var l=(a-c)*(f-k);if(0===l)return 0;var m=((a*d-b*c)*(e-h)-(a-c)*(e*k-f*h))/l;b=(a*d-b*c)*(f-k)/l;if(m>=a)return 0;if((e>h?e-h:h-e)<(f>k?f-k:k-f)){if(e=a=0,f<k?(a=f,e=k):(a=k,e=f),b<a||b>e)return 0}else if(e<h?(a=e,e=h):a=h,m<a||m>e)return 0;return 0<l?1:-1}function Jd(a,b,c,d){a=a.Ub.n;for(var e=a.length,f=0;f<e;f++)if(a[f].Ca(b,c,d))return!0;return!1}
Xc.prototype.getPointAlongPath=function(a){(0>a||1<a)&&v.ua(a,"0 <= fraction <= 1",Xc,"getPointAlongPath:fraction");var b=this.Ub.first(),c=v.jb(),d=[];d.push(b.Ia);d.push(b.Ja);for(var e=b.Ia,f=b.Ja,h=e,k=f,l=b.vb.n,m=l.length,n=0;n<m;n++){var p=l[n];switch(p.ia){case Ad:c.push(d);d=[];d.push(p.J);d.push(p.K);e=p.J;f=p.K;h=e;k=f;break;case sd:d.push(p.J);d.push(p.K);e=p.J;f=p.K;break;case Bd:K.De(e,f,p.md,p.Ae,p.gg,p.hg,p.yb,p.Db,.5,d);e=p.J;f=p.K;break;case Cd:K.rp(e,f,p.md,p.Ae,p.yb,p.Db,.5,d);
e=p.J;f=p.K;break;case Dd:var q=Gd(p,b),r=q.length;if(0===r){d.push(p.oa);d.push(p.va);e=p.oa;f=p.va;break}for(var s=0;s<r;s++){var t=q[s];K.De(e,f,t[2],t[3],t[4],t[5],t[6],t[7],.5,d);e=t[6];f=t[7]}break;case Fd:q=Hd(p,b,e,f);r=q.length;for(s=0;s<r;s++)t=q[s],K.De(e,f,t[2],t[3],t[4],t[5],t[6],t[7],.5,d),e=t[6],f=t[7];break;default:v.k("Segment not of valid type")}p.Dh&&(d.push(h),d.push(k))}c.push(d);q=0;h=c.length;for(k=d=b=0;k<h;k++)for(l=c[k],m=l.length,n=0;n<m;n+=2)e=l[n],f=l[n+1],0!==n&&(p=Math.sqrt(Za(b,
d,e,f)),q+=p),b=e,d=f;a*=q;for(k=q=0;k<h;k++)for(l=c[k],m=l.length,n=0;n<m;n++){e=l[n];f=l[n+1];if(0!==n){p=Math.sqrt(Za(b,d,e,f));if(q+p>a)return n=(a-q)/p,v.ra(c),new w(b+(e-b)*n,d+(f-d)*n);q+=p}b=e;d=f}v.ra(c);return null};v.defineProperty(Xc,{type:"type"},function(){return this.ia},function(a){this.ia!==a&&(v.I(this,a),this.ia=a,this.Za=!0)});v.defineProperty(Xc,{Ia:"startX"},function(){return this.tc},function(a){this.tc!==a&&(v.I(this,a),this.tc=a,this.Za=!0)});
v.defineProperty(Xc,{Ja:"startY"},function(){return this.xc},function(a){this.xc!==a&&(v.I(this,a),this.xc=a,this.Za=!0)});v.defineProperty(Xc,{J:"endX"},function(){return this.yb},function(a){this.yb!==a&&(v.I(this,a),this.yb=a,this.Za=!0)});v.defineProperty(Xc,{K:"endY"},function(){return this.Db},function(a){this.Db!==a&&(v.I(this,a),this.Db=a,this.Za=!0)});v.defineProperty(Xc,{Ub:"figures"},function(){return this.hj},function(a){this.hj!==a&&(v.I(this,a),this.hj=a,this.Za=!0)});
Xc.prototype.add=Xc.prototype.add=function(a){this.hj.add(a);return this};v.defineProperty(Xc,{A:"spot1"},function(){return this.Fi},function(a){v.I(this,a);this.Fi=a.aa()});v.defineProperty(Xc,{B:"spot2"},function(){return this.Gi},function(a){v.I(this,a);this.Gi=a.aa()});v.defineProperty(Xc,{Hd:"defaultStretch"},function(){return this.mi},function(a){v.I(this,a);this.mi=a});v.u(Xc,{pb:"bounds"},function(){this.Tz()&&(this.PA(),this.Ug());return this.Au});
function dd(a,b,c,d){v.cc(this);this.Ea=!1;void 0===c&&(c=!0);this.Sl=c;void 0===d&&(d=!0);this.Wn=d;this.tc=void 0!==a?a:0;this.xc=void 0!==b?b:0;this.po=new G(Kd);this.Nv=this.po.F;this.Za=!0}v.ga("PathFigure",dd);v.Uh(dd);dd.prototype.copy=function(){var a=new dd;a.Sl=this.Sl;a.Wn=this.Wn;a.tc=this.tc;a.xc=this.xc;for(var b=this.po.n,c=b.length,d=a.po,e=0;e<c;e++){var f=b[e].copy();d.add(f)}a.Nv=this.Nv;a.Za=this.Za;return a};
dd.prototype.equalsApprox=dd.prototype.Ie=function(a){if(!(a instanceof dd&&K.D(this.Ia,a.Ia)&&K.D(this.Ja,a.Ja)))return!1;var b=this.vb.n;a=a.vb.n;var c=b.length;if(c!==a.length)return!1;for(var d=0;d<c;d++)if(!b[d].Ie(a[d]))return!1;return!0};g=dd.prototype;g.toString=function(a){void 0===a&&(a=-1);for(var b=0>a?"M"+this.Ia.toString()+" "+this.Ja.toString():"M"+this.Ia.toFixed(a)+" "+this.Ja.toFixed(a),c=this.vb.n,d=c.length,e=0;e<d;e++)b+=" "+c[e].toString(a);return b};
g.freeze=function(){this.Ea=!0;var a=this.vb;a.freeze();for(var b=a.n,a=a.length,c=0;c<a;c++)b[c].freeze();return this};g.Na=function(){this.Ea=!1;var a=this.vb;a.Na();for(var a=a.n,b=a.length,c=0;c<b;c++)a[c].Na();return this};g.Tz=function(){if(this.Za)return!0;var a=this.vb;if(this.Nv!==a.F)return!0;for(var a=a.n,b=a.length,c=0;c<b;c++)if(a[c].Za)return!0;return!1};g.PA=function(){this.Za=!1;var a=this.vb;this.Nv=a.F;for(var a=a.n,b=a.length,c=0;c<b;c++){var d=a[c];d.Za=!1;d.Xf=null}};
v.defineProperty(dd,{mt:"isFilled"},function(){return this.Sl},function(a){v.I(this,a);this.Sl=a});v.defineProperty(dd,{tl:"isShadowed"},function(){return this.Wn},function(a){v.I(this,a);this.Wn=a});v.defineProperty(dd,{Ia:"startX"},function(){return this.tc},function(a){v.I(this,a);this.tc=a;this.Za=!0});v.defineProperty(dd,{Ja:"startY"},function(){return this.xc},function(a){v.I(this,a);this.xc=a;this.Za=!0});
v.defineProperty(dd,{vb:"segments"},function(){return this.po},function(a){v.I(this,a);this.po=a;this.Za=!0});dd.prototype.add=dd.prototype.add=function(a){this.po.add(a);return this};
dd.prototype.Ca=function(a,b,c){for(var d=this.Ia,e=this.Ja,f=d,h=e,k=this.vb.n,l=k.length,m=0;m<l;m++){var n=k[m];switch(n.type){case Ad:f=n.J;h=n.K;d=n.J;e=n.K;break;case sd:if(K.zd(d,e,n.J,n.K,c,a,b))return!0;d=n.J;e=n.K;break;case Bd:if(K.rw(d,e,n.ic,n.Qc,n.ih,n.jh,n.J,n.K,.5,a,b,c))return!0;d=n.J;e=n.K;break;case Cd:if(K.mA(d,e,n.ic,n.Qc,n.J,n.K,.5,a,b,c))return!0;d=n.J;e=n.K;break;case Dd:case Fd:var p=n.type===Dd?Gd(n,this):Hd(n,this,d,e),q=p.length;if(0===q){if(K.zd(d,e,n.oa,n.va,c,a,b))return!0;
d=n.oa;e=n.va;break}for(var r=null,s=0;s<q;s++)if(r=p[s],0===s&&K.zd(d,e,r[0],r[1],c,a,b)||K.rw(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],.5,a,b,c))return!0;null!==r&&(d=r[6],e=r[7]);break;default:v.k("Unknown Segment type: "+n.type)}if(n.Ow&&(d!==f||e!==h)&&K.zd(d,e,f,h,c,a,b))return!0}return!1};
function Kd(a,b,c,d,e,f,h,k){v.cc(this);this.Ea=!1;void 0===a&&(a=sd);this.ia=a;this.yb=void 0!==b?b:0;this.Db=void 0!==c?c:0;a===Fd?(void 0!==f&&(a=f%360,0>a&&(a+=360),this.md=a),void 0!==d&&(this.gg=Math.max(d,0)),void 0!==e&&(this.hg=Math.max(e,0)),this.$n=!!h,this.rn=!!k):(void 0!==d&&(this.md=d),void 0!==e&&(this.Ae=e),void 0!==f&&(a===Dd&&(f=Math.max(f,0)),this.gg=f),void 0!==h&&"number"===typeof h&&(a===Dd&&(h=Math.max(h,0)),this.hg=h));this.Dh=!1;this.Za=!0;this.Xf=null}
v.ga("PathSegment",Kd);v.Uh(Kd);Kd.prototype.copy=function(){var a=new Kd;a.ia=this.ia;a.yb=this.yb;a.Db=this.Db;void 0!==this.md&&(a.md=this.md);void 0!==this.Ae&&(a.Ae=this.Ae);void 0!==this.gg&&(a.gg=this.gg);void 0!==this.hg&&(a.hg=this.hg);void 0!==this.$n&&(a.$n=this.$n);void 0!==this.rn&&(a.rn=this.rn);a.Dh=this.Dh;a.Za=this.Za;return a};
Kd.prototype.equalsApprox=Kd.prototype.Ie=function(a){if(!(a instanceof Kd)||this.type!==a.type||this.Ow!==a.Ow)return!1;switch(this.type){case Ad:case sd:return K.D(this.J,a.J)&&K.D(this.K,a.K);case Bd:return K.D(this.J,a.J)&&K.D(this.K,a.K)&&K.D(this.ic,a.ic)&&K.D(this.Qc,a.Qc)&&K.D(this.ih,a.ih)&&K.D(this.jh,a.jh);case Cd:return K.D(this.J,a.J)&&K.D(this.K,a.K)&&K.D(this.ic,a.ic)&&K.D(this.Qc,a.Qc);case Dd:return K.D(this.Ne,a.Ne)&&K.D(this.Sf,a.Sf)&&K.D(this.oa,a.oa)&&K.D(this.va,a.va)&&K.D(this.radiusX,
a.radiusX)&&K.D(this.radiusY,a.radiusY);case Fd:return this.ql===a.ql&&this.Rw===a.Rw&&K.D(this.$i,a.$i)&&K.D(this.J,a.J)&&K.D(this.K,a.K)&&K.D(this.radiusX,a.radiusX)&&K.D(this.radiusY,a.radiusY);default:return!1}};
Kd.prototype.toString=function(a){void 0===a&&(a=-1);var b="";switch(this.type){case Ad:b=0>a?"M"+this.J.toString()+" "+this.K.toString():"M"+this.J.toFixed(a)+" "+this.K.toFixed(a);break;case sd:b=0>a?"L"+this.J.toString()+" "+this.K.toString():"L"+this.J.toFixed(a)+" "+this.K.toFixed(a);break;case Bd:b=0>a?"C"+this.ic.toString()+" "+this.Qc.toString()+" "+this.ih.toString()+" "+this.jh.toString()+" "+this.J.toString()+" "+this.K.toString():"C"+this.ic.toFixed(a)+" "+this.Qc.toFixed(a)+" "+this.ih.toFixed(a)+
" "+this.jh.toFixed(a)+" "+this.J.toFixed(a)+" "+this.K.toFixed(a);break;case Cd:b=0>a?"Q"+this.ic.toString()+" "+this.Qc.toString()+" "+this.J.toString()+" "+this.K.toString():"Q"+this.ic.toFixed(a)+" "+this.Qc.toFixed(a)+" "+this.J.toFixed(a)+" "+this.K.toFixed(a);break;case Dd:b=0>a?"B"+this.Ne.toString()+" "+this.Sf.toString()+" "+this.oa.toString()+" "+this.va.toString()+" "+this.radiusX:"B"+this.Ne.toFixed(a)+" "+this.Sf.toFixed(a)+" "+this.oa.toFixed(a)+" "+this.va.toFixed(a)+" "+this.radiusX;
break;case Fd:b=0>a?"A"+this.radiusX.toString()+" "+this.radiusY.toString()+" "+this.$i.toString()+" "+(this.Rw?1:0)+" "+(this.ql?1:0)+" "+this.J.toString()+" "+this.K.toString():"A"+this.radiusX.toFixed(a)+" "+this.radiusY.toFixed(a)+" "+this.$i.toFixed(a)+" "+(this.Rw?1:0)+" "+(this.ql?1:0)+" "+this.J.toFixed(a)+" "+this.K.toFixed(a);break;default:b=this.type.toString()}return b+(this.Dh?"z":"")};var Ad;Kd.Move=Ad=v.p(Kd,"Move",0);var sd;Kd.Line=sd=v.p(Kd,"Line",1);var Bd;
Kd.Bezier=Bd=v.p(Kd,"Bezier",2);var Cd;Kd.QuadraticBezier=Cd=v.p(Kd,"QuadraticBezier",3);var Dd;Kd.Arc=Dd=v.p(Kd,"Arc",4);var Fd;Kd.SvgArc=Fd=v.p(Kd,"SvgArc",4);Kd.prototype.freeze=function(){this.Ea=!0;return this};Kd.prototype.Na=function(){this.Ea=!1;return this};Kd.prototype.close=Kd.prototype.close=function(){this.Dh=!0;return this};
function Gd(a,b){if(null!==a.Xf&&!1===b.Za)return a.Xf;var c=a.radiusX,d=a.radiusY;void 0===d&&(d=c);if(0===c||0===d)return a.Xf=[],a.Xf;var e=a.md,f=a.Ae,h=K.MD(0,0,c<d?c:d,a.Ne,a.Ne+a.Sf,!1);if(c!==d){var k=v.nh();k.reset();c<d?k.scale(1,d/c):k.scale(c/d,1);yd(h,k);v.Xe(k)}c=h.length;for(d=0;d<c;d++)k=h[d],k[0]+=e,k[1]+=f,k[2]+=e,k[3]+=f,k[4]+=e,k[5]+=f,k[6]+=e,k[7]+=f;a.Xf=h;return a.Xf}
function Hd(a,b,c,d){function e(a,b,c,d){return(a*d<b*c?-1:1)*Math.acos(f(a,b,c,d))}function f(a,b,c,d){return(a*c+b*d)/(Math.sqrt(a*a+b*b)*Math.sqrt(c*c+d*d))}if(null!==a.Xf&&!1===b.Za)return a.Xf;b=a.gg;var h=a.hg;if(0===b||0===h)return a.Xf=[],a.Xf;var k=Math.PI/180*a.md,l=a.$n,m=a.rn,n=a.yb,p=a.Db,q=Math.cos(k),r=Math.sin(k),s=q*(c-n)/2+r*(d-p)/2,k=-r*(c-n)/2+q*(d-p)/2,t=s*s/(b*b)+k*k/(h*h);1<t&&(b*=Math.sqrt(t),h*=Math.sqrt(t));t=(l===m?-1:1)*Math.sqrt((b*b*h*h-b*b*k*k-h*h*s*s)/(b*b*k*k+h*h*
s*s));isNaN(t)&&(t=0);l=t*b*k/h;t=t*-h*s/b;isNaN(l)&&(l=0);isNaN(t)&&(t=0);c=(c+n)/2+q*l-r*t;d=(d+p)/2+r*l+q*t;p=e(1,0,(s-l)/b,(k-t)/h);q=(s-l)/b;n=(k-t)/h;s=(-s-l)/b;l=(-k-t)/h;k=e(q,n,s,l);s=f(q,n,s,l);-1>=s?k=Math.PI:1<=s&&(k=0);!m&&0<k&&(k-=2*Math.PI);m&&0>k&&(k+=2*Math.PI);m=b>h?1:b/h;s=b>h?h/b:1;b=K.MD(0,0,b>h?b:h,p,p+k,!0);h=v.nh();h.reset();h.translate(c,d);h.rotate(a.md,0,0);h.scale(m,s);yd(b,h);v.Xe(h);a.Xf=b;return a.Xf}
v.defineProperty(Kd,{Ow:"isClosed"},function(){return this.Dh},function(a){this.Dh!==a&&(this.Dh=a,this.Za=!0)});v.defineProperty(Kd,{type:"type"},function(){return this.ia},function(a){v.I(this,a);this.ia=a;this.Za=!0});v.defineProperty(Kd,{J:"endX"},function(){return this.yb},function(a){v.I(this,a);this.yb=a;this.Za=!0});v.defineProperty(Kd,{K:"endY"},function(){return this.Db},function(a){v.I(this,a);this.Db=a;this.Za=!0});
v.defineProperty(Kd,{ic:"point1X"},function(){return this.md},function(a){v.I(this,a);this.md=a;this.Za=!0});v.defineProperty(Kd,{Qc:"point1Y"},function(){return this.Ae},function(a){v.I(this,a);this.Ae=a;this.Za=!0});v.defineProperty(Kd,{ih:"point2X"},function(){return this.gg},function(a){v.I(this,a);this.gg=a;this.Za=!0});v.defineProperty(Kd,{jh:"point2Y"},function(){return this.hg},function(a){v.I(this,a);this.hg=a;this.Za=!0});
v.defineProperty(Kd,{oa:"centerX"},function(){return this.md},function(a){v.I(this,a);this.md=a;this.Za=!0});v.defineProperty(Kd,{va:"centerY"},function(){return this.Ae},function(a){v.I(this,a);this.Ae=a;this.Za=!0});v.defineProperty(Kd,{radiusX:"radiusX"},function(){return this.gg},function(a){0>a&&v.ua(a,">= zero",Kd,"radiusX");v.I(this,a);this.gg=a;this.Za=!0});
v.defineProperty(Kd,{radiusY:"radiusY"},function(){return this.hg},function(a){0>a&&v.ua(a,">= zero",Kd,"radiusY");v.I(this,a);this.hg=a;this.Za=!0});v.defineProperty(Kd,{Ne:"startAngle"},function(){return this.yb},function(a){this.yb!==a&&(v.I(this,a),a%=360,0>a&&(a+=360),this.yb=a,this.Za=!0)});v.defineProperty(Kd,{Sf:"sweepAngle"},function(){return this.Db},function(a){v.I(this,a);360<a&&(a=360);-360>a&&(a=-360);this.Db=a;this.Za=!0});
v.defineProperty(Kd,{ql:"isClockwiseArc"},function(){return this.rn},function(a){v.I(this,a);this.rn=a;this.Za=!0});v.defineProperty(Kd,{Rw:"isLargeArc"},function(){return this.$n},function(a){v.I(this,a);this.$n=a;this.Za=!0});v.defineProperty(Kd,{$i:"xAxisRotation"},function(){return this.md},function(a){a%=360;0>a&&(a+=360);v.I(this,a);this.md=a;this.Za=!0});
function Ld(){this.W=null;this.gz=(new w(0,0)).freeze();this.ly=(new w(0,0)).freeze();this.wu=this.rv=0;this.xu=1;this.fv="";this.cw=this.Mu=!1;this.Iu=this.zu=0;this.bj=this.Tu=this.cv=!1;this.zq=null;this.aw=0;this.ig=this.Yv=null}v.ga("InputEvent",Ld);
Ld.prototype.copy=function(){var a=new Ld;a.W=this.W;a.gz.assign(this.ef);a.ly.assign(this.ea);a.rv=this.rv;a.wu=this.wu;a.xu=this.xu;a.fv=this.fv;a.Mu=this.Mu;a.cw=this.cw;a.zu=this.zu;a.Iu=this.Iu;a.cv=this.cv;a.Tu=this.Tu;a.bj=this.bj;a.zq=this.zq;a.aw=this.aw;a.Yv=this.Yv;a.ig=this.ig;return a};
Ld.prototype.toString=function(){var a="^";0!==this.pd&&(a+="M:"+this.pd);0!==this.button&&(a+="B:"+this.button);""!==this.key&&(a+="K:"+this.key);0!==this.Ue&&(a+="C:"+this.Ue);0!==this.el&&(a+="D:"+this.el);this.Nc&&(a+="h");this.bubbles&&(a+="b");null!==this.ea&&(a+="@"+this.ea.toString());return a};v.defineProperty(Ld,{g:"diagram"},function(){return this.W},function(a){this.W=a});v.defineProperty(Ld,{ef:"viewPoint"},function(){return this.gz},function(a){v.C(a,w,Ld,"viewPoint");this.gz.assign(a)});
v.defineProperty(Ld,{ea:"documentPoint"},function(){return this.ly},function(a){v.C(a,w,Ld,"documentPoint");this.ly.assign(a)});v.defineProperty(Ld,{pd:"modifiers"},function(){return this.rv},function(a){this.rv=a});v.defineProperty(Ld,{button:"button"},function(){return this.wu},function(a){this.wu=a;if(null===this.event)switch(a){case 0:this.buttons=1;break;case 1:this.buttons=4;break;case 2:this.buttons=2}});
v.defineProperty(Ld,{buttons:"buttons"},function(){return this.xu},function(a){this.xu=a});v.defineProperty(Ld,{key:"key"},function(){return this.fv},function(a){this.fv=a});v.defineProperty(Ld,{gl:"down"},function(){return this.Mu},function(a){this.Mu=a});v.defineProperty(Ld,{up:"up"},function(){return this.cw},function(a){this.cw=a});v.defineProperty(Ld,{Ue:"clickCount"},function(){return this.zu},function(a){this.zu=a});
v.defineProperty(Ld,{el:"delta"},function(){return this.Iu},function(a){this.Iu=a});v.defineProperty(Ld,{ot:"isMultiTouch"},function(){return this.cv},function(a){this.cv=a});v.defineProperty(Ld,{Nc:"handled"},function(){return this.Tu},function(a){this.Tu=a});v.defineProperty(Ld,{bubbles:"bubbles"},function(){return this.bj},function(a){this.bj=a});v.defineProperty(Ld,{event:"event"},function(){return this.zq},function(a){this.zq=a});
v.u(Ld,{Zj:"isTouchEvent"},function(){var a=window.TouchEvent;return a&&this.event instanceof a?!0:(a=window.PointerEvent)&&this.event instanceof a&&"touch"===this.event.pointerType});v.defineProperty(Ld,{timestamp:"timestamp"},function(){return this.aw},function(a){this.aw=a});v.defineProperty(Ld,{Ag:"targetDiagram"},function(){return this.Yv},function(a){this.Yv=a});v.defineProperty(Ld,{qe:"targetObject"},function(){return this.ig},function(a){this.ig=a});
v.defineProperty(Ld,{control:"control"},function(){return 0!==(this.pd&1)},function(a){this.pd=a?this.pd|1:this.pd&-2});v.defineProperty(Ld,{shift:"shift"},function(){return 0!==(this.pd&4)},function(a){this.pd=a?this.pd|4:this.pd&-5});v.defineProperty(Ld,{alt:"alt"},function(){return 0!==(this.pd&2)},function(a){this.pd=a?this.pd|2:this.pd&-3});v.defineProperty(Ld,{xt:"meta"},function(){return 0!==(this.pd&8)},function(a){this.pd=a?this.pd|8:this.pd&-9});
v.defineProperty(Ld,{left:"left"},function(){var a=this.event;return null!==a&&a instanceof MouseEvent&&("mousedown"===a.type||"mouseup"===a.type)?0===this.button:0!==(this.buttons&1)},function(a){this.buttons=a?this.buttons|1:this.buttons&-2});v.defineProperty(Ld,{right:"right"},function(){var a=this.event;return null!==a&&a instanceof MouseEvent&&("mousedown"===a.type||"mouseup"===a.type)?2===this.button:0!==(this.buttons&2)},function(a){this.buttons=a?this.buttons|2:this.buttons&-3});
v.defineProperty(Ld,{LK:"middle"},function(){var a=this.event;return null!==a&&a instanceof MouseEvent&&("mousedown"===a.type||"mouseup"===a.type)?1===this.button:0!==(this.buttons&4)},function(a){this.buttons=a?this.buttons|4:this.buttons&-5});function Md(){this.W=null;this.Ob="";this.zv=this.Tv=null;this.yu=!1}v.ga("DiagramEvent",Md);Md.prototype.copy=function(){var a=new Md;a.W=this.W;a.Ob=this.Ob;a.Tv=this.Tv;a.zv=this.zv;a.yu=this.yu;return a};
Md.prototype.toString=function(){var a="*"+this.name;this.cancel&&(a+="x");null!==this.HA&&(a+=":"+this.HA.toString());null!==this.kA&&(a+="("+this.kA.toString()+")");return a};v.defineProperty(Md,{g:"diagram"},function(){return this.W},function(a){this.W=a});v.defineProperty(Md,{name:"name"},function(){return this.Ob},function(a){this.Ob=a});v.defineProperty(Md,{HA:"subject"},function(){return this.Tv},function(a){this.Tv=a});
v.defineProperty(Md,{kA:"parameter"},function(){return this.zv},function(a){this.zv=a});v.defineProperty(Md,{cancel:"cancel"},function(){return this.yu},function(a){this.yu=a});function Nd(){this.$p=Od;this.mm=this.qv="";this.wr=this.xr=this.Ar=this.Br=this.zr=this.W=this.Rd=null}v.ga("ChangedEvent",Nd);var Pd;Nd.Transaction=Pd=v.p(Nd,"Transaction",-1);var Od;Nd.Property=Od=v.p(Nd,"Property",0);var Qd;Nd.Insert=Qd=v.p(Nd,"Insert",1);var be;Nd.Remove=be=v.p(Nd,"Remove",2);
Nd.prototype.clear=Nd.prototype.clear=function(){this.wr=this.xr=this.Ar=this.Br=this.zr=this.W=this.Rd=null};Nd.prototype.copy=function(){var a=new Nd;a.Rd=this.Rd;a.W=this.W;a.$p=this.$p;a.qv=this.qv;a.mm=this.mm;a.zr=this.zr;var b=this.Br;a.Br=v.Wa(b)&&"function"===typeof b.aa?b.aa():b;b=this.Ar;a.Ar=v.Wa(b)&&"function"===typeof b.aa?b.aa():b;b=this.xr;a.xr=v.Wa(b)&&"function"===typeof b.aa?b.aa():b;b=this.wr;a.wr=v.Wa(b)&&"function"===typeof b.aa?b.aa():b;return a};
Nd.prototype.toString=function(){var a="",a=this.Ac===Pd?a+"* ":this.Ac===Od?a+(null!==this.da?"!m":"!d"):a+((null!==this.da?"!m":"!d")+this.Ac);this.propertyName&&"string"===typeof this.propertyName&&(a+=" "+this.propertyName);this.cf&&this.cf!==this.propertyName&&(a+=" "+this.cf);a+=": ";this.Ac===Pd?null!==this.oldValue&&(a+=" "+this.oldValue):(null!==this.object&&(a+=ce(this.object)),null!==this.oldValue&&(a+="  old: "+ce(this.oldValue)),null!==this.xg&&(a+=" "+this.xg),null!==this.newValue&&
(a+="  new: "+ce(this.newValue)),null!==this.vg&&(a+=" "+this.vg));return a};Nd.prototype.getValue=Nd.prototype.la=function(a){return a?this.oldValue:this.newValue};Nd.prototype.getParam=function(a){return a?this.xg:this.vg};Nd.prototype.canUndo=Nd.prototype.canUndo=function(){return null!==this.da||null!==this.g?!0:!1};Nd.prototype.undo=Nd.prototype.undo=function(){this.canUndo()&&(null!==this.da?this.da.Em(this,!0):null!==this.g&&this.g.Em(this,!0))};
Nd.prototype.canRedo=Nd.prototype.canRedo=function(){return null!==this.da||null!==this.g?!0:!1};Nd.prototype.redo=Nd.prototype.redo=function(){this.canRedo()&&(null!==this.da?this.da.Em(this,!1):null!==this.g&&this.g.Em(this,!1))};v.defineProperty(Nd,{da:"model"},function(){return this.Rd},function(a){this.Rd=a});v.defineProperty(Nd,{g:"diagram"},function(){return this.W},function(a){this.W=a});v.defineProperty(Nd,{Ac:"change"},function(){return this.$p},function(a){this.$p=a});
v.defineProperty(Nd,{cf:"modelChange"},function(){return this.qv},function(a){this.qv=a});v.defineProperty(Nd,{propertyName:"propertyName"},function(){return this.mm},function(a){this.mm=a});v.u(Nd,{xE:"isTransactionFinished"},function(){return this.$p===Pd&&("CommittedTransaction"===this.mm||"FinishedUndo"===this.mm||"FinishedRedo"===this.mm)});v.defineProperty(Nd,{object:"object"},function(){return this.zr},function(a){this.zr=a});
v.defineProperty(Nd,{oldValue:"oldValue"},function(){return this.Br},function(a){this.Br=a});v.defineProperty(Nd,{xg:"oldParam"},function(){return this.Ar},function(a){this.Ar=a});v.defineProperty(Nd,{newValue:"newValue"},function(){return this.xr},function(a){this.xr=a});v.defineProperty(Nd,{vg:"newParam"},function(){return this.wr},function(a){this.wr=a});
function F(a){1<arguments.length&&v.k("Model constructor can only take one optional argument, the Array of node data.");v.cc(this);this.nq=this.Ob="";this.qi=!1;this.Ny={};this.kf=[];this.rc=new ma(null,Object);this.Aj="key";this.vn=this.fm=null;this.fq=this.Cu=!1;this.Tp=null;this.hm="category";this.yh=new ma(null,H);this.uj=null;this.Ei=!1;this.fz=null;this.ja=new de;void 0!==a&&(this.dh=a)}v.ga("Model",F);
F.prototype.cloneProtected=function(a){a.Ob=this.Ob;a.nq=this.nq;a.qi=this.qi;a.Aj=this.Aj;a.fm=this.fm;a.vn=this.vn;a.qJ=this.Cu;a.fq=this.fq;a.Tp=this.Tp;a.hm=this.hm};F.prototype.copy=function(){var a=new this.constructor;this.cloneProtected(a);return a};F.prototype.clear=F.prototype.clear=function(){this.kf=[];this.rc.clear();this.yh.clear();this.ja.clear()};g=F.prototype;
g.toString=function(a){void 0===a&&(a=0);if(1<a)return this.KA();var b=(""!==this.name?this.name:"")+" Model";if(0<a){b+="\n node data:";a=this.dh;for(var c=v.Va(a),d=0;d<c;d++)var e=v.Pa(a,d),b=b+(" "+this.mb(e)+":"+ce(e))}return b};
g.Ip=function(){var a="";""!==this.name&&(a+=',\n  "name": '+this.quote(this.name));""!==this.cl&&(a+=',\n  "dataFormat": '+this.quote(this.cl));this.gb&&(a+=',\n  "isReadOnly": '+this.gb);"key"!==this.wl&&"string"===typeof this.wl&&(a+=',\n  "nodeKeyProperty": '+this.quote(this.wl));this.wz&&(a+=',\n  "copiesArrays": true');this.vz&&(a+=',\n  "copiesArrayObjects": true');"category"!==this.Zm&&"string"===typeof this.Zm&&(a+=',\n  "nodeCategoryProperty": '+this.quote(this.Zm));return a};
g.Ht=function(a){a.name&&(this.name=a.name);a.dataFormat&&(this.cl=a.dataFormat);a.isReadOnly&&(this.gb=a.isReadOnly);a.nodeKeyProperty&&(this.wl=a.nodeKeyProperty);a.copiesArrays&&(this.wz=a.copiesArrays);a.copiesArrayObjects&&(this.vz=a.copiesArrayObjects);a.nodeCategoryProperty&&(this.Zm=a.nodeCategoryProperty)};function ee(a){var b=a.yt,c=!1,d;for(d in b)if(!fe(d,b[d])){c=!0;break}return c?',\n  "modelData": '+ge(a,b):""}function he(a,b){var c=b.modelData;v.Wa(c)&&(a.Kt(c),a.yt=c)}
g.SA=function(){return ee(this)+',\n  "nodeDataArray": '+re(this,this.dh,!0)};g.pA=function(a){he(this,a);a=a.nodeDataArray;v.isArray(a)&&(this.Kt(a),this.dh=a)};
g.RA=function(a,b){var c=ee(this),d=this,e=new H,f=new H,h=new H;a.Gf.each(function(a){a.da===d&&("nodeDataArray"===a.cf?a.Ac===Qd?e.add(a.newValue):a.Ac===be&&h.add(a.oldValue):d.Fe(a.object)&&f.add(a.object))});var k=new H;e.each(function(a){k.add(d.mb(a));b||f.add(a)});var l=new H;h.each(function(a){l.add(d.mb(a));b&&f.add(a)});return c+(b?',\n  "removedNodeKeys": ':',\n  "insertedNodeKeys": ')+re(this,k.ed(),!0)+',\n  "modifiedNodeData": '+re(this,f.ed(),!0)+(b?',\n  "insertedNodeKeys": ':',\n  "removedNodeKeys": ')+
re(this,l.ed(),!0)};
g.oA=function(a){he(this,a);var b=a.insertedNodeKeys;if(v.isArray(b))for(var c=v.Va(b),d=0;d<c;d++){var e=v.Pa(b,d),f=this.ke(e);null===f&&(f=this.copyNodeData({}),this.vx(f,e),this.Vk(f))}b=a.modifiedNodeData;if(v.isArray(b))for(c=v.Va(b),d=0;d<c;d++){var h=v.Pa(b,d),e=this.mb(h),f=this.ke(e);if(null!==f)for(var k in h)"__gohashid"!==k&&k!==this.wl&&this.setDataProperty(f,k,h[k])}a=a.removedNodeKeys;if(v.isArray(a))for(c=v.Va(a),d=0;d<c;d++)e=v.Pa(a,d),f=this.ke(e),null!==f&&this.mx(f)};
F.prototype.toIncrementalJson=F.prototype.toIncrementalJSON=function(a,b){v.C(a,Nd,F,"toIncrementalJson:e");a.Ac!==Pd&&v.k("Model.toIncrementalJson argument is not a Transaction ChangedEvent:"+a.toString());var c=a.object;if(!(a.xE&&c instanceof se))return'{ "incremental": 0 }';void 0===b&&(b=this.constructor===F?"go.Model":this.constructor===Q?"go.GraphLinksModel":this.constructor===te?"go.TreeModel":v.nf(this));return'{ "class": '+this.quote(b)+', "incremental": 1'+this.Ip()+this.RA(c,"FinishedUndo"===
a.propertyName)+"}"};F.prototype.toJson=F.prototype.toJSON=F.prototype.KA=function(a){void 0===a&&(a=this.constructor===F?"go.Model":this.constructor===Q?"go.GraphLinksModel":this.constructor===te?"go.TreeModel":v.nf(this));return'{ "class": '+this.quote(a)+this.Ip()+this.SA()+"}"};
F.prototype.applyIncrementalJson=F.prototype.applyIncrementalJSON=function(a){var b=null;if("string"===typeof a)if(window.JSON&&window.JSON.parse)try{b=window.JSON.parse(a)}catch(c){}else v.trace("WARNING: no JSON.parse available");else"object"===typeof a?b=a:v.k("Unable to modify a Model from: "+a);var d=b.incremental;"number"!==typeof d&&v.k("Unable to apply non-incremental changes to Model: "+a);0!==d&&(this.Qb("applyIncrementalJson"),this.oA(b),this.wd("applyIncrementalJson"))};
F.fromJson=F.fromJSON=function(a,b){void 0===b&&(b=null);null!==b&&v.C(b,F,F,"fromJson:model");var c=null;if("string"===typeof a)if(window.JSON&&window.JSON.parse)try{c=window.JSON.parse(a)}catch(d){}else v.trace("WARNING: no JSON.parse available");else"object"===typeof a?c=a:v.k("Unable to construct a Model from: "+a);if(null===b){var e;e=null;var f=c["class"];if("string"===typeof f)try{var h=null;0===f.indexOf("go.")?(f=f.substr(3),h=ea[f]):(h=ea[f],void 0===h&&(h=window[f]));"function"===typeof h&&
(e=new h)}catch(k){}null===e||e instanceof F?b=e:v.k("Unable to construct a Model of declared class: "+c["class"])}null===b&&(b=new Q);b.Ht(c);b.pA(c);return b};
F.prototype.replaceJsonObjects=F.prototype.Kt=function(a){if(v.isArray(a))for(var b=v.Va(a),c=0;c<b;c++){var d=v.Pa(a,c);v.Wa(d)&&v.xD(a,c,this.Kt(d))}else if(v.Wa(a)){for(c in a)if(d=a[c],v.Wa(d)&&(d=this.Kt(d),a[c]=d,"points"===c&&Array.isArray(d))){for(var e=0===d.length%2,f=0;f<d.length;f++)if("number"!==typeof d[f]){e=!1;break}if(e){e=new G(w);for(f=0;f<d.length/2;f++)e.add(new w(d[2*f],d[2*f+1]));e.freeze();a[c]=e}}if("object"===typeof a){c=a;d=a["class"];if("NaN"===d)c=NaN;else if("Date"===
d)c=new Date(a.value);else if("go.Point"===d)c=new w(ue(a.x),ue(a.y));else if("go.Size"===d)c=new ia(ue(a.width),ue(a.height));else if("go.Rect"===d)c=new z(ue(a.x),ue(a.y),ue(a.width),ue(a.height));else if("go.Margin"===d)c=new tb(ue(a.top),ue(a.right),ue(a.bottom),ue(a.left));else if("go.Spot"===d)c="string"===typeof a["enum"]?wb(a["enum"]):new L(ue(a.x),ue(a.y),ue(a.offsetX),ue(a.offsetY));else if("go.Brush"===d){if(c=new ha,c.type=Da(ha,a.type),"string"===typeof a.color&&(c.color=a.color),a.start instanceof
L&&(c.start=a.start),a.end instanceof L&&(c.end=a.end),"number"===typeof a.startRadius&&(c.Xt=ue(a.startRadius)),"number"===typeof a.endRadius&&(c.Us=ue(a.endRadius)),a=a.colorStops,v.Wa(a))for(b in a)c.addColorStop(parseFloat(b),a[b])}else"go.Geometry"===d?(b=null,b="string"===typeof a.path?ud(a.path):new Xc,b.type=Da(Xc,a.type),"number"===typeof a.startX&&(b.Ia=ue(a.startX)),"number"===typeof a.startY&&(b.Ja=ue(a.startY)),"number"===typeof a.endX&&(b.J=ue(a.endX)),"number"===typeof a.endY&&(b.K=
ue(a.endY)),a.spot1 instanceof L&&(b.A=a.spot1),a.spot2 instanceof L&&(b.B=a.spot2),c=b):"go.EnumValue"===d&&(b=a.classType,0===b.indexOf("go.")&&(b=b.substr(3)),c=Da(ea[b],a.name));a=c}}return a};F.prototype.quote=function(a){for(var b="",c=a.length,d=0;d<c;d++)var e=a[d],b='"'===e||"\\"===e?b+("\\"+e):"\b"===e?b+"\\b":"\f"===e?b+"\\f":"\n"===e?b+"\\n":"\r"===e?b+"\\r":"\t"===e?b+"\\t":b+e;return'"'+b+'"'};
F.prototype.writeJsonValue=F.prototype.du=function(a){return void 0===a?"undefined":null===a?"null":!0===a?"true":!1===a?"false":"string"===typeof a?this.quote(a):"number"===typeof a?Infinity===a?"9e9999":-Infinity===a?"-9e9999":isNaN(a)?'{"class":"NaN"}':a.toString():a instanceof Date?'{"class":"Date", "value":"'+a.toJSON()+'"}':a instanceof Number?this.du(a.valueOf()):v.isArray(a)?re(this,a):v.Wa(a)?ge(this,a):"function"===typeof a?"null":a.toString()};
function re(a,b,c){void 0===c&&(c=!1);var d=v.Va(b);if(0>=d)return"[]";var e=new Ba;e.add("[ ");c&&1<d&&e.add("\n");for(var f=0;f<d;f++){var h=v.Pa(b,f);void 0!==h&&(0<f&&(e.add(","),c&&e.add("\n")),e.add(a.du(h)))}c&&1<d&&e.add("\n");e.add(" ]");return e.toString()}function fe(a,b){return void 0===b||"__gohashid"===a||"_"===a[0]||"function"===typeof b?!0:!1}function ve(a){return isNaN(a)?"NaN":Infinity===a?"9e9999":-Infinity===a?"-9e9999":a}
function ge(a,b){var c=b;if(c instanceof w){var d=c;b={"class":"go.Point",x:ve(d.x),y:ve(d.y)}}else if(c instanceof ia){var e=c;b={"class":"go.Size",width:ve(e.width),height:ve(e.height)}}else if(c instanceof z)b={"class":"go.Rect",x:ve(c.x),y:ve(c.y),width:ve(c.width),height:ve(c.height)};else if(c instanceof tb)b={"class":"go.Margin",top:ve(c.top),right:ve(c.right),bottom:ve(c.bottom),left:ve(c.left)};else if(c instanceof L)e=c,b=e.yd()?{"class":"go.Spot",x:ve(e.x),y:ve(e.y),offsetX:ve(e.offsetX),
offsetY:ve(e.offsetY)}:{"class":"go.Spot","enum":e.toString()};else if(c instanceof ha){b={"class":"go.Brush",type:c.type.name};if(c.type===we)b.color=c.color;else if(c.type===xe||c.type===ye)b.start=c.start,b.end=c.end,c.type===ye&&(0!==c.Xt&&(b.startRadius=ve(c.Xt)),isNaN(c.Us)||(b.endRadius=ve(c.Us)));if(null!==c.Rs){for(var f={},h=c.Rs.i;h.next();)f[h.key]=h.value;b.colorStops=f}}else if(c instanceof Xc)b={"class":"go.Geometry",type:c.type.name},0!==c.Ia&&(b.startX=ve(c.Ia)),0!==c.Ja&&(b.startY=
ve(c.Ja)),0!==c.J&&(b.endX=ve(c.J)),0!==c.K&&(b.endY=ve(c.K)),c.A.L(zb)||(b.spot1=c.A),c.B.L(Vb)||(b.spot2=c.B),c.type===cd&&(b.path=td(c));else if(c instanceof fa)b={"class":"go.EnumValue",classType:v.nf(c.je),name:c.name};else if(c instanceof R||c instanceof E||c instanceof ze||c instanceof F||c instanceof Le||c instanceof sa||c instanceof Me||c instanceof wa||c instanceof de||c instanceof se)return v.trace("ERROR: trying to convert a GraphObject or Diagram or Model or Tool or Layout or UndoManager into JSON text: "+
c.toString()),"{}";f="{";c=!0;for(d in b)if(e=v.kb(b,d),!fe(d,e))if(c?c=!1:f+=", ",f+='"'+d+'":',"points"===d&&e instanceof G&&e.ia===w){h=e;e="[";for(h=h.i;h.next();){var k=h.value;1<e.length&&(e+=",");e+=a.du(k.x);e+=",";e+=a.du(k.y)}e+="]";f+=e}else f+=a.du(e);return f+"}"}function ue(a){return"number"===typeof a?a:"NaN"===a?NaN:"9e9999"===a?Infinity:"-9e9999"===a?-Infinity:parseFloat(a)}
v.defineProperty(F,{name:"name"},function(){return this.Ob},function(a){var b=this.Ob;b!==a&&(v.j(a,"string",F,"name"),this.Ob=a,this.h("name",b,a))});v.defineProperty(F,{cl:"dataFormat"},function(){return this.nq},function(a){var b=this.nq;b!==a&&(v.j(a,"string",F,"dataFormat"),this.nq=a,this.h("dataFormat",b,a))});v.defineProperty(F,{gb:"isReadOnly"},function(){return this.qi},function(a){var b=this.qi;b!==a&&(v.j(a,"boolean",F,"isReadOnly"),this.qi=a,this.h("isReadOnly",b,a))});
v.defineProperty(F,{yt:"modelData"},function(){return this.Ny},function(a){var b=this.Ny;b!==a&&(v.j(a,"object",F,"modelData"),this.Ny=a,this.h("modelData",b,a),this.Ib(a))});F.prototype.addChangedListener=F.prototype.zm=function(a){v.j(a,"function",F,"addChangedListener:listener");null===this.uj&&(this.uj=new G("function"));this.uj.add(a)};
F.prototype.removeChangedListener=F.prototype.It=function(a){v.j(a,"function",F,"removeChangedListener:listener");null!==this.uj&&(this.uj.remove(a),0===this.uj.count&&(this.uj=null))};F.prototype.sw=function(a){this.lb||this.ja.jE(a);if(null!==this.uj){var b=this.uj,c=b.length;if(1===c)b=b.ha(0),b(a);else if(0!==c)for(var d=b.ed(),e=0;e<c;e++)b=d[e],b(a)}};F.prototype.raiseChangedEvent=F.prototype.Ec=function(a,b,c,d,e,f,h){Ne(this,"",a,b,c,d,e,f,h)};
F.prototype.raiseChanged=F.prototype.h=function(a,b,c,d,e){Ne(this,"",Od,a,this,b,c,d,e)};F.prototype.raiseDataChanged=F.prototype.nA=function(a,b,c,d,e,f){Ne(this,"",Od,b,a,c,d,e,f)};function Ne(a,b,c,d,e,f,h,k,l){void 0===k&&(k=null);void 0===l&&(l=null);var m=new Nd;m.da=a;m.Ac=c;m.cf=b;m.propertyName=d;m.object=e;m.oldValue=f;m.xg=k;m.newValue=h;m.vg=l;a.sw(m)}
v.defineProperty(F,{ja:"undoManager"},function(){return this.fz},function(a){var b=this.fz;b!==a&&(v.C(a,de,F,"undoManager"),null!==b&&b.EI(this),this.fz=a,null!==a&&a.tG(this))});v.defineProperty(F,{lb:"skipsUndoManager"},function(){return this.Ei},function(a){v.j(a,"boolean",F,"skipsUndoManager");this.Ei=a});
F.prototype.Em=function(a,b){if(null!==a&&a.da===this)if(a.Ac===Od){var c=a.object,d=a.propertyName,e=a.la(b);v.Ha(c,d,e)}else a.Ac===Qd?"nodeDataArray"===a.cf?(c=a.newValue,v.Wa(c)&&(d=this.mb(c),void 0!==d&&(b?(v.Th(this.kf,a.vg),this.rc.remove(d)):(v.Mi(this.kf,a.vg,c),this.rc.add(d,c))))):""===a.cf?(c=a.object,!v.isArray(c)&&a.propertyName&&(c=v.kb(a.object,a.propertyName)),v.isArray(c)&&(d=a.newValue,e=a.vg,b?v.Th(c,e):v.Mi(c,e,d))):v.k("unknown ChangedEvent.Insert object: "+a.toString()):a.Ac===
be?"nodeDataArray"===a.cf?(c=a.oldValue,v.Wa(c)&&(d=this.mb(c),void 0!==d&&(b?(v.Mi(this.kf,a.xg,c),this.rc.add(d,c)):(v.Th(this.kf,a.xg),this.rc.remove(d))))):""===a.cf?(c=a.object,!v.isArray(c)&&a.propertyName&&(c=v.kb(a.object,a.propertyName)),v.isArray(c)&&(d=a.oldValue,e=a.xg,b?v.Mi(c,e,d):v.Th(c,e))):v.k("unknown ChangedEvent.Remove object: "+a.toString()):a.Ac!==Pd&&v.k("unknown ChangedEvent: "+a.toString())};F.prototype.startTransaction=F.prototype.Qb=function(a){return this.ja.Qb(a)};
F.prototype.commitTransaction=F.prototype.wd=function(a){return this.ja.wd(a)};F.prototype.rollbackTransaction=F.prototype.wp=function(){return this.ja.wp()};F.prototype.updateTargetBindings=F.prototype.Ib=function(a,b){void 0===b&&(b="");Ne(this,"SourceChanged",Pd,b,a,null,null)};
v.defineProperty(F,{wl:"nodeKeyProperty"},function(){return this.Aj},function(a){var b=this.Aj;b!==a&&(Oe(a,F,"nodeKeyProperty"),""===a&&v.k("Model.nodeKeyProperty may not be the empty string"),0<this.rc.count&&v.k("Cannot set Model.nodeKeyProperty when there is existing node data"),this.Aj=a,this.h("nodeKeyProperty",b,a))});function Oe(a,b,c){"string"!==typeof a&&"function"!==typeof a&&v.Ad(a,"string or function",b,c)}
F.prototype.getKeyForNodeData=F.prototype.mb=function(a){if(null!==a){var b=this.Aj;if(""!==b&&(b=v.kb(a,b),void 0!==b)){if(Pe(b))return b;v.k("Key value for node data "+a+" is not a number or a string: "+b)}}};
F.prototype.setKeyForNodeData=F.prototype.vx=function(a,b){void 0!==b&&null!==b&&Pe(b)||v.Ad(b,"number or string",F,"setKeyForNodeData:key");if(null!==a){var c=this.Aj;if(""!==c)if(this.Fe(a)){var d=v.kb(a,c);d!==b&&null===this.ke(b)&&(v.Ha(a,c,b),this.rc.remove(d),this.rc.add(b,a),Ne(this,"nodeKey",Od,c,a,d,b),"string"===typeof c&&this.Ib(a,c),this.Jt(d,b))}else v.Ha(a,c,b)}};
v.defineProperty(F,{DK:"makeUniqueKeyFunction"},function(){return this.fm},function(a){var b=this.fm;b!==a&&(null!==a&&v.j(a,"function",F,"makeUniqueKeyFunction"),this.fm=a,this.h("makeUniqueKeyFunction",b,a))});function Pe(a){return"number"===typeof a||"string"===typeof a}F.prototype.containsNodeData=F.prototype.Fe=function(a){var b=this.mb(a);return void 0===b?!1:this.rc.la(b)===a};
F.prototype.findNodeDataForKey=F.prototype.ke=function(a){null===a&&v.k("Model.findNodeDataForKey:key must not be null");return void 0!==a&&Pe(a)?this.rc.la(a):null};
v.defineProperty(F,{dh:"nodeDataArray"},function(){return this.kf},function(a){var b=this.kf;if(b!==a){v.oz(a,F,"nodeDataArray");this.rc.clear();this.NA();for(var c=v.Va(a),d=0;d<c;d++){var e=v.Pa(a,d);if(!v.Wa(e)){v.k("Model.nodeDataArray must only contain Objects, not: "+e);return}v.ht(e)}this.kf=a;for(var f=new G(Object),d=0;d<c;d++){var e=v.Pa(a,d),h=this.mb(e);void 0===h?f.add(e):null!==this.rc.la(h)?f.add(e):this.rc.add(h,e)}for(d=f.i;d.next();)e=d.value,this.EE(e),f=this.mb(e),void 0!==f&&
this.rc.add(f,e);Ne(this,"nodeDataArray",Od,"nodeDataArray",this,b,a);for(d=0;d<c;d++)e=v.Pa(a,d),this.vp(e),this.tp(e);this.DD();v.QH(a)||(this.gb=!0)}});
F.prototype.makeNodeDataKeyUnique=F.prototype.EE=function(a){if(null!==a){var b=this.Aj;if(""!==b){var c=this.mb(a);if(void 0===c||this.rc.contains(c)){var d=this.fm;if(null!==d&&(c=d(this,a),void 0!==c&&null!==c&&!this.rc.contains(c))){v.Ha(a,b,c);return}if("string"===typeof c){for(d=2;this.rc.contains(c+d);)d++;v.Ha(a,b,c+d)}else if(void 0===c||"number"===typeof c){for(d=-this.rc.count-1;this.rc.contains(d);)d--;v.Ha(a,b,d)}else v.k("Model.getKeyForNodeData returned something other than a string or a number: "+
c)}}}};F.prototype.addNodeData=F.prototype.Vk=function(a){if(null!==a){v.ht(a);var b=this.mb(a);if(void 0===b||this.rc.la(b)!==a)this.EE(a),b=this.mb(a),void 0===b?v.k("Model.makeNodeDataKeyUnique failed on "+a+".  Data not added to Model."):(this.rc.add(b,a),b=v.Va(this.kf),v.Mi(this.kf,b,a),Ne(this,"nodeDataArray",Qd,"nodeDataArray",this,null,a,null,b),this.vp(a),this.tp(a))}};
F.prototype.addNodeDataCollection=function(a){if(v.isArray(a))for(var b=v.Va(a),c=0;c<b;c++)this.Vk(v.Pa(a,c));else for(a=a.i;a.next();)this.Vk(a.value)};F.prototype.removeNodeData=F.prototype.mx=function(a){if(null!==a){var b=this.mb(a);void 0!==b&&this.rc.contains(b)&&(this.rc.remove(b),b=v.nz(this.kf,a),0>b||(v.Th(this.kf,b),Ne(this,"nodeDataArray",be,"nodeDataArray",this,a,null,b,null),this.bu(a)))}};
F.prototype.removeNodeDataCollection=function(a){if(v.isArray(a))for(var b=v.Va(a),c=0;c<b;c++)this.mx(v.Pa(a,c));else for(a=a.i;a.next();)this.mx(a.value)};g=F.prototype;g.Jt=function(a,b){var c=Qe(this,a);c instanceof H&&this.yh.add(b,c)};g.NA=function(){};g.vp=function(){};g.tp=function(){};g.bu=function(){};function Re(a,b,c){if(void 0!==b){var d=a.yh.la(b);null===d&&(d=new H(Object),a.yh.add(b,d));d.add(c)}}
function Se(a,b,c){if(void 0!==b){var d=a.yh.la(b);d instanceof H&&(void 0===c||null===c?a.yh.remove(b):(d.remove(c),0===d.count&&a.yh.remove(b)))}}function Qe(a,b){if(void 0===b)return null;var c=a.yh.la(b);return c instanceof H?c:null}F.prototype.clearUnresolvedReferences=F.prototype.DD=function(a){void 0===a?this.yh.clear():this.yh.remove(a)};
v.defineProperty(F,{TJ:"copyNodeDataFunction"},function(){return this.vn},function(a){var b=this.vn;b!==a&&(null!==a&&v.j(a,"function",F,"copyNodeDataFunction"),this.vn=a,this.h("copyNodeDataFunction",b,a))});v.defineProperty(F,{wz:"copiesArrays"},function(){return this.Cu},function(a){var b=this.Cu;b!==a&&(null!==a&&v.j(a,"boolean",F,"copiesArrays"),this.Cu=a,this.h("copiesArrays",b,a))});
v.defineProperty(F,{vz:"copiesArrayObjects"},function(){return this.fq},function(a){var b=this.fq;b!==a&&(null!==a&&v.j(a,"boolean",F,"copiesArrayObjects"),this.fq=a,this.h("copiesArrayObjects",b,a))});F.prototype.copyNodeData=function(a){if(null===a)return null;var b=null,b=this.vn,b=null!==b?b(a,this):Te(this,a,!0);v.Wa(b)&&v.cc(b);return b};
function Te(a,b,c){if(a.wz&&Array.isArray(b)){var d=[];for(c=0;c<b.length;c++){var e=Te(a,b[c],a.vz);d.push(e)}v.cc(d);return d}if(c&&v.Wa(b)){c=(c=b.constructor)?new c:{};for(d in b)if("__gohashid"!==d){var e=v.kb(b,d),f;f=e;f instanceof R||f instanceof E||f instanceof ze||f instanceof Ue||f instanceof $e||f instanceof Le||f instanceof sa||f instanceof Me||f instanceof Ld||f instanceof Md?("_"!==d[0]&&v.trace('Warning: found GraphObject or Diagram reference when copying model data on property "'+
d+'" of data object: '+b.toString()+"  \nModel data should not have any references to a Diagram or any part of a diagram, such as: "+f.toString()),f=!0):f=f instanceof F||f instanceof de||f instanceof se||f instanceof Nd?!0:!1;f||(e=Te(a,e,!1));v.Ha(c,d,e)}v.cc(c);return c}return b instanceof w?b.copy():b instanceof ia?b.copy():b instanceof z?b.copy():b instanceof L?b.copy():b instanceof tb?b.copy():b}
v.defineProperty(F,{vG:"afterCopyFunction"},function(){return this.Tp},function(a){var b=this.Tp;b!==a&&(null!==a&&v.j(a,"function",F,"afterCopyFunction"),this.Tp=a,this.h("afterCopyFunction",b,a))});var af=!1;
F.prototype.setDataProperty=function(a,b,c){if(this.Fe(a))if(b===this.wl)this.vx(a,c);else{if(b===this.Zm){this.sx(a,c);return}}else!af&&a instanceof R&&(af=!0,v.trace('Model.setDataProperty is modifying a GraphObject, "'+a.toString()+'"'),v.trace("  Is that really your intent?"));var d=v.kb(a,b);d!==c&&(v.Ha(a,b,c),this.nA(a,b,d,c))};F.prototype.addArrayItem=function(a,b){this.KH(a,-1,b)};
F.prototype.insertArrayItem=F.prototype.KH=function(a,b,c){a===this.kf&&v.k("Model.insertArrayItem or Model.addArrayItem should not be called on the Model.nodeDataArray");0>b&&(b=v.Va(a));v.Mi(a,b,c);Ne(this,"",Qd,"",a,null,c,null,b)};F.prototype.removeArrayItem=function(a,b){void 0===b&&(b=-1);a===this.kf&&v.k("Model.removeArrayItem should not be called on the Model.nodeDataArray");-1===b&&(b=v.Va(a)-1);var c=v.Pa(a,b);v.Th(a,b);Ne(this,"",be,"",a,c,null,b,null)};
v.defineProperty(F,{Zm:"nodeCategoryProperty"},function(){return this.hm},function(a){var b=this.hm;b!==a&&(Oe(a,F,"nodeCategoryProperty"),this.hm=a,this.h("nodeCategoryProperty",b,a))});F.prototype.getCategoryForNodeData=F.prototype.Iz=function(a){if(null===a)return"";var b=this.hm;if(""===b)return"";b=v.kb(a,b);if(void 0===b)return"";if("string"===typeof b)return b;v.k("getCategoryForNodeData found a non-string category for "+a+": "+b);return""};
F.prototype.setCategoryForNodeData=F.prototype.sx=function(a,b){v.j(b,"string",F,"setCategoryForNodeData:cat");if(null!==a){var c=this.hm;if(""!==c)if(this.Fe(a)){var d=v.kb(a,c);void 0===d&&(d="");d!==b&&(v.Ha(a,c,b),Ne(this,"nodeCategory",Od,c,a,d,b))}else v.Ha(a,c,b)}};
function Q(a,b){2<arguments.length&&v.k("GraphLinksModel constructor can only take two optional arguments, the Array of node data and the Array of link data.");F.call(this);this.jf=[];this.cm=new H(Object);this.ld=new ma(null,Object);this.Hk="";this.sk=this.un=this.fr=null;this.Fh="from";this.Gh="to";this.em=this.dm="";this.bm="category";this.cg="";this.ho="isGroup";this.Ng="group";this.gq=!1;void 0!==a&&(this.dh=a);void 0!==b&&(this.$h=b)}v.Ga(Q,F);v.ga("GraphLinksModel",Q);
Q.prototype.cloneProtected=function(a){F.prototype.cloneProtected.call(this,a);a.Hk=this.Hk;a.fr=this.fr;a.un=this.un;a.Fh=this.Fh;a.Gh=this.Gh;a.dm=this.dm;a.em=this.em;a.bm=this.bm;a.cg=this.cg;a.ho=this.ho;a.Ng=this.Ng;a.gq=this.gq};Q.prototype.clear=Q.prototype.clear=function(){F.prototype.clear.call(this);this.jf=[];this.ld.clear();this.cm.clear()};g=Q.prototype;
g.toString=function(a){void 0===a&&(a=0);if(2<=a)return this.KA();var b=(""!==this.name?this.name:"")+" GraphLinksModel";if(0<a){b+="\n node data:";a=this.dh;for(var c=v.Va(a),d=0,d=0;d<c;d++)var e=v.Pa(a,d),b=b+(" "+this.mb(e)+":"+ce(e));b+="\n link data:";a=this.$h;c=v.Va(a);for(d=0;d<c;d++)e=v.Pa(a,d),b+=" "+this.kl(e)+"--\x3e"+this.nl(e)}return b};
g.Ip=function(){var a=F.prototype.Ip.call(this),b="";"category"!==this.st&&"string"===typeof this.st&&(b+=',\n  "linkCategoryProperty": '+this.quote(this.st));""!==this.$j&&"string"===typeof this.$j&&(b+=',\n  "linkKeyProperty": '+this.quote(this.$j));"from"!==this.ep&&"string"===typeof this.ep&&(b+=',\n  "linkFromKeyProperty": '+this.quote(this.ep));"to"!==this.gp&&"string"===typeof this.gp&&(b+=',\n  "linkToKeyProperty": '+this.quote(this.gp));""!==this.tt&&"string"===typeof this.tt&&(b+=',\n  "linkFromPortIdProperty": '+
this.quote(this.tt));""!==this.vt&&"string"===typeof this.vt&&(b+=',\n  "linkToPortIdProperty": '+this.quote(this.vt));""!==this.ut&&"string"===typeof this.ut&&(b+=',\n  "linkLabelKeysProperty": '+this.quote(this.ut));"isGroup"!==this.Dt&&"string"===typeof this.Dt&&(b+=',\n  "nodeIsGroupProperty": '+this.quote(this.Dt));"group"!==this.pp&&"string"===typeof this.pp&&(b+=',\n  "nodeGroupKeyProperty": '+this.quote(this.pp));return a+b};
g.Ht=function(a){F.prototype.Ht.call(this,a);a.linkKeyProperty&&(this.$j=a.linkKeyProperty);a.linkFromKeyProperty&&(this.ep=a.linkFromKeyProperty);a.linkToKeyProperty&&(this.gp=a.linkToKeyProperty);a.linkFromPortIdProperty&&(this.tt=a.linkFromPortIdProperty);a.linkToPortIdProperty&&(this.vt=a.linkToPortIdProperty);a.linkCategoryProperty&&(this.st=a.linkCategoryProperty);a.linkLabelKeysProperty&&(this.ut=a.linkLabelKeysProperty);a.nodeIsGroupProperty&&(this.Dt=a.nodeIsGroupProperty);a.nodeGroupKeyProperty&&
(this.pp=a.nodeGroupKeyProperty)};g.SA=function(){var a=F.prototype.SA.call(this),b=',\n  "linkDataArray": '+re(this,this.$h,!0);return a+b};g.pA=function(a){F.prototype.pA.call(this,a);a=a.linkDataArray;v.isArray(a)&&(this.Kt(a),this.$h=a)};
g.RA=function(a,b){""===this.$j&&v.k("GraphLinksModel.linkKeyProperty must not be an empty string for .toIncrementalJson() to succeed.");var c=F.prototype.RA.call(this,a,b),d=this,e=new H,f=new H,h=new H;a.Gf.each(function(a){a.da===d&&("linkDataArray"===a.cf?a.Ac===Qd?e.add(a.newValue):a.Ac===be&&h.add(a.oldValue):d.Vg(a.object)&&f.add(a.object))});var k=new H;e.each(function(a){k.add(d.Jf(a));b||f.add(a)});var l=new H;h.each(function(a){l.add(d.Jf(a));b&&f.add(a)});return c+(b?',\n  "removedLinkKeys": ':
',\n  "insertedLinkKeys": ')+re(this,k.ed(),!0)+',\n  "modifiedLinkData": '+re(this,f.ed(),!0)+(b?',\n  "insertedLinkKeys": ':',\n  "removedLinkKeys": ')+re(this,l.ed(),!0)};
g.oA=function(a){F.prototype.oA.call(this,a);var b=a.insertedLinkKeys;if(v.isArray(b))for(var c=v.Va(b),d=0;d<c;d++){var e=v.Pa(b,d),f=this.Ew(e);null===f&&(f=this.xz({}),this.lF(f,e),this.Gs(f))}b=a.modifiedLinkData;if(v.isArray(b))for(c=v.Va(b),d=0;d<c;d++){var h=v.Pa(b,d),e=this.Jf(h),f=this.Ew(e);if(null!==f)for(var k in h)"__gohashid"!==k&&k!==this.$j&&this.setDataProperty(f,k,h[k])}a=a.removedLinkKeys;if(v.isArray(a))for(c=v.Va(a),d=0;d<c;d++)e=v.Pa(a,d),f=this.Ew(e),null!==f&&this.lx(f)};
g.Em=function(a,b){var c=null;if(a.Ac===Qd){if("linkDataArray"===a.cf?c=this.jf:"linkLabelKeys"===a.cf&&(c=this.Xj(a.object)),v.isArray(c)){if(b)v.Th(c,a.vg),c===this.jf&&(c=this.Jf(a.newValue),void 0!==c&&this.ld.remove(c));else if(v.Mi(c,a.vg,a.newValue),c===this.jf){var d=a.newValue,c=this.Jf(d);void 0!==c&&this.ld.add(c,d)}return}}else if(a.Ac===be&&("linkDataArray"===a.cf?c=this.jf:"linkLabelKeys"===a.cf&&(c=this.Xj(a.object)),v.isArray(c))){b?(v.Mi(c,a.xg,a.oldValue),c===this.jf&&(d=a.newValue,
c=this.Jf(d),void 0!==c&&this.ld.add(c,d))):(v.Th(c,a.xg),c===this.jf&&(c=this.Jf(a.newValue),void 0!==c&&this.ld.remove(c)));return}F.prototype.Em.call(this,a,b)};v.defineProperty(Q,{mz:"archetypeNodeData"},function(){return this.sk},function(a){var b=this.sk;b!==a&&(null!==a&&v.C(a,Object,Q,"archetypeNodeData"),this.sk=a,this.h("archetypeNodeData",b,a))});Q.prototype.Xm=function(a){if(void 0!==a){var b=this.sk;if(null!==b){var c=this.ke(a);null===c&&(c=this.copyNodeData(b),v.Ha(c,this.Aj,a),this.Vk(c))}return a}};
v.defineProperty(Q,{ep:"linkFromKeyProperty"},function(){return this.Fh},function(a){var b=this.Fh;b!==a&&(Oe(a,Q,"linkFromKeyProperty"),this.Fh=a,this.h("linkFromKeyProperty",b,a))});Q.prototype.getFromKeyForLinkData=Q.prototype.kl=function(a){if(null!==a){var b=this.Fh;if(""!==b&&(b=v.kb(a,b),void 0!==b)){if(Pe(b))return b;v.k("FromKey value for link data "+a+" is not a number or a string: "+b)}}};
Q.prototype.setFromKeyForLinkData=Q.prototype.tx=function(a,b){null===b&&(b=void 0);void 0===b||Pe(b)||v.Ad(b,"number or string",Q,"setFromKeyForLinkData:key");if(null!==a){var c=this.Fh;if(""!==c)if(b=this.Xm(b),this.Vg(a)){var d=v.kb(a,c);d!==b&&(Se(this,d,a),v.Ha(a,c,b),null===this.ke(b)&&Re(this,b,a),Ne(this,"linkFromKey",Od,c,a,d,b),"string"===typeof c&&this.Ib(a,c))}else v.Ha(a,c,b)}};
v.defineProperty(Q,{gp:"linkToKeyProperty"},function(){return this.Gh},function(a){var b=this.Gh;b!==a&&(Oe(a,Q,"linkToKeyProperty"),this.Gh=a,this.h("linkToKeyProperty",b,a))});Q.prototype.getToKeyForLinkData=Q.prototype.nl=function(a){if(null!==a){var b=this.Gh;if(""!==b&&(b=v.kb(a,b),void 0!==b)){if(Pe(b))return b;v.k("ToKey value for link data "+a+" is not a number or a string: "+b)}}};
Q.prototype.setToKeyForLinkData=Q.prototype.wx=function(a,b){null===b&&(b=void 0);void 0===b||Pe(b)||v.Ad(b,"number or string",Q,"setToKeyForLinkData:key");if(null!==a){var c=this.Gh;if(""!==c)if(b=this.Xm(b),this.Vg(a)){var d=v.kb(a,c);d!==b&&(Se(this,d,a),v.Ha(a,c,b),null===this.ke(b)&&Re(this,b,a),Ne(this,"linkToKey",Od,c,a,d,b),"string"===typeof c&&this.Ib(a,c))}else v.Ha(a,c,b)}};
v.defineProperty(Q,{tt:"linkFromPortIdProperty"},function(){return this.dm},function(a){var b=this.dm;b!==a&&(Oe(a,Q,"linkFromPortIdProperty"),this.dm=a,this.h("linkFromPortIdProperty",b,a))});Q.prototype.getFromPortIdForLinkData=Q.prototype.sH=function(a){if(null===a)return"";var b=this.dm;if(""===b)return"";a=v.kb(a,b);return void 0===a?"":a};
Q.prototype.setFromPortIdForLinkData=Q.prototype.AA=function(a,b){v.j(b,"string",Q,"setFromPortIdForLinkData:portname");if(null!==a){var c=this.dm;if(""!==c)if(this.Vg(a)){var d=v.kb(a,c);void 0===d&&(d="");d!==b&&(v.Ha(a,c,b),Ne(this,"linkFromPortId",Od,c,a,d,b),"string"===typeof c&&this.Ib(a,c))}else v.Ha(a,c,b)}};v.defineProperty(Q,{vt:"linkToPortIdProperty"},function(){return this.em},function(a){var b=this.em;b!==a&&(Oe(a,Q,"linkToPortIdProperty"),this.em=a,this.h("linkToPortIdProperty",b,a))});
Q.prototype.getToPortIdForLinkData=Q.prototype.vH=function(a){if(null===a)return"";var b=this.em;if(""===b)return"";a=v.kb(a,b);return void 0===a?"":a};Q.prototype.setToPortIdForLinkData=Q.prototype.EA=function(a,b){v.j(b,"string",Q,"setToPortIdForLinkData:portname");if(null!==a){var c=this.em;if(""!==c)if(this.Vg(a)){var d=v.kb(a,c);void 0===d&&(d="");d!==b&&(v.Ha(a,c,b),Ne(this,"linkToPortId",Od,c,a,d,b),"string"===typeof c&&this.Ib(a,c))}else v.Ha(a,c,b)}};
v.defineProperty(Q,{ut:"linkLabelKeysProperty"},function(){return this.cg},function(a){var b=this.cg;b!==a&&(Oe(a,Q,"linkLabelKeysProperty"),this.cg=a,this.h("linkLabelKeysProperty",b,a))});Q.prototype.getLabelKeysForLinkData=Q.prototype.Xj=function(a){if(null===a)return v.qh;var b=this.cg;if(""===b)return v.qh;a=v.kb(a,b);return void 0===a?v.qh:a};
Q.prototype.setLabelKeysForLinkData=Q.prototype.mF=function(a,b){v.oz(b,Q,"setLabelKeysForLinkData:arr");if(null!==a){var c=this.cg;if(""!==c)if(this.Vg(a)){var d=v.kb(a,c);void 0===d&&(d=v.qh);if(d!==b){for(var e=v.Va(d),f=0;f<e;f++){var h=v.Pa(d,f);Se(this,h,a)}v.Ha(a,c,b);e=v.Va(b);for(f=0;f<e;f++)h=v.Pa(b,f),null===this.ke(h)&&Re(this,h,a);Ne(this,"linkLabelKeys",Od,c,a,d,b);"string"===typeof c&&this.Ib(a,c)}}else v.Ha(a,c,b)}};
Q.prototype.addLabelKeyForLinkData=Q.prototype.jz=function(a,b){if(null!==b&&void 0!==b&&(Pe(b)||v.Ad(b,"number or string",Q,"addLabelKeyForLinkData:key"),null!==a)){var c=this.cg;if(""!==c){var d=v.kb(a,c);void 0===d?(c=[],c.push(b),this.mF(a,c)):v.isArray(d)?0<=v.nz(d,b)||(v.Mi(d,Infinity,b),this.Vg(a)&&(null===this.ke(b)&&Re(this,b,a),Ne(this,"linkLabelKeys",Qd,c,a,null,b))):v.k(c+" property is not an Array; cannot addLabelKeyForLinkData: "+a)}}};
Q.prototype.removeLabelKeyForLinkData=Q.prototype.TE=function(a,b){if(null!==b&&void 0!==b&&(Pe(b)||v.Ad(b,"number or string",Q,"removeLabelKeyForLinkData:key"),null!==a)){var c=this.cg;if(""!==c){var d=v.kb(a,c);if(v.isArray(d)){var e=v.nz(d,b);0>e||(v.Th(d,e),this.Vg(a)&&(Se(this,b,a),Ne(this,"linkLabelKeys",be,c,a,b,null)))}else void 0!==d&&v.k(c+" property is not an Array; cannot removeLabelKeyforLinkData: "+a)}}};
v.defineProperty(Q,{$h:"linkDataArray"},function(){return this.jf},function(a){var b=this.jf;if(b!==a){v.oz(a,Q,"linkDataArray");this.ld.clear();for(var c=v.Va(a),d=0;d<c;d++){var e=v.Pa(a,d);if(!v.Wa(e)){v.k("GraphLinksModel.linkDataArray must only contain Objects, not: "+e);return}v.ht(e)}this.jf=a;if(""!==this.$j){for(var f=new G(Object),d=0;d<c;d++){var e=v.Pa(a,d),h=this.Jf(e);void 0===h?f.add(e):null!==this.ld.la(h)?f.add(e):this.ld.add(h,e)}for(d=f.i;d.next();)e=d.value,this.DE(e),f=this.Jf(e),
void 0!==f&&this.ld.add(f,e)}f=new H(Object);for(d=0;d<c;d++)e=v.Pa(a,d),f.add(e);this.cm=f;Ne(this,"linkDataArray",Od,"linkDataArray",this,b,a);for(d=0;d<c;d++)e=v.Pa(a,d),bf(this,e)}});v.defineProperty(Q,{$j:"linkKeyProperty"},function(){return this.Hk},function(a){var b=this.Hk;if(b!==a){Oe(a,Q,"linkKeyProperty");this.Hk=a;this.ld.clear();for(var c=v.Va(this.$h),d=0;d<c;d++){var e=v.Pa(this.$h,d),f=this.Jf(e);void 0!==f&&this.ld.add(f,e)}this.h("linkKeyProperty",b,a)}});
Q.prototype.getKeyForLinkData=Q.prototype.Jf=function(a){if(null!==a){var b=this.Hk;if(""!==b&&(b=v.kb(a,b),void 0!==b)){if(Pe(b))return b;v.k("Key value for link data "+a+" is not a number or a string: "+b)}}};
Q.prototype.setKeyForLinkData=Q.prototype.lF=function(a,b){void 0!==b&&null!==b&&Pe(b)||v.Ad(b,"number or string",Q,"setKeyForLinkData:key");if(null!==a){var c=this.Hk;if(""!==c)if(this.Vg(a)){var d=v.kb(a,c);d!==b&&null===this.Ew(b)&&(v.Ha(a,c,b),this.ld.remove(d),this.ld.add(b,a),Ne(this,"linkKey",Od,c,a,d,b),"string"===typeof c&&this.Ib(a,c))}else v.Ha(a,c,b)}};
v.defineProperty(Q,{EK:"makeUniqueLinkKeyFunction"},function(){return this.fr},function(a){var b=this.fr;b!==a&&(null!==a&&v.j(a,"function",Q,"makeUniqueLinkKeyFunction"),this.fr=a,this.h("makeUniqueLinkKeyFunction",b,a))});Q.prototype.findLinkDataForKey=Q.prototype.Ew=function(a){null===a&&v.k("GraphLinksModel.findLinkDataForKey:key must not be null");return void 0!==a&&Pe(a)?this.ld.la(a):null};
Q.prototype.makeLinkDataKeyUnique=Q.prototype.DE=function(a){if(null!==a){var b=this.Hk;if(""!==b){var c=this.Jf(a);if(void 0===c||this.ld.contains(c)){var d=this.fm;if(null!==d&&(c=d(this,a),void 0!==c&&null!==c&&!this.ld.contains(c))){v.Ha(a,b,c);return}if("string"===typeof c){for(d=2;this.ld.contains(c+d);)d++;v.Ha(a,b,c+d)}else if(void 0===c||"number"===typeof c){for(d=-this.ld.count-1;this.ld.contains(d);)d--;v.Ha(a,b,d)}else v.k("GraphLinksModel.getKeyForLinkData returned something other than a string or a number: "+
c)}}}};Q.prototype.containsLinkData=Q.prototype.Vg=function(a){return null===a?!1:this.cm.contains(a)};
Q.prototype.addLinkData=Q.prototype.Gs=function(a){if(null!==a){if(void 0===v.cd(a))v.cc(a);else if(this.Vg(a))return;if(""!==this.$j){var b=this.Jf(a);if(void 0!==b&&this.ld.la(b)===a)return;this.DE(a);b=this.Jf(a);if(void 0===b){v.k("GraphLinksModel.makeLinkDataKeyUnique failed on "+a+". Data not added to model.");return}this.ld.add(b,a)}this.cm.add(a);b=v.Va(this.jf);v.Mi(this.jf,b,a);Ne(this,"linkDataArray",Qd,"linkDataArray",this,null,a,null,b);bf(this,a)}};
Q.prototype.addLinkDataCollection=function(a){if(v.isArray(a))for(var b=v.Va(a),c=0;c<b;c++)this.Gs(v.Pa(a,c));else for(a=a.i;a.next();)this.Gs(a.value)};
Q.prototype.removeLinkData=Q.prototype.lx=function(a){if(null!==a){this.cm.remove(a);var b=this.Jf(a);void 0!==b&&this.ld.remove(b);b=this.jf.indexOf(a);if(!(0>b)){v.Th(this.jf,b);Ne(this,"linkDataArray",be,"linkDataArray",this,a,null,b,null);b=this.kl(a);Se(this,b,a);b=this.nl(a);Se(this,b,a);var c=this.Xj(a);if(v.isArray(c))for(var d=v.Va(c),e=0;e<d;e++)b=v.Pa(c,e),Se(this,b,a)}}};
Q.prototype.removeLinkDataCollection=function(a){if(v.isArray(a))for(var b=v.Va(a),c=0;c<b;c++)this.lx(v.Pa(a,c));else for(a=a.i;a.next();)this.lx(a.value)};function bf(a,b){var c=a.kl(b),c=a.Xm(c);null===a.ke(c)&&Re(a,c,b);c=a.nl(b);c=a.Xm(c);null===a.ke(c)&&Re(a,c,b);var d=a.Xj(b);if(v.isArray(d))for(var e=v.Va(d),f=0;f<e;f++)c=v.Pa(d,f),null===a.ke(c)&&Re(a,c,b)}
v.defineProperty(Q,{SJ:"copyLinkDataFunction"},function(){return this.un},function(a){var b=this.un;b!==a&&(null!==a&&v.j(a,"function",Q,"copyLinkDataFunction"),this.un=a,this.h("copyLinkDataFunction",b,a))});Q.prototype.copyLinkData=Q.prototype.xz=function(a){if(null===a)return null;var b=null,b=this.un,b=null!==b?b(a,this):Te(this,a,!0);v.Wa(b)&&(v.cc(b),""!==this.Fh&&v.Ha(b,this.Fh,void 0),""!==this.Gh&&v.Ha(b,this.Gh,void 0),""!==this.cg&&v.Ha(b,this.cg,[]));return b};
v.defineProperty(Q,{Dt:"nodeIsGroupProperty"},function(){return this.ho},function(a){var b=this.ho;b!==a&&(Oe(a,Q,"nodeIsGroupProperty"),this.ho=a,this.h("nodeIsGroupProperty",b,a))});Q.prototype.isGroupForNodeData=Q.prototype.Rz=function(a){if(null===a)return!1;var b=this.ho;return""===b?!1:v.kb(a,b)?!0:!1};v.defineProperty(Q,{pp:"nodeGroupKeyProperty"},function(){return this.Ng},function(a){var b=this.Ng;b!==a&&(Oe(a,Q,"nodeGroupKeyProperty"),this.Ng=a,this.h("nodeGroupKeyProperty",b,a))});
v.defineProperty(Q,{Im:"copiesGroupKeyOfNodeData"},function(){return this.gq},function(a){this.gq!==a&&(v.j(a,"boolean",Q,"copiesGroupKeyOfNodeData"),this.gq=a)});Q.prototype.getGroupKeyForNodeData=Q.prototype.Rm=function(a){if(null!==a){var b=this.Ng;if(""!==b&&(b=v.kb(a,b),void 0!==b)){if(Pe(b))return b;v.k("GroupKey value for node data "+a+" is not a number or a string: "+b)}}};
Q.prototype.setGroupKeyForNodeData=Q.prototype.ux=function(a,b){null===b&&(b=void 0);void 0===b||Pe(b)||v.Ad(b,"number or string",Q,"setGroupKeyForNodeData:key");if(null!==a){var c=this.Ng;if(""!==c)if(this.Fe(a)){var d=v.kb(a,c);d!==b&&(Se(this,d,a),v.Ha(a,c,b),null===this.ke(b)&&Re(this,b,a),Ne(this,"nodeGroupKey",Od,c,a,d,b),"string"===typeof c&&this.Ib(a,c))}else v.Ha(a,c,b)}};
Q.prototype.copyNodeData=function(a){if(null===a)return null;a=F.prototype.copyNodeData.call(this,a);this.Im||""===this.Ng||void 0===v.kb(a,this.Ng)||v.Ha(a,this.Ng,void 0);return a};
Q.prototype.setDataProperty=function(a,b,c){if(this.Fe(a))if(b===this.wl)this.vx(a,c);else{if(b===this.Zm){this.sx(a,c);return}if(b===this.pp){this.ux(a,c);return}b===this.Dt&&v.k("GraphLinksModel.setDataProperty: property name must not be the nodeIsGroupProperty: "+b)}else if(this.Vg(a)){if(b===this.ep){this.tx(a,c);return}if(b===this.gp){this.wx(a,c);return}if(b===this.tt){this.AA(a,c);return}if(b===this.vt){this.EA(a,c);return}if(b===this.$j){this.lF(a,c);return}if(b===this.st){this.kF(a,c);return}if(b===
this.ut){this.mF(a,c);return}}else!af&&a instanceof R&&(af=!0,v.trace('GraphLinksModel.setDataProperty is modifying a GraphObject, "'+a.toString()+'"'),v.trace("  Is that really your intent?"));var d=v.kb(a,b);d!==c&&(v.Ha(a,b,c),this.nA(a,b,d,c))};g=Q.prototype;
g.Jt=function(a,b){F.prototype.Jt.call(this,a,b);for(var c=this.rc.i;c.next();)this.vA(c.value,a,b);for(var d=this.cm.i;d.next();){var e=c.value,f=a,h=b;if(this.kl(e)===f){var k=this.Fh;v.Ha(e,k,h);Ne(this,"linkFromKey",Od,k,e,f,h);"string"===typeof k&&this.Ib(e,k)}this.nl(e)===f&&(k=this.Gh,v.Ha(e,k,h),Ne(this,"linkToKey",Od,k,e,f,h),"string"===typeof k&&this.Ib(e,k));var l=this.Xj(e);if(v.isArray(l))for(var m=v.Va(l),k=this.cg,n=0;n<m;n++)v.Pa(l,n)===f&&(v.xD(l,n,h),Ne(this,"linkLabelKeys",Qd,k,
e,f,h))}};g.vA=function(a,b,c){if(this.Rm(a)===b){var d=this.Ng;v.Ha(a,d,c);Ne(this,"nodeGroupKey",Od,d,a,b,c);"string"===typeof d&&this.Ib(a,d)}};g.NA=function(){F.prototype.NA.call(this);for(var a=this.$h,b=v.Va(a),c=0;c<b;c++){var d=v.Pa(a,c);bf(this,d)}};
g.vp=function(a){F.prototype.vp.call(this,a);a=this.mb(a);var b=Qe(this,a);if(null!==b){for(var c=new G(Object),b=b.i;b.next();){var d=b.value;if(this.Fe(d)){if(this.Rm(d)===a){var e=this.Ng;Ne(this,"nodeGroupKey",Od,e,d,a,a);"string"===typeof e&&this.Ib(d,e);c.add(d)}}else{this.kl(d)===a&&(e=this.Fh,Ne(this,"linkFromKey",Od,e,d,a,a),"string"===typeof e&&this.Ib(d,e),c.add(d));this.nl(d)===a&&(e=this.Gh,Ne(this,"linkToKey",Od,e,d,a,a),"string"===typeof e&&this.Ib(d,e),c.add(d));var f=this.Xj(d);if(v.isArray(f))for(var h=
v.Va(f),e=this.cg,k=0;k<h;k++)v.Pa(f,k)===a&&(Ne(this,"linkLabelKeys",Qd,e,d,a,a),c.add(d))}}for(c=c.i;c.next();)Se(this,a,c.value)}};g.tp=function(a){F.prototype.tp.call(this,a);var b=this.Rm(a);null===this.ke(b)&&Re(this,b,a)};g.bu=function(a){F.prototype.bu.call(this,a);var b=this.Rm(a);Se(this,b,a)};v.defineProperty(Q,{st:"linkCategoryProperty"},function(){return this.bm},function(a){var b=this.bm;b!==a&&(Oe(a,Q,"linkCategoryProperty"),this.bm=a,this.h("linkCategoryProperty",b,a))});
Q.prototype.getCategoryForLinkData=Q.prototype.Iw=function(a){if(null===a)return"";var b=this.bm;if(""===b)return"";b=v.kb(a,b);if(void 0===b)return"";if("string"===typeof b)return b;v.k("getCategoryForLinkData found a non-string category for "+a+": "+b);return""};
Q.prototype.setCategoryForLinkData=Q.prototype.kF=function(a,b){v.j(b,"string",Q,"setCategoryForLinkData:cat");if(null!==a){var c=this.bm;if(""===c)return"";if(this.Vg(a)){var d=v.kb(a,c);void 0===d&&(d="");d!==b&&(v.Ha(a,c,b),Ne(this,"linkCategory",Od,c,a,d,b),"string"===typeof c&&this.Ib(a,c))}else v.Ha(a,c,b)}};
function te(a){1<arguments.length&&v.k("TreeModel constructor can only take one optional argument, the Array of node data.");F.call(this);this.Og="parent";this.hq=!1;this.jm="parentLinkCategory";void 0!==a&&(this.dh=a)}v.Ga(te,F);v.ga("TreeModel",te);te.prototype.cloneProtected=function(a){F.prototype.cloneProtected.call(this,a);a.Og=this.Og;a.hq=this.hq;a.jm=this.jm};
te.prototype.toString=function(a){void 0===a&&(a=0);if(2<=a)return this.KA();var b=(""!==this.name?this.name:"")+" TreeModel";if(0<a){b+="\n node data:";a=this.dh;for(var c=v.Va(a),d=0;d<c;d++)var e=v.Pa(a,d),b=b+(" "+this.mb(e)+":"+ce(e))}return b};te.prototype.Ip=function(){var a=F.prototype.Ip.call(this),b="";"parent"!==this.qp&&"string"===typeof this.qp&&(b+=',\n  "nodeParentKeyProperty": '+this.quote(this.qp));return a+b};
te.prototype.Ht=function(a){F.prototype.Ht.call(this,a);a.nodeParentKeyProperty&&(this.qp=a.nodeParentKeyProperty)};te.prototype.Xm=function(a){return a};v.defineProperty(te,{qp:"nodeParentKeyProperty"},function(){return this.Og},function(a){var b=this.Og;b!==a&&(Oe(a,te,"nodeParentKeyProperty"),this.Og=a,this.h("nodeParentKeyProperty",b,a))});
v.defineProperty(te,{Jm:"copiesParentKeyOfNodeData"},function(){return this.hq},function(a){this.hq!==a&&(v.j(a,"boolean",te,"copiesParentKeyOfNodeData"),this.hq=a)});te.prototype.getParentKeyForNodeData=te.prototype.Sm=function(a){if(null!==a){var b=this.Og;if(""!==b&&(b=v.kb(a,b),void 0!==b)){if(Pe(b))return b;v.k("ParentKey value for node data "+a+" is not a number or a string: "+b)}}};
te.prototype.setParentKeyForNodeData=te.prototype.mh=function(a,b){null===b&&(b=void 0);void 0===b||Pe(b)||v.Ad(b,"number or string",te,"setParentKeyForNodeData:key");if(null!==a){var c=this.Og;if(""!==c)if(b=this.Xm(b),this.Fe(a)){var d=v.kb(a,c);d!==b&&(Se(this,d,a),v.Ha(a,c,b),null===this.ke(b)&&Re(this,b,a),Ne(this,"nodeParentKey",Od,c,a,d,b),"string"===typeof c&&this.Ib(a,c))}else v.Ha(a,c,b)}};
v.defineProperty(te,{ZK:"parentLinkCategoryProperty"},function(){return this.jm},function(a){var b=this.jm;b!==a&&(Oe(a,te,"parentLinkCategoryProperty"),this.jm=a,this.h("parentLinkCategoryProperty",b,a))});te.prototype.getParentLinkCategoryForNodeData=te.prototype.uH=function(a){if(null===a)return"";var b=this.jm;if(""===b)return"";b=v.kb(a,b);if(void 0===b)return"";if("string"===typeof b)return b;v.k("getParentLinkCategoryForNodeData found a non-string category for "+a+": "+b);return""};
te.prototype.setParentLinkCategoryForNodeData=te.prototype.UI=function(a,b){v.j(b,"string",te,"setParentLinkCategoryForNodeData:cat");if(null!==a){var c=this.jm;if(""===c)return"";if(this.Fe(a)){var d=v.kb(a,c);void 0===d&&(d="");d!==b&&(v.Ha(a,c,b),Ne(this,"parentLinkCategory",Od,c,a,d,b),"string"===typeof c&&this.Ib(a,c))}else v.Ha(a,c,b)}};
te.prototype.copyNodeData=function(a){if(null===a)return null;a=F.prototype.copyNodeData.call(this,a);this.Jm||""===this.Og||void 0===v.kb(a,this.Og)||v.Ha(a,this.Og,void 0);return a};
te.prototype.setDataProperty=function(a,b,c){if(this.Fe(a))if(b===this.wl)this.vx(a,c);else{if(b===this.Zm){this.sx(a,c);return}if(b===this.qp){this.mh(a,c);return}}else!af&&a instanceof R&&(af=!0,v.trace('TreeModel.setDataProperty is modifying a GraphObject, "'+a.toString()+'"'),v.trace("  Is that really your intent?"));var d=v.kb(a,b);d!==c&&(v.Ha(a,b,c),this.nA(a,b,d,c))};g=te.prototype;g.Jt=function(a,b){F.prototype.Jt.call(this,a,b);for(var c=this.rc.i;c.next();)this.vA(c.value,a,b)};
g.vA=function(a,b,c){if(this.Sm(a)===b){var d=this.Og;v.Ha(a,d,c);Ne(this,"nodeParentKey",Od,d,a,b,c);"string"===typeof d&&this.Ib(a,d)}};g.vp=function(a){F.prototype.vp.call(this,a);a=this.mb(a);var b=Qe(this,a);if(null!==b){for(var c=new G(Object),b=b.i;b.next();){var d=b.value;if(this.Fe(d)&&this.Sm(d)===a){var e=this.Og;Ne(this,"nodeParentKey",Od,e,d,a,a);"string"===typeof e&&this.Ib(d,e);c.add(d)}}for(c=c.i;c.next();)Se(this,a,c.value)}};
g.tp=function(a){F.prototype.tp.call(this,a);var b=this.Sm(a),b=this.Xm(b);null===this.ke(b)&&Re(this,b,a)};g.bu=function(a){F.prototype.bu.call(this,a);var b=this.Sm(a);Se(this,b,a)};
function cf(a,b,c){v.cc(this);this.Ea=!1;void 0===a?a="":v.j(a,"string",cf,"constructor:targetprop");void 0===b?b=a:v.j(b,"string",cf,"constructor:sourceprop");void 0===c?c=null:null!==c&&v.j(c,"function",cf,"constructor:conv");this.SC=-1;this.ig=null;this.Zv=a;this.Xv=this.$y=0;this.OC=null;this.dz=!1;this.Qv=b;this.Zx=c;this.My=df;this.Tx=null}v.ga("Binding",cf);var df;cf.OneWay=df=v.p(cf,"OneWay",1);var ef;cf.TwoWay=ef=v.p(cf,"TwoWay",2);
cf.parseEnum=function(a,b){v.j(a,"function",cf,"parseEnum:ctor");v.qb(b,a,cf,"parseEnum:defval");return function(c){c=Da(a,c);return null===c?b:c}};var ce;cf.toString=ce=function(a){var b=a;v.Wa(a)&&(a.text?b=a.text:a.name?b=a.name:void 0!==a.key?b=a.key:void 0!==a.id?b=a.id:a.constructor===Object&&(a.Text?b=a.Text:a.Name?b=a.Name:void 0!==a.Key?b=a.Key:void 0!==a.Id?b=a.Id:void 0!==a.ID&&(b=a.ID)));return void 0===b?"undefined":null===b?"null":b.toString()};
cf.prototype.toString=function(){return"Binding("+this.Ax+":"+this.qF+(-1!==this.Dl?" "+this.Dl:"")+" "+this.mode.name+")"};cf.prototype.freeze=function(){this.Ea=!0;return this};cf.prototype.Na=function(){this.Ea=!1;return this};v.defineProperty(cf,{Dl:null},function(){return this.SC},function(a){v.I(this);v.j(a,"number",cf,"targetId");this.SC=a});v.defineProperty(cf,{Ax:"targetProperty"},function(){return this.Zv},function(a){v.I(this);v.j(a,"string",cf,"targetProperty");this.Zv=a});
v.defineProperty(cf,{dn:"sourceName"},function(){return this.OC},function(a){v.I(this);null!==a&&v.j(a,"string",cf,"sourceName");this.OC=a;null!==a&&(this.dz=!1)});v.defineProperty(cf,{$t:"toModel"},function(){return this.dz},function(a){v.I(this);v.j(a,"boolean",cf,"toModel");this.dz=a});v.defineProperty(cf,{qF:"sourceProperty"},function(){return this.Qv},function(a){v.I(this);v.j(a,"string",cf,"sourceProperty");this.Qv=a});
v.defineProperty(cf,{OG:"converter"},function(){return this.Zx},function(a){v.I(this);null!==a&&v.j(a,"function",cf,"converter");this.Zx=a});v.defineProperty(cf,{BG:"backConverter"},function(){return this.Tx},function(a){v.I(this);null!==a&&v.j(a,"function",cf,"backConverter");this.Tx=a});v.defineProperty(cf,{mode:"mode"},function(){return this.My},function(a){v.I(this);v.qb(a,cf,cf,"mode");this.My=a});
cf.prototype.makeTwoWay=cf.prototype.fI=function(a){void 0===a&&(a=null);null!==a&&v.j(a,"function",cf,"makeTwoWay");this.mode=ef;this.BG=a;return this};cf.prototype.ofObject=cf.prototype.ax=function(a){void 0===a&&(a="");this.dn=a;this.$t=!1;return this};cf.prototype.ofModel=function(){this.dn=null;this.$t=!0;return this};cf.prototype.ofData=function(){this.dn=null;this.$t=!1;return this};function ff(a,b,c){a=a.dn;var d=null;return d=null===a||""===a?b:"."===a?c:".."===a?c.T:b.Yd(a)}
cf.prototype.updateTarget=cf.prototype.GF=function(a,b,c){var d=this.Qv;if(void 0===c||d===c){c=this.Zv;var e=this.Zx;if(null===e&&""===c)v.trace("Binding error: target property is the empty string: "+this.toString());else{var f=b;""!==d&&(f=v.kb(b,d));if(void 0!==f)if(null===e)""!==c&&v.Ha(a,c,f);else try{if(""!==c){var h=e(f,a);v.Ha(a,c,h)}else e(f,a)}catch(k){}}}};
cf.prototype.updateSource=cf.prototype.Bx=function(a,b,c,d){void 0===d&&(d=null);if(this.My===ef){var e=this.Zv;if(void 0===c||e===c){c=this.Qv;var f=this.Tx;if(null!==f||""!==c){var h=a;""!==e&&(h=v.kb(a,e));if(void 0!==h)if(null===f)null!==d&&d.da?d.da.setDataProperty(b,c,h):v.Ha(b,c,h);else try{if(""!==c){var k=f(h,b);null!==d&&d.da?d.da.setDataProperty(b,c,k):v.Ha(b,c,k)}else f(h,b)}catch(l){}}}}};function se(){this.TF=(new G(Nd)).freeze();this.Ob="";this.UB=!1}v.ga("Transaction",se);
se.prototype.toString=function(a){var b="Transaction: "+this.name+" "+this.Gf.count.toString()+(this.lt?"":", incomplete");if(void 0!==a&&0<a){a=this.Gf.count;for(var c=0;c<a;c++){var d=this.Gf.ha(c);null!==d&&(b+="\n  "+d.toString())}}return b};se.prototype.clear=se.prototype.clear=function(){var a=this.Gf;a.Na();for(var b=a.count-1;0<=b;b--){var c=a.ha(b);null!==c&&c.clear()}a.clear();a.freeze()};se.prototype.canUndo=se.prototype.canUndo=function(){return this.lt};
se.prototype.undo=se.prototype.undo=function(){if(this.canUndo())for(var a=this.Gf.count-1;0<=a;a--){var b=this.Gf.ha(a);null!==b&&b.undo()}};se.prototype.canRedo=se.prototype.canRedo=function(){return this.lt};se.prototype.redo=se.prototype.redo=function(){if(this.canRedo())for(var a=this.Gf.count,b=0;b<a;b++){var c=this.Gf.ha(b);null!==c&&c.redo()}};v.u(se,{Gf:"changes"},function(){return this.TF});v.defineProperty(se,{name:"name"},function(){return this.Ob},function(a){this.Ob=a});
v.defineProperty(se,{lt:"isComplete"},function(){return this.UB},function(a){this.UB=a});function de(){this.Oy=new H(F);this.Pe=!1;this.XF=(new G(se)).freeze();this.Hg=-1;this.iC=999;this.ri=!1;this.Hu=null;this.Tk=0;this.iB=!1;this.Mg=(new G("string")).freeze();this.fo=new G("number");this.uy=!0;this.Hy=!1}v.ga("UndoManager",de);
de.prototype.toString=function(a){for(var b="UndoManager "+this.Ti+"<"+this.history.count+"<="+this.FE,b=b+"[",c=this.KE.count,d=0;d<c;d++)0<d&&(b+=" "),b+=this.KE.ha(d);b+="]";if(void 0!==a&&0<a)for(c=this.history.count,d=0;d<c;d++)b+="\n "+this.history.ha(d).toString(a-1);return b};
de.prototype.clear=de.prototype.clear=function(){var a=this.history;a.Na();for(var b=a.count-1;0<=b;b--){var c=a.ha(b);null!==c&&c.clear()}a.clear();this.Hg=-1;a.freeze();this.ri=!1;this.Hu=null;this.Tk=0;this.Mg.Na();this.Mg.clear();this.Mg.freeze();this.fo.clear()};de.prototype.addModel=de.prototype.tG=function(a){this.Oy.add(a)};de.prototype.removeModel=de.prototype.EI=function(a){this.Oy.remove(a)};
de.prototype.startTransaction=de.prototype.Qb=function(a){void 0===a&&(a="");null===a&&(a="");if(this.ib)return!1;!0===this.uy&&(this.uy=!1,this.Tk++,this.Xc("StartingFirstTransaction",a,this.Pi),0<this.Tk&&this.Tk--);this.isEnabled&&(this.Mg.Na(),this.Mg.add(a),this.Mg.freeze(),null===this.Pi?this.fo.add(0):this.fo.add(this.Pi.Gf.count));this.Tk++;var b=1===this.ph;b&&this.Xc("StartedTransaction",a,this.Pi);return b};
de.prototype.commitTransaction=de.prototype.wd=function(a){void 0===a&&(a="");return gf(this,!0,a)};de.prototype.rollbackTransaction=de.prototype.wp=function(){return gf(this,!1,"")};
function gf(a,b,c){if(a.ib)return!1;a.pz&&1>a.ph&&v.trace("Ending transaction without having started a transaction: "+c);var d=1===a.ph;d&&b&&a.isEnabled&&a.Xc("CommittingTransaction",c,a.Pi);var e=0;if(0<a.ph&&(a.Tk--,a.isEnabled)){var f=a.Mg.count;0<f&&(""===c&&(c=a.Mg.ha(0)),a.Mg.Na(),a.Mg.Rc(f-1),a.Mg.freeze());f=a.fo.count;0<f&&(e=a.fo.ha(f-1),a.fo.Rc(f-1))}f=a.Pi;if(d){if(b){a.Hy=!1;if(a.isEnabled&&null!==f){b=f;b.lt=!0;b.name=c;d=a.history;d.Na();for(e=d.count-1;e>a.Ti;e--)f=d.ha(e),null!==
f&&f.clear(),d.Rc(e),a.Hy=!0;e=a.FE;0===e&&(e=1);0<e&&d.count>=e&&(f=d.ha(0),null!==f&&f.clear(),d.Rc(0),a.Hg--);d.add(b);a.Hg++;d.freeze();f=b}a.Xc("CommittedTransaction",c,f)}else{a.ri=!0;try{a.isEnabled&&null!==f&&(f.lt=!0,f.undo())}finally{a.Xc("RolledBackTransaction",c,f),a.ri=!1}null!==f&&f.clear()}a.Hu=null;return!0}if(a.isEnabled&&!b&&null!==f){a=e;c=f.Gf;for(b=c.count-1;b>=a;b--)d=c.ha(b),null!==d&&d.undo(),c.Na(),c.Rc(b);c.freeze()}return!1}
de.prototype.canUndo=de.prototype.canUndo=function(){if(!this.isEnabled||0<this.ph||this.ib)return!1;var a=this.BF;return null!==a&&a.canUndo()?!0:!1};de.prototype.undo=de.prototype.undo=function(){if(this.canUndo()){var a=this.BF;try{this.Xc("StartingUndo","Undo",a),this.ri=!0,this.Hg--,a.undo()}catch(b){v.trace("undo error: "+b.toString())}finally{this.ri=!1,this.Xc("FinishedUndo","Undo",a)}}};
de.prototype.canRedo=de.prototype.canRedo=function(){if(!this.isEnabled||0<this.ph||this.ib)return!1;var a=this.AF;return null!==a&&a.canRedo()?!0:!1};de.prototype.redo=de.prototype.redo=function(){if(this.canRedo()){var a=this.AF;try{this.Xc("StartingRedo","Redo",a),this.ri=!0,this.Hg++,a.redo()}catch(b){v.trace("redo error: "+b.toString())}finally{this.ri=!1,this.Xc("FinishedRedo","Redo",a)}}};
de.prototype.Xc=function(a,b,c){void 0===c&&(c=null);var d=new Nd;d.Ac=Pd;d.propertyName=a;d.object=c;d.oldValue=b;for(a=this.nI;a.next();)b=a.value,d.da=b,b.sw(d)};de.prototype.handleChanged=de.prototype.jE=function(a){if(this.isEnabled&&!this.ib&&!this.skipsEvent(a)){var b=this.Pi;null===b&&(this.Hu=b=new se);var c=a.copy(),b=b.Gf;b.Na();b.add(c);b.freeze();this.pz&&0>=this.ph&&!this.uy&&(a=a.g,null!==a&&!1===a.ve||v.trace("Change not within a transaction: "+c.toString()))}};
de.prototype.skipsEvent=function(a){if(null===a||0>a.Ac.value)return!0;a=a.object;if(a instanceof R){if(a=a.layer,null!==a&&a.Bc)return!0}else if(a instanceof ze&&a.Bc)return!0;return!1};v.u(de,{nI:"models"},function(){return this.Oy.i});v.defineProperty(de,{isEnabled:"isEnabled"},function(){return this.Pe},function(a){this.Pe=a});v.u(de,{BF:"transactionToUndo"},function(){return 0<=this.Ti&&this.Ti<=this.history.count-1?this.history.ha(this.Ti):null});
v.u(de,{AF:"transactionToRedo"},function(){return this.Ti<this.history.count-1?this.history.ha(this.Ti+1):null});v.u(de,{ib:"isUndoingRedoing"},function(){return this.ri});v.u(de,{history:"history"},function(){return this.XF});v.defineProperty(de,{FE:"maxHistoryLength"},function(){return this.iC},function(a){this.iC=a});v.u(de,{Ti:"historyIndex"},function(){return this.Hg});v.u(de,{Pi:"currentTransaction"},function(){return this.Hu});v.u(de,{ph:"transactionLevel"},function(){return this.Tk});
v.u(de,{uE:"isInTransaction"},function(){return 0<this.Tk});v.defineProperty(de,{pz:"checksTransactionLevel"},function(){return this.iB},function(a){this.iB=a});v.u(de,{KE:"nestedTransactionNames"},function(){return this.Mg});function sa(){0<arguments.length&&v.dd(sa);v.cc(this);this.W=null;this.BB=this.lB=!0;this.nB=this.oB=this.CB=this.pB=!1;this.Lk=this.Qx=null;this.kD=1.05;this.zB=1;this.Iy=NaN;this.fC=null;this.lD=NaN;this.rm=null}v.ga("CommandHandler",sa);var hf=null,jf="";
sa.prototype.toString=function(){return"CommandHandler"};v.u(sa,{g:"diagram"},function(){return this.W});sa.prototype.Fc=function(a){this.W=a};
sa.prototype.doKeyDown=function(){var a=this.g;if(null!==a){var b=a.O,c=v.Vm?b.xt:b.control,d=b.shift,e=b.alt,f=b.key;!c||"C"!==f&&"Insert"!==f?c&&"X"===f||d&&"Del"===f?this.canCutSelection()&&this.cutSelection():c&&"V"===f||d&&"Insert"===f?this.canPasteSelection()&&this.pasteSelection():c&&"Y"===f||e&&d&&"Backspace"===f?this.canRedo()&&this.redo():c&&"Z"===f||e&&"Backspace"===f?this.canUndo()&&this.undo():"Del"===f||"Backspace"===f?this.canDeleteSelection()&&this.deleteSelection():c&&"A"===f?this.canSelectAll()&&
this.selectAll():"Esc"===f?this.canStopCommand()&&this.stopCommand():"Up"===f?a.Ce&&(c?a.scroll("pixel","up"):a.scroll("line","up")):"Down"===f?a.Ce&&(c?a.scroll("pixel","down"):a.scroll("line","down")):"Left"===f?a.Be&&(c?a.scroll("pixel","left"):a.scroll("line","left")):"Right"===f?a.Be&&(c?a.scroll("pixel","right"):a.scroll("line","right")):"PageUp"===f?d&&a.Be?a.scroll("page","left"):a.Ce&&a.scroll("page","up"):"PageDown"===f?d&&a.Be?a.scroll("page","right"):a.Ce&&a.scroll("page","down"):"Home"===
f?c&&a.Ce?a.scroll("document","up"):!c&&a.Be&&a.scroll("document","left"):"End"===f?c&&a.Ce?a.scroll("document","down"):!c&&a.Be&&a.scroll("document","right"):" "===f?this.canScrollToPart()&&this.scrollToPart():"Subtract"===f?this.canDecreaseZoom()&&this.decreaseZoom():"Add"===f?this.canIncreaseZoom()&&this.increaseZoom():c&&"0"===f?this.canResetZoom()&&this.resetZoom():d&&"Z"===f?this.canZoomToFit()&&this.zoomToFit():c&&!d&&"G"===f?this.canGroupSelection()&&this.groupSelection():c&&d&&"G"===f?this.canUngroupSelection()&&
this.ungroupSelection():b.event&&113===b.event.which?this.canEditTextBlock()&&this.editTextBlock():b.event&&93===b.event.which?this.canShowContextMenu()&&this.showContextMenu():b.bubbles=!0:this.canCopySelection()&&this.copySelection()}};sa.prototype.doKeyUp=function(){var a=this.g;null!==a&&(a.O.bubbles=!0)};sa.prototype.stopCommand=function(){var a=this.g;if(null!==a){var b=a.$a;b instanceof kf&&a.lf&&a.uw();null!==b&&b.doCancel()}};sa.prototype.canStopCommand=function(){return!0};
sa.prototype.selectAll=function(){var a=this.g;if(null!==a){a.pa();try{a.Yb="wait";a.ya("ChangingSelection");for(var b=a.bk;b.next();)b.value.hb=!0;for(var c=a.wg;c.next();)c.value.hb=!0;for(var d=a.links;d.next();)d.value.hb=!0}finally{a.ya("ChangedSelection"),a.Yb=""}}};sa.prototype.canSelectAll=function(){var a=this.g;return null!==a&&a.lf};
sa.prototype.deleteSelection=function(){var a=this.g;if(null!==a&&!a.ya("SelectionDeleting",a.selection))try{a.Yb="wait";a.Qb("Delete");a.ya("ChangingSelection");for(var b=new H(J),c=a.selection.i;c.next();)lf(b,c.value,!0,this.$G?Infinity:0,this.TD,function(a){return a.canDelete()});a.uA(b,!0);a.ya("SelectionDeleted",b)}finally{a.ya("ChangedSelection"),a.wd("Delete"),a.Yb=""}};sa.prototype.canDeleteSelection=function(){var a=this.g;return null===a||a.gb||a.rf||!a.Am||0===a.selection.count?!1:!0};
function lf(a,b,c,d,e,f){void 0===f&&(f=null);if(!(a.contains(b)||null!==f&&!f(b)||b instanceof mf))if(a.add(b),b instanceof S){if(c&&b instanceof T)for(var h=b.Pc;h.next();)lf(a,h.value,c,d,e,f);if(e)for(h=b.ne;h.next();){var k=h.value;if(!a.contains(k)){var l=k.U,m=k.ba;null!==l&&a.contains(l)&&null!==m&&a.contains(m)?lf(a,k,c,d,e,f):null!==l&&null!==m||lf(a,k,c,d,e,f)}}if(1<d)for(b=b.aE();b.next();)lf(a,b.value,c,d-1,e,f)}else if(b instanceof W)for(h=b.Mf;h.next();)lf(a,h.value,c,d,e,f)}
sa.prototype.Lo=function(a,b,c){var d=new ma(J,J);for(a=a.i;a.next();)nf(this,a.value,b,d,c);if(null!==b){c=b.da;a=!1;null!==b.wb.Xd&&(a=b.wb.Xd.Ri);for(var e=new H(W),f=new ma(W,W),h=d.i;h.next();){var k=h.value;if(k instanceof W){var l=k;a||null!==l.U&&null!==l.ba||e.add(l)}else if(c instanceof te&&k instanceof S&&null!==k.data){var l=c,m=k,k=h.key,n=k.Pm();null!==n&&(n=d.la(n),null!==n?(l.mh(m.data,l.mb(n.data)),l=b.pg(m.data),k=k.$s(),null!==k&&null!==l&&f.add(k,l)):l.mh(m.data,void 0))}}0<e.count&&
b.uA(e,!1);if(0<f.count)for(c=f.i;c.next();)d.add(c.key,c.value)}if(null!==b&&(b=b.da,c=b.vG,null!==c)){var p=new ma;d.each(function(a){null!==a.key.data&&p.add(a.key.data,a.value.data)});c(p,b,this.g.da)}for(b=d.i;b.next();)b.value.Ib();return d};
function nf(a,b,c,d,e){if(null===b||e&&!b.canCopy())return null;if(d.contains(b))return d.la(b);var f=null,h=b.data;if(null!==h&&null!==c){var k=c.da;b instanceof W?k instanceof Q&&(h=k.xz(h),v.Wa(h)&&(k.Gs(h),f=c.pg(h))):(h=k.copyNodeData(h),v.Wa(h)&&(k.Vk(h),f=c.Wh(h)))}else of(b),f=b.copy(),null!==c&&null!==f&&c.add(f);if(!(f instanceof J))return null;f.hb=!1;f.Yg=!1;d.add(b,f);if(b instanceof S){for(k=b.ne;k.next();){h=k.value;if(h.U===b){var l=d.la(h);null!==l&&(l.U=f)}h.ba===b&&(l=d.la(h),null!==
l&&(l.ba=f))}if(b instanceof T&&f instanceof T)for(k=f,b=b.Pc;b.next();)h=nf(a,b.value,c,d,e),h instanceof W||null===h||(h.Sa=k)}else if(b instanceof W)for(k=b.U,null!==k&&(k=d.la(k),null!==k&&(f.U=k)),k=b.ba,null!==k&&(k=d.la(k),null!==k&&(f.ba=k)),b=b.Mf;b.next();)k=nf(a,b.value,c,d,e),null!==k&&(k.ce=f);return f}
sa.prototype.copySelection=function(){var a=this.g;if(null!==a){for(var b=new H(J),a=a.selection.i;a.next();)lf(b,a.value,!0,this.RG?Infinity:0,this.PG,function(a){return a.canCopy()});this.copyToClipboard(b)}};sa.prototype.canCopySelection=function(){var a=this.g;return null!==a&&a.Qj&&a.kz&&0!==a.selection.count?!0:!1};sa.prototype.cutSelection=function(){this.copySelection();this.deleteSelection()};
sa.prototype.canCutSelection=function(){var a=this.g;return null!==a&&!a.gb&&!a.rf&&a.Qj&&a.Am&&a.kz&&0!==a.selection.count?!0:!1};sa.prototype.copyToClipboard=function(a){var b=this.g;if(null!==b){var c=null;if(null===a)hf=null,jf="";else{var c=b.da,d=!1,e=!1,f=null;try{if(c instanceof te){var h=c,d=h.Jm;h.Jm=this.LD}c instanceof Q&&(h=c,e=h.Im,h.Im=this.KD);f=b.Lo(a,null,!0)}finally{c instanceof te&&(c.Jm=d),c instanceof Q&&(c.Im=e),c=new G(J),c.Yc(f),hf=c,jf=b.da.cl}}b.ya("ClipboardChanged",c)}};
sa.prototype.pasteFromClipboard=function(){var a=new H(J),b=hf;if(null===b)return a;var c=this.g;if(null===c||jf!==c.da.cl)return a;var d=c.da,e=!1,f=!1,h=null;try{if(d instanceof te){var k=d,e=k.Jm;k.Jm=this.LD}d instanceof Q&&(k=d,f=k.Im,k.Im=this.KD);h=c.Lo(b,c,!1)}finally{for(d instanceof te&&(d.Jm=e),d instanceof Q&&(d.Im=f),b=h.i;b.next();)c=b.value,d=b.key,c.location.H()||(d.location.H()?c.location=d.location:!c.position.H()&&d.position.H()&&(c.position=d.position)),a.add(c)}return a};
sa.prototype.pasteSelection=function(a){void 0===a&&(a=null);var b=this.g;if(null!==b)try{b.Yb="wait";b.Qb("Paste");b.ya("ChangingSelection");var c=this.pasteFromClipboard();0<c.count&&pf(b);for(var d=c.i;d.next();)d.value.hb=!0;b.ya("ChangedSelection");if(null!==a){var e=b.computePartsBounds(b.selection);if(e){var f=b.wb.Xd;null===f&&(f=new wf,f.Fc(b));var h=f.computeEffectiveCollection(b.selection);f.moveParts(h,new w(a.x-e.oa,a.y-e.va),!1)}}b.ya("ClipboardPasted",c)}finally{b.wd("Paste"),b.Yb=
""}};sa.prototype.canPasteSelection=function(){var a=this.g;return null===a||a.gb||a.rf||!a.Co||!a.kz||null===hf||jf!==a.da.cl?!1:!0};sa.prototype.undo=function(){var a=this.g;null!==a&&a.ja.undo()};sa.prototype.canUndo=function(){var a=this.g;return null===a||a.gb||a.rf?!1:a.tD&&a.ja.canUndo()};sa.prototype.redo=function(){var a=this.g;null!==a&&a.ja.redo()};sa.prototype.canRedo=function(){var a=this.g;return null===a||a.gb||a.rf?!1:a.tD&&a.ja.canRedo()};
sa.prototype.decreaseZoom=function(a){void 0===a&&(a=1/this.Dx);v.Te(a,sa,"decreaseZoom:factor");var b=this.g;null!==b&&b.Eo===xf&&(a*=b.scale,a<b.$g||a>b.Zg||(b.scale=a))};sa.prototype.canDecreaseZoom=function(a){void 0===a&&(a=1/this.Dx);v.Te(a,sa,"canDecreaseZoom:factor");var b=this.g;if(null===b||b.Eo!==xf)return!1;a*=b.scale;return a<b.$g||a>b.Zg?!1:b.pw};
sa.prototype.increaseZoom=function(a){void 0===a&&(a=this.Dx);v.Te(a,sa,"increaseZoom:factor");var b=this.g;null!==b&&b.Eo===xf&&(a*=b.scale,a<b.$g||a>b.Zg||(b.scale=a))};sa.prototype.canIncreaseZoom=function(a){void 0===a&&(a=this.Dx);v.Te(a,sa,"canIncreaseZoom:factor");var b=this.g;if(null===b||b.Eo!==xf)return!1;a*=b.scale;return a<b.$g||a>b.Zg?!1:b.pw};sa.prototype.resetZoom=function(a){void 0===a&&(a=this.xw);v.Te(a,sa,"resetZoom:newscale");var b=this.g;null===b||a<b.$g||a>b.Zg||(b.scale=a)};
sa.prototype.canResetZoom=function(a){void 0===a&&(a=this.xw);v.Te(a,sa,"canResetZoom:newscale");var b=this.g;return null===b||a<b.$g||a>b.Zg?!1:b.pw};sa.prototype.zoomToFit=function(){var a=this.g;if(null!==a){var b=a.scale,c=a.position;b!==this.lD||isNaN(this.Iy)?(this.Iy=b,this.fC=c.copy(),a.zoomToFit(),this.lD=a.scale):(a.scale=this.Iy,a.position=this.fC)}};sa.prototype.canZoomToFit=function(){var a=this.g;return null===a?!1:a.pw};
sa.prototype.scrollToPart=function(a){void 0===a&&(a=null);null!==a&&v.C(a,J,sa,"part");var b=this.g;if(null!==b){if(null===a){null===this.rm&&(this.rm=b.selection.i);try{this.rm.next()&&(a=this.rm.value)}catch(c){}null===a&&(this.rm=b.selection.i,this.rm.next()&&(a=this.rm.value))}null!==a&&(b.Oa.an("Scroll To Part"),b.eF(a.Z))}};sa.prototype.canScrollToPart=function(a){void 0===a&&(a=null);null!==a&&v.C(a,J,sa,"part");a=this.g;return null===a||0===a.selection.count?!1:a.Be&&a.Ce};
sa.prototype.collapseTree=function(a){void 0===a&&(a=null);var b=this.g;if(null===b)return!1;try{b.Qb("Collapse Tree");b.Oa.an("Collapse Tree");var c=new G(S);if(null!==a&&a.od)a.collapseTree(),c.add(a);else for(var d=b.selection.i;d.next();){var e=d.value;e instanceof S&&(a=e,a.od&&(a.collapseTree(),c.add(a)))}b.ya("TreeCollapsed",c)}finally{b.wd("Collapse Tree")}};
sa.prototype.canCollapseTree=function(a){void 0===a&&(a=null);var b=this.g;if(null===b||b.gb)return!1;if(null!==a){if(!a.od)return!1;if(0<a.Hw().count)return!0}else for(a=b.selection.i;a.next();)if(b=a.value,b instanceof S&&b.od&&0<b.Hw().count)return!0;return!1};
sa.prototype.expandTree=function(a){void 0===a&&(a=null);var b=this.g;if(null===b)return!1;try{b.Qb("Expand Tree");b.Oa.an("Expand Tree");var c=new G(S);if(null===a||a.od)for(var d=b.selection.i;d.next();){var e=d.value;e instanceof S&&(a=e,a.od||(a.expandTree(),c.add(a)))}else a.expandTree(),c.add(a);b.ya("TreeExpanded",c)}finally{b.wd("Expand Tree")}};
sa.prototype.canExpandTree=function(a){void 0===a&&(a=null);var b=this.g;if(null===b||b.gb)return!1;if(null!==a){if(a.od)return!1;if(0<a.Hw().count)return!0}else for(a=b.selection.i;a.next();)if(b=a.value,b instanceof S&&!b.od&&0<b.Hw().count)return!0;return!1};
sa.prototype.groupSelection=function(){var a=this.g;if(null!==a){var b=a.da;if(b instanceof Q){var c=this.uD;if(null!==c){var d=null;try{a.Yb="wait";a.Qb("Group");a.ya("ChangingSelection");for(var e=new G(J),f=a.selection.i;f.next();){var h=f.value;h.Ld()&&h.canGroup()&&e.add(h)}for(var k=new G(J),l=e.i;l.next();){for(var m=l.value,f=!1,n=e.i;n.next();)if(m.Yh(n.value)){f=!0;break}f||k.add(m)}if(0<k.count){var p=k.first().Sa;if(null!==p)for(;null!==p;){for(var e=!1,q=k.i;q.next();)if(!q.value.Yh(p)){e=
!0;break}if(e)p=p.Sa;else break}if(c instanceof T)of(c),d=c.copy(),null!==d&&a.add(d);else if(b.Rz(c)){var r=b.copyNodeData(c);v.Wa(r)&&(b.Vk(r),d=a.Gw(r))}if(null!==d){null!==p&&this.isValidMember(p,d)&&(d.Sa=p);for(var s=k.i;s.next();){var t=s.value;this.isValidMember(d,t)&&(t.Sa=d)}a.select(d)}}a.ya("ChangedSelection");a.ya("SelectionGrouped",d)}finally{a.wd("Group"),a.Yb=""}}}}};
sa.prototype.canGroupSelection=function(){var a=this.g;if(null===a||a.gb||a.rf||!a.Co||!a.kw||!(a.da instanceof Q)||null===this.uD)return!1;for(a=a.selection.i;a.next();){var b=a.value;if(b.Ld()&&b.canGroup())return!0}return!1};function yf(a){var b=v.jb();for(a=a.i;a.next();){var c=a.value;c instanceof W||b.push(c)}a=new H(J);for(var c=b.length,d=0;d<c;d++){for(var e=b[d],f=!0,h=0;h<c;h++)if(e.Yh(b[h])){f=!1;break}f&&a.add(e)}v.ra(b);return a}
sa.prototype.isValidMember=function(a,b){if(null===b||a===b||b instanceof W)return!1;if(null!==a){if(a===b||a.Yh(b))return!1;var c=a.$z;if(null!==c&&!c(a,b)||null===a.data&&null!==b.data||null!==a.data&&null===b.data)return!1}c=this.$z;return null!==c?c(a,b):!0};
sa.prototype.ungroupSelection=function(a){void 0===a&&(a=null);var b=this.g;if(null!==b){var c=b.da;if(c instanceof Q)try{b.Yb="wait";b.Qb("Ungroup");b.ya("ChangingSelection");var d=new G(T);if(null!==a)d.add(a);else for(var e=b.selection.i;e.next();){var f=e.value;f instanceof T&&(a=f,a.canUngroup()&&d.add(a))}if(0<d.count){b.uw();for(var h=d.i;h.next();){var k=h.value;k.expandSubGraph();var l=k.Sa,m=null!==l&&null!==l.data?c.mb(l.data):void 0,n=new G(J);n.Yc(k.Pc);for(var p=n.i;p.next();){var q=
p.value;q.hb=!0;if(!(q instanceof W)){var r=q.data;null!==r?c.ux(r,m):q.Sa=l}}b.remove(k)}}b.ya("ChangedSelection");b.ya("SelectionUngrouped",d,n)}finally{b.wd("Ungroup"),b.Yb=""}}};sa.prototype.canUngroupSelection=function(a){void 0===a&&(a=null);var b=this.g;if(null===b||b.gb||b.rf||!b.Am||!b.ow||!(b.da instanceof Q))return!1;if(null!==a){if(a.canUngroup())return!0}else for(a=b.selection.i;a.next();)if(b=a.value,b instanceof T&&b.canUngroup())return!0;return!1};
sa.prototype.addTopLevelParts=function(a,b){for(var c=!0,d=yf(a).i;d.next();){var e=d.value;null!==e.Sa&&(!b||this.isValidMember(null,e)?e.Sa=null:c=!1)}return c};
sa.prototype.collapseSubGraph=function(a){void 0===a&&(a=null);var b=this.g;if(null===b)return!1;try{b.Qb("Collapse SubGraph");b.Oa.an("Collapse SubGraph");var c=new G(T);if(null!==a&&a.be)a.collapseSubGraph(),c.add(a);else for(var d=b.selection.i;d.next();){var e=d.value;e instanceof T&&(a=e,a.be&&(a.collapseSubGraph(),c.add(a)))}b.ya("SubGraphCollapsed",c)}finally{b.wd("Collapse SubGraph")}};
sa.prototype.canCollapseSubGraph=function(a){void 0===a&&(a=null);var b=this.g;if(null===b||b.gb)return!1;if(null!==a)return a.be?!0:!1;for(a=b.selection.i;a.next();)if(b=a.value,b instanceof T&&b.be)return!0;return!1};
sa.prototype.expandSubGraph=function(a){void 0===a&&(a=null);var b=this.g;if(null===b)return!1;try{b.Qb("Expand SubGraph");b.Oa.an("Expand SubGraph");var c=new G(T);if(null===a||a.be)for(var d=b.selection.i;d.next();){var e=d.value;e instanceof T&&(a=e,a.be||(a.expandSubGraph(),c.add(a)))}else a.expandSubGraph(),c.add(a);b.ya("SubGraphExpanded",c)}finally{b.wd("Expand SubGraph")}};
sa.prototype.canExpandSubGraph=function(a){void 0===a&&(a=null);var b=this.g;if(null===b||b.gb)return!1;if(null!==a)return a.be?!1:!0;for(a=b.selection.i;a.next();)if(b=a.value,b instanceof T&&!b.be)return!0;return!1};
sa.prototype.editTextBlock=function(a){void 0===a&&(a=null);null!==a&&v.C(a,ra,sa,"editTextBlock");var b=this.g;if(null!==b){var c=b.wb.IA;if(null!==c){if(null===a){a=null;for(var d=b.selection.i;d.next();){var e=d.value;if(e.canEdit()){a=e;break}}if(null===a)return;a=a.Vs(function(a){return a instanceof ra&&a.Dz})}null!==a&&(b.$a=null,c.Cg=a,b.$a=c)}}};
sa.prototype.canEditTextBlock=function(a){void 0===a&&(a=null);null!==a&&v.C(a,ra,sa,"canEditTextBlock");var b=this.g;if(null===b||b.gb||b.rf||!b.nw||null===b.wb.IA)return!1;if(null!==a){if(a=a.V,null!==a&&a.canEdit())return!0}else for(b=b.selection.i;b.next();)if(a=b.value,a.canEdit()&&(a=a.Vs(function(a){return a instanceof ra&&a.Dz}),null!==a))return!0;return!1};
sa.prototype.showContextMenu=function(a){var b=this.g;if(null!==b){var c=b.wb.uz;if(null!==c&&(void 0===a&&(a=0<b.selection.count?b.selection.first():b),a=c.findObjectWithContextMenu(a),null!==a)){var d=new Ld,e=null;a instanceof R?e=a.fb(Kb):b.RH||(e=b.tb,e=new w(e.x+e.width/2,e.y+e.height/2));null!==e&&(d.ef=b.CF(e),d.ea=e,b.O=d);b.$a=c;zf(c,!1,a)}}};
sa.prototype.canShowContextMenu=function(a){var b=this.g;if(null===b)return!1;var c=b.wb.uz;if(null===c)return!1;void 0===a&&(a=0<b.selection.count?b.selection.first():b);return null===c.findObjectWithContextMenu(a)?!1:!0};v.defineProperty(sa,{PG:"copiesConnectedLinks"},function(){return this.lB},function(a){v.j(a,"boolean",sa,"copiesConnectedLinks");this.lB=a});
v.defineProperty(sa,{TD:"deletesConnectedLinks"},function(){return this.BB},function(a){v.j(a,"boolean",sa,"deletesConnectedLinks");this.BB=a});v.defineProperty(sa,{RG:"copiesTree"},function(){return this.pB},function(a){v.j(a,"boolean",sa,"copiesTree");this.pB=a});v.defineProperty(sa,{$G:"deletesTree"},function(){return this.CB},function(a){v.j(a,"boolean",sa,"deletesTree");this.CB=a});
v.defineProperty(sa,{LD:"copiesParentKey"},function(){return this.oB},function(a){v.j(a,"boolean",sa,"copiesParentKey");this.oB=a});v.defineProperty(sa,{KD:"copiesGroupKey"},function(){return this.nB},function(a){v.j(a,"boolean",sa,"copiesGroupKey");this.nB=a});
v.defineProperty(sa,{uD:"archetypeGroupData"},function(){return this.Qx},function(a){null!==a&&v.C(a,Object,sa,"archetypeGroupData");var b=this.g;null!==b&&(b=b.da,b instanceof Q&&(a instanceof T||b.Rz(a)||v.k("CommandHandler.archetypeGroupData must be either a Group or a data object for which GraphLinksModel.isGroupForNodeData is true: "+a)));this.Qx=a});v.defineProperty(sa,{$z:"memberValidation"},function(){return this.Lk},function(a){null!==a&&v.j(a,"function",sa,"memberValidation");this.Lk=a});
v.defineProperty(sa,{xw:"defaultScale"},function(){return this.zB},function(a){v.Te(a,sa,"defaultScale");0<a||v.k("defaultScale must be larger than zero, not: "+a);this.zB=a});v.defineProperty(sa,{Dx:"zoomFactor"},function(){return this.kD},function(a){v.Te(a,sa,"zoomFactor");1<a||v.k("zoomFactor must be larger than 1.0, not: "+a);this.kD=a});function Le(){0<arguments.length&&v.dd(Le);v.cc(this);this.W=null;this.Ob="";this.Pe=!0;this.SB=!1;this.gD=null;this.fw=-1}v.ga("Tool",Le);
Le.prototype.Fc=function(a){this.W=a};Le.prototype.toString=function(){return""!==this.name?this.name+" Tool":v.nf(Object.getPrototypeOf(this))};Le.prototype.updateAdornments=function(){};Le.prototype.canStart=function(){return this.isEnabled};Le.prototype.doStart=function(){};Le.prototype.doActivate=function(){this.qa=!0};Le.prototype.doDeactivate=function(){this.qa=!1};Le.prototype.doStop=function(){};Le.prototype.doCancel=function(){this.stopTool()};
Le.prototype.stopTool=function(){var a=this.g;null!==a&&a.$a===this&&(a.$a=null,a.Yb="")};Le.prototype.doMouseDown=function(){!this.qa&&this.canStart()&&this.doActivate()};Le.prototype.doMouseMove=function(){};Le.prototype.doMouseUp=function(){this.stopTool()};Le.prototype.doMouseWheel=function(){};Le.prototype.canStartMultiTouch=function(){return!0};
Le.prototype.standardPinchZoomStart=function(){var a=this.g;if(null!==a){var b=a.O.event,c=null,d=null;if(void 0!==b.targetTouches){if(2>b.targetTouches.length)return;c=b.targetTouches[0];d=b.targetTouches[1]}else if(null!==a.Bf[0])c=a.Bf[0],d=a.Bf[1];else return;this.doCancel();if(a.Wo("hasGestureZoom")){a.vy=!0;a.sC=a.scale;var e=Af(a),f=c,h=f.clientX-e.x,c=f.clientY-e.y,f=d,d=f.clientX-e.x,f=f.clientY-e.y;v.v(e);e=d-h;c=f-c;e=Math.sqrt(e*e+c*c);a.PC=e;b.preventDefault();b.cancelBubble=!0}else Bf(a)}};
Le.prototype.standardPinchZoomMove=function(){var a=this.g;if(null!==a){var b=a.O.event;this.doCancel();Bf(a);var c=null,d=null;if(void 0!==b.targetTouches){if(2>b.targetTouches.length)return;c=b.targetTouches[0];d=b.targetTouches[1]}else if(null!==a.Bf[0])c=a.Bf[0],d=a.Bf[1];else return;if(a.Wo("hasGestureZoom")&&a.vy){var e=Af(a),f=c,c=f.clientX-e.x,h=f.clientY-e.y,f=d,d=f.clientX-e.x,f=f.clientY-e.y;v.v(e);var e=d-c,k=f-h,e=Math.sqrt(e*e+k*k)/a.PC,c=new w((Math.min(d,c)+Math.max(d,c))/2,(Math.min(f,
h)+Math.max(f,h))/2),h=a.sC*e,d=a.rb;h!==a.scale&&d.canResetZoom(h)&&(e=a.Hl,a.Hl=c,d.resetZoom(h),a.Hl=e);b.preventDefault();b.cancelBubble=!0}}};Le.prototype.doKeyDown=function(){var a=this.g;null!==a&&"Esc"===a.O.key&&this.doCancel()};Le.prototype.doKeyUp=function(){};Le.prototype.startTransaction=Le.prototype.Qb=function(a){void 0===a&&(a=this.name);this.wf=null;var b=this.g;return null===b?!1:b.Qb(a)};
Le.prototype.stopTransaction=Le.prototype.dk=function(){var a=this.g;return null===a?!1:null===this.wf?a.wp():a.wd(this.wf)};
Le.prototype.standardMouseSelect=function(){var a=this.g;if(null!==a&&a.lf){var b=a.O,c=a.Zs(b.ea,!1);if(null!==c)if(v.Vm?b.xt:b.control){a.ya("ChangingSelection");for(b=c;null!==b&&!b.canSelect();)b=b.Sa;null!==b&&(b.hb=!b.hb);a.ya("ChangedSelection")}else if(b.shift){if(!c.hb){a.ya("ChangingSelection");for(b=c;null!==b&&!b.canSelect();)b=b.Sa;null!==b&&(b.hb=!0);a.ya("ChangedSelection")}}else{if(!c.hb){for(b=c;null!==b&&!b.canSelect();)b=b.Sa;null!==b&&a.select(b)}}else!b.left||(v.Vm?b.xt:b.control)||
b.shift||a.uw()}};Le.prototype.standardMouseClick=function(a,b){void 0===a&&(a=null);void 0===b&&(b=function(a){return!a.layer.Bc});var c=this.g;if(null!==c){var d=c.O,e=c.le(d.ea,a,b);d.qe=e;Cf(e,d,c)}};
function Cf(a,b,c){var d=0;b.left?d=1===b.Ue?1:2===b.Ue?2:1:b.right&&1===b.Ue&&(d=3);var e="";if(null!==a){switch(d){case 1:e="ObjectSingleClicked";break;case 2:e="ObjectDoubleClicked";break;case 3:e="ObjectContextClicked"}0!==d&&c.ya(e,a)}else{switch(d){case 1:e="BackgroundSingleClicked";break;case 2:e="BackgroundDoubleClicked";break;case 3:e="BackgroundContextClicked"}0!==d&&c.ya(e)}if(null!==a)for(b.Nc=!1;null!==a;){c=null;switch(d){case 1:c=a.click;break;case 2:c=a.Ts?a.Ts:a.click;break;case 3:c=
a.sz}if(null!==c&&(c(b,a),b.Nc))break;a=a.T}else{a=null;switch(d){case 1:a=c.click;break;case 2:a=c.Ts?c.Ts:c.click;break;case 3:a=c.sz}null!==a&&a(b)}}
Le.prototype.standardMouseOver=function(){var a=this.g;if(null!==a){var b=a.O;if(null!==b.g&&!0!==a.Oa.sc){var c=a.lb;a.lb=!0;var d=a.le(b.ea,null,null);b.qe=d;var e=!1;if(d!==a.wn){var f=a.wn,h=f;a.wn=d;this.doCurrentObjectChanged(f,d);for(b.Nc=!1;null!==f;){var k=f.At;if(null!==k){if(d===f)break;if(null!==d&&d.rl(f))break;k(b,f,d);e=!0;if(b.Nc)break}f=f.T}f=h;for(b.Nc=!1;null!==d;){k=d.zt;if(null!==k){if(f===d)break;if(null!==f&&f.rl(d))break;k(b,d,f);e=!0;if(b.Nc)break}d=d.T}d=a.wn}if(null!==d){f=
d;for(k="";null!==f;){k=f.cursor;if(""!==k)break;f=f.T}a.Yb=k;b.Nc=!1;for(f=d;null!==f;){k=f.dA;if(null!==k&&(k(b,f),e=!0,b.Nc))break;f=f.T}}else a.Yb="",k=a.dA,null!==k&&(k(b),e=!0);e&&a.de();a.lb=c}}};Le.prototype.doCurrentObjectChanged=function(){};
Le.prototype.standardMouseWheel=function(){var a=this.g;if(null!==a){var b=a.O,c=b.el;if(0!==c&&a.Wd.H()){var d=a.rb,e=a.wb.Bt;if((e===Df&&!b.shift||e===Ef&&b.control)&&(0<c?d.canIncreaseZoom():d.canDecreaseZoom()))e=a.Hl,a.Hl=b.ef,0<c?d.increaseZoom():d.decreaseZoom(),a.Hl=e,b.bubbles=!1;else if(e===Df&&b.shift||e===Ef&&!b.control){d=a.position.copy();e=0<c?c:-c;if(!b.shift&&a.Ce){var f=a.Ot,e=e/40*f;0<c?a.scroll("pixel","up",e):a.scroll("pixel","down",e)}else b.shift&&a.Be&&(f=a.Nt,e=e/40*f,0<c?
a.scroll("pixel","left",e):a.scroll("pixel","right",e));a.position.L(d)||(b.bubbles=!1)}}}};Le.prototype.standardWaitAfter=function(a){v.j(a,"number",Le,"standardWaitAfter:delay");this.cancelWaitAfter();var b=this;this.fw=v.setTimeout(function(){b.doWaitAfter()},a)};Le.prototype.cancelWaitAfter=function(){-1!==this.fw&&v.clearTimeout(this.fw);this.fw=-1};Le.prototype.doWaitAfter=function(){};
Le.prototype.findToolHandleAt=function(a,b){var c=this.g;if(null===c)return null;c=c.le(a,null,function(a){a=a.V;return null===a?!1:null!==a.ec});if(null===c)return null;var d=c.V;return null===d||d.Mc!==b?null:c};Le.prototype.isBeyondDragSize=function(a,b){var c=this.g;if(null===c)return!1;void 0===a&&(a=c.uc.ef);void 0===b&&(b=c.O.ef);var d=c.wb.eH,e=d.width,d=d.height;c.uc.Zj&&(e+=6,d+=6);return Math.abs(b.x-a.x)>e||Math.abs(b.y-a.y)>d};v.u(Le,{g:"diagram"},function(){return this.W});
v.defineProperty(Le,{name:"name"},function(){return this.Ob},function(a){v.j(a,"string",Le,"name");this.Ob=a});v.defineProperty(Le,{isEnabled:"isEnabled"},function(){return this.Pe},function(a){v.j(a,"boolean",Le,"isEnabled");this.Pe=a});v.defineProperty(Le,{qa:"isActive"},function(){return this.SB},function(a){v.j(a,"boolean",Le,"isActive");this.SB=a});v.defineProperty(Le,{wf:"transactionResult"},function(){return this.gD},function(a){null!==a&&v.j(a,"string",Le,"transactionResult");this.gD=a});
function wf(){0<arguments.length&&v.dd(wf);Le.call(this);this.name="Dragging";this.mB=this.WB=!0;this.Mq=this.IB=!1;this.$B=!0;this.wy=(new ia(NaN,NaN)).freeze();this.xy=zb;this.yy=(new w(NaN,NaN)).freeze();this.HB=!1;this.FB=this.kB=this.GB=this.tB=this.Ci=null;this.vq=this.YB=!1;this.to=new w(NaN,NaN);this.Rv=new w;this.Uv=!1;this.Pv=this.VB=!0;this.Gn=100;this.gj=[];this.WF=(new H(J)).freeze()}v.Ga(wf,Le);v.ga("DraggingTool",wf);
v.defineProperty(wf,{rE:"isCopyEnabled"},function(){return this.WB},function(a){v.j(a,"boolean",wf,"isCopyEnabled");this.WB=a});v.defineProperty(wf,{QG:"copiesEffectiveCollection"},function(){return this.mB},function(a){v.j(a,"boolean",wf,"copiesEffectiveCollection");this.mB=a});v.defineProperty(wf,{fH:"dragsTree"},function(){return this.IB},function(a){v.j(a,"boolean",wf,"dragsTree");this.IB=a});
v.defineProperty(wf,{Qw:"isGridSnapEnabled"},function(){return this.Mq},function(a){v.j(a,"boolean",wf,"isGridSnapEnabled");this.Mq=a});v.defineProperty(wf,{LH:"isComplexRoutingRealtime"},function(){return this.VB},function(a){v.j(a,"boolean",wf,"isComplexRoutingRealtime");this.VB=a});v.defineProperty(wf,{NH:"isGridSnapRealtime"},function(){return this.$B},function(a){v.j(a,"boolean",wf,"isGridSnapRealtime");this.$B=a});
v.defineProperty(wf,{iE:"gridSnapCellSize"},function(){return this.wy},function(a){v.C(a,ia,wf,"gridSnapCellSize");this.wy.L(a)||(this.wy=a=a.aa())});v.defineProperty(wf,{wH:"gridSnapCellSpot"},function(){return this.xy},function(a){v.C(a,L,wf,"gridSnapCellSpot");this.xy.L(a)||(this.xy=a=a.aa())});v.defineProperty(wf,{xH:"gridSnapOrigin"},function(){return this.yy},function(a){v.C(a,w,wf,"gridSnapOrigin");this.yy.L(a)||(this.yy=a=a.aa())});
v.defineProperty(wf,{Ri:"dragsLink"},function(){return this.HB},function(a){v.j(a,"boolean",wf,"dragsLink");this.HB=a});v.defineProperty(wf,{Mm:"currentPart"},function(){return this.tB},function(a){null!==a&&v.C(a,J,wf,"currentPart");this.tB=a});v.defineProperty(wf,{nc:"copiedParts"},function(){return this.kB},function(a){this.kB=a});v.defineProperty(wf,{$b:"draggedParts"},function(){return this.GB},function(a){this.GB=a});
v.u(wf,{hK:"draggingParts"},function(){return null!==this.nc?this.nc.Yi():null!==this.$b?this.$b.Yi():this.WF});v.defineProperty(wf,{Zc:"draggedLink"},function(){return this.FB},function(a){null!==a&&v.C(a,W,wf,"draggedLink");this.FB=a});v.defineProperty(wf,{Pw:"isDragOutStarted"},function(){return this.YB},function(a){this.YB=a});v.defineProperty(wf,{ck:"startPoint"},function(){return this.Rv},function(a){v.C(a,w,wf,"startPoint");this.Rv.L(a)||(this.Rv=a=a.aa())});
v.defineProperty(wf,{PD:"delay"},function(){return this.Gn},function(a){v.j(a,"number",wf,"delay");this.Gn=a});wf.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;if(null===a||!a.Yk&&!a.Qj&&!a.jw||!a.lf)return!1;var b=a.O;return!b.left||a.$a!==this&&(!this.isBeyondDragSize()||b.Zj&&b.timestamp-a.uc.timestamp<this.Gn)?!1:null!==this.findDraggablePart()};
wf.prototype.findDraggablePart=function(){var a=this.g;if(null===a)return null;a=a.Zs(a.uc.ea,!1);if(null===a)return null;for(;null!==a&&!a.canSelect();)a=a.Sa;return null!==a&&(a.canMove()||a.canCopy())?a:null};wf.prototype.standardMouseSelect=function(){var a=this.g;if(null!==a&&a.lf){var b=a.Zs(a.uc.ea,!1);if(null!==b){for(;null!==b&&!b.canSelect();)b=b.Sa;this.Mm=b;this.Mm.hb||(a.ya("ChangingSelection"),b=a.O,(v.Vm?b.xt:b.control)||b.shift||pf(a),this.Mm.hb=!0,a.ya("ChangedSelection"))}}};
wf.prototype.doActivate=function(){var a=this.g;if(null!==a){null===this.Mm&&this.standardMouseSelect();var b=this.Mm;null!==b&&(b.canMove()||b.canCopy())&&(this.qa=!0,this.to.set(a.position),Ff(this,a.selection),this.gj.length=0,this.$b=this.computeEffectiveCollection(a.selection),a.Wt=!0,Gf(this,this.$b),this.Qb("Drag"),this.ck=a.uc.ea,a.Le=!0,a.jw&&(this.Pw=!0,this.vq=!1,Hf=this,If=this.g,this.doSimulatedDragOut()))}};
function Ff(a,b){if(a.Ri){var c=a.g;null!==c&&c.Bm&&(c.da instanceof Q&&1===b.count&&b.first()instanceof W?(a.Zc=b.first(),a.Zc.canRelinkFrom()&&a.Zc.canRelinkTo()&&a.Zc.Os(),a.Ci=c.wb.QE,null===a.Ci&&(a.Ci=new Jf,a.Ci.Fc(c))):(a.Zc=null,a.Ci=null))}}
wf.prototype.computeEffectiveCollection=function(a){var b=null!==this.g&&this.g.$a===this,c=new ma(J);if(null===a)return c;for(var d=a.i;d.next();)Kf(this,c,d.value,b);if(null!==this.Zc&&this.Ri)return c;for(d=a.i;d.next();)a=d.value,a instanceof W&&(b=a.U,null===b||c.contains(b)?(b=a.ba,null===b||c.contains(b)||c.remove(a)):c.remove(a));return c};function Lf(a){return void 0===a?new Mf(K.fk):new Mf(a.copy())}
function Kf(a,b,c,d){if(!b.contains(c)&&(!d||c.canMove()||c.canCopy()))if(c instanceof S){b.add(c,Lf(c.location));if(c instanceof T)for(var e=c.Pc;e.next();)Kf(a,b,e.value,d);for(e=c.ne;e.next();){var f=e.value;if(!b.contains(f)){var h=f.U,k=f.ba;null!==h&&b.contains(h)&&null!==k&&b.contains(k)&&Kf(a,b,f,d)}}if(a.fH)for(c=c.aE();c.next();)Kf(a,b,c.value,d)}else if(c instanceof W)for(f=c,b.add(f,Lf()),e=f.Mf;e.next();)Kf(a,b,e.value,d);else c instanceof mf||b.add(c,Lf(c.location))}
wf.prototype.doDeactivate=function(){this.qa=!1;var a=this.g;null!==a&&Nf(a);Of(this);Zf(this,this.$b);this.$b=this.Mm=null;this.vq=this.Pw=!1;if(0<$f.count){for(var b=$f.length,c=0;c<b;c++){var d=$f.ha(c);ag(d);bg(d);Of(d);null!==d.g&&Nf(d.g)}$f.clear()}ag(this);this.to.m(NaN,NaN);Hf=If=null;bg(this);a.Le=!1;a.Yb="";a.Wt=!1;this.dk()};function Of(a){var b=a.g;if(null!==b){var c=b.lb;b.lb=!0;cg(a,b.O,null);b.lb=c}a.gj.length=0}
function dg(){var a=Hf;bg(a);eg(a);var b=a.g;null!==b&&a.to.H()&&(b.position=a.to);null!==b&&Nf(b)}wf.prototype.doCancel=function(){bg(this);eg(this);var a=this.g;null!==a&&this.to.H()&&(a.position=this.to);this.stopTool()};function Gf(a,b){if(null!==b){a.Uv=!0;for(var c=b.i;c.next();){var d=c.key;d instanceof W&&(d.Gp=!0)}}}function Zf(a,b){if(null!==b){for(var c=b.i;c.next();){var d=c.key;d instanceof W&&(d.Gp=!1,d.pl&&fg(d)&&d.gc())}a.Uv=!1}}
wf.prototype.doKeyDown=function(){var a=this.g;null!==a&&(a=a.O,null!==a&&this.qa&&("Esc"===a.key?this.doCancel():this.doMouseMove()))};wf.prototype.doKeyUp=function(){var a=this.g;null!==a&&null!==a.O&&this.qa&&this.doMouseMove()};function gg(a,b){for(var c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,h=a.i;h.next();){var k=h.value;if(k.Ld()&&k.isVisible()){var l=k.location,k=l.x,l=l.y;isNaN(k)||isNaN(l)||(k<c&&(c=k),l<d&&(d=l),k>e&&(e=k),l>f&&(f=l))}}Infinity===c?b.m(0,0,0,0):b.m(c,d,e-c,f-d)}
function hg(a,b){if(null===a.nc){var c=a.g;if(!(null===c||b&&(c.gb||c.rf))&&null!==a.$b){var d=c.ja;d.isEnabled&&d.uE?null!==d.Pi&&0<d.Pi.Gf.count&&(c.ja.wp(),c.Qb("Drag")):eg(a);c.lb=!b;c.ln=!b;a.ck=c.uc.ea;d=a.QG?a.$b.Yi():c.selection;d=c.Lo(d,c,!0);for(c=d.i;c.next();)c.value.location=c.key.location;c=v.Uf();gg(d,c);v.fc(c);for(var c=new ma(J),e=a.$b.i;e.next();){var f=e.key;f.Ld()&&f.canCopy()&&(f=d.la(f),null!==f&&(f.mf(),c.add(f,Lf(f.location))))}for(d=d.i;d.next();)e=d.value,e instanceof W&&
e.canCopy()&&c.add(e,Lf());a.nc=c;Ff(a,c.Yi());null!==a.Zc&&(c=a.Zc,d=c.cn,c.vl(a.ck.x-(d.x+d.width/2),a.ck.y-(d.y+d.height/2)))}}}function bg(a){var b=a.g;if(null!==b){if(null!==a.nc&&(b.uA(a.nc.Yi(),!1),a.nc=null,null!==a.$b))for(var c=a.$b.i;c.next();)c.key instanceof W&&(c.value.point=new w(0,0));b.lb=!1;b.ln=!1;a.ck=b.uc.ea}}function ag(a){if(null!==a.Zc){if(a.Ri&&null!==a.Ci){var b=a.Ci;b.g.remove(b.re);b.g.remove(b.se)}a.Zc=null;a.Ci=null}}
function ig(a,b,c){var d=a.g;if(null!==d){var e=a.ck,f=v.M();f.assign(d.O.ea);a.moveParts(b,f.Yt(e),c);v.v(f)}}
wf.prototype.moveParts=function(a,b,c){if(null!==a&&(v.C(a,ma,wf,"moveParts:parts"),0!==a.count)){var d=v.M(),e=v.M();e.assign(b);isNaN(e.x)&&(e.x=0);isNaN(e.y)&&(e.y=0);(b=this.Uv)||Gf(this,a);for(var f=new G(jg),h=new G(Qa),k=a.i;k.next();){var l=k.key;if(l.Ld()){var m=kg(this,l,a);if(null!==m)f.add(new jg(l,k.value,m));else if(!c||l.canMove()){m=k.value.point;d.assign(m);var n=v.M(),p=this.computeMove(l,d.add(e),a,n);l.location=p;k.value.nF=n.Yt(m);v.v(n)}}else k.key instanceof W&&h.add(k.bb)}for(c=
f.i;c.next();)f=c.value,m=f.info.point,d.assign(m),f.Dc.location=d.add(f.yH.nF);c=v.M();m=v.M();for(h=h.i;h.next();)if(k=h.value,f=k.key,f instanceof W)if(f.Gp)l=f.U,n=f.ba,null!==this.Zc&&this.Ri?(k=k.value.point,a.add(f,Lf(e)),l=e.x-k.x,k=e.y-k.y,f.vl(l,k)):(null!==l&&(c.assign(l.location),p=a.la(l),null!==p&&c.Yt(p.point)),null!==n&&(m.assign(n.location),p=a.la(n),null!==p&&m.Yt(p.point)),null!==l&&null!==n?c.Ie(m)?(k=k.value.point,l=d,l.assign(c),l.Yt(k),a.add(f,Lf(c)),f.vl(l.x,l.y)):(f.Gp=!1,
f.gc()):(k=k.value.point,n=null!==l?c:null!==n?m:e,a.add(f,Lf(n)),l=n.x-k.x,k=n.y-k.y,f.vl(l,k)));else if(null===f.U||null===f.ba)k=k.value.point,a.add(f,Lf(e)),l=e.x-k.x,k=e.y-k.y,f.vl(l,k);v.v(d);v.v(e);v.v(c);v.v(m);b||Zf(this,a)}};function kg(a,b,c){b=b.Sa;if(null!==b){a=kg(a,b,c);if(null!==a)return a;a=c.la(b);if(null!==a)return a}return null}
function eg(a){if(null!==a.$b){for(var b=a.g,c=a.$b.i;c.next();){var d=c.key;d.Ld()&&(d.location=c.value.point)}for(c=a.$b.i;c.next();)if(d=c.key,d instanceof W&&d.Gp){var e=c.value.point;a.$b.add(d,Lf());d.vl(-e.x,-e.y)}b.Nf()}}
wf.prototype.computeMove=function(a,b,c,d){void 0===d&&(d=new w);d.assign(b);if(null===a)return d;void 0===c&&(c=null);var e=b;if(this.Qw&&(this.NH||null===c||this.g.O.up)&&(e=v.M(),c=e,c.assign(b),null!==a)){var f=this.g;if(null!==f){var h=f.ft,k=this.iE,f=k.width,k=k.height,l=this.xH,m=l.x,l=l.y,n=this.wH;if(null!==h){var p=h.Jw;isNaN(f)&&(f=p.width);isNaN(k)&&(k=p.height);h=h.hE;isNaN(m)&&(m=h.x);isNaN(l)&&(l=h.y)}h=v.Rb(0,0);h.Ut(0,0,f,k,n);K.Xs(b.x,b.y,m+h.x,l+h.y,f,k,c);v.v(h)}}c=null!==a.UD?
a.UD(a,b,e):e;k=a.mI;f=k.x;isNaN(f)&&(f=a.location.x);k=k.y;isNaN(k)&&(k=a.location.y);h=a.hI;m=h.x;isNaN(m)&&(m=a.location.x);h=h.y;isNaN(h)&&(h=a.location.y);d.m(Math.max(f,Math.min(c.x,m)),Math.max(k,Math.min(c.y,h)));e!==b&&v.v(e);return d};function lg(a,b){if(null===b)return!0;var c=b.V;return null===c||c instanceof mf||c.layer.Bc||a.$b&&a.$b.contains(c)||a.nc&&a.nc.contains(c)?!0:!1}
function mg(a,b,c,d){var e=a.g;if(null!==e){a.Ri&&(null!==a.Zc&&(a.Zc.U=null,a.Zc.ba=null),ng(a,!1));var f=!1;!1===a.Pv&&(f=e.lb,e.lb=!0);var h=og(e,b,null,function(b){return!lg(a,b)}),k=e.O;k.qe=h;var l=e.lb;e.lb=!0;var m=cg(a,k,h);if(a.qa||null!==Hf){if(null===h){var n=e.qI;null!==n&&(n(k),m=!0)}if(a.qa||null!==Hf)if(a.doDragOver(b,h),a.qa||null!==Hf)e.lb=l,m&&e.Nf(),!1===a.Pv&&(e.lb=f),(e.Be||e.Ce)&&(c||d)&&pg(e,k.ef)}}}
function cg(a,b,c){var d=!1,e=a.gj.length,f=0<e?a.gj[0]:null;if(c===f)return!1;b.Nc=!1;for(var h=0;h<e;h++){var k=a.gj[h],l=k.pI;if(null!==l&&(l(b,k,c),d=!0,b.Nc))break}a.gj.length=0;if(!a.qa&&null===Hf||null===c)return d;for(b.Nc=!1;null!==c;)a.gj.push(c),c=xg(c);e=a.gj.length;for(h=0;h<e&&(k=a.gj[h],l=k.oI,null===l||(l(b,k,f),d=!0,!b.Nc));h++);return d}function xg(a){var b=a.T;return null!==b?b:a instanceof J&&!(a instanceof T)&&(a=a.Sa,null!==a&&a.BH)?a:null}
function yg(a,b,c){var d=a.Ci;if(null===d)return null;var e=a.g.Om(b,d.OE,function(a){return d.findValidLinkablePort(a,c)});a=v.M();for(var f=Infinity,h=null,e=e.i;e.next();){var k=e.value;if(null!==k.V){var l=k.fb(Kb,a),l=b.Tj(l);l<f&&(h=k,f=l)}}v.v(a);return h}
function ng(a,b){var c=a.Zc;if(null!==c&&!(2>c.ma)){var d=a.g;if(null!==d&&!d.gb&&(d=a.Ci,null!==d)){var e=null,f=null;null===c.U&&(e=yg(a,c.l(0),!1),null!==e&&(f=e.V));var h=null,k=null;null===c.ba&&(h=yg(a,c.l(c.ma-1),!0),null!==h&&(k=h.V));d.isValidLink(f,e,k,h)?b?(c.An=c.l(0).copy(),c.En=c.l(c.ma-1).copy(),c.Gp=!1,c.U=f,null!==e&&(c.rg=e.Od),c.ba=k,null!==h&&(c.oh=h.Od)):zg(d,f,e,k,h):zg(d,null,null,null,null)}}}wf.prototype.doDragOver=function(){};
function Ag(a,b){var c=a.g;if(null!==c){a.Ri&&ng(a,!0);Of(a);var d=og(c,b,null,function(b){return!lg(a,b)}),e=c.O;e.qe=d;if(null!==d){e.Nc=!1;for(var f=d;null!==f;){var h=f.aA;if(null!==h&&(h(e,f),e.Nc))break;f=xg(f)}}else h=c.aA,null!==h&&h(e);if(a.qa||null!==Hf)if(a.doDropOnto(b,d),a.qa||null!==Hf)for(d=c.selection.i;d.next();)e=d.value,e instanceof S&&Bg(c,e.Z)}}wf.prototype.doDropOnto=function(){};
wf.prototype.doMouseMove=function(){if(this.qa){var a=this.g;if(null!==a&&null!==this.Mm&&null!==this.$b){var b=!1,c=!1;this.mayCopy()?(b=!0,a.Yb="copy",hg(this,!1),Gf(this,this.nc),ig(this,this.nc,!1),Zf(this,this.nc)):this.mayMove()?(c=!0,a.Yb="default",bg(this),ig(this,this.$b,!0)):this.mayDragOut()?(a.Yb="no-drop",hg(this,!1),ig(this,this.nc,!1)):bg(this);mg(this,a.O.ea,c,b)}}};
wf.prototype.doMouseUp=function(){if(this.qa){var a=this.g;if(null!==a){var b=!1,c=this.mayCopy();c&&null!==this.nc?(bg(this),hg(this,!0),Gf(this,this.nc),ig(this,this.nc,!1),Zf(this,this.nc),null!==this.nc&&a.iF(this.nc.Yi())):(b=!0,bg(this),this.mayMove()&&(ig(this,this.$b,!0),this.Pv=!1,mg(this,a.O.ea,!0,!1),this.Pv=!0));this.vq=!0;Ag(this,a.O.ea);if(this.qa){this.nc=null;if(b&&null!==this.$b)for(b=this.$b.i;b.next();){var d=b.key;d instanceof S&&(d=d.Sa,null===d||null===d.placeholder||this.$b.contains(d)||
d.HD&&d.P())}a.oc();Zf(this,this.$b);this.wf=c?"Copy":"Move";a.ya(c?"SelectionCopied":"SelectionMoved",a.selection)}this.stopTool()}}};wf.prototype.mayCopy=function(){if(!this.rE)return!1;var a=this.g;if(null===a||a.gb||a.rf||!a.Co||!a.Qj||(v.Vm?!a.O.alt:!a.O.control))return!1;for(a=a.selection.i;a.next();){var b=a.value;if(b.Ld()&&b.canCopy())return!0}return null!==this.Zc&&this.Ri&&this.Zc.canCopy()?!0:!1};
wf.prototype.mayDragOut=function(){if(!this.rE)return!1;var a=this.g;if(null===a||!a.jw||!a.Qj||a.Yk)return!1;for(a=a.selection.i;a.next();){var b=a.value;if(b.Ld()&&b.canCopy())return!0}return null!==this.Zc&&this.Ri&&this.Zc.canCopy()?!0:!1};wf.prototype.mayMove=function(){var a=this.g;if(null===a||a.gb||!a.Yk)return!1;for(a=a.selection.i;a.next();){var b=a.value;if(b.Ld()&&b.canMove())return!0}return null!==this.Zc&&this.Ri&&this.Zc.canMove()?!0:!1};var $f=new G(wf),Hf=null,If=null;
wf.prototype.mayDragIn=function(){var a=this.g;if(null===a||!a.sD||a.gb||a.rf||!a.Co)return!1;var b=Hf;return null===b||b.g.da.cl!==a.da.cl?!1:!0};wf.prototype.doSimulatedDragEnter=function(){if(this.mayDragIn()){var a=this.g;a.Oa.Xi();Cg(a);a=Hf;null!==a&&(a.g.Yb="copy")}};wf.prototype.doSimulatedDragLeave=function(){var a=Hf;null!==a&&a.doSimulatedDragOut();this.doCancel()};
wf.prototype.doSimulatedDragOver=function(){var a=this.g;if(null!==a){var b=Hf;null!==b&&null!==b.$b&&this.mayDragIn()&&(a.Yb="copy",Dg(this,b.$b.Yi(),!1),ig(this,this.nc,!1),mg(this,a.O.ea,!1,!0))}};
wf.prototype.doSimulatedDrop=function(){var a=this.g;if(null!==a){var b=Hf;null!==b&&(b.vq=!0,bg(this),this.mayDragIn()&&(this.Qb("Drop"),Dg(this,b.$b.Yi(),!0),ig(this,this.nc,!1),null!==this.nc&&a.iF(this.nc.Yi()),this.wf="ExternalCopy",Ag(this,a.O.ea),a.oc(),this.nc=null,a.focus(),a.ya("ExternalObjectsDropped",a.selection),this.dk()))}};
function Dg(a,b,c){if(null===a.nc){var d=a.g;if(null!==d&&!d.gb&&!d.rf){d.lb=!c;d.ln=!c;a.ck=d.O.ea;d=d.Lo(b,d,!0);c=v.Uf();gg(b,c);var e=c.x+c.width/2,f=c.y+c.height/2;v.fc(c);var h=a.Rv;c=new ma(J);var k=v.M();for(b=b.i;b.next();){var l=b.value;if(l.Ld()&&l.canCopy()){var m=l.location,l=d.la(l);k.m(h.x-(e-m.x),h.y-(f-m.y));l.location=k;l.mf();c.add(l,Lf(k))}}v.v(k);for(d=d.i;d.next();)e=d.value,e instanceof W&&e.canCopy()&&c.add(e,Lf());a.nc=c;Ff(a,c.Yi());null!==a.Zc&&(c=a.Zc,d=c.cn,c.vl(a.ck.x-
(d.x+d.width/2),a.ck.y-(d.y+d.height/2)))}}}wf.prototype.doSimulatedDragOut=function(){var a=this.g;null!==a&&(this.mayCopy()||this.mayMove()?a.Yb="":a.Yb="no-drop")};function Mf(a){this.point=a;this.nF=K.fk}v.ga("DraggingInfo",Mf);function jg(a,b,c){this.Dc=a;this.info=b;this.yH=c}
function Eg(){0<arguments.length&&v.dd(Eg);Le.call(this);this.DC=100;this.dC=!1;var a=new W,b=new X;b.Lf=!0;b.stroke="blue";a.add(b);b=new X;b.Hp="Standard";b.fill="blue";b.stroke="blue";a.add(b);a.tf="Tool";this.ZC=a;a=new S;b=new X;b.Od="";b.Cb="Rectangle";b.fill=null;b.stroke="magenta";b.nb=2;b.xa=K.Ix;a.add(b);a.zl=!1;a.tf="Tool";this.XC=a;this.YC=b;a=new S;b=new X;b.Od="";b.Cb="Rectangle";b.fill=null;b.stroke="magenta";b.nb=2;b.xa=K.Ix;a.add(b);a.zl=!1;a.tf="Tool";this.$C=a;this.aD=b;this.zC=
this.yC=this.uC=this.tC=this.vC=null;this.ZB=!0;this.lG=new ma(R,"boolean");this.EC=this.Ik=this.TC=null}v.Ga(Eg,Le);v.ga("LinkingBaseTool",Eg);Eg.prototype.doStop=function(){var a=this.g;null!==a&&Nf(a);this.hh=this.gh=this.fh=this.eh=this.pc=null;this.Cx.clear();this.Tf=null};v.defineProperty(Eg,{OE:"portGravity"},function(){return this.DC},function(a){v.j(a,"number",Eg,"portGravity");0<=a&&(this.DC=a)});
v.defineProperty(Eg,{cp:"isUnconnectedLinkValid"},function(){return this.dC},function(a){v.j(a,"boolean",Eg,"isUnconnectedLinkValid");this.dC=a});v.defineProperty(Eg,{Bg:"temporaryLink"},function(){return this.ZC},function(a){v.C(a,W,Eg,"temporaryLink");this.ZC=a});v.defineProperty(Eg,{re:"temporaryFromNode"},function(){return this.XC},function(a){v.C(a,S,Eg,"temporaryFromNode");this.XC=a});
v.defineProperty(Eg,{en:"temporaryFromPort"},function(){return this.YC},function(a){v.C(a,R,Eg,"temporaryFromPort");this.YC=a});v.defineProperty(Eg,{se:"temporaryToNode"},function(){return this.$C},function(a){v.C(a,S,Eg,"temporaryToNode");this.$C=a});v.defineProperty(Eg,{fn:"temporaryToPort"},function(){return this.aD},function(a){v.C(a,R,Eg,"temporaryToPort");this.aD=a});v.defineProperty(Eg,{pc:"originalLink"},function(){return this.vC},function(a){null!==a&&v.C(a,W,Eg,"originalLink");this.vC=a});
v.defineProperty(Eg,{eh:"originalFromNode"},function(){return this.tC},function(a){null!==a&&v.C(a,S,Eg,"originalFromNode");this.tC=a});v.defineProperty(Eg,{fh:"originalFromPort"},function(){return this.uC},function(a){null!==a&&v.C(a,R,Eg,"originalFromPort");this.uC=a});v.defineProperty(Eg,{gh:"originalToNode"},function(){return this.yC},function(a){null!==a&&v.C(a,S,Eg,"originalToNode");this.yC=a});
v.defineProperty(Eg,{hh:"originalToPort"},function(){return this.zC},function(a){null!==a&&v.C(a,R,Eg,"originalToPort");this.zC=a});v.defineProperty(Eg,{$d:"isForwards"},function(){return this.ZB},function(a){v.j(a,"boolean",Eg,"isForwards");this.ZB=a});v.u(Eg,{Cx:"validPortsCache"},function(){return this.lG});v.defineProperty(Eg,{Tf:"targetPort"},function(){return this.TC},function(a){null!==a&&v.C(a,R,Eg,"targetPort");this.TC=a});
Eg.prototype.copyPortProperties=function(a,b,c,d,e){if(null!==a&&null!==b&&null!==c&&null!==d){d.xa=b.Z.size;e?(d.Bb=b.Bb,d.Fl=b.Fl):(d.Ab=b.Ab,d.il=b.il);c.Ze=Kb;var f=v.M();c.location=b.fb(Kb,f);v.v(f);d.angle=b.jl();null!==this.ix&&this.ix(a,b,c,d,e)}};Eg.prototype.setNoTargetPortProperties=function(a,b,c){null!==b&&(b.xa=K.Ix,b.Ab=xb,b.Bb=xb);null!==a&&(a.location=this.g.O.ea);null!==this.ix&&this.ix(null,null,a,b,c)};Eg.prototype.doMouseDown=function(){this.qa&&this.doMouseMove()};
Eg.prototype.doMouseMove=function(){if(this.qa){var a=this.g;if(null!==a){this.Tf=this.findTargetPort(this.$d);if(null!==this.Tf){var b=this.Tf.V;if(b instanceof S){this.$d?this.copyPortProperties(b,this.Tf,this.se,this.fn,!0):this.copyPortProperties(b,this.Tf,this.re,this.en,!1);return}}this.$d?this.setNoTargetPortProperties(this.se,this.fn,!0):this.setNoTargetPortProperties(this.re,this.en,!1);(a.Be||a.Ce)&&pg(a,a.O.ef)}}};
Eg.prototype.findValidLinkablePort=function(a,b){if(null===a)return null;var c=a.V;if(!(c instanceof S))return null;for(;null!==a;){var d=b?a.uF:a.cE;if(!0===d&&(null!==a.Od||a instanceof S)&&(b?this.isValidTo(c,a):this.isValidFrom(c,a)))return a;if(!1===d)break;a=a.T}return null};
Eg.prototype.findTargetPort=function(a){var b=this.g,c=b.O.ea,d=this.OE;0>=d&&(d=.1);for(var e=this,f=b.Om(c,d,function(b){return e.findValidLinkablePort(b,a)},null,!0),d=Infinity,b=null,f=f.i;f.next();){var h=f.value,k=h.V;if(k instanceof S){var l=h.fb(Kb,v.M()),m=c.x-l.x,n=c.y-l.y;v.v(l);l=m*m+n*n;l<d&&(m=this.Cx.la(h),null!==m?m&&(b=h,d=l):a&&this.isValidLink(this.eh,this.fh,k,h)||!a&&this.isValidLink(k,h,this.gh,this.hh)?(this.Cx.add(h,!0),b=h,d=l):this.Cx.add(h,!1))}}return null!==b&&(c=b.V,
c instanceof S&&(null===c.layer||c.layer.Ks))?b:null};Eg.prototype.isValidFrom=function(a,b){if(null===a||null===b)return this.cp;if(this.g.$a===this&&(null!==a.layer&&!a.layer.Ks||!0!==b.cE))return!1;var c=b.qH;if(Infinity>c){if(null!==this.pc&&a===this.eh&&b===this.fh)return!0;var d=b.Od;null===d&&(d="");if(a.Fw(d).count>=c)return!1}return!0};
Eg.prototype.isValidTo=function(a,b){if(null===a||null===b)return this.cp;if(this.g.$a===this&&(null!==a.layer&&!a.layer.Ks||!0!==b.uF))return!1;var c=b.iJ;if(Infinity>c){if(null!==this.pc&&a===this.gh&&b===this.hh)return!0;var d=b.Od;null===d&&(d="");if(a.qg(d).count>=c)return!1}return!0};Eg.prototype.isInSameNode=function(a,b){if(null===a||null===b)return!1;if(a===b)return!0;var c=a.V,d=b.V;return null!==c&&c===d};
Eg.prototype.isLinked=function(a,b){if(null===a||null===b)return!1;var c=a.V;if(!(c instanceof S))return!1;var d=a.Od;null===d&&(d="");var e=b.V;if(!(e instanceof S))return!1;var f=b.Od;null===f&&(f="");for(e=e.qg(f);e.next();)if(f=e.value,f.U===c&&f.rg===d)return!0;return!1};
Eg.prototype.isValidLink=function(a,b,c,d){if(!this.isValidFrom(a,b)||!this.isValidTo(c,d)||!(null===b||null===d||(b.pH&&d.hJ||!this.isInSameNode(b,d))&&(b.oH&&d.gJ||!this.isLinked(b,d)))||null!==this.pc&&(null!==a&&this.isLabelDependentOnLink(a,this.pc)||null!==c&&this.isLabelDependentOnLink(c,this.pc))||null!==a&&null!==c&&(null===a.data&&null!==c.data||null!==a.data&&null===c.data)||!this.isValidCycle(a,c,this.pc))return!1;if(null!==a){var e=a.Yw;if(null!==e&&!e(a,b,c,d,this.pc))return!1}if(null!==
c&&(e=c.Yw,null!==e&&!e(a,b,c,d,this.pc)))return!1;e=this.Yw;return null!==e?e(a,b,c,d,this.pc):!0};Eg.prototype.isLabelDependentOnLink=function(a,b){if(null===a)return!1;var c=a.ce;if(null===c)return!1;if(c===b)return!0;var d=new H(S);d.add(a);return Fg(this,c,b,d)};function Fg(a,b,c,d){if(b===c)return!0;var e=b.U;if(null!==e&&e.qf&&(d.add(e),Fg(a,e.ce,c,d)))return!0;b=b.ba;return null!==b&&b.qf&&(d.add(b),Fg(a,b.ce,c,d))?!0:!1}
Eg.prototype.isValidCycle=function(a,b,c){void 0===c&&(c=null);if(null===a||null===b)return this.cp;var d=this.g.oJ;if(d!==Gg){if(d===Hg){if(null!==c&&!c.Cc)return!0;for(d=b.ne;d.next();){var e=d.value;if(e!==c&&e.Cc&&e.ba===b)return!1}return!Ig(this,a,b,c,!0)}if(d===Jg){if(null!==c&&!c.Cc)return!0;for(d=a.ne;d.next();)if(e=d.value,e!==c&&e.Cc&&e.U===a)return!1;return!Ig(this,a,b,c,!0)}if(d===Kg)return a===b?a=!0:(d=new H(S),d.add(b),a=Lg(this,d,a,b,c)),!a;if(d===Mg)return!Ig(this,a,b,c,!1);if(d===
Ng)return a===b?a=!0:(d=new H(S),d.add(b),a=Xg(this,d,a,b,c)),!a}return!0};function Ig(a,b,c,d,e){if(b===c)return!0;if(null===b||null===c)return!1;for(var f=b.ne;f.next();){var h=f.value;if(h!==d&&(!e||h.Cc)&&h.ba===b&&(h=h.U,h!==b&&Ig(a,h,c,d,e)))return!0}return!1}function Lg(a,b,c,d,e){if(c===d)return!0;if(null===c||null===d||b.contains(c))return!1;b.add(c);for(var f=c.ne;f.next();){var h=f.value;if(h!==e&&h.ba===c&&(h=h.U,h!==c&&Lg(a,b,h,d,e)))return!0}return!1}
function Xg(a,b,c,d,e){if(c===d)return!0;if(null===c||null===d||b.contains(c))return!1;b.add(c);for(var f=c.ne;f.next();){var h=f.value;if(h!==e){var k=h.U,h=h.ba,k=k===c?h:k;if(k!==c&&Xg(a,b,k,d,e))return!0}}return!1}v.defineProperty(Eg,{Yw:"linkValidation"},function(){return this.Ik},function(a){null!==a&&v.j(a,"function",Eg,"linkValidation");this.Ik=a});v.defineProperty(Eg,{ix:"portTargeted"},function(){return this.EC},function(a){null!==a&&v.j(a,"function",Eg,"portTargeted");this.EC=a});
function ua(){0<arguments.length&&v.dd(ua);Eg.call(this);this.name="Linking";this.Sx={};this.Rx=null;this.na=ah;this.QC=null}v.Ga(ua,Eg);v.ga("LinkingTool",ua);var ah;ua.Either=ah=v.p(ua,"Either",0);var bh;ua.ForwardsOnly=bh=v.p(ua,"ForwardsOnly",0);var ch;ua.BackwardsOnly=ch=v.p(ua,"BackwardsOnly",0);v.defineProperty(ua,{xG:"archetypeLinkData"},function(){return this.Sx},function(a){null!==a&&v.C(a,Object,ua,"archetypeLinkData");a instanceof R&&v.C(a,W,ua,"archetypeLinkData");this.Sx=a});
v.defineProperty(ua,{vD:"archetypeLabelNodeData"},function(){return this.Rx},function(a){null!==a&&v.C(a,Object,ua,"archetypeLabelNodeData");a instanceof R&&v.C(a,S,ua,"archetypeLabelNodeData");this.Rx=a});v.defineProperty(ua,{direction:"direction"},function(){return this.na},function(a){v.qb(a,ua,ua,"direction");this.na=a});v.defineProperty(ua,{rF:"startObject"},function(){return this.QC},function(a){null!==a&&v.C(a,R,ua,"startObject");this.QC=a});
ua.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;if(null===a||a.gb||a.rf||!a.Ks)return!1;var b=a.da;return(b instanceof Q||b instanceof te)&&a.O.left&&(a.$a===this||this.isBeyondDragSize())?null!==this.findLinkablePort():!1};
ua.prototype.findLinkablePort=function(){var a=this.g;if(null===a)return null;var b=this.rF;null===b&&(b=a.le(a.uc.ea,null,null));if(null===b||!(b.V instanceof S))return null;a=this.direction;if(a===ah||a===bh){var c=this.findValidLinkablePort(b,!1);if(null!==c)return this.$d=!0,c}if(a===ah||a===ch)if(c=this.findValidLinkablePort(b,!0),null!==c)return this.$d=!1,c;return null};
ua.prototype.doActivate=function(){var a=this.g;if(null!==a){var b=this.findLinkablePort();null!==b&&(this.Qb(this.name),a.Le=!0,a.Yb="pointer",this.$d?(this.fh=b,b=this.fh.V,b instanceof S&&(this.eh=b),this.copyPortProperties(this.eh,this.fh,this.re,this.en,!1)):(this.hh=b,b=this.hh.V,b instanceof S&&(this.gh=b),this.copyPortProperties(this.gh,this.hh,this.se,this.fn,!0)),a.add(this.re),a.add(this.se),null!==this.Bg&&(null!==this.re&&(this.Bg.U=this.re),null!==this.se&&(this.Bg.ba=this.se),this.Bg.gc(),
a.add(this.Bg)),this.qa=!0)}};ua.prototype.doDeactivate=function(){this.qa=!1;var a=this.g;null!==a&&(a.remove(this.Bg),a.remove(this.re),a.remove(this.se),a.Le=!1,a.Yb="",this.dk())};ua.prototype.doStop=function(){Eg.prototype.doStop.call(this);this.rF=null};
ua.prototype.doMouseUp=function(){if(this.qa){var a=this.g;if(null===a)return;var b=this.wf=null,c=null,d=null,e=null,f=this.Tf=this.findTargetPort(this.$d);if(null!==f){var h=f.V;h instanceof S&&(this.$d?(null!==this.eh&&(b=this.eh,c=this.fh),d=h,e=f):(b=h,c=f,null!==this.gh&&(d=this.gh,e=this.hh)))}else this.$d?null!==this.eh&&this.cp&&(b=this.eh,c=this.fh):null!==this.gh&&this.cp&&(d=this.gh,e=this.hh);if(null!==b||null!==d)b=this.insertLink(b,c,d,e),null!==b?(null===f&&(this.$d?b.En=a.O.ea.copy():
b.An=a.O.ea.copy()),a.lf&&a.select(b),this.wf=this.name,a.ya("LinkDrawn",b)):a.da.DD()}this.stopTool()};
ua.prototype.insertLink=function(a,b,c,d){var e=this.g;if(null===e)return null;var f=e.da;if(f instanceof te){var h=a;b=c;e.Md||(h=c,b=a);if(null!==h&&null!==b)return f.mh(b.data,f.mb(h.data)),b.$s()}else if(f instanceof Q)if(h="",null!==a&&(null===b&&(b=a),h=b.Od,null===h&&(h="")),b="",null!==c&&(null===d&&(d=c),b=d.Od,null===b&&(b="")),d=this.xG,d instanceof W){if(of(d),f=d.copy(),null!==f)return f.U=a,f.rg=h,f.ba=c,f.oh=b,e.add(f),a=this.vD,a instanceof S&&(of(a),a=a.copy(),null!==a&&(a.ce=f,e.add(a))),
f}else if(null!==d&&(d=f.xz(d),v.Wa(d)))return null!==a&&f.tx(d,f.mb(a.data)),f.AA(d,h),null!==c&&f.wx(d,f.mb(c.data)),f.EA(d,b),f.Gs(d),a=this.vD,null===a||a instanceof S||(a=f.copyNodeData(a),v.Wa(a)&&(f.Vk(a),a=f.mb(a),void 0!==a&&f.jz(d,a))),f=e.pg(d);return null};
function Jf(){0<arguments.length&&v.dd(Jf);Eg.call(this);this.name="Relinking";var a=new X;a.Cb="Diamond";a.xa=K.Fx;a.fill="lightblue";a.stroke="dodgerblue";a.cursor="pointer";a.pe=0;this.MB=a;a=new X;a.Cb="Diamond";a.xa=K.Fx;a.fill="lightblue";a.stroke="dodgerblue";a.cursor="pointer";a.pe=-1;this.bD=a;this.Vb=null;this.wC=new z}v.Ga(Jf,Eg);v.ga("RelinkingTool",Jf);
Jf.prototype.updateAdornments=function(a){if(null!==a&&a instanceof W){var b="RelinkFrom",c=null;if(a.hb&&!this.g.gb){var d=a.Qt;null!==d&&a.canRelinkFrom()&&a.Z.H()&&a.isVisible()&&d.Z.H()&&d.ul()&&(c=a.Qo(b),null===c&&(c=this.makeAdornment(d,!1),null!==c&&(c.Mc=b),a.Uk(b,c)))}null===c&&a.yl(b);b="RelinkTo";c=null;a.hb&&!this.g.gb&&(d=a.Qt,null!==d&&a.canRelinkTo()&&a.Z.H()&&a.isVisible()&&d.Z.H()&&d.ul()&&(c=a.Qo(b),null===c&&(c=this.makeAdornment(d,!0),null!==c&&(c.Mc=b),a.Uk(b,c))));null===c&&
a.yl(b)}};Jf.prototype.makeAdornment=function(a,b){var c=new mf;c.type=dh;var d=b?this.fJ:this.nH;null!==d&&c.add(d.copy());c.ec=a;return c};v.defineProperty(Jf,{nH:"fromHandleArchetype"},function(){return this.MB},function(a){null!==a&&v.C(a,R,Jf,"fromHandleArchetype");this.MB=a});v.defineProperty(Jf,{fJ:"toHandleArchetype"},function(){return this.bD},function(a){null!==a&&v.C(a,R,Jf,"toHandleArchetype");this.bD=a});v.u(Jf,{handle:"handle"},function(){return this.Vb});
Jf.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;if(null===a||a.gb||a.rf||!a.Bm)return!1;var b=a.da;if(!(b instanceof Q||b instanceof te)||!a.O.left)return!1;b=this.findToolHandleAt(a.uc.ea,"RelinkFrom");null===b&&(b=this.findToolHandleAt(a.uc.ea,"RelinkTo"));return null!==b};
Jf.prototype.doActivate=function(){var a=this.g;if(null!==a){if(null===this.pc){var b=this.findToolHandleAt(a.uc.ea,"RelinkFrom");null===b&&(b=this.findToolHandleAt(a.uc.ea,"RelinkTo"));if(null===b)return;var c=b.V;if(!(c instanceof mf&&c.Sh instanceof W))return;this.Vb=b;this.$d=null===c||"RelinkTo"===c.Mc;this.pc=c.Sh}this.Qb(this.name);a.Le=!0;a.Yb="pointer";this.fh=this.pc.$c;this.eh=this.pc.U;this.hh=this.pc.Bd;this.gh=this.pc.ba;this.wC.set(this.pc.Z);null!==this.pc&&0<this.pc.ma&&(null===this.pc.U&&
(null!==this.en&&(this.en.xa=K.Np),null!==this.re&&(this.re.location=this.pc.l(0))),null===this.pc.ba&&(null!==this.fn&&(this.fn.xa=K.Np),null!==this.se&&(this.se.location=this.pc.l(this.pc.ma-1))));this.copyPortProperties(this.eh,this.fh,this.re,this.en,!1);this.copyPortProperties(this.gh,this.hh,this.se,this.fn,!0);a.add(this.re);a.add(this.se);null!==this.Bg&&(null!==this.re&&(this.Bg.U=this.re),null!==this.se&&(this.Bg.ba=this.se),this.copyLinkProperties(this.pc,this.Bg),this.Bg.gc(),a.add(this.Bg));
this.qa=!0}};Jf.prototype.copyLinkProperties=function(a,b){if(null!==a&&null!==b){b.Is=a.Is;b.yz=a.yz;var c=a.Ge;if(c===eh||c===fh)c=gh;b.Ge=c;b.ww=a.ww;b.ox=a.ox;b.Ep=a.Ep;b.Ab=a.Ab;b.il=a.il;b.dt=a.dt;b.et=a.et;b.Bb=a.Bb;b.Fl=a.Fl;b.Zt=a.Zt;b.au=a.au}};Jf.prototype.doDeactivate=function(){this.qa=!1;var a=this.g;null!==a&&(a.remove(this.Bg),a.remove(this.re),a.remove(this.se),a.Le=!1,a.Yb="",this.dk())};Jf.prototype.doStop=function(){Eg.prototype.doStop.call(this);this.Vb=null};
Jf.prototype.doMouseUp=function(){if(this.qa){var a=this.g;if(null===a)return;this.wf=null;var b=this.eh,c=this.fh,d=this.gh,e=this.hh,f=this.pc;this.Tf=this.findTargetPort(this.$d);if(null!==this.Tf){var h=this.Tf.V;h instanceof S&&(this.$d?(d=h,e=this.Tf):(b=h,c=this.Tf))}else this.cp?this.$d?e=d=null:c=b=null:f=null;null!==f&&(this.reconnectLink(f,this.$d?d:b,this.$d?e:c,this.$d),null===this.Tf&&(this.$d?f.En=a.O.ea.copy():f.An=a.O.ea.copy(),f.gc()),a.lf&&(f.hb=!0),this.wf=this.name,a.ya("LinkRelinked",
f,this.$d?this.hh:this.fh));hh(this.pc,this.wC)}this.stopTool()};Jf.prototype.reconnectLink=function(a,b,c,d){if(null===this.g)return!1;c=null!==c&&null!==c.Od?c.Od:"";d?(a.ba=b,a.oh=c):(a.U=b,a.rg=c);return!0};function zg(a,b,c,d,e){null!==b?(a.copyPortProperties(b,c,a.re,a.en,!1),a.g.add(a.re)):a.g.remove(a.re);null!==d?(a.copyPortProperties(d,e,a.se,a.fn,!0),a.g.add(a.se)):a.g.remove(a.se)}
function ih(){0<arguments.length&&v.dd(ih);Le.call(this);this.name="LinkReshaping";var a=new X;a.Cb="Rectangle";a.xa=K.Lp;a.fill="lightblue";a.stroke="dodgerblue";this.zk=a;a=new X;a.Cb="Diamond";a.xa=K.Lp;a.fill="lightblue";a.stroke="dodgerblue";this.jC=a;this.FC=3;this.Px=this.Vb=null;this.xC=new w;this.Ty=null}v.Ga(ih,Le);v.ga("LinkReshapingTool",ih);var jh;ih.None=jh=v.p(ih,"None",0);var kh;ih.Horizontal=kh=v.p(ih,"Horizontal",1);var lh;ih.Vertical=lh=v.p(ih,"Vertical",2);var mh;
ih.All=mh=v.p(ih,"All",3);ih.prototype.getReshapingBehavior=ih.prototype.gE=function(a){return a&&a.GC?a.GC:jh};ih.prototype.setReshapingBehavior=ih.prototype.Tt=function(a,b){v.C(a,R,ih,"setReshapingBehavior:obj");v.qb(b,ih,ih,"setReshapingBehavior:behavior");a.GC=b};
ih.prototype.updateAdornments=function(a){if(null!==a&&a instanceof W){if(a.hb&&!this.g.gb){var b=a.path;if(null!==b&&a.canReshape()&&a.Z.H()&&a.isVisible()&&b.Z.H()&&b.ul()){var c=a.Qo(this.name);if(null===c||c.bG!==a.ma||c.nG!==a.Lt)c=this.makeAdornment(b),null!==c&&(c.bG=a.ma,c.nG=a.Lt,a.Uk(this.name,c));if(null!==c){c.location=a.position;return}}}a.yl(this.name)}};
ih.prototype.makeAdornment=function(a){var b=a.V,c=b.ma,d=b.hc,e=null;if(null!==b.points&&1<c){e=new mf;e.type=dh;var c=b.at,f=b.Vw,h=d?1:0;if(b.Lt&&b.Ge!==nh)for(var k=c+h;k<f-h;k++){var l=this.makeResegmentHandle(a,k);null!==l&&(l.pe=k,l.qx=.5,e.add(l))}for(k=c+1;k<f;k++)if(l=this.makeHandle(a,k),null!==l){l.pe=k;if(k!==c)if(k===c+1&&d){var h=b.l(c),m=b.l(c+1);K.D(h.x,m.x)&&K.D(h.y,m.y)&&(m=b.l(c-1));K.D(h.x,m.x)?(this.Tt(l,lh),l.cursor="n-resize"):K.D(h.y,m.y)&&(this.Tt(l,kh),l.cursor="w-resize")}else k===
f-1&&d?(h=b.l(f-1),m=b.l(f),K.D(h.x,m.x)&&K.D(h.y,m.y)&&(h=b.l(f+1)),K.D(h.x,m.x)?(this.Tt(l,lh),l.cursor="n-resize"):K.D(h.y,m.y)&&(this.Tt(l,kh),l.cursor="w-resize")):k!==f&&(this.Tt(l,mh),l.cursor="move");e.add(l)}e.Mc=this.name;e.ec=a}return e};ih.prototype.makeHandle=function(){var a=this.gt;return null===a?null:a.copy()};v.defineProperty(ih,{gt:"handleArchetype"},function(){return this.zk},function(a){null!==a&&v.C(a,R,ih,"handleArchetype");this.zk=a});
ih.prototype.makeResegmentHandle=function(){var a=this.lI;return null===a?null:a.copy()};v.defineProperty(ih,{lI:"midHandleArchetype"},function(){return this.jC},function(a){null!==a&&v.C(a,R,ih,"midHandleArchetype");this.jC=a});v.u(ih,{handle:"handle"},function(){return this.Vb});v.u(ih,{Js:"adornedLink"},function(){return this.Px});ih.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;return null!==a&&!a.gb&&a.lw&&a.O.left?null!==this.findToolHandleAt(a.uc.ea,this.name):!1};
ih.prototype.doActivate=function(){var a=this.g;if(null!==a&&(this.Vb=this.findToolHandleAt(a.uc.ea,this.name),null!==this.Vb)){var b=this.Vb.V.Sh;if(b instanceof W){this.Px=b;a.Le=!0;this.Qb(this.name);if(b.Lt&&.5===this.Vb.qx){var c=b.points.copy(),d=this.Vb.fb(Kb);c.xd(this.Vb.pe+1,d);b.hc&&c.xd(this.Vb.pe+1,d);b.points=c;b.Zd();this.Vb=this.findToolHandleAt(a.uc.ea,this.name)}this.xC=b.l(this.Vb.pe);this.Ty=b.points.copy();this.qa=!0}}};
ih.prototype.doDeactivate=function(){this.dk();this.Px=this.Vb=null;var a=this.g;null!==a&&(a.Le=!1);this.qa=!1};ih.prototype.doCancel=function(){var a=this.Js;null!==a&&(a.points=this.Ty);this.stopTool()};ih.prototype.doMouseMove=function(){var a=this.g;this.qa&&null!==a&&(a=this.computeReshape(a.O.ea),this.reshape(a))};
ih.prototype.doMouseUp=function(){var a=this.g;if(this.qa&&null!==a){var b=this.computeReshape(a.O.ea);this.reshape(b);b=this.Js;if(null!==b&&b.Lt){var c=this.handle.pe,d=b.l(c-1),e=b.l(c),f=b.l(c+1);if(b.hc){if(c>b.at+1&&c<b.Vw-1){var h=b.l(c-2);if(Math.abs(d.x-e.x)<this.kh&&Math.abs(d.y-e.y)<this.kh&&(oh(this,h,d,e,f,!0)||oh(this,h,d,e,f,!1))){var k=b.points.copy();oh(this,h,d,e,f,!0)?(k.zg(c-2,new w(h.x,(f.y+h.y)/2)),k.zg(c+1,new w(f.x,(f.y+h.y)/2))):(k.zg(c-2,new w((f.x+h.x)/2,h.y)),k.zg(c+1,
new w((f.x+h.x)/2,f.y)));k.Rc(c);k.Rc(c-1);b.points=k;b.Zd()}else h=b.l(c+2),Math.abs(e.x-f.x)<this.kh&&Math.abs(e.y-f.y)<this.kh&&(oh(this,d,e,f,h,!0)||oh(this,d,e,f,h,!1))&&(k=b.points.copy(),oh(this,d,e,f,h,!0)?(k.zg(c-1,new w(d.x,(d.y+h.y)/2)),k.zg(c+2,new w(h.x,(d.y+h.y)/2))):(k.zg(c-1,new w((d.x+h.x)/2,d.y)),k.zg(c+2,new w((d.x+h.x)/2,h.y))),k.Rc(c+1),k.Rc(c),b.points=k,b.Zd())}}else h=v.M(),K.Ym(d.x,d.y,f.x,f.y,e.x,e.y,h)&&h.Tj(e)<this.kh*this.kh&&(k=b.points.copy(),k.Rc(c),b.points=k,b.Zd()),
v.v(h)}a.oc();this.wf=this.name;a.ya("LinkReshaped",this.Js)}this.stopTool()};function oh(a,b,c,d,e,f){return f?Math.abs(b.y-c.y)<a.kh&&Math.abs(c.y-d.y)<a.kh&&Math.abs(d.y-e.y)<a.kh:Math.abs(b.x-c.x)<a.kh&&Math.abs(c.x-d.x)<a.kh&&Math.abs(d.x-e.x)<a.kh}v.defineProperty(ih,{kh:"resegmentingDistance"},function(){return this.FC},function(a){v.j(a,"number",ih,"resegmentingDistance");this.FC=a});
ih.prototype.reshape=function(a){var b=this.Js;b.Bl();var c=this.handle.pe,d=this.gE(this.handle);if(b.hc)if(c===b.at+1)c=b.at+1,d===lh?(b.Y(c,b.l(c-1).x,a.y),b.Y(c+1,b.l(c+2).x,a.y)):d===kh&&(b.Y(c,a.x,b.l(c-1).y),b.Y(c+1,a.x,b.l(c+2).y));else if(c===b.Vw-1)c=b.Vw-1,d===lh?(b.Y(c-1,b.l(c-2).x,a.y),b.Y(c,b.l(c+1).x,a.y)):d===kh&&(b.Y(c-1,a.x,b.l(c-2).y),b.Y(c,a.x,b.l(c+1).y));else{var d=c,e=b.l(d),f=b.l(d-1),h=b.l(d+1);K.D(f.x,e.x)&&K.D(e.y,h.y)?(K.D(f.x,b.l(d-2).x)&&!K.D(f.y,b.l(d-2).y)?(b.w(d,a.x,
f.y),c++,d++):b.Y(d-1,a.x,f.y),K.D(h.y,b.l(d+2).y)&&!K.D(h.x,b.l(d+2).x)?b.w(d+1,h.x,a.y):b.Y(d+1,h.x,a.y)):K.D(f.y,e.y)&&K.D(e.x,h.x)?(K.D(f.y,b.l(d-2).y)&&!K.D(f.x,b.l(d-2).x)?(b.w(d,f.x,a.y),c++,d++):b.Y(d-1,f.x,a.y),K.D(h.x,b.l(d+2).x)&&!K.D(h.y,b.l(d+2).y)?b.w(d+1,a.x,h.y):b.Y(d+1,a.x,h.y)):K.D(f.x,e.x)&&K.D(e.x,h.x)?(K.D(f.x,b.l(d-2).x)&&!K.D(f.y,b.l(d-2).y)?(b.w(d,a.x,f.y),c++,d++):b.Y(d-1,a.x,f.y),K.D(h.x,b.l(d+2).x)&&!K.D(h.y,b.l(d+2).y)?b.w(d+1,a.x,h.y):b.Y(d+1,a.x,h.y)):K.D(f.y,e.y)&&K.D(e.y,
h.y)&&(K.D(f.y,b.l(d-2).y)&&!K.D(f.x,b.l(d-2).x)?(b.w(d,f.x,a.y),c++,d++):b.Y(d-1,f.x,a.y),K.D(h.y,b.l(d+2).y)&&!K.D(h.x,b.l(d+2).x)?b.w(d+1,h.x,a.y):b.Y(d+1,h.x,a.y));b.Y(c,a.x,a.y)}else b.Y(c,a.x,a.y),1===c&&b.computeSpot(!0).me()&&(e=b.U,f=b.$c,null===e||e.isVisible()||(e=e.findVisibleNode(),e!==b.U&&(f=e.hl(""))),d=f.fb(Kb,v.M()),e=b.getLinkPointFromPoint(e,f,d,a,!0,v.M()),b.Y(0,e.x,e.y),v.v(d),v.v(e)),c===b.ma-2&&b.computeSpot(!1).me()&&(c=b.ba,e=b.Bd,null===c||c.isVisible()||(c=c.findVisibleNode(),
c!==b.ba&&(e=c.hl(""))),d=e.fb(Kb,v.M()),e=b.getLinkPointFromPoint(c,e,d,a,!1,v.M()),b.Y(b.ma-1,e.x,e.y),v.v(d),v.v(e));b.Oi()};ih.prototype.computeReshape=function(a){var b=this.Js,c=this.handle.pe;switch(this.gE(this.handle)){case mh:return a;case lh:return b=b.l(c),new w(b.x,a.y);case kh:return b=b.l(c),new w(a.x,b.y);default:case jh:return b.l(c)}};v.u(ih,{VK:"originalPoint"},function(){return this.xC});v.u(ih,{WK:"originalPoints"},function(){return this.Ty});
function ph(){0<arguments.length&&v.dd(ph);Le.call(this);this.name="Resizing";this.yj=(new ia(1,1)).freeze();this.wj=(new ia(9999,9999)).freeze();this.cj=(new ia(NaN,NaN)).freeze();this.Mq=!1;this.Eb=null;var a=new X;a.Pj=Kb;a.Cb="Rectangle";a.xa=K.Lp;a.fill="lightblue";a.stroke="dodgerblue";a.nb=1;a.cursor="pointer";this.zk=a;this.Vb=null;this.wv=new ia;this.Sy=new w;this.ty=new ia(0,0);this.sy=new ia(Infinity,Infinity);this.qy=new ia(1,1);this.qC=!0}v.Ga(ph,Le);v.ga("ResizingTool",ph);
ph.prototype.updateAdornments=function(a){if(!(null===a||a instanceof W)){if(a.hb&&!this.g.gb){var b=a.ZE;if(null!==b&&a.canResize()&&a.Z.H()&&a.isVisible()&&b.Z.H()&&b.ul()){var c=a.Qo(this.name);if(null===c||c.ec!==b)c=this.makeAdornment(b);if(null!==c){var d=b.jl();c.angle=d;var e=b.fb(c.Ze,v.M()),f=b.Si();c.location=e;v.v(e);e=c.placeholder;if(null!==e){var b=b.Fa,h=v.El();h.m(b.width*f,b.height*f);e.xa=h;v.Wj(h)}qh(this,c,d);a.Uk(this.name,c);return}}}a.yl(this.name)}};
ph.prototype.makeAdornment=function(a){var b=null,b=a.V.YE;if(null===b){b=new mf;b.type=rh;b.Ze=Kb;var c=new sh;c.Lf=!0;b.add(c);b.add(this.makeHandle(a,zb));b.add(this.makeHandle(a,Gb));b.add(this.makeHandle(a,Vb));b.add(this.makeHandle(a,Rb));b.add(this.makeHandle(a,zc));b.add(this.makeHandle(a,Bc));b.add(this.makeHandle(a,Cc));b.add(this.makeHandle(a,Ac))}else if(of(b),b=b.copy(),null===b)return null;b.Mc=this.name;b.ec=a;return b};
ph.prototype.makeHandle=function(a,b){var c=this.gt;if(null===c)return null;c=c.copy();c.alignment=b;return c};
function qh(a,b,c){if(null!==b)if(!b.alignment.Oc()&&""!==b.cursor)a:{a=b.alignment;a.me()&&(a=Kb);if(0>=a.x)c=0>=a.y?c+225:1<=a.y?c+135:c+180;else if(1<=a.x)0>=a.y?c+=315:1<=a.y&&(c+=45);else if(0>=a.y)c+=270;else if(1<=a.y)c+=90;else break a;0>c?c+=360:360<=c&&(c-=360);b.cursor=22.5>c?"e-resize":67.5>c?"se-resize":112.5>c?"s-resize":157.5>c?"sw-resize":202.5>c?"w-resize":247.5>c?"nw-resize":292.5>c?"n-resize":337.5>c?"ne-resize":"e-resize"}else if(b instanceof C)for(b=b.elements;b.next();)qh(a,
b.value,c)}v.defineProperty(ph,{gt:"handleArchetype"},function(){return this.zk},function(a){null!==a&&v.C(a,R,ph,"handleArchetype");this.zk=a});v.u(ph,{handle:"handle"},function(){return this.Vb});v.defineProperty(ph,{ec:"adornedObject"},function(){return this.Eb},function(a){null!==a&&v.C(a,R,ph,"adornedObject");this.Eb=a});ph.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;return null!==a&&!a.gb&&a.Ls&&a.O.left?null!==this.findToolHandleAt(a.uc.ea,this.name)?!0:!1:!1};
ph.prototype.doActivate=function(){var a=this.g;null!==a&&(this.Vb=this.findToolHandleAt(a.uc.ea,this.name),null!==this.Vb&&(this.Eb=this.Vb.V.ec,this.Sy.set(this.Eb.V.location),this.wv.set(this.Eb.xa),this.qy=this.computeCellSize(),this.ty=this.computeMinSize(),this.sy=this.computeMaxSize(),a.Le=!0,this.qC=a.Oa.isEnabled,a.Oa.isEnabled=!1,this.Qb(this.name),this.qa=!0))};ph.prototype.doDeactivate=function(){var a=this.g;null!==a&&(this.dk(),this.Eb=this.Vb=null,this.qa=a.Le=!1,a.Oa.isEnabled=this.qC)};
ph.prototype.doCancel=function(){this.Eb.xa=this.wv;this.Eb.V.location=this.Sy;this.stopTool()};ph.prototype.doMouseMove=function(){var a=this.g;if(this.qa&&null!==a){var b=this.ty,c=this.sy,d=this.qy,e=this.Eb.fE(a.O.ea,v.M()),f=th;this.Eb instanceof X&&(f=uh(this.Eb));b=this.computeResize(e,this.Vb.alignment,b,c,d,!(f===vh||f===wh||a.O.shift));this.resize(b);a.Nf();v.v(e)}};
ph.prototype.doMouseUp=function(){var a=this.g;if(this.qa&&null!==a){var b=this.ty,c=this.sy,d=this.qy,e=this.Eb.fE(a.O.ea,v.M()),f=th;this.Eb instanceof X&&(f=uh(this.Eb));b=this.computeResize(e,this.Vb.alignment,b,c,d,!(f===vh||f===wh||a.O.shift));this.resize(b);v.v(e);a.oc();this.wf=this.name;a.ya("PartResized",this.Eb,this.wv)}this.stopTool()};
ph.prototype.resize=function(a){if(null!==this.g){var b=this.ec,c=b.V,d=b.jl(),e=b.Si(),f=Math.PI*d/180,h=Math.cos(f),f=Math.sin(f),k=0<d&&180>d?1:0,l=90<d&&270>d?1:0,d=180<d&&360>d?1:0,m=b.Fa.width,n=b.Fa.height;b.xa=a.size;var p=c.position.copy();c.mf();m=b.Fa.width-m;n=b.Fa.height-n;if(0!==m||0!==n)0!==m&&(p.x+=e*((a.x+m*l)*h-(a.y+n*k)*f)),0!==n&&(p.y+=e*((a.x+m*d)*f+(a.y+n*l)*h)),c.move(p),c instanceof S&&c.invalidateConnectedLinks()}};
ph.prototype.computeResize=function(a,b,c,d,e,f){b.me()&&(b=Kb);var h=this.ec.Fa,k=h.x,l=h.y,m=h.x+h.width,n=h.y+h.height,p=1;if(!f){var p=h.width,q=h.height;0>=p&&(p=1);0>=q&&(q=1);p=q/p}q=v.M();K.Xs(a.x,a.y,k,l,e.width,e.height,q);a=h.copy();0>=b.x?0>=b.y?(a.x=Math.max(q.x,m-d.width),a.x=Math.min(a.x,m-c.width),a.width=Math.max(m-a.x,c.width),a.y=Math.max(q.y,n-d.height),a.y=Math.min(a.y,n-c.height),a.height=Math.max(n-a.y,c.height),f||(b=a.height/a.width,p<b?(a.height=p*a.width,a.y=n-a.height):
(a.width=a.height/p,a.x=m-a.width))):1<=b.y?(a.x=Math.max(q.x,m-d.width),a.x=Math.min(a.x,m-c.width),a.width=Math.max(m-a.x,c.width),a.height=Math.max(Math.min(q.y-l,d.height),c.height),f||(b=a.height/a.width,p<b?a.height=p*a.width:(a.width=a.height/p,a.x=m-a.width))):(a.x=Math.max(q.x,m-d.width),a.x=Math.min(a.x,m-c.width),a.width=m-a.x,f||(a.height=p*a.width,a.y=l+.5*(n-l-a.height))):1<=b.x?0>=b.y?(a.width=Math.max(Math.min(q.x-k,d.width),c.width),a.y=Math.max(q.y,n-d.height),a.y=Math.min(a.y,n-
c.height),a.height=Math.max(n-a.y,c.height),f||(b=a.height/a.width,p<b?(a.height=p*a.width,a.y=n-a.height):a.width=a.height/p)):1<=b.y?(a.width=Math.max(Math.min(q.x-k,d.width),c.width),a.height=Math.max(Math.min(q.y-l,d.height),c.height),f||(b=a.height/a.width,p<b?a.height=p*a.width:a.width=a.height/p)):(a.width=Math.max(Math.min(q.x-k,d.width),c.width),f||(a.height=p*a.width,a.y=l+.5*(n-l-a.height))):0>=b.y?(a.y=Math.max(q.y,n-d.height),a.y=Math.min(a.y,n-c.height),a.height=n-a.y,f||(a.width=a.height/
p,a.x=k+.5*(m-k-a.width))):1<=b.y&&(a.height=Math.max(Math.min(q.y-l,d.height),c.height),f||(a.width=a.height/p,a.x=k+.5*(m-k-a.width)));v.v(q);return a};ph.prototype.computeMinSize=function(){var a=this.ec.ug.copy(),b=this.ug;!isNaN(b.width)&&b.width>a.width&&(a.width=b.width);!isNaN(b.height)&&b.height>a.height&&(a.height=b.height);return a};
ph.prototype.computeMaxSize=function(){var a=this.ec.af.copy(),b=this.af;!isNaN(b.width)&&b.width<a.width&&(a.width=b.width);!isNaN(b.height)&&b.height<a.height&&(a.height=b.height);return a};
ph.prototype.computeCellSize=function(){var a=new ia(NaN,NaN),b=this.ec.V;if(null!==b){var c=b.HI;!isNaN(c.width)&&0<c.width&&(a.width=c.width);!isNaN(c.height)&&0<c.height&&(a.height=c.height)}c=this.Ho;isNaN(a.width)&&!isNaN(c.width)&&0<c.width&&(a.width=c.width);isNaN(a.height)&&!isNaN(c.height)&&0<c.height&&(a.height=c.height);b=this.g;(isNaN(a.width)||isNaN(a.height))&&b&&(c=b.wb.Xd,null!==c&&c.Qw&&(c=c.iE,isNaN(a.width)&&!isNaN(c.width)&&0<c.width&&(a.width=c.width),isNaN(a.height)&&!isNaN(c.height)&&
0<c.height&&(a.height=c.height)),b=b.ft,null!==b&&b.visible&&this.Qw&&(c=b.Jw,isNaN(a.width)&&!isNaN(c.width)&&0<c.width&&(a.width=c.width),isNaN(a.height)&&!isNaN(c.height)&&0<c.height&&(a.height=c.height)));if(isNaN(a.width)||0===a.width||Infinity===a.width)a.width=1;if(isNaN(a.height)||0===a.height||Infinity===a.height)a.height=1;return a};
v.defineProperty(ph,{ug:"minSize"},function(){return this.yj},function(a){v.C(a,ia,ph,"minSize");if(!this.yj.L(a)){var b=a.width;isNaN(b)&&(b=0);a=a.height;isNaN(a)&&(a=0);this.yj.m(b,a)}});v.defineProperty(ph,{af:"maxSize"},function(){return this.wj},function(a){v.C(a,ia,ph,"maxSize");if(!this.wj.L(a)){var b=a.width;isNaN(b)&&(b=Infinity);a=a.height;isNaN(a)&&(a=Infinity);this.wj.m(b,a)}});
v.defineProperty(ph,{Ho:"cellSize"},function(){return this.cj},function(a){v.C(a,ia,ph,"cellSize");this.cj.L(a)||this.cj.assign(a)});v.defineProperty(ph,{Qw:"isGridSnapEnabled"},function(){return this.Mq},function(a){v.j(a,"boolean",ph,"isGridSnapEnabled");this.Mq=a});v.u(ph,{TK:"originalDesiredSize"},function(){return this.wv});v.u(ph,{UK:"originalLocation"},function(){return this.Sy});
function xh(){0<arguments.length&&v.dd(xh);Le.call(this);this.name="Rotating";this.NC=45;this.MC=2;this.Eb=null;var a=new X;a.Cb="Ellipse";a.xa=K.Fx;a.fill="lightblue";a.stroke="dodgerblue";a.nb=1;a.cursor="pointer";this.zk=a;this.Vb=null;this.vv=0;this.HC=new w}v.Ga(xh,Le);v.ga("RotatingTool",xh);
xh.prototype.updateAdornments=function(a){if(!(null===a||a instanceof W)){if(a.hb&&!this.g.gb){var b=a.bF;if(null!==b&&a.canRotate()&&a.Z.H()&&a.isVisible()&&b.Z.H()&&b.ul()){var c=a.Qo(this.name);if(null===c||c.ec!==b)c=this.makeAdornment(b);if(null!==c){c.angle=b.jl();var d=null,e=null;b===a||b===a.ac?(d=a.ac,e=a.Ze):(d=b,e=Kb);for(var f=d.Fa,e=v.Rb(f.width*e.x+e.offsetX,f.height*e.y+e.offsetY);null!==d&&d!==b;)d.transform.xb(e),d=d.T;var d=e.y,f=Math.max(e.x-b.Fa.width,0),h=v.M();c.location=b.fb(new L(1,
0,50+f,d),h);v.v(h);v.v(e);a.Uk(this.name,c);return}}}a.yl(this.name)}};xh.prototype.makeAdornment=function(a){var b=null,b=a.V.KI;if(null===b){b=new mf;b.type=yh;b.Ze=Kb;var c=this.gt;null!==c&&b.add(c.copy())}else if(of(b),b=b.copy(),null===b)return null;b.Mc=this.name;b.ec=a;return b};v.defineProperty(xh,{gt:"handleArchetype"},function(){return this.zk},function(a){null!==a&&v.C(a,R,xh,"handleArchetype");this.zk=a});v.u(xh,{handle:"handle"},function(){return this.Vb});
v.defineProperty(xh,{ec:"adornedObject"},function(){return this.Eb},function(a){null!==a&&v.C(a,R,xh,"adornedObject");this.Eb=a});xh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;return null!==a&&!a.gb&&a.mw&&a.O.left?null!==this.findToolHandleAt(a.uc.ea,this.name)?!0:!1:!1};
xh.prototype.doActivate=function(){var a=this.g;if(null!==a&&(this.Vb=this.findToolHandleAt(a.uc.ea,this.name),null!==this.Vb)){this.Eb=this.Vb.V.ec;var b=this.Eb.V,c=b.ac;this.HC=this.Eb===b||this.Eb===c?c.fb(b.Ze):this.Eb.fb(Kb);this.vv=this.Eb.angle;a.Le=!0;a.Cz=!0;this.Qb(this.name);this.qa=!0}};xh.prototype.doDeactivate=function(){var a=this.g;null!==a&&(this.dk(),this.Eb=this.Vb=null,this.qa=a.Le=!1)};xh.prototype.doCancel=function(){var a=this.g;null!==a&&(a.Cz=!1);this.rotate(this.vv);this.stopTool()};
xh.prototype.doMouseMove=function(){var a=this.g;this.qa&&null!==a&&(a=this.computeRotate(a.O.ea),this.rotate(a))};xh.prototype.doMouseUp=function(){var a=this.g;if(this.qa&&null!==a){a.Cz=!1;var b=this.computeRotate(a.O.ea);this.rotate(b);a.oc();this.wf=this.name;a.ya("PartRotated",this.Eb,this.vv)}this.stopTool()};xh.prototype.rotate=function(a){null!==this.Eb&&(this.Eb.angle=a)};
xh.prototype.computeRotate=function(a){a=this.HC.Wg(a);var b=this.Eb.T;null!==b&&(a-=b.jl(),360<=a?a-=360:0>a&&(a+=360));var b=Math.min(Math.abs(this.ZI),180),c=Math.min(Math.abs(this.YI),b/2);!this.g.O.shift&&0<b&&0<c&&(a%b<c?a=Math.floor(a/b)*b:a%b>b-c&&(a=(Math.floor(a/b)+1)*b));360<=a?a-=360:0>a&&(a+=360);return a};v.defineProperty(xh,{ZI:"snapAngleMultiple"},function(){return this.NC},function(a){v.j(a,"number",xh,"snapAngleMultiple");this.NC=a});
v.defineProperty(xh,{YI:"snapAngleEpsilon"},function(){return this.MC},function(a){v.j(a,"number",xh,"snapAngleEpsilon");this.MC=a});v.u(xh,{SK:"originalAngle"},function(){return this.vv});function zh(){0<arguments.length&&v.dd(zh);Le.call(this);this.name="ClickSelecting"}v.Ga(zh,Le);v.ga("ClickSelectingTool",zh);zh.prototype.canStart=function(){return!this.isEnabled||null===this.g||this.isBeyondDragSize()?!1:!0};
zh.prototype.doMouseUp=function(){this.qa&&(this.standardMouseSelect(),this.standardMouseClick(),this.g.O.Zj&&this.g.wb.doToolTip());this.stopTool()};function Ah(){0<arguments.length&&v.dd(Ah);Le.call(this);this.name="Action";this.kn=null}v.Ga(Ah,Le);v.ga("ActionTool",Ah);
Ah.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;if(null===a)return!1;var b=a.O,c=a.le(b.ea,function(a){for(;null!==a.T&&!a.Nw;)a=a.T;return a});if(null!==c){if(!c.Nw)return!1;this.kn=c;a.wn=a.le(b.ea,null,null);return!0}return!1};Ah.prototype.doMouseDown=function(){if(this.qa){var a=this.g.O,b=this.kn;null!==b&&(a.qe=b,null!==b.nD&&b.nD(a,b))}else this.canStart()&&this.doActivate()};
Ah.prototype.doMouseMove=function(){if(this.qa){var a=this.g.O,b=this.kn;null!==b&&(a.qe=b,null!==b.oD&&b.oD(a,b))}};Ah.prototype.doMouseUp=function(){if(this.qa){var a=this.g,b=a.O,c=this.kn;if(null===c)return;b.qe=c;null!==c.pD&&c.pD(b,c);this.isBeyondDragSize()||Cf(c,b,a)}this.stopTool()};Ah.prototype.doCancel=function(){var a=this.g;if(null!==a){var a=a.O,b=this.kn;if(null===b)return;a.qe=b;null!==b.mD&&b.mD(a,b)}this.stopTool()};Ah.prototype.doStop=function(){this.kn=null};
function va(){0<arguments.length&&v.dd(va);Le.call(this);this.name="ClickCreating";this.sk=null;this.XB=!0;this.LB=new w(0,0)}v.Ga(va,Le);v.ga("ClickCreatingTool",va);
va.prototype.canStart=function(){if(!this.isEnabled||null===this.mz)return!1;var a=this.g;if(null===a||a.gb||a.rf||!a.Co||!a.O.left||this.isBeyondDragSize())return!1;if(this.MH){if(1===a.O.Ue&&(this.LB=a.O.ef.copy()),2!==a.O.Ue||this.isBeyondDragSize(this.LB))return!1}else if(1!==a.O.Ue)return!1;return a.$a!==this&&null!==a.Zs(a.O.ea,!0)?!1:!0};va.prototype.doMouseUp=function(){var a=this.g;this.qa&&null!==a&&this.insertPart(a.O.ea);this.stopTool()};
va.prototype.insertPart=function(a){var b=this.g;if(null===b)return null;var c=this.mz;if(null===c)return null;this.Qb(this.name);var d=null;c instanceof J?c.Ld()&&(of(c),d=c.copy(),null!==d&&b.add(d)):null!==c&&(c=b.da.copyNodeData(c),v.Wa(c)&&(b.da.Vk(c),d=b.Wh(c)));null!==d&&(d.location=a,b.lf&&b.select(d));b.oc();this.wf=this.name;b.ya("PartCreated",d);this.dk();return d};
v.defineProperty(va,{mz:"archetypeNodeData"},function(){return this.sk},function(a){null!==a&&v.C(a,Object,va,"archetypeNodeData");this.sk=a});v.defineProperty(va,{MH:"isDoubleClick"},function(){return this.XB},function(a){v.j(a,"boolean",va,"isDoubleClick");this.XB=a});function Bh(a,b,c){this.text=a;this.FD=b;this.visible=c}function Ch(){0<arguments.length&&v.dd(Ch);Le.call(this);this.name="ContextMenu";this.xn=this.qB=null;this.nC=new w;this.gy=this.Fn=null;Dh(this)}v.Ga(Ch,Le);
v.ga("ContextMenuTool",Ch);v.OD=!1;v.Ps=null;v.Qs=null;
function Dh(a){a.Fn=new mf;a.cD=function(){a.stopTool()};if(!1===v.OD){var b=v.createElement("div"),c=v.createElement("div");b.style.cssText="top: 0px;z-index:300;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px";c.style.cssText="z-index:299;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;-moz-opacity: 0.8;opacity:.80;filter: alpha(opacity=80);";var d=
v.createElement("style");window.document.getElementsByTagName("head")[0].appendChild(d);d.sheet.insertRule(".defaultCXul { list-style: none; }",0);d.sheet.insertRule(".defaultCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }",0);d.sheet.insertRule(".defaultCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }",0);b.addEventListener("contextmenu",function(a){a.preventDefault();return!1},
!1);b.addEventListener("selectstart",function(a){a.preventDefault();return!1},!1);c.addEventListener("contextmenu",function(a){a.preventDefault();return!1},!1);window.document.body&&(window.document.body.appendChild(b),window.document.body.appendChild(c));v.Qs=b;v.Ps=c;v.OD=!0}}Ch.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;return null===a||this.isBeyondDragSize()||!a.O.right?!1:null!==this.Fn&&a.O.Zj||null!==this.findObjectWithContextMenu()?!0:!1};
Ch.prototype.doStart=function(){var a=this.g;null!==a&&this.nC.set(a.uc.ea)};Ch.prototype.doStop=function(){this.hideDefaultContextMenu();this.hideContextMenu();this.xn=null};
Ch.prototype.findObjectWithContextMenu=function(a){void 0===a&&(a=null);var b=this.g;if(null===b)return null;var c=b.O,d=null;a instanceof E||(d=a instanceof R?a:b.le(c.ea,null,function(a){return!a.layer.Bc}));if(null!==d){for(a=d;null!==a;){c=a.contextMenu;if(null!==c)return a;a=a.T}if(null!==this.Fn&&b.O.Zj)return d.V}else if(c=b.contextMenu,null!==c)return b;return null};Ch.prototype.doActivate=function(){};
Ch.prototype.doMouseUp=function(){var a=this.g;null!==a&&(this.qa?null!==this.Hf&&(a=a.le(a.O.ea,null,null),null!==a&&a.rl(this.Hf)&&this.standardMouseClick(null,null),this.stopTool()):this.canStart()&&zf(this,!0))};
function zf(a,b,c){void 0===c&&(c=null);a.qa=!0;b&&a.standardMouseSelect();a.standardMouseClick();a.xn=null;null===c&&(c=a.findObjectWithContextMenu());null!==c?(b=c.contextMenu,null!==b?(a.xn=c instanceof R?c:null,a.showContextMenu(b,a.xn)):a.showDefaultContextMenu()):a.showDefaultContextMenu()}Ch.prototype.doMouseMove=function(){this.qa&&this.standardMouseOver()};
Ch.prototype.showContextMenu=function(a,b){v.C(a,mf,Ch,"showContextMenu:contextmenu");null!==b&&v.C(b,R,Ch,"showContextMenu:obj");var c=this.g;if(null!==c){a!==this.Hf&&this.hideContextMenu();a.tf="Tool";a.zl=!1;a.scale=1/c.scale;a.Mc=this.name;c.add(a);if(null!==b){var c=null,d=b.So();null!==d&&(c=d.data);a.ec=b;a.data=c}else a.data=c.da;a.mf();this.positionContextMenu(a,b);this.Hf=a}};
Ch.prototype.positionContextMenu=function(a){if(null===a.placeholder){var b=this.g;if(null!==b){var c=b.O.ea.copy(),d=a.Ba,e=b.tb;b.O.Zj&&(c.x-=d.width);c.x+d.width>e.right&&(c.x-=d.width+5);c.x<e.x&&(c.x=e.x);c.y+d.height>e.bottom&&(c.y-=d.height+5);c.y<e.y&&(c.y=e.y);a.position=c}}};Ch.prototype.hideContextMenu=function(){var a=this.g;null!==a&&null!==this.Hf&&(this.Hf.data=null,this.Hf.ec=null,a.remove(this.Hf),this.Hf=null,this.standardMouseOver())};
function Eh(a){if(null===a.g)return null;a=new G(Bh);a.add(new Bh("Copy",function(a){a.rb.copySelection()},function(a){return a.rb.canCopySelection()}));a.add(new Bh("Cut",function(a){a.rb.cutSelection()},function(a){return a.rb.canCutSelection()}));a.add(new Bh("Delete",function(a){a.rb.deleteSelection()},function(a){return a.rb.canDeleteSelection()}));a.add(new Bh("Paste",function(a){a.rb.pasteSelection(a.O.ea)},function(a){return a.rb.canPasteSelection()}));a.add(new Bh("Select All",function(a){a.rb.selectAll()},
function(a){return a.rb.canSelectAll()}));a.add(new Bh("Undo",function(a){a.rb.undo()},function(a){return a.rb.canUndo()}));a.add(new Bh("Redo",function(a){a.rb.redo()},function(a){return a.rb.canRedo()}));a.add(new Bh("Scroll To Part",function(a){a.rb.scrollToPart()},function(a){return a.rb.canScrollToPart()}));a.add(new Bh("Zoom To Fit",function(a){a.rb.zoomToFit()},function(a){return a.rb.canZoomToFit()}));a.add(new Bh("Reset Zoom",function(a){a.rb.resetZoom()},function(a){return a.rb.canResetZoom()}));
a.add(new Bh("Group Selection",function(a){a.rb.groupSelection()},function(a){return a.rb.canGroupSelection()}));a.add(new Bh("Ungroup Selection",function(a){a.rb.ungroupSelection()},function(a){return a.rb.canUngroupSelection()}));a.add(new Bh("Edit Text",function(a){a.rb.editTextBlock()},function(a){return a.rb.canEditTextBlock()}));return a}
Ch.prototype.showDefaultContextMenu=function(){var a=this.g;if(null!==a){null===this.gy&&(this.gy=Eh(this));this.Fn!==this.Hf&&this.hideContextMenu();v.Qs.innerHTML="";v.Ps.addEventListener("click",this.cD,!1);var b=this,c=v.createElement("ul");c.className="defaultCXul";v.Qs.appendChild(c);c.innerHTML="";for(var d=this.gy.i;d.next();){var e=d.value,f=e.text,h=e.visible;if("function"===typeof e.FD&&("function"!==typeof h||h(a))){h=v.createElement("li");h.className="defaultCXli";var k=v.createElement("a");
k.className="defaultCXa";k.href="#";k.UF=e.FD;k.addEventListener("click",function(c){this.UF(a);b.stopTool();c.preventDefault();return!1},!1);k.textContent=f;h.appendChild(k);c.appendChild(h)}}v.Qs.style.display="block";v.Ps.style.display="block";this.Hf=this.Fn}};Ch.prototype.hideDefaultContextMenu=function(){null!==this.Hf&&this.Hf===this.Fn&&(v.Qs.style.display="none",v.Ps.style.display="none",v.Ps.removeEventListener("click",this.cD,!1),this.Hf=null)};
v.defineProperty(Ch,{Hf:"currentContextMenu"},function(){return this.qB},function(a){null!==a&&v.C(a,mf,Ch,"currentContextMenu");this.qB=a});v.defineProperty(Ch,{VJ:"currentObject"},function(){return this.xn},function(a){null!==a&&v.C(a,R,Ch,"currentObject");this.xn=a});v.u(Ch,{NK:"mouseDownPoint"},function(){return this.nC});
function Fh(){0<arguments.length&&v.dd(Fh);Le.call(this);this.name="DragSelecting";this.Gn=175;this.bC=!1;var a=new J;a.tf="Tool";a.zl=!1;var b=new X;b.name="SHAPE";b.Cb="Rectangle";b.fill=null;b.stroke="magenta";a.add(b);this.Ll=a}v.Ga(Fh,Le);v.ga("DragSelectingTool",Fh);
Fh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;if(null===a||!a.lf)return!1;var b=a.O;return!b.left||a.$a!==this&&(!this.isBeyondDragSize()||b.timestamp-a.uc.timestamp<this.PD||null!==a.Zs(b.ea,!0))?!1:!0};Fh.prototype.doActivate=function(){var a=this.g;null!==a&&(this.qa=!0,a.Le=!0,a.lb=!0,a.add(this.Tg),this.doMouseMove())};Fh.prototype.doDeactivate=function(){var a=this.g;null!==a&&(a.remove(this.Tg),a.lb=!1,this.qa=a.Le=!1)};
Fh.prototype.doMouseMove=function(){if(null!==this.g&&this.qa&&null!==this.Tg){var a=this.computeBoxBounds(),b=this.Tg.Yd("SHAPE");null===b&&(b=this.Tg.If());b.xa=a.size;this.Tg.position=a.position}};Fh.prototype.doMouseUp=function(){if(this.qa){var a=this.g;a.remove(this.Tg);try{a.Yb="wait",this.selectInRect(this.computeBoxBounds())}finally{a.Yb=""}}this.stopTool()};Fh.prototype.computeBoxBounds=function(){var a=this.g;return null===a?new z(0,0,0,0):new z(a.uc.ea,a.O.ea)};
Fh.prototype.selectInRect=function(a){var b=this.g;if(null!==b){var c=b.O;b.ya("ChangingSelection");a=b.Vj(a,null,function(a){return a instanceof J?a.canSelect():!1},this.TH);if(v.Vm?c.xt:c.control)if(c.shift)for(a=a.i;a.next();)c=a.value,c.hb&&(c.hb=!1);else for(a=a.i;a.next();)c=a.value,c.hb=!c.hb;else{if(!c.shift){for(var c=new G(J),d=b.selection.i;d.next();){var e=d.value;a.contains(e)||c.add(e)}for(c=c.i;c.next();)c.value.hb=!1}for(a=a.i;a.next();)c=a.value,c.hb||(c.hb=!0)}b.ya("ChangedSelection")}};
v.defineProperty(Fh,{PD:"delay"},function(){return this.Gn},function(a){v.j(a,"number",Fh,"delay");this.Gn=a});v.defineProperty(Fh,{TH:"isPartialInclusion"},function(){return this.bC},function(a){v.j(a,"boolean",Fh,"isPartialInclusion");this.bC=a});v.defineProperty(Fh,{Tg:"box"},function(){return this.Ll},function(a){null!==a&&v.C(a,J,Fh,"box");this.Ll=a});
function Gh(){0<arguments.length&&v.dd(Gh);Le.call(this);this.name="Panning";this.Uy=new w;this.bj=!1;var a=this;this.RC=function(){window.document.removeEventListener("scroll",a.RC,!1);a.stopTool()}}v.Ga(Gh,Le);v.ga("PanningTool",Gh);Gh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;return null===a||!a.Be&&!a.Ce||!a.O.left||a.$a!==this&&!this.isBeyondDragSize()?!1:!0};
Gh.prototype.doActivate=function(){var a=this.g;null!==a&&(this.bj?(a.O.bubbles=!0,window.document.addEventListener("scroll",this.RC,!1)):(a.Yb="move",a.Le=!0,this.Uy=a.position.copy()),this.qa=!0)};Gh.prototype.doDeactivate=function(){var a=this.g;null!==a&&(a.Yb="",this.qa=a.Le=!1)};Gh.prototype.doCancel=function(){var a=this.g;null!==a&&(a.position=this.Uy,a.Le=!1);this.stopTool()};Gh.prototype.doMouseMove=function(){this.move()};Gh.prototype.doMouseUp=function(){this.move();this.stopTool()};
Gh.prototype.move=function(){var a=this.g;if(this.qa&&a)if(this.bj)a.O.bubbles=!0;else{var b=a.position,c=a.uc.ea,d=a.O.ea,e=b.x+c.x-d.x,c=b.y+c.y-d.y;a.Be||(e=b.x);a.Ce||(c=b.y);a.position=new w(e,c)}};v.defineProperty(Gh,{bubbles:"bubbles"},function(){return this.bj},function(a){v.j(a,"boolean",Gh,"bubbles");this.bj=a});v.u(Gh,{XK:"originalPosition"},function(){return this.Uy});
function Hh(){0<arguments.length&&v.dd(Hh);Le.call(this);this.name="TextEditing";this.uB=this.$v=this.VC=null;this.uo=Ph;this.Rk=null;this.cb=Qh;this.Ok=null;this.kC=1;this.KC=!0;var a=v.createElement("textarea");a.bB=!0;this.AB=a;a.addEventListener("input",function(){var a=this.textEditingTool,c=a.VC;c.text=this.value;var d=this.eJ;Rh(c,a.Cg.gv,Infinity);this.style.width=20+c.Ba.width*d+"px";this.style.height=10+c.Ba.height*d+"px";this.rows=c.$H},!1);a.addEventListener("keydown",function(a){var c=
a.which,d=this.textEditingTool;if(null!==d)if(13===c)!1===d.$v.Sw&&a.preventDefault(),d.acceptText(Sh);else{if(9===c)return d.acceptText(Th),a.preventDefault(),!1;27===c&&(d.doCancel(),null!==d.g&&d.g.focus())}},!1);a.addEventListener("focus",function(){var a=this.textEditingTool;a.cb===Uh?a.cb=Vh:a.cb===Wh?a.cb=Xh:a.cb===Xh&&(a.cb=Vh);"function"===typeof this.select&&a.zA&&(this.select(),this.setSelectionRange(0,9999))},!1);a.addEventListener("blur",function(){"function"===typeof this.focus&&this.focus();
var a=this.textEditingTool;"function"===typeof this.select&&a.zA&&(this.select(),this.setSelectionRange(0,9999))},!1)}v.ga("TextEditingTool",Hh);v.Ga(Hh,Le);var Yh;Hh.LostFocus=Yh=v.p(Hh,"LostFocus",0);var Zh;Hh.MouseDown=Zh=v.p(Hh,"MouseDown",1);var Th;Hh.Tab=Th=v.p(Hh,"Tab",2);var Sh;Hh.Enter=Sh=v.p(Hh,"Enter",3);Hh.SingleClick=v.p(Hh,"SingleClick",0);var Ph;Hh.SingleClickSelected=Ph=v.p(Hh,"SingleClickSelected",1);
var Qh=v.p(Hh,"StateNone",0),Uh=v.p(Hh,"StateActive",1),Vh=v.p(Hh,"StateEditing",2),Xh=v.p(Hh,"StateEditing2",3),$h=v.p(Hh,"StateValidating",4),Wh=v.p(Hh,"StateValidated",5);v.defineProperty(Hh,{Cg:"textBlock"},function(){return this.$v},function(a){null!==a&&v.C(a,ra,Hh,"textBlock");this.$v=a});v.defineProperty(Hh,{ng:"currentTextEditor"},function(){return this.uB},function(a){this.uB=a});
v.defineProperty(Hh,{XG:"defaultTextEditor"},function(){return this.AB},function(a){v.C(a,Element,Hh,"defaultTextEditor");this.AB=a});v.defineProperty(Hh,{GA:"starting"},function(){return this.uo},function(a){v.qb(a,Hh,Hh,"starting");this.uo=a});
Hh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;if(null===a||a.gb||!a.O.left||this.isBeyondDragSize())return!1;a=a.le(a.O.ea,null,function(a){return a instanceof ra});if(null===a||!a.Dz||!a.V.canEdit())return!1;a=a.V;return null===a||this.GA===Ph&&!a.hb?!1:!0};Hh.prototype.doStart=function(){this.qa||null===this.Cg||this.doActivate()};
Hh.prototype.doActivate=function(){if(!this.qa){var a=this.g;if(null!==a){var b=this.Cg;null===b&&(b=a.le(a.O.ea,function(a){return a instanceof ra?a:null}));if(null!==b){this.Cg=b;var c=b.V;if(null!==c){this.qa=!0;this.cb=Uh;var d=this.XG,e=!1;null!==b.tF&&(d=b.tF);null===d||d.bB||(e=!0);this.VC=this.Cg.copy();a.eF(c.Z);if(d.bB){var f=b.fb(Kb),h=a.position,k=a.scale,l=b.Si()*k;l<this.IE&&(l=this.IE);var c=b.Fa.width*l,m=b.Fa.height*l,n=(f.x-h.x)*k,f=(f.y-h.y)*k;d.value=b.text;a.fl.style.font=b.font;
d.style.font="inherit";d.style.fontSize=100*l+"%";d.style.lineHeight="normal";d.style.width=c+6+"px";d.style.height=m+2+"px";d.style.left=(n-c/2|0)-1+"px";d.style.top=(f-m/2|0)-1+"px";d.style.textAlign=b.textAlign;d.style.margin="0";d.style.padding="1px";d.style.border="0";d.style.outline="none";d.style["white-space"]="pre-wrap";d.style.overflow="hidden"}a.fl.appendChild(d);d.style.position="absolute";d.style.zIndex=100;d.className="start";d.textEditingTool=this;d.eJ=l;if(e&&"function"===typeof d.onActivate)d.onActivate();
this.ng=d;"function"===typeof d.focus&&d.focus();"function"===typeof d.select&&this.zA&&(d.select(),d.setSelectionRange(0,9999))}}}}};Hh.prototype.doCancel=function(){null!==this.Ok&&(this.ng.style.border=this.Ok,this.Ok=null);this.stopTool()};Hh.prototype.doMouseUp=function(){!this.qa&&this.canStart()&&this.doActivate()};Hh.prototype.doMouseDown=function(){this.qa&&this.acceptText(Zh)};
Hh.prototype.acceptText=function(a){switch(a){case Zh:if(this.cb===Wh||this.cb===Xh)"function"===typeof this.ng.focus&&this.ng.focus();else if(this.cb===Uh||this.cb===Vh)this.cb=$h,ai(this);break;case Yh:case Sh:case Th:if(Sh===a&&!0===this.$v.Sw)break;if(this.cb===Uh||this.cb===Vh)this.cb=$h,ai(this)}};
function ai(a){if(null!==a.Cg&&null!==a.ng){var b=a.Cg,c=a.Cg.text,d=a.ng.value,e="",e="function"===typeof d?d():d;if(!a.isValidText(a.Cg,c,e)){a.cb=Vh;null!==b.Ez&&b.Ez(a,c,e);null===a.Ok&&(a.Ok=a.ng.style.border,a.ng.style.border="3px solid red");"function"===typeof a.ng.focus&&a.ng.focus();return}a.Qb(a.name);a.cb=Wh;c!==e&&(a.Cg.text=e);a.wf=a.name;b=a.g;null!==b&&b.ya("TextEdited",a.Cg,c);a.dk();a.stopTool();null!==b&&b.focus()}null!==a.Ok&&(a.ng.style.border=a.Ok,a.Ok=null)}
Hh.prototype.doDeactivate=function(){var a=this.g;if(null!==a){this.cb=Qh;this.Cg=null;if(null!==this.ng){var b=this.ng;if("function"===typeof b.onDeactivate)b.onDeactivate();null!==b&&a.fl.removeChild(b)}this.qa=!1}};Hh.prototype.isValidText=function(a,b,c){v.C(a,ra,Hh,"isValidText:textblock");var d=this.JA;if(null!==d&&!d(a,b,c))return!1;d=a.JA;return null===d||d(a,b,c)?!0:!1};
v.defineProperty(Hh,{JA:"textValidation"},function(){return this.Rk},function(a){null!==a&&v.j(a,"function",Hh,"textValidation");this.Rk=a});v.defineProperty(Hh,{IE:"minimumEditorScale"},function(){return this.kC},function(a){null!==a&&v.j(a,"number",Hh,"minimumEditorScale");this.kC=a});v.defineProperty(Hh,{zA:"selectsTextOnActivate"},function(){return this.KC},function(a){null!==a&&v.j(a,"boolean",Hh,"selectsTextOnActivate");this.KC=a});
function kf(){Le.call(this);this.name="ToolManager";this.ZF=new G(Le);this.$F=new G(Le);this.aG=new G(Le);this.PB=this.QB=1E3;this.EB=(new ia(2,2)).Ma();this.dD=5E3;this.oC=Ef;this.NB=bi;this.Gu=this.ey=null;this.xm=-1}v.Ga(kf,Le);v.ga("ToolManager",kf);var Ef;kf.WheelScroll=Ef=v.p(kf,"WheelScroll",0);var Df;kf.WheelZoom=Df=v.p(kf,"WheelZoom",1);kf.WheelNone=v.p(kf,"WheelNone",2);var bi;kf.GestureZoom=bi=v.p(kf,"GestureZoom",3);var ci;kf.GestureCancel=ci=v.p(kf,"GestureCancel",4);var di;
kf.GestureNone=di=v.p(kf,"GestureNone",5);v.defineProperty(kf,{Bt:"mouseWheelBehavior"},function(){return this.oC},function(a){v.qb(a,kf,kf,"mouseWheelBehavior");this.oC=a});v.defineProperty(kf,{Vo:"gestureBehavior"},function(){return this.NB},function(a){v.qb(a,kf,kf,"gestureBehavior");this.NB=a});
kf.prototype.initializeStandardTools=function(){this.oG=new Ah;this.QE=new Jf;this.cI=new ih;this.aF=new ph;this.MI=new xh;this.CE=new ua;this.Xd=new wf;this.dH=new Fh;this.vI=new Gh;this.uz=new Ch;this.IA=new Hh;this.EG=new va;this.FG=new zh};
kf.prototype.doMouseDown=function(){var a=this.g;if(null!==a){var b=a.O;b.Zj&&this.Vo===ci&&(b.bubbles=!1);if(b.ot){if(this.Vo===di){b.bubbles=!0;return}if(this.Vo===ci)return;if(a.$a.canStartMultiTouch()){a.$a.standardPinchZoomStart();return}}b=a.ja;b.pz&&0!==b.ph&&v.trace("WARNING: In ToolManager.doMouseDown: UndoManager.transactionLevel is not zero");for(var b=this.df.length,c=0;c<b;c++){var d=this.df.ha(c);null===d.g&&d.Fc(this.g);if(d.canStart()){a.$a=d;a.$a===d&&(d.qa||d.doActivate(),d.doMouseDown());
return}}1===a.O.button&&(this.Bt===Ef?this.Bt=Df:this.Bt===Df&&(this.Bt=Ef));this.doActivate();this.standardWaitAfter(this.kE)}};
kf.prototype.doMouseMove=function(){var a=this.g;if(null!==a){var b=a.O;if(b.ot){if(this.Vo===di){b.bubbles=!0;return}if(this.Vo===ci)return;if(a.$a.canStartMultiTouch()){a.$a.standardPinchZoomMove();return}}if(this.qa)for(var b=this.Of.length,c=0;c<b;c++){var d=this.Of.ha(c);null===d.g&&d.Fc(this.g);if(d.canStart()){a.$a=d;a.$a===d&&(d.qa||d.doActivate(),d.doMouseMove());return}}this.standardMouseOver();this.isBeyondDragSize()&&this.standardWaitAfter(this.qa?this.kE:this.DH)}};
kf.prototype.doCurrentObjectChanged=function(a,b){var c=this.bl;null===c||null!==b&&(b===c||b.rl(c))||this.hideToolTip()};kf.prototype.doWaitAfter=function(){var a=this.g;null!==a&&a.ub&&(this.doMouseHover(),this.qa||this.doToolTip())};kf.prototype.doMouseHover=function(){var a=this.g;if(null!==a){var b=a.O;null===b.qe&&(b.qe=a.le(b.ea,null,null));var c=b.qe;if(null!==c)for(b.Nc=!1;null!==c;){a=this.qa?c.bA:c.cA;if(null!==a&&(a(b,c),b.Nc))break;c=c.T}else a=this.qa?a.bA:a.cA,null!==a&&a(b)}};
kf.prototype.doToolTip=function(){var a=this.g;if(null!==a){var b=a.O;null===b.qe&&(b.qe=a.le(b.ea,null,null));b=b.qe;if(null!==b){if(b!==this.bl&&!b.rl(this.bl)){for(;null!==b;){a=b.LA;if(null!==a){this.showToolTip(a,b);return}b=b.T}this.hideToolTip()}}else a=a.LA,null!==a?this.showToolTip(a,null):this.hideToolTip()}};
kf.prototype.showToolTip=function(a,b){v.C(a,mf,kf,"showToolTip:tooltip");null!==b&&v.C(b,R,kf,"showToolTip:obj");var c=this.g;if(null!==c){a!==this.bl&&this.hideToolTip();a.tf="Tool";a.zl=!1;a.scale=1/c.scale;c.add(a);if(null!==b&&b!==this.Gu){var c=null,d=b.So();null!==d&&(c=d.data);a.ec=b;a.data=c}else null===b&&(a.data=c.da);if(null===b||b!==this.Gu)a.mf(),this.positionToolTip(a,b);this.ey=a;this.Gu=b;-1!==this.xm&&(v.clearTimeout(this.xm),this.xm=-1);c=this.jJ;if(0<c&&Infinity!==c){var e=this;
this.xm=v.setTimeout(function(){e.hideToolTip()},c)}}};kf.prototype.positionToolTip=function(a){if(null===a.placeholder){var b=this.g;if(null!==b){var c=b.O.ea.copy(),d=a.Ba,e=b.tb;b.O.Zj&&(c.x-=d.width);c.x+d.width>e.right&&(c.x-=d.width+5);c.x<e.x&&(c.x=e.x);c.y=c.y+20+d.height>e.bottom?c.y-(d.height+5):c.y+20;c.y<e.y&&(c.y=e.y);a.position=c}}};
kf.prototype.hideToolTip=function(){-1!==this.xm&&(v.clearTimeout(this.xm),this.xm=-1);if(null!==this.bl){var a=this.g;null!==a&&(this.bl.data=null,this.bl.ec=null,a.remove(this.bl),this.Gu=this.ey=null)}};v.u(kf,{bl:"currentToolTip"},function(){return this.ey});
kf.prototype.doMouseUp=function(){this.cancelWaitAfter();if(this.qa){var a=this.g;if(null===a)return;for(var b=this.Pf.length,c=0;c<b;c++){var d=this.Pf.ha(c);null===d.g&&d.Fc(this.g);if(d.canStart()){a.$a=d;a.$a===d&&(d.qa||d.doActivate(),d.doMouseUp());return}}}this.doDeactivate()};kf.prototype.doMouseWheel=function(){this.standardMouseWheel()};kf.prototype.doKeyDown=function(){var a=this.g;null!==a&&a.rb.doKeyDown()};kf.prototype.doKeyUp=function(){var a=this.g;null!==a&&a.rb.doKeyUp()};
kf.prototype.doCancel=function(){null!==Hf&&Hf.doCancel();Le.prototype.doCancel.call(this)};kf.prototype.findTool=function(a){v.j(a,"string",kf,"findTool:name");for(var b=this.df.length,c=0;c<b;c++){var d=this.df.ha(c);if(d.name===a)return d}b=this.Of.length;for(c=0;c<b;c++)if(d=this.Of.ha(c),d.name===a)return d;b=this.Pf.length;for(c=0;c<b;c++)if(d=this.Pf.ha(c),d.name===a)return d;return null};
kf.prototype.replaceTool=function(a,b){v.j(a,"string",kf,"replaceTool:name");null!==b&&(v.C(b,Le,kf,"replaceTool:newtool"),b.g&&b.g!==this.g&&v.k("Cannot share tools between Diagrams: "+b.toString()),b.Fc(this.g));for(var c=this.df.length,d=0;d<c;d++){var e=this.df.ha(d);if(e.name===a)return null!==b?this.df.zg(d,b):this.df.Rc(d),e}c=this.Of.length;for(d=0;d<c;d++)if(e=this.Of.ha(d),e.name===a)return null!==b?this.Of.zg(d,b):this.Of.Rc(d),e;c=this.Pf.length;for(d=0;d<c;d++)if(e=this.Pf.ha(d),e.name===
a)return null!==b?this.Pf.zg(d,b):this.Pf.Rc(d),e;return null};function ei(a,b,c,d){v.j(b,"string",kf,"replaceStandardTool:name");v.C(d,G,kf,"replaceStandardTool:list");null!==c&&(v.C(c,Le,kf,"replaceStandardTool:newtool"),c.g&&c.g!==a.g&&v.k("Cannot share tools between Diagrams: "+c.toString()),c.name=b,c.Fc(a.g));a.findTool(b)?a.replaceTool(b,c):null!==c&&d.add(c)}v.u(kf,{df:"mouseDownTools"},function(){return this.ZF});v.u(kf,{Of:"mouseMoveTools"},function(){return this.$F});
v.u(kf,{Pf:"mouseUpTools"},function(){return this.aG});v.defineProperty(kf,{DH:"hoverDelay"},function(){return this.QB},function(a){v.j(a,"number",kf,"hoverDelay");this.QB=a});v.defineProperty(kf,{kE:"holdDelay"},function(){return this.PB},function(a){v.j(a,"number",kf,"holdDelay");this.PB=a});v.defineProperty(kf,{eH:"dragSize"},function(){return this.EB},function(a){v.C(a,ia,kf,"dragSize");this.EB=a.aa()});
v.defineProperty(kf,{jJ:"toolTipDuration"},function(){return this.dD},function(a){v.j(a,"number",kf,"toolTipDuration");this.dD=a});v.defineProperty(kf,{oG:"actionTool"},function(){return this.findTool("Action")},function(a){ei(this,"Action",a,this.df)});v.defineProperty(kf,{QE:"relinkingTool"},function(){return this.findTool("Relinking")},function(a){ei(this,"Relinking",a,this.df)});
v.defineProperty(kf,{cI:"linkReshapingTool"},function(){return this.findTool("LinkReshaping")},function(a){ei(this,"LinkReshaping",a,this.df)});v.defineProperty(kf,{aF:"resizingTool"},function(){return this.findTool("Resizing")},function(a){ei(this,"Resizing",a,this.df)});v.defineProperty(kf,{MI:"rotatingTool"},function(){return this.findTool("Rotating")},function(a){ei(this,"Rotating",a,this.df)});
v.defineProperty(kf,{CE:"linkingTool"},function(){return this.findTool("Linking")},function(a){ei(this,"Linking",a,this.Of)});v.defineProperty(kf,{Xd:"draggingTool"},function(){return this.findTool("Dragging")},function(a){ei(this,"Dragging",a,this.Of)});v.defineProperty(kf,{dH:"dragSelectingTool"},function(){return this.findTool("DragSelecting")},function(a){ei(this,"DragSelecting",a,this.Of)});
v.defineProperty(kf,{vI:"panningTool"},function(){return this.findTool("Panning")},function(a){ei(this,"Panning",a,this.Of)});v.defineProperty(kf,{uz:"contextMenuTool"},function(){return this.findTool("ContextMenu")},function(a){ei(this,"ContextMenu",a,this.Pf)});v.defineProperty(kf,{IA:"textEditingTool"},function(){return this.findTool("TextEditing")},function(a){ei(this,"TextEditing",a,this.Pf)});
v.defineProperty(kf,{EG:"clickCreatingTool"},function(){return this.findTool("ClickCreating")},function(a){ei(this,"ClickCreating",a,this.Pf)});v.defineProperty(kf,{FG:"clickSelectingTool"},function(){return this.findTool("ClickSelecting")},function(a){ei(this,"ClickSelecting",a,this.Pf)});
function $e(){this.vB=fi;this.sq=this.tq=this.W=null;this.Hn=this.In=0;this.tu=this.sc=this.Xn=this.oj=!1;this.pj=this.Pe=!0;this.Fu=this.Eu=this.sB=null;this.rB=0;this.uo=null;this.ru=new H("string");this.ny=600;this.dG=new w(0,0);this.gB=this.fB=this.hD=!1;this.jo=new ma(R,gi)}v.ga("AnimationManager",$e);$e.prototype.Fc=function(a){this.W=a};function fi(a,b,c,d){a/=d/2;return 1>a?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b}function hi(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b}
function ii(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b}v.defineProperty($e,{GA:"starting"},function(){return this.uo},function(a){this.uo!==a&&(null!==a&&v.j(a,"function",$e,"starting"),this.uo=a)});v.u($e,{NJ:"animationReasons"},function(){return this.ru});$e.prototype.prepareAutomaticAnimation=$e.prototype.an=function(a){if(this.Pe&&(this.pj||this.W.ve)){this.ru.add(a);var b=this.GA;if(null===b||b(this,a))this.oj&&this.Xi(),this.sc=!0,this.tu=!1}};
function ji(a){a.Pe&&(a.ru.clear(),a.sc&&requestAnimationFrame(function(){!1===a.sc||a.oj||(a.W.Ij=1,ki(a.W),a.sc=!1,a.W.ya("AnimationStarting"),li(a))}))}
function mi(a,b,c,d,e,f){if(a.sc&&(!(b instanceof J)||b.oE)){void 0===f&&(f=!1);var h=a.jo;if(h.contains(b)){a=h.la(b);var k=a.start,l=a.end;void 0===k[c]&&(k[c]=ni(d));a.zz&&void 0!==l[c]?a.hH[c]=ni(e):l[c]=ni(e)}else k=new pa,l=new pa,k[c]=ni(d),l[c]=ni(e),c=l,d=k.position,d instanceof w&&!d.H()&&a.ru.contains("Expand SubGraph")&&d.assign(c.position),h.add(b,new gi(k,l,f))}}function ni(a){return a instanceof w?a.copy():a instanceof ia?a.copy():a}
function li(a){var b;void 0===b&&(b=new pa);var c=a.W;if(null!==c){a.oj=!0;var d=b.jK||a.vB,e=b.QK||null,f=b.RK||null,h=b.duration||a.ny;b=a.dG;for(var k=a.jo.i;k.next();){var l=k.value.start.position;l instanceof w&&(l.H()||l.assign(b))}a.sB=d;a.Eu=e;a.Fu=f;a.rB=h;var m=a.ay=a.jo;oi(a);pi(a,c,m,d,0,h);Cg(a.W);qi(a);requestAnimationFrame(function(b){var e=b||+new Date,f=e+h;(function s(b){if(!1!==a.oj){b=b||+new Date;var k=b>f?h:b-e;oi(a);pi(a,c,m,d,k,h);a.Eu&&a.Eu();Cg(c);qi(a);b>f?ri(a):requestAnimationFrame(s)}})(e)})}}
var si={opacity:function(a,b,c,d,e,f){a.opacity=d(e,b,c-b,f)},position:function(a,b,c,d,e,f){e!==f?a.DA(d(e,b.x,c.x-b.x,f),d(e,b.y,c.y-b.y,f)):a.position=new w(d(e,b.x,c.x-b.x,f),d(e,b.y,c.y-b.y,f))},"position:node":function(a,b,c,d,e,f){var h=a.Z,k=c.Z;c=k.x+k.width/2-h.width/2;h=k.y+k.height/2-h.height/2;e!==f?a.DA(d(e,b.x,c-b.x,f),d(e,b.y,h-b.y,f)):a.position=new w(d(e,b.x,c-b.x,f),d(e,b.y,h-b.y,f))},scale:function(a,b,c,d,e,f){a.scale=d(e,b,c-b,f)},visible:function(a,b,c,d,e,f){a.visible=e!==
f?b:c}};function oi(a){if(!a.Xn){var b=a.W;a.hD=b.lb;a.fB=b.yx;a.gB=b.Wt;b.lb=!0;b.yx=!0;b.Wt=!0;a.Xn=!0}}function qi(a){var b=a.W;b.lb=a.hD;b.yx=a.fB;b.Wt=a.gB;a.Xn=!1}
function pi(a,b,c,d,e,f){for(c=c.i;c.next();){var h=c.key,k=c.value,l=k.start,k=k.end,m;for(m in k)if(void 0!==si[m])si[m](h,l[m],k[m],d,e,f)}d=b.Qz;b.Qz=!0;0!==a.In&&0!==a.Hn&&(m=a.In,c=a.Hn,h=hi,m>c&&(h=ii),b.Tb=h(e,m,c-m,f));null!==a.tq&&null!==a.sq&&(m=a.tq,c=a.sq,h=a.vB,a.In>a.Hn&&(h=hi),b.Xa=new w(h(e,m.x,c.x-m.x,f),h(e,m.y,c.y-m.y,f)));b.Qz=d}$e.prototype.stopAnimation=$e.prototype.Xi=function(){!0===this.sc&&(this.sc=!1,this.tu&&this.W.de());this.oj&&this.Pe&&ri(this)};
function ri(a){a.oj=!1;a.tq=null;a.sq=null;a.In=0;a.Hn=0;oi(a);for(var b=a.W,c=a.sB,d=a.rB,e=a.ay.i;e.next();){var f=e.key,h=e.value,k=h.start,l=h.end,m;for(m in l)if(void 0!==si[m]){var n=m;h.zz&&"position:node"===n&&(n="position");si[n](f,k[m],h.zz?k[m]:l[m],c,d,d)}h.kx&&f.oe(!1)}for(c=a.W.links;c.next();)d=c.value,null!==d.oo&&(d.points=d.oo,d.oo=null);b.Zw.clear();b.Ij=null;b.oc();b.Nf();ti(b);qi(a);a.jo=new ma(R,gi);a.Fu&&a.Fu();a.Fu=null;a.Eu=null;b.ya("AnimationFinished");b.de()}
function ui(a,b,c){var d=b.Z,e=c.Z,f=null;c instanceof T&&(f=c.placeholder);null!==f?(c=f.fb(zb),c.x+=f.padding.left,c.y+=f.padding.top,mi(a,b,"position",c,b.position,!1)):mi(a,b,"position",new w(e.x+e.width/2-d.width/2,e.y+e.height/2-d.height/2),b.position,!1);mi(a,b,"scale",.01,b.scale,!1)}
function vi(a,b,c){var d=null;c instanceof T&&(d=c.placeholder);null!==d?(c=d.fb(zb),c.x+=d.padding.left,c.y+=d.padding.top,mi(a,b,"position",b.position,c,!0)):mi(a,b,"position:node",b.position,c,!0);mi(a,b,"scale",b.scale,.01,!0);a.sc&&(a=a.jo,a.contains(b)&&(a.la(b).kx=!0))}function wi(a,b,c){a.sc&&(null===a.tq&&b.H()&&null===a.sq&&(a.tq=b.copy()),a.sq=c.copy(),a.tu=!0)}function xi(a,b,c){a.sc&&a.W.ve&&(0===a.In&&0===a.Hn&&(a.In=b),a.Hn=c,a.tu=!0)}
v.defineProperty($e,{isEnabled:"isEnabled"},function(){return this.Pe},function(a){v.j(a,"boolean",$e,"isEnabled");this.Pe=a});v.defineProperty($e,{duration:"duration"},function(){return this.ny},function(a){v.j(a,"number",$e,"duration");1>a&&v.ua(a,">= 1",$e,"duration");this.ny=a});v.u($e,{pf:"isAnimating"},function(){return this.oj});v.u($e,{uK:"isTicking"},function(){return this.Xn});
v.defineProperty($e,{vE:"isInitial"},function(){return this.pj},function(a){v.j(a,"boolean",$e,"isInitial");this.pj=a;a||(this.Wl=!0)});function gi(a,b,c){this.start=a;this.end=b;this.hH=new pa;this.zz=c;this.kx=!1}function ze(){0<arguments.length&&v.dd(ze);v.cc(this);this.W=null;this.zb=new G(J);this.Ob="";this.Kc=1;this.Fy=!1;this.Qk=this.hz=this.pk=this.ok=this.nk=this.mk=this.kk=this.lk=this.jk=this.rk=this.ik=this.qk=this.hk=this.gk=!0;this.Ay=!1;this.xv=[]}v.ga("Layer",ze);
ze.prototype.Fc=function(a){this.W=a};
ze.prototype.toString=function(a){void 0===a&&(a=0);var b='Layer "'+this.name+'"';if(0>=a)return b;for(var c=0,d=0,e=0,f=0,h=0,k=this.zb.i;k.next();){var l=k.value;l instanceof T?e++:l instanceof S?d++:l instanceof W?f++:l instanceof mf?h++:c++}k="";0<c&&(k+=c+" Parts ");0<d&&(k+=d+" Nodes ");0<e&&(k+=e+" Groups ");0<f&&(k+=f+" Links ");0<h&&(k+=h+" Adornments ");if(1<a)for(a=this.zb.i;a.next();)c=a.value,k+="\n    "+c.toString(),d=c.data,null!==d&&v.cd(d)&&(k+=" #"+v.cd(d)),c instanceof S?k+=" "+
ce(d):c instanceof W&&(k+=" "+ce(c.U)+" "+ce(c.ba));return b+" "+this.zb.count+": "+k};ze.prototype.findObjectAt=ze.prototype.le=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=null);if(!1===this.Qk)return null;var d=!1;this.g.tb.Ca(a)&&(d=!0);for(var e=v.M(),f=this.zb.n,h=f.length;h--;){var k=f[h];if((!0!==d||!1!==yi(k))&&k.isVisible()&&(e.assign(a),Xa(e,k.Ef),k=k.le(e,b,c),null!==k&&(null!==b&&(k=b(k)),null!==k&&(null===c||c(k)))))return v.v(e),k}v.v(e);return null};
ze.prototype.findObjectsAt=ze.prototype.Ys=function(a,b,c,d){void 0===b&&(b=null);void 0===c&&(c=null);d instanceof G||d instanceof H||(d=new H(R));if(!1===this.Qk)return d;var e=!1;this.g.tb.Ca(a)&&(e=!0);for(var f=v.M(),h=this.zb.n,k=h.length;k--;){var l=h[k];!0===e&&!1===yi(l)||!l.isVisible()||(f.assign(a),Xa(f,l.Ef),l.Ys(f,b,c,d)&&(null!==b&&(l=b(l)),null===l||null!==c&&!c(l)||d.add(l)))}v.v(f);return d};
ze.prototype.findObjectsIn=ze.prototype.Vj=function(a,b,c,d,e){void 0===b&&(b=null);void 0===c&&(c=null);void 0===d&&(d=!1);e instanceof G||e instanceof H||(e=new H(R));if(!1===this.Qk)return e;var f=!1;this.g.tb.Sj(a)&&(f=!0);for(var h=this.zb.n,k=h.length;k--;){var l=h[k];(!0!==f||!1!==yi(l))&&l.isVisible()&&l.Vj(a,b,c,d,e)&&(null!==b&&(l=b(l)),null===l||null!==c&&!c(l)||e.add(l))}return e};
ze.prototype.Fz=function(a,b,c,d,e,f,h){if(!1===this.Qk)return e;for(var k=this.zb.n,l=k.length;l--;){var m=k[l];(!0!==h||!1!==yi(m))&&f(m)&&m.isVisible()&&m.Vj(a,b,c,d,e)&&(null!==b&&(m=b(m)),null===m||null!==c&&!c(m)||e.add(m))}return e};
ze.prototype.findObjectsNear=ze.prototype.Om=function(a,b,c,d,e,f){void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=!0);if(!1!==e&&!0!==e){if(e instanceof G||e instanceof H)f=e;e=!0}f instanceof G||f instanceof H||(f=new H(R));if(!1===this.Qk)return f;var h=!1;this.g.tb.Ca(a)&&(h=!0);for(var k=v.M(),l=v.M(),m=this.zb.n,n=m.length;n--;){var p=m[n];!0===h&&!1===yi(p)||!p.isVisible()||(k.assign(a),Xa(k,p.Ef),l.m(a.x+b,a.y),Xa(l,p.Ef),p.Om(k,l,c,d,e,f)&&(null!==c&&(p=c(p)),null===p||null!==d&&
!d(p)||f.add(p)))}v.v(k);v.v(l);return f};g=ze.prototype;g.uf=function(a,b){if(this.visible){var c;c=void 0===b?a.tb:b;for(var d=this.zb.n,e=d.length,f=0;f<e;f++){var h=d[f];h.hC=f;if(!(h instanceof W&&!1===h.Df)){if(h instanceof mf){var k=h;if(null!==k.Sh)continue}if(qb(h.Z,c))for(h.uf(!0),zi(h),h=h.iw;h.next();)k=h.value,Rh(k,Infinity,Infinity),k.zc(),k.uf(!0);else h.uf(!1),null!==h.iw&&0<h.iw.count&&zi(h)}}}};
g.Ve=function(a,b,c,d){if(this.visible&&0!==this.Kc&&(void 0===d&&(d=!0),d||!this.Bc)){1!==this.Kc&&(a.globalAlpha=this.Kc);c=this.xv;c.length=0;d=b.scale;for(var e=this.zb.n,f=e.length,h=0;h<f;h++){var k=e[h];if(yi(k)||Ai(k)){if(k instanceof W){var l=k;l.hc&&c.push(l);if(!1===l.Df)continue}l=k.Z;1<l.width*d||1<l.height*d?k.Ve(a,b):Bi(k,a)}}a.globalAlpha=1}};
function Ci(a,b,c,d){if(a.visible&&0!==a.Kc){1!==a.Kc&&(b.globalAlpha=a.Kc);var e=a.xv;e.length=0;var f=c.scale;a=a.zb.n;for(var h=a.length,k=d.length,l=0;l<h;l++){var m=a[l];if(yi(m)||Ai(m)){if(m instanceof W){var n=m;n.hc&&e.push(n);if(!1===n.Df)continue}var n=Pi(m,m.Z),p;a:{p=n;for(var q=d,r=k,s=2/f,t=4/f,u=0;u<r;u++){var x=q[u];if(0!==x.width&&0!==x.height&&p.mE(x.x-s,x.y-s,x.width+t,x.height+t)){p=!0;break a}}p=!1}p&&(1<n.width*f||1<n.height*f?m.Ve(b,c):Bi(m,b))}}b.globalAlpha=1}}
g.h=function(a,b,c,d,e){var f=this.g;null!==f&&f.Ec(Od,a,this,b,c,d,e)};g.Zo=function(a,b,c){var d=this.zb;b.hv=this;if(a>=d.count)a=d.count;else if(d.ha(a)===b)return-1;d.xd(a,b);b.it(c);d=this.g;null!==d&&(c?d.pa():d.Zo(b));Qi(this,a,b);return a};
g.Ke=function(a,b,c){if(!c&&b.layer!==this&&null!==b.layer)return b.layer.Ke(a,b,c);var d=this.zb;if(0>a||a>=d.length){if(a=d.indexOf(b),0>a)return-1}else if(d.ha(a)!==b&&(a=d.indexOf(b),0>a))return-1;b.jt(c);d.Rc(a);d=this.g;null!==d&&(c?d.pa():d.Ke(b));b.hv=null;return a};
function Qi(a,b,c){b=Ri(a,b,c);if(c instanceof T&&null!==c&&isNaN(c.Kp)){if(0!==c.Pc.count){for(var d=-1,e=a.zb.n,f=e.length,h=0;h<f;h++){var k=e[h];if(k===c&&(b=h,0<=d))break;if(0>d&&k.Sa===c&&(d=h,0<=b))break}!(0>d)&&d<b&&(e=a.zb,e.Rc(b),e.xd(d,c))}c=c.Sa;null!==c&&Qi(a,-1,c)}}
function Ri(a,b,c){var d=c.Kp;if(isNaN(d))return b;a=a.zb;var e=a.count;if(1>=e)return b;0>b&&(b=a.indexOf(c));if(0>b)return-1;for(var f=b-1,h=NaN;0<=f;){h=a.ha(f).Kp;if(!isNaN(h))break;f--}for(var k=b+1,l=NaN;k<e;){l=a.ha(k).Kp;if(!isNaN(l))break;k++}if(!isNaN(h)&&h>d)for(;;){if(-1===f||h<=d){f++;if(f===b)break;a.Rc(b);a.xd(f,c);return f}for(h=NaN;0<=--f&&(h=a.ha(f).Kp,isNaN(h)););}else if(!isNaN(l)&&l<d)for(;;){if(k===e||l>=d){k--;if(k===b)break;a.Rc(b);a.xd(k,c);return k}for(l=NaN;++k<e&&(l=a.ha(k).Kp,
isNaN(l)););}return b}g.clear=function(){for(var a=this.zb.ed(),b=a.length,c=0;c<b;c++)a[c].uf(!1),this.Ke(-1,a[c],!1)};v.u(ze,{bk:"parts"},function(){return this.zb.i});v.u(ze,{$K:"partsBackwards"},function(){return this.zb.Wm});v.u(ze,{g:"diagram"},function(){return this.W});
v.defineProperty(ze,{name:"name"},function(){return this.Ob},function(a){v.j(a,"string",ze,"name");var b=this.Ob;if(b!==a){var c=this.g;if(null!==c)for(""===b&&v.k("Cannot rename default Layer to: "+a),c=c.Ww;c.next();)c.value.name===a&&v.k("Layer.name is already present in this diagram: "+a);this.Ob=a;this.h("name",b,a);for(a=this.zb.i;a.next();)a.value.tf=this.Ob}});
v.defineProperty(ze,{opacity:"opacity"},function(){return this.Kc},function(a){var b=this.Kc;b!==a&&(v.j(a,"number",ze,"opacity"),(0>a||1<a)&&v.ua(a,"0 <= value <= 1",ze,"opacity"),this.Kc=a,this.h("opacity",b,a),a=this.g,null!==a&&a.pa())});v.defineProperty(ze,{Bc:"isTemporary"},function(){return this.Fy},function(a){var b=this.Fy;b!==a&&(v.j(a,"boolean",ze,"isTemporary"),this.Fy=a,this.h("isTemporary",b,a))});
v.defineProperty(ze,{visible:"visible"},function(){return this.hz},function(a){var b=this.hz;if(b!==a){v.j(a,"boolean",ze,"visible");this.hz=a;this.h("visible",b,a);for(b=this.zb.i;b.next();)b.value.oe(a);a=this.g;null!==a&&a.pa()}});v.defineProperty(ze,{yg:"pickable"},function(){return this.Qk},function(a){var b=this.Qk;b!==a&&(v.j(a,"boolean",ze,"pickable"),this.Qk=a,this.h("pickable",b,a))});
v.defineProperty(ze,{pE:"isBoundsIncluded"},function(){return this.Ay},function(a){this.Ay!==a&&(this.Ay=a,null!==this.g&&this.g.oc())});v.defineProperty(ze,{Qj:"allowCopy"},function(){return this.gk},function(a){var b=this.gk;b!==a&&(v.j(a,"boolean",ze,"allowCopy"),this.gk=a,this.h("allowCopy",b,a))});v.defineProperty(ze,{Am:"allowDelete"},function(){return this.hk},function(a){var b=this.hk;b!==a&&(v.j(a,"boolean",ze,"allowDelete"),this.hk=a,this.h("allowDelete",b,a))});
v.defineProperty(ze,{nw:"allowTextEdit"},function(){return this.qk},function(a){var b=this.qk;b!==a&&(v.j(a,"boolean",ze,"allowTextEdit"),this.qk=a,this.h("allowTextEdit",b,a))});v.defineProperty(ze,{kw:"allowGroup"},function(){return this.ik},function(a){var b=this.ik;b!==a&&(v.j(a,"boolean",ze,"allowGroup"),this.ik=a,this.h("allowGroup",b,a))});
v.defineProperty(ze,{ow:"allowUngroup"},function(){return this.rk},function(a){var b=this.rk;b!==a&&(v.j(a,"boolean",ze,"allowUngroup"),this.rk=a,this.h("allowUngroup",b,a))});v.defineProperty(ze,{Ks:"allowLink"},function(){return this.jk},function(a){var b=this.jk;b!==a&&(v.j(a,"boolean",ze,"allowLink"),this.jk=a,this.h("allowLink",b,a))});
v.defineProperty(ze,{Bm:"allowRelink"},function(){return this.lk},function(a){var b=this.lk;b!==a&&(v.j(a,"boolean",ze,"allowRelink"),this.lk=a,this.h("allowRelink",b,a))});v.defineProperty(ze,{Yk:"allowMove"},function(){return this.kk},function(a){var b=this.kk;b!==a&&(v.j(a,"boolean",ze,"allowMove"),this.kk=a,this.h("allowMove",b,a))});
v.defineProperty(ze,{lw:"allowReshape"},function(){return this.mk},function(a){var b=this.mk;b!==a&&(v.j(a,"boolean",ze,"allowReshape"),this.mk=a,this.h("allowReshape",b,a))});v.defineProperty(ze,{Ls:"allowResize"},function(){return this.nk},function(a){var b=this.nk;b!==a&&(v.j(a,"boolean",ze,"allowResize"),this.nk=a,this.h("allowResize",b,a))});
v.defineProperty(ze,{mw:"allowRotate"},function(){return this.ok},function(a){var b=this.ok;b!==a&&(v.j(a,"boolean",ze,"allowRotate"),this.ok=a,this.h("allowRotate",b,a))});v.defineProperty(ze,{lf:"allowSelect"},function(){return this.pk},function(a){var b=this.pk;b!==a&&(v.j(a,"boolean",ze,"allowSelect"),this.pk=a,this.h("allowSelect",b,a))});
function E(a){function b(){window.document.removeEventListener("DOMContentLoaded",b,!1);Si(c)}1<arguments.length&&v.k("Diagram constructor can only take one optional argument, the DIV HTML element or its id.");v.cc(this);Ti=[];this.Uc=!0;this.dB=new $e;this.dB.Fc(this);this.ud=17;var c=this;null!==window.document.body?Si(this):window.document.addEventListener("DOMContentLoaded",b,!1);this.cC=!1;this.Xb=new G(ze);this.Kb=this.Fb=0;this.Cj=this.Mb=this.Fg=this.ub=null;this.XE();this.Un=null;this.WE();
this.Xa=(new w(NaN,NaN)).freeze();this.Tb=1;this.Zu=(new w(NaN,NaN)).freeze();this.$u=NaN;this.pv=1E-4;this.mv=100;this.Td=new ja;this.gw=(new w(NaN,NaN)).freeze();this.Qu=(new z(NaN,NaN,NaN,NaN)).freeze();this.Iv=(new tb(0,0,0,0)).freeze();this.Jv=Ui;this.Fv=this.Bv=null;this.Jl=xf;this.tn=yc;this.Ck=xf;this.Rn=yc;this.av=this.Yu=zb;this.he=!0;this.Jq=!1;this.Zf=new H(R);this.Ql=new ma(W,z);this.Jn=!0;this.eB=250;this.pn=-1;this.vu=(new tb(16,16,16,16)).freeze();this.Ju=this.Cf=!1;this.Nn=!0;this.xk=
new Ld;this.Lc=new Ld;this.Nb=new Ld;this.Hh=this.dj=null;this.Wv=-1;this.Vv=!1;this.jy=this.ky=null;Vi(this);this.io=new H(S);this.Sk=new H(T);this.bo=new H(W);this.zb=new H(J);this.ev=!0;this.bw=Wi;this.TB=!1;this.dw=Gg;this.by=this.hy=this.ez=null;this.$x="";this.rq="auto";this.ji=this.Hi=this.wi=this.sv=this.xi=this.yi=this.zi=this.ii=this.ni=this.fi=null;this.Py=!1;this.CC={};this.Gr=0;this.Bf=[null,null];this.Vx=null;this.ln=this.iy=this.Yy=this.LC=this.Ei=!1;this.eC=!0;this.Cy=this.Fd=!1;this.Xy=
this.Wy=0;this.Rg="gray";this.Mh=0;this.Rd=null;var d=this;this.lC=function(a){if(a.da===d.da&&d.Qa){d.Qa=!1;try{var b=a.Ac;""===a.cf&&b===Od&&Xi(d,a.object,a.propertyName)}finally{d.Qa=!0}}};this.mC=function(a){Yi(d,a)};this.jD=!0;this.Hg=-2;this.ki=new ma(Object,J);this.vk=new ma(Object,W);this.Xl=new ma(Object,Array);this.ko=new ma("string",Array);this.BC=new G(Zi);this.qi=!1;this.hk=this.gk=this.ju=this.Pe=!0;this.lu=this.ku=!1;this.qu=this.ou=this.pk=this.ok=this.nk=this.mk=this.kk=this.lk=this.jk=
this.nu=this.rk=this.ik=this.qk=!0;this.Tl=this.aC=!1;this.pu=this.mu=this.Wu=this.Vu=!0;this.Lv=this.Hv=16;this.Vy=this.Gv=!1;this.Yr=this.Kv=null;this.IC=this.JC=0;this.Re=(new tb(5)).freeze();this.Ov=(new H(J)).freeze();this.nv=999999999;this.Xu=(new H(J)).freeze();this.Dk=this.Rl=this.nj=!0;this.Ak=this.mj=!1;this.Qd=null;this.su=!0;this.ve=!1;this.YF=new H(W);this.RB=new H($i);this.sd=null;this.sC=1;this.vy=!1;this.PC=0;this.iD=(new z(NaN,NaN,NaN,NaN)).freeze();this.Ku=(new z(NaN,NaN,NaN,NaN)).freeze();
this.yv=new H(aj);bj(this);this.jv=this.Su=this.tv=this.xB=this.wB=this.yB=this.tj=this.yk=this.Ai=null;cj(this);this.kd=null;this.Ru=!1;this.wn=null;this.wb=new kf;this.wb.initializeStandardTools();this.$a=this.Bz=this.wb;this.rb=new sa;this.da=new Q;this.Ei=!0;this.Pb=new Me;this.Ei=!1;this.JB=this.my=null;this.ze=1;this.Ij=null;this.Bk=new dj;void 0!==a&&ej(this,a);this.Zl=1;this.$l=0;this.gC=new w;this.fD=500;this.uu=new w;this.js=null;this.Uc=this.Gy=!1}v.ga("Diagram",E);
function cj(a){a.Ai=new ma("string",J);var b=new S,c=new ra;c.bind(new cf("text","",ce));b.add(c);a.yB=b;a.Ai.add("",b);b=new S;c=new ra;c.stroke="brown";c.bind(new cf("text","",ce));b.add(c);a.Ai.add("Comment",b);b=new S;b.zl=!1;b.zD=!1;c=new X;c.Cb="Ellipse";c.fill="black";c.stroke=null;c.xa=(new ia(3,3)).Ma();b.add(c);a.Ai.add("LinkLabel",b);a.yk=new ma("string",T);b=new T;b.yA="GROUPPANEL";b.type=fj;c=new ra;c.font="bold 12pt sans-serif";c.bind(new cf("text","",ce));b.add(c);c=new C(gj);c.name=
"GROUPPANEL";var d=new X;d.Cb="Rectangle";d.fill="rgba(128,128,128,0.2)";d.stroke="black";c.add(d);d=new sh;d.padding=(new tb(5,5,5,5)).Ma();c.add(d);b.add(c);a.wB=b;a.yk.add("",b);a.tj=new ma("string",W);b=new W;c=new X;c.Lf=!0;b.add(c);c=new X;c.Hp="Standard";c.fill="black";c.stroke=null;c.nb=0;b.add(c);a.xB=b;a.tj.add("",b);b=new W;c=new X;c.Lf=!0;c.stroke="brown";b.add(c);a.tj.add("Comment",b);b=new mf;b.type=gj;c=new X;c.fill=null;c.stroke="dodgerblue";c.nb=3;b.add(c);c=new sh;c.margin=(new tb(1.5,
1.5,1.5,1.5)).Ma();b.add(c);a.tv=b;a.Su=b;b=new mf;b.type=dh;c=new X;c.Lf=!0;c.fill=null;c.stroke="dodgerblue";c.nb=3;b.add(c);a.jv=b}
function Si(a){var b=v.createElement("p");b.style.width="100%";b.style.height="200px";b.style.boxSizing="content-box";var c=v.createElement("div");c.style.position="absolute";c.style.visibility="hidden";c.style.width="200px";c.style.height="150px";c.style.overflow="hidden";c.style.boxSizing="content-box";c.appendChild(b);window.document.body.appendChild(c);var d=b.offsetWidth;c.style.overflow="scroll";b=b.offsetWidth;d===b&&(b=c.clientWidth);window.document.body.removeChild(c);c=d-b;0!==c||v.tE||
(c=11);a.ud=c}E.prototype.toString=function(a){void 0===a&&(a=0);var b="";this.id&&(b=this.id);this.fl&&this.fl.id&&(b=this.fl.id);b='Diagram "'+b+'"';if(0>=a)return b;for(var c=this.Xb.i;c.next();)b+="\n  "+c.value.toString(a-1);return b};E.prototype.checkProperties=function(){return v.check(this)};E.fromDiv=function(a){var b=a;"string"===typeof a&&(b=window.document.getElementById(a));return b instanceof HTMLDivElement&&b.W instanceof E?b.W:null};
v.defineProperty(E,{fl:"div"},function(){return this.Mb},function(a){null!==a&&v.C(a,HTMLDivElement,E,"div");if(this.Mb!==a){Ti=[];var b=this.Mb;null!==b?(b.W=void 0,b.innerHTML="",null!==this.ub&&(this.ub.removeEventListener("touchstart",this.zF,!1),this.ub.removeEventListener("touchmove",this.yF,!1),this.ub.removeEventListener("touchend",this.xF,!1),this.ub.Kd.W=null),b=this.wb,null!==b&&(b.df.each(function(a){a.cancelWaitAfter()}),b.Of.each(function(a){a.cancelWaitAfter()}),b.Pf.each(function(a){a.cancelWaitAfter()})),
b.cancelWaitAfter(),this.$a.doCancel(),this.Fg=this.ub=null,window.removeEventListener("resize",this.IF,!1),window.removeEventListener("mousemove",this.kp,!0),window.removeEventListener("mousedown",this.jp,!0),window.removeEventListener("mouseup",this.mp,!0),window.removeEventListener("mousewheel",this.ah,!0),window.removeEventListener("DOMMouseScroll",this.ah,!0),window.removeEventListener("mouseout",this.lp,!0)):this.ve=!1;this.Mb=null;if(null!==a){if(b=a.W)b.fl=null;ej(this,a);this.rA()}}});
function hj(a){var b=a.ub;b.addEventListener("touchstart",a.zF,!1);b.addEventListener("touchmove",a.yF,!1);b.addEventListener("touchend",a.xF,!1);b.addEventListener("mousemove",a.kp,!1);b.addEventListener("mousedown",a.jp,!1);b.addEventListener("mouseup",a.mp,!1);b.addEventListener("mousewheel",a.ah,!1);b.addEventListener("DOMMouseScroll",a.ah,!1);b.addEventListener("mouseout",a.lp,!1);b.addEventListener("keydown",a.WH,!1);b.addEventListener("keyup",a.XH,!1);b.addEventListener("selectstart",function(a){a.preventDefault();
return!1},!1);b.addEventListener("contextmenu",function(a){a.preventDefault();return!1},!1);b.addEventListener("gesturechange",function(b){a.wb.Vo===ci&&b.preventDefault()},!1);b.addEventListener("pointerdown",a.wI,!1);b.addEventListener("pointermove",a.yI,!1);b.addEventListener("pointerleave",a.xI,!1);window.addEventListener("resize",a.IF,!1)}
E.prototype.computePixelRatio=function(){if(null!==this.Ij)return this.Ij;var a=this.Fg;return(window.devicePixelRatio||1)/(a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1)};E.prototype.doMouseMove=function(){this.$a.doMouseMove()};E.prototype.doMouseDown=function(){this.$a.doMouseDown()};E.prototype.doMouseUp=function(){this.$a.doMouseUp()};E.prototype.doMouseWheel=function(){this.$a.doMouseWheel()};
E.prototype.doKeyDown=function(){this.$a.doKeyDown()};E.prototype.doKeyUp=function(){this.$a.doKeyUp()};function ki(a){if(null!==a.ub){var b=a.Mb;if(0!==b.clientWidth&&0!==b.clientHeight){var c=a.Ak?a.ud:0,d=a.mj?a.ud:0,e=a.ze;a.ze=a.computePixelRatio();a.ze!==e&&(a.Jq=!0,a.de());if(b.clientWidth!==a.Fb+c||b.clientHeight!==a.Kb+d)a.Rl=!0,a.he=!0,b=a.Pb,null!==b&&b.Tw&&b.G(),a.Fd||a.de()}}}E.prototype.focus=E.prototype.focus=function(){this.ub&&this.ub.focus()};
function ij(a,b,c){void 0===b&&(b=a.Fg);void 0===c&&(c=!0);c&&(b.gu="");b.jn="";b.hn=""}function bj(a){var b=new ze;b.name="Background";a.Fs(b);b=new ze;b.name="";a.Fs(b);b=new ze;b.name="Foreground";a.Fs(b);b=new ze;b.name="Adornment";b.Bc=!0;a.Fs(b);b=new ze;b.name="Tool";b.Bc=!0;b.pE=!0;a.Fs(b);b=new ze;b.name="Grid";b.lf=!1;b.yg=!1;b.Bc=!0;a.sG(b,a.Ws("Background"))}
function jj(a){a.kd=new C(kj);a.kd.name="GRID";var b=new X;b.Cb="LineH";b.stroke="lightgray";b.nb=.5;b.interval=1;a.kd.add(b);b=new X;b.Cb="LineH";b.stroke="gray";b.nb=.5;b.interval=5;a.kd.add(b);b=new X;b.Cb="LineH";b.stroke="gray";b.nb=1;b.interval=10;a.kd.add(b);b=new X;b.Cb="LineV";b.stroke="lightgray";b.nb=.5;b.interval=1;a.kd.add(b);b=new X;b.Cb="LineV";b.stroke="gray";b.nb=.5;b.interval=5;a.kd.add(b);b=new X;b.Cb="LineV";b.stroke="gray";b.nb=1;b.interval=10;a.kd.add(b);b=new J;b.add(a.kd);
b.tf="Grid";b.Sz=!1;b.oE=!1;b.yg=!1;b.Yz="GRID";a.add(b);a.zb.remove(b);a.kd.visible=!1}
E.prototype.cG=function(){if(this.W.isEnabled){var a=this.W;if(a.Vy&&null!==a.ub){a.Gv=!0;var b=a.Wd,c=a.tb,d=b.width,e=c.width,f=b.height,h=c.height,k=b.right,l=c.right,m=b.bottom,n=c.bottom,p=b.x,q=c.x,b=b.y,c=c.y,r=a.scale,s;e<d||h<f?(s=v.Rb(a.position.x,a.position.y),a.Be&&a.IC!==this.scrollLeft&&(s.x=this.scrollLeft/r+p),a.Ce&&a.JC!==this.scrollTop&&(s.y=this.scrollTop/r+b),a.position=s,v.v(s),a.Gv=!1,a.Rl=!1):(s=v.M(),this.fG&&a.Be&&(p<q&&(a.position=s.m(this.scrollLeft+p,a.position.y)),k>l&&
(a.position=s.m(-(a.Kv.scrollWidth-a.Fb)+this.scrollLeft-a.Fb/r+a.Wd.right,a.position.y))),this.gG&&a.Ce&&(b<c&&(a.position=s.m(a.position.x,this.scrollTop+b)),m>n&&(a.position=s.m(a.position.x,-(a.Kv.scrollHeight-a.Kb)+this.scrollTop-a.Kb/r+a.Wd.bottom))),v.v(s),lj(a),a.Gv=!1,a.Rl=!1,b=a.Wd,c=a.tb,k=b.right,l=c.right,m=b.bottom,n=c.bottom,p=b.x,q=c.x,b=b.y,c=c.y,e>=d&&p>=q&&k<=l&&(a.Yr.style.width="1px"),h>=f&&b>=c&&m<=n&&(a.Yr.style.height="1px"))}}else mj(this.W)};
E.prototype.rC=function(a){this.W.isEnabled?(this.W.Vy=!0,this.W.JC=a.target.scrollTop,this.W.IC=a.target.scrollLeft):mj(this.W)};E.prototype.computeBounds=E.prototype.Ug=function(){0<this.Zf.count&&nj(this);return oj(this)};
function oj(a){if(a.bE.H()){var b=a.bE.copy();b.hw(a.padding);return b}for(var c=!0,d=a.Xb.n,e=d.length,f=0;f<e;f++){var h=d[f];if(h.visible&&(!h.Bc||h.pE))for(var h=h.zb.n,k=h.length,l=0;l<k;l++){var m=h[l];m.Sz&&m.isVisible()&&(m=m.Z,m.H()&&(c?(c=!1,b=m.copy()):b.bi(m)))}}c&&(b=new z(0,0,0,0));b.hw(a.padding);return b}
E.prototype.computePartsBounds=function(a){var b=null;for(a=a.i;a.next();){var c=a.value;c instanceof W||(c.mf(),null===b?b=c.Z.copy():b.bi(c.Z))}return null===b?new z(NaN,NaN,0,0):b};
function pj(a,b){if((b||a.ve)&&!a.Uc&&null!==a.ub&&!a.Oa.pf&&a.Wd.H()){a.Uc=!0;var c=a.Jl;b&&a.Ck!==xf&&(c=a.Ck);var d=c!==xf?qj(a,c):a.scale,c=a.tb.copy(),e=a.Fb/d,f=a.Kb/d,h=null,k=a.Oa;k.sc&&(h=a.Xa.copy());a.position.Na();var l=a.tn;b&&!l.yd()&&a.Rn.yd()&&(l=a.Rn);rj(a,a.Xa,a.Wd,e,f,l,b);a.position.freeze();null!==h&&wi(k,h,a.Xa);a.scale=d;a.Uc=!1;d=a.tb;d.Ie(c)||a.Ft(c,d)}}
function qj(a,b){var c=a.rb.xw;if(null===a.ub)return c;a.nj&&sj(a,a.Ug());var d=a.Wd;if(!d.H())return c;var e=d.width,d=d.height,f=a.Fb,h=a.Kb,k=f/e,l=h/d;return b===tj?(e=Math.min(l,k),e>c&&(e=c),e<a.$g&&(e=a.$g),e>a.Zg&&(e=a.Zg),e):b===uj?(e=l>k?(h-a.ud)/d:(f-a.ud)/e,e>c&&(e=c),e<a.$g&&(e=a.$g),e>a.Zg&&(e=a.Zg),e):a.scale}E.prototype.zoomToFit=E.prototype.zoomToFit=function(){this.scale=qj(this,tj)};
E.prototype.zoomToRect=function(a,b){void 0===b&&(b=tj);var c=a.width,d=a.height;if(!(0===c||0===d||isNaN(c)&&isNaN(d))){var e=1;if(b===tj||b===uj)if(isNaN(c))e=this.tb.height*this.scale/d;else if(isNaN(d))e=this.tb.width*this.scale/c;else var e=this.Fb,f=this.Kb,e=b===uj?f/d>e/c?(f-(this.mj?this.ud:0))/d:(e-(this.Ak?this.ud:0))/c:Math.min(f/d,e/c);this.scale=e;this.position=new w(a.x,a.y)}};v.defineProperty(E,{Qz:null},function(){return this.Uc},function(a){this.Uc=a});
E.prototype.alignDocument=function(a,b){this.nj&&sj(this,this.Ug());var c=this.Wd,d=this.tb;this.position=new w(c.x+(a.x*c.width+a.offsetX)-(b.x*d.width-b.offsetX),c.y+(a.y*c.height+a.offsetY)-(b.y*d.height-b.offsetY))};
function rj(a,b,c,d,e,f,h){var k=b.x,l=b.y;if(h||a.xA===Ui)f.yd()&&(d>c.width&&(k=c.x+(f.x*c.width+f.offsetX)-(f.x*d-f.offsetX)),e>c.height&&(l=c.y+(f.y*c.height+f.offsetY)-(f.y*e-f.offsetY))),f=a.dF,h=d-c.width,d<c.width+f.left+f.right?(k=Math.min(k+d/2,c.right+Math.max(h,f.right)-d/2),k=Math.max(k,c.left-Math.max(h,f.left)+d/2),k-=d/2):k>c.left?k=c.left:k<c.right-d&&(k=c.right-d),d=e-c.height,e<c.height+f.top+f.bottom?(l=Math.min(l+e/2,c.bottom+Math.max(d,f.bottom)-e/2),l=Math.max(l,c.top-Math.max(d,
f.top)+e/2),l-=e/2):l>c.top?l=c.top:l<c.bottom-e&&(l=c.bottom-e);b.x=isFinite(k)?k:-a.padding.left;b.y=isFinite(l)?l:-a.padding.top;null!==a.PE&&(a=a.PE(a,b),b.x=a.x,b.y=a.y)}E.prototype.findPartAt=E.prototype.Zs=function(a,b){var c=b?og(this,a,function(a){return a.V},function(a){return a.canSelect()}):og(this,a,function(a){return a.V});return c instanceof J?c:null};
E.prototype.findObjectAt=E.prototype.le=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=null);nj(this);for(var d=this.Xb.Wm;d.next();){var e=d.value;if(e.visible&&(e=e.le(a,b,c),null!==e))return e}return null};function og(a,b,c,d){void 0===c&&(c=null);void 0===d&&(d=null);nj(a);for(a=a.Xb.Wm;a.next();){var e=a.value;if(e.visible&&!e.Bc&&(e=e.le(b,c,d),null!==e))return e}return null}
E.prototype.findObjectsAt=E.prototype.Ys=function(a,b,c,d){void 0===b&&(b=null);void 0===c&&(c=null);d instanceof G||d instanceof H||(d=new H(R));nj(this);for(var e=this.Xb.Wm;e.next();){var f=e.value;f.visible&&f.Ys(a,b,c,d)}return d};E.prototype.findObjectsIn=E.prototype.Vj=function(a,b,c,d,e){void 0===b&&(b=null);void 0===c&&(c=null);void 0===d&&(d=!1);e instanceof G||e instanceof H||(e=new H(R));nj(this);for(var f=this.Xb.Wm;f.next();){var h=f.value;h.visible&&h.Vj(a,b,c,d,e)}return e};
E.prototype.Fz=function(a,b,c,d,e,f){var h=new H(R);nj(this);for(var k=this.Xb.Wm;k.next();){var l=k.value;l.visible&&l.Fz(a,b,c,d,h,e,f)}return h};E.prototype.findObjectsNear=E.prototype.Om=function(a,b,c,d,e,f){void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=!0);if(!1!==e&&!0!==e){if(e instanceof G||e instanceof H)f=e;e=!0}f instanceof G||f instanceof H||(f=new H(R));nj(this);for(var h=this.Xb.Wm;h.next();){var k=h.value;k.visible&&k.Om(a,b,c,d,e,f)}return f};
function Bf(a){-1!==a.Wv&&(v.clearTimeout(a.Wv),a.Wv=-1)}function vj(a,b){var c=b.copy();a.Wv=v.setTimeout(function(){c.button=2;c.buttons=2;a.O=c;a.Vv=!0;a.doMouseUp()},850)}E.prototype.acceptEvent=function(a){var b=this.Lc;this.Lc=this.Nb;this.Nb=b;wj(this,this,a,b,a instanceof MouseEvent);return b};
function wj(a,b,c,d,e){d.g=b;d.event=c;e?xj(a,c,d):(d.ef=b.Nb.ef,d.ea=b.Nb.ea);a=0;c.ctrlKey&&(a+=1);c.altKey&&(a+=2);c.shiftKey&&(a+=4);c.metaKey&&(a+=8);d.pd=a;d.button=c.button;void 0!==c.buttons&&(d.buttons=c.buttons);v.Vm&&0===c.button&&c.ctrlKey&&(d.button=2);d.gl=!1;d.up=!1;d.Ue=1;d.el=0;d.Nc=!1;d.bubbles=!1;d.timestamp=Date.now();d.ot=!1;d.Ag=c.target.W?c.target.W:null;d.qe=null}
function yj(a,b,c,d,e){d.g=a;xj(a,c,d);d.pd=0;d.button=0;d.buttons=1;d.gl=!0;d.up=!1;d.Ue=1;d.el=0;d.Nc=!1;d.bubbles=!0;d.event=b;d.timestamp=Date.now();d.ot=e;d.Ag=b.target.W?b.target.W:null;d.qe=null;a.xk=d.copy();Hf=null}
function zj(a,b,c,d,e){var f=null;d.g=a;null!==c?((f=window.document.elementFromPoint(c.clientX,c.clientY))&&f.W?f=f.W:(c=b.changedTouches[0],f=a),d.Ag=f,xj(a,c,d)):null!==a.Lc?(d.ea=a.Lc.ea,d.ef=a.Lc.ef,d.Ag=a.Lc.Ag):null!==a.xk&&(d.ea=a.xk.ea,d.ef=a.xk.ef,d.Ag=a.xk.Ag);d.pd=0;d.button=0;d.buttons=1;d.gl=!1;d.up=!1;d.Ue=1;d.el=0;d.Nc=!1;d.bubbles=!1;d.event=b;d.timestamp=Date.now();d.ot=e;d.qe=null}
function Aj(a,b){if(a.bubbles)return!0;void 0!==b.stopPropagation&&b.stopPropagation();(void 0===b.touches||2>b.touches.length)&&b.preventDefault();b.cancelBubble=!0;return!1}
E.prototype.WH=function(a){if(!this.W.isEnabled)return!1;var b=this.W.Nb;wj(this.W,this.W,a,b,!1);b.key=String.fromCharCode(a.which);b.gl=!0;switch(a.which){case 8:b.key="Backspace";break;case 33:b.key="PageUp";break;case 34:b.key="PageDown";break;case 35:b.key="End";break;case 36:b.key="Home";break;case 37:b.key="Left";break;case 38:b.key="Up";break;case 39:b.key="Right";break;case 40:b.key="Down";break;case 45:b.key="Insert";break;case 46:b.key="Del";break;case 48:b.key="0";break;case 187:case 61:case 107:b.key=
"Add";break;case 189:case 173:case 109:b.key="Subtract";break;case 27:b.key="Esc"}this.W.doKeyDown();return 187!==a.which&&189!==a.which&&48!==a.which&&107!==a.which&&109!==a.which&&61!==a.which&&173!==a.which||!0!==a.ctrlKey?Aj(b,a):(a.cancelBubble=!0,a.preventDefault(),a.stopPropagation(),!1)};
E.prototype.XH=function(a){if(!this.W.isEnabled)return!1;var b=this.W.Nb;wj(this.W,this.W,a,b,!1);b.key=String.fromCharCode(a.which);b.up=!0;switch(a.which){case 8:b.key="Backspace";break;case 33:b.key="PageUp";break;case 34:b.key="PageDown";break;case 35:b.key="End";break;case 36:b.key="Home";break;case 37:b.key="Left";break;case 38:b.key="Up";break;case 39:b.key="Right";break;case 40:b.key="Down";break;case 45:b.key="Insert";break;case 46:b.key="Del";break;case 93:a.preventDefault()}this.W.doKeyUp();
return Aj(b,a)};E.prototype.Eq=function(a){var b=this.ub;if(null===b)return new w(0,0);var c=this.Fb,d=this.Kb,b=b.getBoundingClientRect(),c=a.clientX-c/b.width*b.left;a=a.clientY-d/b.height*b.top;return null!==this.Td?(a=new w(c,a),Xa(a,this.Td),a):new w(c,a)};function xj(a,b,c){var d=a.ub,e=a.Fb,f=a.Kb,h=0,k=0;null!==d&&(d=d.getBoundingClientRect(),h=b.clientX-e/d.width*d.left,k=b.clientY-f/d.height*d.top);c.ef.m(h,k);null!==a.Td?(b=v.Rb(h,k),a.Td.Xh(b),c.ea.assign(b),v.v(b)):c.ea.m(h,k)}
E.prototype.invalidateDocumentBounds=E.prototype.oc=function(){this.nj||(this.nj=!0,this.de(!0))};function ti(a){a.Fd||nj(a);a.nj&&sj(a,a.Ug())}E.prototype.redraw=E.prototype.rA=function(){this.Uc||this.Fd||(this.pa(),Bj(this),lj(this),this.oc(),this.Nf())};E.prototype.isUpdateRequested=function(){return this.Cf};
E.prototype.delayInitialization=E.prototype.YG=function(a){void 0===a&&(a=null);var b=this.Oa,c=b.isEnabled;b.Xi();b.isEnabled=!1;Cg(this);this.ve=!1;b.isEnabled=c;null!==a&&v.setTimeout(a,1)};E.prototype.requestUpdate=E.prototype.de=function(a){void 0===a&&(a=!1);if(!0!==this.Cf&&!(this.Uc||!1===a&&this.Fd)){this.Cf=!0;var b=this;requestAnimationFrame(function(){b.Cf&&b.Nf()})}};E.prototype.maybeUpdate=E.prototype.Nf=function(){if(!this.Nn||this.Cf)this.Nn&&(this.Nn=!1),Cg(this)};
function Cj(a,b){a.Uc||!a.Rl||mj(a)||(b&&nj(a),pj(a,!1))}
function Cg(a){if(!a.Fd&&(a.Cf=!1,null!==a.Mb)){a.Fd=!0;var b=a.Oa,c=a.BC;if(!b.Xn&&0!==c.length){for(var d=c.n,e=d.length,f=0;f<e;f++){var h=d[f];Dj(h,!1);h.P()}c.clear()}c=a.RB;0<c.count&&(c.each(function(a){a.OA()}),c.clear());d=c=!1;b.pf&&(d=!0,c=a.lb,a.lb=!0);b.sc||ki(a);Cj(a,!1);null!==a.kd&&(a.kd.visible&&!a.Ru&&(Ej(a),a.Ru=!0),!a.kd.visible&&a.Ru&&(a.Ru=!1));nj(a);e=!1;if(!a.ve||a.su)a.ve?Fj(a,!a.Ju):(a.Qb("Initial Layout"),!1===b.isEnabled&&b.Xi(),Fj(a,!1)),e=!0;a.Ju=!1;nj(a);a.Yy||b.pf||
ti(a);Cj(a,!0);e&&(a.ve||(Gj(a),a.de(!0)),a.ya("LayoutCompleted"));nj(a);e&&!a.ve&&(a.ve=!0,a.wd("Initial Layout"),a.lb||a.ja.clear(),v.setTimeout(function(){a.Zh=!1},1));Hj(a);ji(b);a.Ve();d&&(a.lb=c);a.Fd=!1}}
function Gj(a){var b=a.Xb.n;a.uf(b,b.length,a);a.Ck!==xf?a.scale=qj(a,a.Ck):a.Jl!==xf?a.scale=qj(a,a.Jl):(b=a.HH,isFinite(b)&&0<b&&(a.scale=b));b=a.GH;if(b.H())a.position=b;else{b=v.M();b.St(a.Wd,a.FH);var c=a.tb,c=v.ek(0,0,c.width,c.height),d=v.M();d.St(c,a.IH);d.m(b.x-d.x,b.y-d.y);a.position=d;v.fc(c);v.v(d);v.v(b);Cj(a,!0);pj(a,!0)}a.ya("InitialLayoutCompleted");Ej(a)}
function nj(a){if((a.Fd||!a.Oa.pf)&&0!==a.Zf.count)for(var b=0;23>b;b++){var c=a.Zf.i;if(null===c||0===a.Zf.count)break;a.Zf=new H(R);a.OA(c,a.Zf)}}
E.prototype.OA=function(a,b){for(a.reset();a.next();){var c=a.value;!c.Ld()||c instanceof T||!c.isVisible()||(c.sl()?(Rh(c,Infinity,Infinity),c.zc()):b.add(c))}for(a.reset();a.next();)c=a.value,c instanceof T&&c.isVisible()&&Ij(this,c);for(a.reset();a.next();)c=a.value,c instanceof W&&c.isVisible()&&(c.sl()?(Rh(c,Infinity,Infinity),c.zc()):b.add(c));for(a.reset();a.next();)c=a.value,c instanceof mf&&c.isVisible()&&(c.sl()?(Rh(c,Infinity,Infinity),c.zc()):b.add(c))};
function Ij(a,b){for(var c=v.jb(),d=v.jb(),e=b.Pc;e.next();){var f=e.value;f.isVisible()&&(f instanceof T?(Jj(f)||Kj(f)||Lj(f))&&Ij(a,f):f instanceof W?f.U===b||f.ba===b?d.push(f):c.push(f):(Rh(f,Infinity,Infinity),f.zc()))}for(var e=c.length,h=0;h<e;h++)f=c[h],Rh(f,Infinity,Infinity),f.zc();v.ra(c);Rh(b,Infinity,Infinity);b.zc();e=d.length;for(h=0;h<e;h++)f=d[h],Rh(f,Infinity,Infinity),f.zc();v.ra(d)}E.prototype.uf=function(a,b,c,d){var e=this.Oa;if(this.Dk||e.pf)for(e=0;e<b;e++)a[e].uf(c,d)};
E.prototype.Ve=function(a,b){void 0===a&&(a=this.Fg);void 0===b&&(b=null);null===this.Mb&&v.k("No div specified");var c=this.ub;null===c&&v.k("No canvas specified");var d=this.Oa;if(!d.sc){Mj(this);var e=a!==this.Fg,f=this.Xb.n,h=f.length,k=this;this.uf(f,h,k);if(e)ij(this,a),lj(this);else if(!this.he&&null===b&&!d.oj)return;var d=this.Xa,l=this.Tb,m=Math.round(d.x*l)/l,n=Math.round(d.y*l)/l,h=this.Td;h.reset();1!==l&&h.scale(l);0===d.x&&0===d.y||h.translate(-m,-n);d=this.ze;v.Um?(c.width=c.width,
ij(this,a),a.scale(d,d)):(a.setTransform(1,0,0,1,0,0),a.scale(d,d),a.clearRect(0,0,this.Fb,this.Kb));a.miterLimit=9;a.setTransform(1,0,0,1,0,0);a.scale(d,d);a.transform(h.m11,h.m12,h.m21,h.m22,h.dx,h.dy);c=null!==b?function(c){var d=a,e=b;if(c.visible&&0!==c.Kc){1!==c.Kc&&(d.globalAlpha=c.Kc);var f=c.xv;f.length=0;var h=k.scale;c=c.zb.n;for(var l=c.length,m=0;m<l;m++){var n=c[m];if((yi(n)||Ai(n))&&!e.contains(n)){if(n instanceof W){var A=n;A.hc&&f.push(A);if(!1===A.Df)continue}A=n.Z;1<A.width*h||
1<A.height*h?n.Ve(d,k):Bi(n,d)}}d.globalAlpha=1}}:function(b){b.Ve(a,k)};Nj(this,a);h=f.length;for(d=0;d<h;d++)c(f[d]);this.Bk?this.Bk.Gl(this)&&this.Ox():this.Eq=function(){return new w(0,0)};e?(ij(this),lj(this)):this.he=this.Dk=!1}};
function Oj(a,b,c,d,e){null===a.Mb&&v.k("No div specified");var f=a.ub;null===f&&v.k("No canvas specified");if(!a.Oa.sc){var h=a.Fg;if(a.he){Mj(a);var k=a.ze;v.Um?(f.width=f.width,ij(a,h)):(h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,a.Fb*k,a.Kb*k));h.lE=!1;h.drawImage(a.my.Kd,0<d?0:Math.round(-d),0<e?0:Math.round(-e));e=a.Xa;var f=a.Tb,l=Math.round(e.x*f)/f,m=Math.round(e.y*f)/f;d=a.Td;d.reset();1!==f&&d.scale(f);0===e.x&&0===e.y||d.translate(-l,-m);h.save();h.beginPath();e=c.length;for(f=0;f<e;f++)l=
c[f],0!==l.width&&0!==l.height&&h.rect(Math.floor(l.x),Math.floor(l.y),Math.ceil(l.width),Math.ceil(l.height));h.clip();h.setTransform(1,0,0,1,0,0);h.scale(k,k);h.transform(d.m11,d.m12,d.m21,d.m22,d.dx,d.dy);c=a.Xb.n;e=c.length;a.uf(c,e,a);Nj(a,h);for(f=0;f<e;f++)Ci(c[f],h,a,b);h.restore();ij(a);a.Bk?a.Bk.Gl(a)&&a.Ox():a.Eq=function(){return new w(0,0)};a.Dk=!1;a.he=!1;a.sA()}}}
function Pj(a,b,c,d,e,f,h,k,l,m){null===a.Mb&&v.k("No div specified");null===a.ub&&v.k("No canvas specified");void 0===h&&(h=null);void 0===k&&(k=null);void 0===l&&(l=!1);void 0===m&&(m=!1);Mj(a);ij(a);lj(a);a.Cy=!0;var n=new z(f.x,f.y,d.width/e,d.height/e),p=n.copy();p.hw(c);Ej(a,p);nj(a);var p=a.Xb.n,q=p.length;a.uf(p,q,a,n);var r=a.ze;b.setTransform(1,0,0,1,0,0);b.scale(r,r);b.clearRect(0,0,d.width,d.height);null!==k&&""!==k&&(b.fillStyle=k,b.fillRect(0,0,d.width,d.height));d=v.nh();d.reset();
d.translate(c.left,c.top);d.scale(e);0===f.x&&0===f.y||d.translate(-f.x,-f.y);b.setTransform(d.m11,d.m12,d.m21,d.m22,d.dx,d.dy);v.Xe(d);Nj(a,b);if(null!==h){var s=new H(R);c=h.i;for(c.reset();c.next();)e=c.value,!1===m&&"Grid"===e.layer.name||null===e||s.add(e);c=function(c){var d=l;if(c.visible&&0!==c.Kc&&(void 0===d&&(d=!0),d||!c.Bc)){1!==c.Kc&&(b.globalAlpha=c.Kc);d=c.xv;d.length=0;var e=a.scale;c=c.zb.n;for(var f=c.length,h=0;h<f;h++){var k=c[h];if((yi(k)||Ai(k))&&s.contains(k)){if(k instanceof
W){var m=k;m.hc&&d.push(m);if(!1===m.Df)continue}m=k.Z;1<m.width*e||1<m.height*e?k.Ve(b,a):Bi(k,b)}}b.globalAlpha=1}}}else if(!l&&m){var t=a.ft.V,u=t.layer;c=function(c){c===u?t.Ve(b,a):c.Ve(b,a,n,l,m)}}else c=function(c){c.Ve(b,a,n,l,m)};for(e=0;e<q;e++)c(p[e]);a.Cy=!1;a.Bk?a.Bk.Gl(a)&&a.Ox():a.Eq=function(){return new w(0,0)};ij(a);lj(a);a.uf(p,q,a);Ej(a)}E.prototype.getRenderingHint=E.prototype.Yj=function(a){return this.Cj[a]};
E.prototype.setRenderingHint=E.prototype.VI=function(a,b){this.Cj[a]=b;this.rA()};E.prototype.resetRenderingHints=E.prototype.XE=function(){this.Cj=new pa;this.Cj.drawShadows=!0;this.Cj.textGreeking=!0;this.Cj.viewportOptimizations=v.tE?!1:!0;this.Cj.temporaryPixelRatio=!0;this.Cj.pictureRatioOptimization=!0};function Nj(a,b){var c=a.Cj;if(null!==c){if(void 0!==c.imageSmoothingEnabled){var d=!!c.imageSmoothingEnabled;b.lE=d;b.OK=d}c=c.defaultFont;void 0!==c&&null!==c&&(b.font=c,b.gu=c)}}
E.prototype.getInputOption=E.prototype.Wo=function(a){return this.Un[a]};E.prototype.setInputOption=function(a,b){this.Un[a]=b};E.prototype.resetInputOptions=E.prototype.WE=function(){this.Un=new pa;this.Un.extraTouchArea=10;this.Un.extraTouchThreshold=10;this.Un.hasGestureZoom=!0};E.prototype.setProperties=function(a){v.Rt(this,a)};function Hj(a){if(0===a.ja.ph&&0!==a.Ql.count){for(var b=a.Ql.i;b.next();){var c=b.key;hh(c,b.value);c.Ye()}a.Ql.clear();a.pa()}}
E.prototype.pa=function(a){void 0===a&&(a=null);if(null===a)this.he=!0,this.de();else{var b=this.tb;null!==a&&a.H()&&b.tg(a)&&(this.he=!0,this.de())}for(b=this.yv.i;b.next();)b.value.pa(a)};
E.prototype.nE=function(a,b){if(!0!==this.he){this.he=!0;var c=!0===this.Yj("temporaryPixelRatio");if(!0===this.Yj("viewportOptimizations")&&this.xA!==Qj&&this.dF.Bw(0,0,0,0)&&b.width===a.width&&b.height===a.height){var d=this.scale,e=v.Uf(),f=Math.max(a.x,b.x),h=Math.max(a.y,b.y),k=Math.min(a.x+a.width,b.x+b.width),l=Math.min(a.y+a.height,b.y+b.height);e.x=f;e.y=h;e.width=Math.max(0,k-f)*d;e.height=Math.max(0,l-h)*d;if(0<e.width&&0<e.height){if(!this.Fd&&(this.Cf=!1,null!==this.Mb)){this.Fd=!0;Hj(this);
this.Wd.H()||sj(this,this.Ug());var m=this.ub;if(null!==m){var n=this.ze,h=this.Fb*n,k=this.Kb*n,f=this.scale*n,d=Math.round(Math.round(b.x*f)-Math.round(a.x*f)),f=Math.round(Math.round(b.y*f)-Math.round(a.y*f)),l=this.my,p=this.JB;l.width!==h&&(l.width=h);l.height!==k&&(l.height=k);p.clearRect(0,0,h,k);var l=190*this.ze,q=70*this.ze,r=Math.max(d,0),s=Math.max(f,0),t=Math.floor(h-r),u=Math.floor(k-s);p.lE=!1;p.drawImage(m.Kd,r,s,t,u,0,0,t,u);this.Bk.Gl(this)&&p.clearRect(0,0,l,q);var m=v.jb(),p=v.jb(),
u=Math.abs(d),t=Math.abs(f),x=0===r?0:h-u,r=v.Rb(x,0),u=v.Rb(u+x,k);p.push(new z(Math.min(r.x,u.x),Math.min(r.y,u.y),Math.abs(r.x-u.x),Math.abs(r.y-u.y)));var y=this.Td;y.reset();y.scale(n,n);1!==this.Tb&&y.scale(this.Tb);n=this.Xa;(0!==n.x||0!==n.y)&&isFinite(n.x)&&isFinite(n.y)&&y.translate(-n.x,-n.y);Xa(r,y);Xa(u,y);m.push(new z(Math.min(r.x,u.x),Math.min(r.y,u.y),Math.abs(r.x-u.x),Math.abs(r.y-u.y)));x=0===s?0:k-t;r.m(0,x);u.m(h,t+x);p.push(new z(Math.min(r.x,u.x),Math.min(r.y,u.y),Math.abs(r.x-
u.x),Math.abs(r.y-u.y)));Xa(r,y);Xa(u,y);m.push(new z(Math.min(r.x,u.x),Math.min(r.y,u.y),Math.abs(r.x-u.x),Math.abs(r.y-u.y)));this.Bk.Gl(this)&&(h=0<d?0:-d,k=0<f?0:-f,r.m(h,k),u.m(l+h,q+k),p.push(new z(Math.min(r.x,u.x),Math.min(r.y,u.y),Math.abs(r.x-u.x),Math.abs(r.y-u.y))),Xa(r,y),Xa(u,y),m.push(new z(Math.min(r.x,u.x),Math.min(r.y,u.y),Math.abs(r.x-u.x),Math.abs(r.y-u.y))));v.v(r);v.v(u);Cj(this,!1);Oj(this,m,p,d,f);v.ra(m);v.ra(p);this.Fd=!1}}}else this.Nf();v.fc(e);c&&(this.Ij=1,this.Nf(),
this.Ij=null,this.sA())}else c?(this.Ij=1,this.Nf(),this.Ij=null,this.sA()):this.Nf()}};function Bj(a){!1===a.Rl&&(a.Rl=!0)}function lj(a){!1===a.Dk&&(a.Dk=!0)}function Mj(a){!1!==a.Jq&&(a.Jq=!1,Rj(a,a.Fb,a.Kb))}function Rj(a,b,c){var d=a.ub,e=a.ze,f=b*e,e=c*e;if(d.width!==f||d.height!==e)d.width=f,d.height=e,d.style.width=b+"px",d.style.height=c+"px",a.he=!0,ij(a)}function Af(a){var b=a.Fb,c=a.Kb;a=a.ub.getBoundingClientRect();return v.Rb(b/a.width*a.left,c/a.height*a.top)}
function mj(a){var b=a.ub;if(null===b)return!0;var c=a.Mb,d=a.Fb,e=a.Kb,f=a.iD.copy();if(!f.H())return!0;var h=!1,k=a.Ak?a.ud:0,l=a.mj?a.ud:0,m=c.clientWidth||d+k,c=c.clientHeight||e+l;if(m!==d+k||c!==e+l)a.Ak=!1,a.mj=!1,l=k=0,a.Fb=m,a.Kb=c,h=a.Jq=!0;a.Rl=!1;if(a.Oa.pf)return h?(a.Oa.Xi(),a.YG(),!1):!0;var n=a.tb,p=a.Wd,m=p.width,c=p.height,q=n.width,r=n.height,s=p.x,t=n.x,u=p.right,x=n.right+k,y=p.y,A=n.y,p=p.bottom,n=n.bottom+l,B="1px",I="1px",D=a.scale;a.xA===Ui&&m<q+k&&c<r+l||(a.Mz&&a.Be&&(B=
1,s+1<t&&(B=Math.max((t-s)*D+a.Fb,B)),u>x+1&&(B=Math.max((u-x)*D+a.Fb,B)),q+k+1<m&&(B=Math.max((m-q+k)*D+a.Fb,B)),B+="px"),a.Nz&&a.Ce&&(I=1,y+1<A&&(I=Math.max((A-y)*D+a.Kb,I)),p>n+1&&(I=Math.max((p-n)*D+a.Kb,I)),r+l+1<c&&(I=Math.max((c-r+l)*D+a.Kb,I)),I+="px"));k="1px"!==B;l="1px"!==I;if((!k||!l)&&k||l)l&&(x-=a.ud),k&&(n-=a.ud),a.Mz&&a.Be&&(B=1,s+1<t&&(B=Math.max((t-s)*D+a.Fb,B)),u>x+1&&(B=Math.max((u-x)*D+a.Fb,B)),q+1<m&&(B=Math.max((m-q)*D+a.Fb,B)),B+="px"),k="1px"!==B,l=k!==a.mj?a.Kb-a.ud:a.Kb,
a.Nz&&a.Ce&&(I=1,y+1<A&&(I=Math.max((A-y)*D+l,I)),p>n+1&&(I=Math.max((p-n)*D+l,I)),r+1<c&&(I=Math.max((c-r)*D+l,I)),I+="px"),l="1px"!==I;if(a.Gv&&k===a.mj&&l===a.Ak)return d===a.Fb&&e===a.Kb||a.Nf(),!1;k!==a.mj&&(a.Kb="1px"===B?a.Kb+a.ud:Math.max(a.Kb-a.ud,1),h=!0);a.mj=k;a.Yr.style.width=B;l!==a.Ak&&(a.Fb="1px"===I?a.Fb+a.ud:Math.max(a.Fb-a.ud,1),h=!0,a.cC&&(k=v.M(),l?(b.style.left=a.ud+"px",a.position=k.m(a.Xa.x+a.ud/a.scale,a.Xa.y)):(b.style.left="0px",a.position=k.m(a.Xa.x-a.ud/a.scale,a.Xa.y)),
v.v(k)));a.Ak=l;a.Yr.style.height=I;b=a.Kv;a.Mz&&a.Be&&(q+1<m?b.scrollLeft=(a.position.x-s)*D:s+1<t?b.scrollLeft=b.scrollWidth-b.clientWidth:u>x+1&&(b.scrollLeft=a.position.x*D));a.Nz&&a.Ce&&(r+1<c?b.scrollTop=(a.position.y-y)*D:y+1<A?b.scrollTop=b.scrollHeight-b.clientHeight:p>n+1&&(b.scrollTop=a.position.y*D));h&&(a.Jq=!0);m=a.Fb;c=a.Kb;b.style.width=m+(a.Ak?a.ud:0)+"px";b.style.height=c+(a.mj?a.ud:0)+"px";a.Vy=!1;return d!==m||e!==c||a.Oa.sc?(n=a.tb,a.Ft(f,n,h),!1):!0}
E.prototype.add=E.prototype.add=function(a){v.C(a,J,E,"add:part");var b=a.g;if(b!==this){null!==b&&v.k("Cannot add part "+a.toString()+" to "+this.toString()+". It is already a part of "+b.toString());this.ln&&(a.Gk="Tool");var c=a.tf,b=this.Ws(c);null===b&&(b=this.Ws(""));null===b&&v.k('Cannot add a Part when unable find a Layer named "'+c+'" and there is no default Layer');a.layer!==b&&(c=b.Zo(99999999,a,a.g===this),0<=c&&this.Ec(Qd,"parts",b,null,a,null,c),b.Bc||this.oc(),a.G(Sj),c=a.qt,null!==
c&&c(a,null,b))}};
E.prototype.Zo=function(a){if(a instanceof S){if(this.io.add(a),a instanceof T){var b=a.Sa;null===b?this.Sk.add(a):b.eo.add(a);b=a.Pb;null!==b&&(b.g=this)}}else a instanceof W?this.bo.add(a):a instanceof mf||this.zb.add(a);var c=this;Tj(a,function(a){Uj(c,a)});a.Hb&&a.P();b=a.data;null!==b&&(a instanceof mf||(a instanceof W?this.vk.add(b,a):this.ki.add(b,a)),Tj(a,function(a){Vj(c,a)}));!0!==Kj(a)&&!0!==Lj(a)||this.Zf.add(a);Wj(a,!0,this);Xj(a)?(a.Z.H()&&this.pa(Pi(a,a.Z)),this.oc()):a.isVisible()&&
a.Z.H()&&this.pa(Pi(a,a.Z));this.de()};
E.prototype.Ke=function(a){a.Os();if(a instanceof S){if(this.io.remove(a),a instanceof T){var b=a.Sa;null===b?this.Sk.remove(a):b.eo.remove(a);b=a.Pb;null!==b&&(b.g=null)}}else a instanceof W?this.bo.remove(a):a instanceof mf||this.zb.remove(a);var c=this;Tj(a,function(a){Yj(c,a)});b=a.data;null!==b&&(a instanceof mf||(a instanceof W?this.vk.remove(b):this.ki.remove(b)),Tj(a,function(a){Zj(c,a)}));this.Zf.remove(a);Xj(a)?(a.Z.H()&&this.pa(Pi(a,a.Z)),this.oc()):a.isVisible()&&a.Z.H()&&this.pa(Pi(a,
a.Z));this.de()};E.prototype.remove=E.prototype.remove=function(a){v.C(a,J,E,"remove:part");a.hb=!1;a.Yg=!1;var b=a.layer;if(null!==b&&b.g===this){a.G(ak);a.Nm();var c=b.Ke(-1,a,!1);0<=c&&this.Ec(be,"parts",b,a,null,c,null);c=a.qt;null!==c&&c(a,b,null)}};E.prototype.removeParts=E.prototype.uA=function(a,b){if(v.isArray(a))for(var c=v.Va(a),d=0;d<c;d++){var e=v.Pa(a,d);b&&!e.canDelete()||this.remove(e)}else for(e=new H(J),e.Yc(a),c=e.i;c.next();)e=c.value,b&&!e.canDelete()||this.remove(e)};
E.prototype.copyParts=E.prototype.Lo=function(a,b,c){return this.rb.Lo(a,b,c)};E.prototype.moveParts=E.prototype.moveParts=function(a,b,c){v.C(b,w,E,"moveParts:offset");var d=this.wb;if(null!==d){d=d.Xd;null===d&&(d=new wf,d.Fc(this));var e=new ma(J,Object);if(null!==a)a=a.i;else{for(a=this.bk;a.next();)Kf(d,e,a.value,c);for(a=this.wg;a.next();)Kf(d,e,a.value,c);a=this.links}for(;a.next();)Kf(d,e,a.value,c);d.moveParts(e,b,c)}};
function bk(a,b,c){v.C(b,ze,E,"addLayer:layer");null!==b.g&&b.g!==a&&v.k("Cannot share a Layer with another Diagram: "+b+" of "+b.g);null===c?null!==b.g&&v.k("Cannot add an existing Layer to this Diagram again: "+b):(v.C(c,ze,E,"addLayer:existingLayer"),c.g!==a&&v.k("Existing Layer must be in this Diagram: "+c+" not in "+c.g),b===c&&v.k("Cannot move a Layer before or after itself: "+b));if(b.g!==a){b=b.name;a=a.Xb;c=a.count;for(var d=0;d<c;d++)a.ha(d).name===b&&v.k("Cannot add Layer with the name '"+
b+"'; a Layer with the same name is already present in this Diagram.")}}E.prototype.addLayer=E.prototype.Fs=function(a){bk(this,a,null);a.Fc(this);var b=this.Xb,c=b.count-1;if(!a.Bc)for(;0<=c&&b.ha(c).Bc;)c--;b.xd(c+1,a);null!==this.Rd&&this.Ec(Qd,"layers",this,null,a,null,c+1);this.pa();this.oc()};
E.prototype.addLayerBefore=E.prototype.sG=function(a,b){bk(this,a,b);a.Fc(this);var c=this.Xb,d=c.indexOf(a);0<=d&&(c.remove(a),null!==this.Rd&&this.Ec(be,"layers",this,a,null,d,null));for(var e=c.count,f=0;f<e;f++)if(c.ha(f)===b){c.xd(f,a);break}null!==this.Rd&&this.Ec(Qd,"layers",this,null,a,null,f);this.pa();0>d&&this.oc()};
E.prototype.addLayerAfter=function(a,b){bk(this,a,b);a.Fc(this);var c=this.Xb,d=c.indexOf(a);0<=d&&(c.remove(a),null!==this.Rd&&this.Ec(be,"layers",this,a,null,d,null));for(var e=c.count,f=0;f<e;f++)if(c.ha(f)===b){c.xd(f+1,a);break}null!==this.Rd&&this.Ec(Qd,"layers",this,null,a,null,f+1);this.pa();0>d&&this.oc()};
E.prototype.removeLayer=function(a){v.C(a,ze,E,"removeLayer:layer");a.g!==this&&v.k("Cannot remove a Layer from another Diagram: "+a+" of "+a.g);if(""!==a.name){var b=this.Xb,c=b.indexOf(a);if(b.remove(a)){for(b=a.zb.copy().i;b.next();){var d=b.value,e=d.tf;d.tf=e!==a.name?e:""}null!==this.Rd&&this.Ec(be,"layers",this,a,null,c,null);this.pa();this.oc()}}};E.prototype.findLayer=E.prototype.Ws=function(a){for(var b=this.Ww;b.next();){var c=b.value;if(c.name===a)return c}return null};
E.prototype.addModelChangedListener=E.prototype.uG=function(a){v.j(a,"function",E,"addModelChangedListener:listener");null===this.Hh&&(this.Hh=new G("function"));this.Hh.add(a);this.da.zm(a)};E.prototype.removeModelChangedListener=function(a){v.j(a,"function",E,"removeModelChangedListener:listener");null!==this.Hh&&(this.Hh.remove(a),0===this.Hh.count&&(this.Hh=null));this.da.It(a)};
E.prototype.addChangedListener=E.prototype.zm=function(a){v.j(a,"function",E,"addChangedListener:listener");null===this.dj&&(this.dj=new G("function"));this.dj.add(a)};E.prototype.removeChangedListener=E.prototype.It=function(a){v.j(a,"function",E,"removeChangedListener:listener");null!==this.dj&&(this.dj.remove(a),0===this.dj.count&&(this.dj=null))};
E.prototype.sw=function(a){this.lb||this.ja.jE(a);a.Ac!==Pd&&(this.Zh=!0);if(null!==this.dj){var b=this.dj,c=b.length;if(1===c)b=b.ha(0),b(a);else if(0!==c)for(var d=b.ed(),e=0;e<c;e++)b=d[e],b(a)}};E.prototype.raiseChangedEvent=E.prototype.Ec=function(a,b,c,d,e,f,h){void 0===f&&(f=null);void 0===h&&(h=null);var k=new Nd;k.g=this;k.Ac=a;k.propertyName=b;k.object=c;k.oldValue=d;k.xg=f;k.newValue=e;k.vg=h;this.sw(k)};
E.prototype.raiseChanged=E.prototype.h=function(a,b,c,d,e){this.Ec(Od,a,this,b,c,d,e)};v.u(E,{Oa:"animationManager"},function(){return this.dB});v.u(E,{ja:"undoManager"},function(){return this.Rd.ja});v.defineProperty(E,{lb:"skipsUndoManager"},function(){return this.Ei},function(a){v.j(a,"boolean",E,"skipsUndoManager");this.Ei=a;this.Rd.Ei=a});v.defineProperty(E,{Cz:"delaysLayout"},function(){return this.iy},function(a){this.iy=a});
E.prototype.Em=function(a,b){if(null!==a&&a.g===this){var c=a.Ac;if(c===Od){var d=a.object,c=a.propertyName,e=a.la(b);v.Ha(d,c,e);d instanceof R&&(d=d.V,null!==d&&d.Zd());this.Zh=!0}else if(c===Qd){e=a.object;c=a.vg;d=a.newValue;if(e instanceof C)if("number"===typeof c&&d instanceof R){var f=e;b?f.Ke(c):f.xd(c,d);d=e.V;null!==d&&d.Zd()}else"number"===typeof c&&d instanceof Ue&&(f=e,b?d.ae?f.VE(c):f.RE(c):(c=d.ae?f.bd(d.index):f.ad(d.index),c.Ss(d)));else e instanceof ze?(f=!0===a.xg,"number"===typeof c&&
d instanceof J&&(b?(d.Zd(),e.Ke(f?c:-1,d,f)):e.Zo(c,d,f))):e instanceof E?"number"===typeof c&&d instanceof ze&&(e=d,b?this.Xb.Rc(c):(e.Fc(this),this.Xb.xd(c,e))):v.k("unknown ChangedEvent.Insert object: "+a.toString());this.Zh=!0}else c===be?(e=a.object,c=a.xg,d=a.oldValue,e instanceof C?"number"===typeof c&&d instanceof R?(f=e,b?f.xd(c,d):f.Ke(c)):"number"===typeof c&&d instanceof Ue&&(f=e,b?(c=d.ae?f.bd(d.index):f.ad(d.index),c.Ss(d)):d.ae?f.VE(c):f.RE(c)):e instanceof ze?(f=!0===a.vg,"number"===
typeof c&&d instanceof J&&(b?e.Zo(c,d,f):(d.Zd(),e.Ke(f?c:-1,d,f)))):e instanceof E?"number"===typeof c&&d instanceof ze&&(e=d,b?(e.Fc(this),this.Xb.xd(c,e)):this.Xb.Rc(c)):v.k("unknown ChangedEvent.Remove object: "+a.toString()),this.Zh=!0):c!==Pd&&v.k("unknown ChangedEvent: "+a.toString())}};E.prototype.startTransaction=E.prototype.Qb=function(a){return this.ja.Qb(a)};E.prototype.commitTransaction=E.prototype.wd=function(a){return this.ja.wd(a)};E.prototype.rollbackTransaction=E.prototype.wp=function(){return this.ja.wp()};
E.prototype.updateAllTargetBindings=E.prototype.nJ=function(a){void 0===a&&(a="");for(var b=this.bk;b.next();)b.value.Ib(a);for(b=this.wg;b.next();)b.value.Ib(a);for(b=this.links;b.next();)b.value.Ib(a)};E.prototype.updateAllRelationshipsFromData=function(){for(var a=this.bk;a.next();)a.value.updateRelationshipsFromData();for(a=this.wg;a.next();)a.value.updateRelationshipsFromData();for(a=this.links;a.next();)a.value.updateRelationshipsFromData()};
function ck(a,b,c){if(a.Uc||a.Fd)a.Tb=c,c=a.Oa,c.sc&&xi(c,b,a.Tb);else if(a.Uc=!0,null===a.ub)a.Tb=c;else{var d=a.tb.copy(),e=a.Fb,f=a.Kb;d.width=a.Fb/b;d.height=a.Kb/b;var h=a.Hl.x,k=a.Hl.y;if(isNaN(h))switch(a.rz){case Xb:h=0;break;case Yb:h=e-1;break;case Kb:h=e/2;break;case yc:case xc:h=e/2}if(isNaN(k))switch(a.rz){case Wb:k=0;break;case Zb:k=f-1;break;case Kb:k=f/2;break;case yc:case xc:k=f/2}null!==a.cF&&(c=a.cF(a,c));c<a.$g&&(c=a.$g);c>a.Zg&&(c=a.Zg);e=v.Rb(a.Xa.x+h/b-h/c,a.Xa.y+k/b-k/c);a.position=
e;v.v(e);a.Tb=c;a.Ft(d,a.tb);a.Uc=!1;pj(a,!1);c=a.Oa;c.sc&&xi(c,b,a.Tb);a.pa();Bj(a)}}E.prototype.Ft=function(a,b,c){void 0===c&&(c=!1);c||Bj(this);lj(this);var d=this.Pb;null===d||!d.Tw||c||a.width===b.width&&a.height===b.height||d.G();d=this.$a;!0===this.Tl&&d instanceof kf&&(this.O.ea=this.EF(this.O.ef),d.doMouseMove());this.nE(a,b);Ej(this);this.ya("ViewportBoundsChanged",c?v.qh:null,a)};
function Ej(a,b){void 0===b&&(b=null);var c=a.kd;if(null!==c&&c.visible){for(var d=v.El(),e=1,f=1,h=c.wa.n,k=h.length,l=0;l<k;l++){var m=h[l],n=m.interval;2>n||(ik(m.Cb)?f=f*n/K.eE(f,n):e=e*n/K.eE(e,n))}h=c.Jw;d.m(f*h.width,e*h.height);h=f=l=k=0;if(null!==b)k=b.width,l=b.height,f=b.x,h=b.y;else{e=v.Uf();f=a.tb;e.m(f.x,f.y,f.width,f.height);for(h=a.yv.i;h.next();)f=h.value.tb,f.H()&&rb(e,f.x,f.y,f.width,f.height);k=e.width;l=e.height;f=e.x;h=e.y;if(!e.H())return}c.width=k+2*d.width;c.height=l+2*d.height;
e=v.M();K.Xs(f,h,0,0,d.width,d.height,e);e.offset(-d.width,-d.height);v.Wj(d);c.V.location=e;v.v(e)}}E.prototype.clearSelection=E.prototype.uw=function(){var a=0<this.selection.count;a&&this.ya("ChangingSelection");pf(this);a&&this.ya("ChangedSelection")};function pf(a){a=a.selection;if(0<a.count){for(var b=a.ed(),c=b.length,d=0;d<c;d++)b[d].hb=!1;a.Na();a.clear();a.freeze()}}
E.prototype.select=E.prototype.select=function(a){null!==a&&(v.C(a,J,E,"select:part"),a.layer.g===this&&(!a.hb||1<this.selection.count)&&(this.ya("ChangingSelection"),pf(this),a.hb=!0,this.ya("ChangedSelection")))};
E.prototype.selectCollection=E.prototype.iF=function(a){this.ya("ChangingSelection");pf(this);if(v.isArray(a))for(var b=v.Va(a),c=0;c<b;c++){var d=v.Pa(a,c);d instanceof J||v.k("Diagram.selectCollection given something that is not a Part: "+d);d.hb=!0}else for(a=a.i;a.next();)d=a.value,d instanceof J||v.k("Diagram.selectCollection given something that is not a Part: "+d),d.hb=!0;this.ya("ChangedSelection")};
E.prototype.clearHighlighteds=E.prototype.CD=function(){var a=this.Kw;if(0<a.count){for(var b=a.ed(),c=b.length,d=0;d<c;d++)b[d].Yg=!1;a.Na();a.clear();a.freeze()}};E.prototype.highlight=function(a){null!==a&&a.layer.g===this&&(v.C(a,J,E,"highlight:part"),!a.Yg||1<this.Kw.count)&&(this.CD(),a.Yg=!0)};
E.prototype.highlightCollection=function(a){this.CD();if(v.isArray(a))for(var b=v.Va(a),c=0;c<b;c++){var d=v.Pa(a,c);d instanceof J||v.k("Diagram.highlightCollection given something that is not a Part: "+d);d.Yg=!0}else for(a=a.i;a.next();)d=a.value,d instanceof J||v.k("Diagram.highlightCollection given something that is not a Part: "+d),d.Yg=!0};
E.prototype.scroll=E.prototype.scroll=function(a,b,c){void 0===c&&(c=1);var d="up"===b||"down"===b,e=0;if("pixel"===a)e=c;else if("line"===a)e=c*(d?this.Ot:this.Nt);else if("page"===a)a=d?this.tb.height:this.tb.width,a*=this.scale,0!==a&&(e=Math.max(a-(d?this.Ot:this.Nt),0),e*=c);else{if("document"===a){e=this.Wd;d=this.tb;c=v.M();"up"===b?this.position=c.m(d.x,e.y):"left"===b?this.position=c.m(e.x,d.y):"down"===b?this.position=c.m(d.x,e.bottom-d.height):"right"===b&&(this.position=c.m(e.right-d.width,
d.y));v.v(c);return}v.k("scrolling unit must be 'pixel', 'line', 'page', or 'document', not: "+a)}e/=this.scale;c=this.position.copy();"up"===b?c.y=this.position.y-e:"down"===b?c.y=this.position.y+e:"left"===b?c.x=this.position.x-e:"right"===b?c.x=this.position.x+e:v.k("scrolling direction must be 'up', 'down', 'left', or 'right', not: "+b);this.position=c};E.prototype.scrollToRect=E.prototype.eF=function(a){var b=this.tb;b.Sj(a)||(a=a.Zk,a.x-=b.width/2,a.y-=b.height/2,this.position=a)};
E.prototype.centerRect=function(a){var b=this.tb;a=a.Zk;a.x-=b.width/2;a.y-=b.height/2;this.position=a};E.prototype.transformDocToView=E.prototype.CF=function(a){var b=this.Td;b.reset();1!==this.Tb&&b.scale(this.Tb);var c=this.Xa;(0!==c.x||0!==c.y)&&isFinite(c.x)&&isFinite(c.y)&&b.translate(-c.x,-c.y);return a.copy().transform(this.Td)};
E.prototype.transformViewToDoc=E.prototype.EF=function(a){var b=this.Td;b.reset();1!==this.Tb&&b.scale(this.Tb);var c=this.Xa;(0!==c.x||0!==c.y)&&isFinite(c.x)&&isFinite(c.y)&&b.translate(-c.x,-c.y);return Xa(a.copy(),this.Td)};var xf;E.None=xf=v.p(E,"None",0);var tj;E.Uniform=tj=v.p(E,"Uniform",1);var uj;E.UniformToFill=uj=v.p(E,"UniformToFill",2);var Gg;E.CycleAll=Gg=v.p(E,"CycleAll",10);var Kg;E.CycleNotDirected=Kg=v.p(E,"CycleNotDirected",11);var Mg;
E.CycleNotDirectedFast=Mg=v.p(E,"CycleNotDirectedFast",12);var Ng;E.CycleNotUndirected=Ng=v.p(E,"CycleNotUndirected",13);var Hg;E.CycleDestinationTree=Hg=v.p(E,"CycleDestinationTree",14);var Jg;E.CycleSourceTree=Jg=v.p(E,"CycleSourceTree",15);var Ui;E.DocumentScroll=Ui=v.p(E,"DocumentScroll",1);var Qj;E.InfiniteScroll=Qj=v.p(E,"InfiniteScroll",2);var Wi;E.TreeParentCollapsed=Wi=v.p(E,"TreeParentCollapsed",1);E.AllParentsCollapsed=v.p(E,"AllParentsCollapsed",2);
v.defineProperty(E,{oJ:"validCycle"},function(){return this.dw},function(a){var b=this.dw;b!==a&&(v.qb(a,E,E,"validCycle"),this.dw=a,this.h("validCycle",b,a))});v.u(E,{Ww:"layers"},function(){return this.Xb.i});v.defineProperty(E,{rf:"isModelReadOnly"},function(){var a=this.Rd;return null===a?!1:a.gb},function(a){var b=this.Rd;null!==b&&(b.gb=a)});
v.defineProperty(E,{gb:"isReadOnly"},function(){return this.qi},function(a){var b=this.qi;b!==a&&(v.j(a,"boolean",E,"isReadOnly"),this.qi=a,this.h("isReadOnly",b,a))});v.defineProperty(E,{isEnabled:"isEnabled"},function(){return this.Pe},function(a){var b=this.Pe;b!==a&&(v.j(a,"boolean",E,"isEnabled"),this.Pe=a,this.h("isEnabled",b,a))});
v.defineProperty(E,{kz:"allowClipboard"},function(){return this.ju},function(a){var b=this.ju;b!==a&&(v.j(a,"boolean",E,"allowClipboard"),this.ju=a,this.h("allowClipboard",b,a))});v.defineProperty(E,{Qj:"allowCopy"},function(){return this.gk},function(a){var b=this.gk;b!==a&&(v.j(a,"boolean",E,"allowCopy"),this.gk=a,this.h("allowCopy",b,a))});
v.defineProperty(E,{Am:"allowDelete"},function(){return this.hk},function(a){var b=this.hk;b!==a&&(v.j(a,"boolean",E,"allowDelete"),this.hk=a,this.h("allowDelete",b,a))});v.defineProperty(E,{jw:"allowDragOut"},function(){return this.ku},function(a){var b=this.ku;b!==a&&(v.j(a,"boolean",E,"allowDragOut"),this.ku=a,this.h("allowDragOut",b,a))});
v.defineProperty(E,{sD:"allowDrop"},function(){return this.lu},function(a){var b=this.lu;b!==a&&(v.j(a,"boolean",E,"allowDrop"),this.lu=a,this.h("allowDrop",b,a))});v.defineProperty(E,{nw:"allowTextEdit"},function(){return this.qk},function(a){var b=this.qk;b!==a&&(v.j(a,"boolean",E,"allowTextEdit"),this.qk=a,this.h("allowTextEdit",b,a))});
v.defineProperty(E,{kw:"allowGroup"},function(){return this.ik},function(a){var b=this.ik;b!==a&&(v.j(a,"boolean",E,"allowGroup"),this.ik=a,this.h("allowGroup",b,a))});v.defineProperty(E,{ow:"allowUngroup"},function(){return this.rk},function(a){var b=this.rk;b!==a&&(v.j(a,"boolean",E,"allowUngroup"),this.rk=a,this.h("allowUngroup",b,a))});
v.defineProperty(E,{Co:"allowInsert"},function(){return this.nu},function(a){var b=this.nu;b!==a&&(v.j(a,"boolean",E,"allowInsert"),this.nu=a,this.h("allowInsert",b,a))});v.defineProperty(E,{Ks:"allowLink"},function(){return this.jk},function(a){var b=this.jk;b!==a&&(v.j(a,"boolean",E,"allowLink"),this.jk=a,this.h("allowLink",b,a))});
v.defineProperty(E,{Bm:"allowRelink"},function(){return this.lk},function(a){var b=this.lk;b!==a&&(v.j(a,"boolean",E,"allowRelink"),this.lk=a,this.h("allowRelink",b,a))});v.defineProperty(E,{Yk:"allowMove"},function(){return this.kk},function(a){var b=this.kk;b!==a&&(v.j(a,"boolean",E,"allowMove"),this.kk=a,this.h("allowMove",b,a))});
v.defineProperty(E,{lw:"allowReshape"},function(){return this.mk},function(a){var b=this.mk;b!==a&&(v.j(a,"boolean",E,"allowReshape"),this.mk=a,this.h("allowReshape",b,a))});v.defineProperty(E,{Ls:"allowResize"},function(){return this.nk},function(a){var b=this.nk;b!==a&&(v.j(a,"boolean",E,"allowResize"),this.nk=a,this.h("allowResize",b,a))});
v.defineProperty(E,{mw:"allowRotate"},function(){return this.ok},function(a){var b=this.ok;b!==a&&(v.j(a,"boolean",E,"allowRotate"),this.ok=a,this.h("allowRotate",b,a))});v.defineProperty(E,{lf:"allowSelect"},function(){return this.pk},function(a){var b=this.pk;b!==a&&(v.j(a,"boolean",E,"allowSelect"),this.pk=a,this.h("allowSelect",b,a))});
v.defineProperty(E,{tD:"allowUndo"},function(){return this.ou},function(a){var b=this.ou;b!==a&&(v.j(a,"boolean",E,"allowUndo"),this.ou=a,this.h("allowUndo",b,a))});v.defineProperty(E,{pw:"allowZoom"},function(){return this.qu},function(a){var b=this.qu;b!==a&&(v.j(a,"boolean",E,"allowZoom"),this.qu=a,this.h("allowZoom",b,a))});
v.defineProperty(E,{Nz:"hasVerticalScrollbar"},function(){return this.Wu},function(a){var b=this.Wu;b!==a&&(v.j(a,"boolean",E,"hasVerticalScrollbar"),this.Wu=a,Bj(this),this.pa(),this.h("hasVerticalScrollbar",b,a),pj(this,!1))});v.defineProperty(E,{Mz:"hasHorizontalScrollbar"},function(){return this.Vu},function(a){var b=this.Vu;b!==a&&(v.j(a,"boolean",E,"hasHorizontalScrollbar"),this.Vu=a,Bj(this),this.pa(),this.h("hasHorizontalScrollbar",b,a),pj(this,!1))});
v.defineProperty(E,{Be:"allowHorizontalScroll"},function(){return this.mu},function(a){var b=this.mu;b!==a&&(v.j(a,"boolean",E,"allowHorizontalScroll"),this.mu=a,this.h("allowHorizontalScroll",b,a),pj(this,!1))});v.defineProperty(E,{Ce:"allowVerticalScroll"},function(){return this.pu},function(a){var b=this.pu;b!==a&&(v.j(a,"boolean",E,"allowVerticalScroll"),this.pu=a,this.h("allowVerticalScroll",b,a),pj(this,!1))});
v.defineProperty(E,{Nt:"scrollHorizontalLineChange"},function(){return this.Hv},function(a){var b=this.Hv;b!==a&&(v.j(a,"number",E,"scrollHorizontalLineChange"),0>a&&v.ua(a,">= 0",E,"scrollHorizontalLineChange"),this.Hv=a,this.h("scrollHorizontalLineChange",b,a))});
v.defineProperty(E,{Ot:"scrollVerticalLineChange"},function(){return this.Lv},function(a){var b=this.Lv;b!==a&&(v.j(a,"number",E,"scrollVerticalLineChange"),0>a&&v.ua(a,">= 0",E,"scrollVerticalLineChange"),this.Lv=a,this.h("scrollVerticalLineChange",b,a))});v.defineProperty(E,{O:"lastInput"},function(){return this.Nb},function(a){this.Nb=a});v.defineProperty(E,{uc:"firstInput"},function(){return this.xk},function(a){this.xk=a});
v.defineProperty(E,{Yb:"currentCursor"},function(){return this.$x},function(a){""===a&&(a=this.rq);this.$x!==a&&(v.j(a,"string",E,"currentCursor"),null!==this.ub&&(this.$x=a,this.ub.style.cursor=a,this.Mb.style.cursor=a))});v.defineProperty(E,{ZJ:"defaultCursor"},function(){return this.rq},function(a){""===a&&(a="auto");var b=this.rq;b!==a&&(v.j(a,"string",E,"defaultCursor"),this.rq=a,this.h("defaultCursor",b,a))});
v.defineProperty(E,{click:"click"},function(){return this.fi},function(a){var b=this.fi;b!==a&&(null!==a&&v.j(a,"function",E,"click"),this.fi=a,this.h("click",b,a))});v.defineProperty(E,{Ts:"doubleClick"},function(){return this.ni},function(a){var b=this.ni;b!==a&&(null!==a&&v.j(a,"function",E,"doubleClick"),this.ni=a,this.h("doubleClick",b,a))});
v.defineProperty(E,{sz:"contextClick"},function(){return this.ii},function(a){var b=this.ii;b!==a&&(null!==a&&v.j(a,"function",E,"contextClick"),this.ii=a,this.h("contextClick",b,a))});v.defineProperty(E,{dA:"mouseOver"},function(){return this.zi},function(a){var b=this.zi;b!==a&&(null!==a&&v.j(a,"function",E,"mouseOver"),this.zi=a,this.h("mouseOver",b,a))});
v.defineProperty(E,{cA:"mouseHover"},function(){return this.yi},function(a){var b=this.yi;b!==a&&(null!==a&&v.j(a,"function",E,"mouseHover"),this.yi=a,this.h("mouseHover",b,a))});v.defineProperty(E,{bA:"mouseHold"},function(){return this.xi},function(a){var b=this.xi;b!==a&&(null!==a&&v.j(a,"function",E,"mouseHold"),this.xi=a,this.h("mouseHold",b,a))});
v.defineProperty(E,{qI:"mouseDragOver"},function(){return this.sv},function(a){var b=this.sv;b!==a&&(null!==a&&v.j(a,"function",E,"mouseDragOver"),this.sv=a,this.h("mouseDragOver",b,a))});v.defineProperty(E,{aA:"mouseDrop"},function(){return this.wi},function(a){var b=this.wi;b!==a&&(null!==a&&v.j(a,"function",E,"mouseDrop"),this.wi=a,this.h("mouseDrop",b,a))});
v.defineProperty(E,{LA:"toolTip"},function(){return this.Hi},function(a){var b=this.Hi;b!==a&&(null!==a&&v.C(a,mf,E,"toolTip"),this.Hi=a,this.h("toolTip",b,a))});v.defineProperty(E,{contextMenu:"contextMenu"},function(){return this.ji},function(a){var b=this.ji;b!==a&&(null!==a&&v.C(a,mf,E,"contextMenu"),this.ji=a,this.h("contextMenu",b,a))});
v.defineProperty(E,{rb:"commandHandler"},function(){return this.Vx},function(a){var b=this.Vx;b!==a&&(v.C(a,sa,E,"commandHandler"),null!==a.g&&v.k("Cannot share CommandHandlers between Diagrams: "+a.toString()),null!==b&&b.Fc(null),this.Vx=a,a.Fc(this))});v.defineProperty(E,{wb:"toolManager"},function(){return this.ez},function(a){var b=this.ez;b!==a&&(v.C(a,kf,E,"toolManager"),null!==a.g&&v.k("Cannot share ToolManagers between Diagrams: "+a.toString()),null!==b&&b.Fc(null),this.ez=a,a.Fc(this))});
v.defineProperty(E,{Bz:"defaultTool"},function(){return this.hy},function(a){var b=this.hy;b!==a&&(v.C(a,Le,E,"defaultTool"),this.hy=a,this.$a===b&&(this.$a=a))});v.defineProperty(E,{$a:"currentTool"},function(){return this.by},function(a){var b=this.by;null!==b&&(b.qa&&b.doDeactivate(),b.cancelWaitAfter(),b.doStop());null===a&&(a=this.Bz);null!==a&&(v.C(a,Le,E,"currentTool"),this.by=a,a.Fc(this),a.doStart())});v.u(E,{selection:"selection"},function(){return this.Ov});
v.defineProperty(E,{iI:"maxSelectionCount"},function(){return this.nv},function(a){var b=this.nv;if(b!==a)if(v.j(a,"number",E,"maxSelectionCount"),0<=a&&!isNaN(a)){if(this.nv=a,this.h("maxSelectionCount",b,a),!this.ja.ib&&(a=this.selection.count-a,0<a)){this.ya("ChangingSelection");for(var b=this.selection.ed(),c=0;c<a;c++)b[c].hb=!1;this.ya("ChangedSelection")}}else v.ua(a,">= 0",E,"maxSelectionCount")});
v.defineProperty(E,{tI:"nodeSelectionAdornmentTemplate"},function(){return this.tv},function(a){var b=this.tv;b!==a&&(v.C(a,mf,E,"nodeSelectionAdornmentTemplate"),this.tv=a,this.h("nodeSelectionAdornmentTemplate",b,a))});v.defineProperty(E,{zH:"groupSelectionAdornmentTemplate"},function(){return this.Su},function(a){var b=this.Su;b!==a&&(v.C(a,mf,E,"groupSelectionAdornmentTemplate"),this.Su=a,this.h("groupSelectionAdornmentTemplate",b,a))});
v.defineProperty(E,{dI:"linkSelectionAdornmentTemplate"},function(){return this.jv},function(a){var b=this.jv;b!==a&&(v.C(a,mf,E,"linkSelectionAdornmentTemplate"),this.jv=a,this.h("linkSelectionAdornmentTemplate",b,a))});v.u(E,{Kw:"highlighteds"},function(){return this.Xu});
v.defineProperty(E,{Zh:"isModified"},function(){var a=this.ja;return a.isEnabled?null!==a.Pi?!0:this.Ey&&this.Hg!==a.Ti:this.Ey},function(a){if(this.Ey!==a){v.j(a,"boolean",E,"isModified");this.Ey=a;var b=this.ja;!a&&b.isEnabled&&(this.Hg=b.Ti);a||sk(this)}});function sk(a){var b=a.Zh;a.jD!==b&&(a.jD=b,a.ya("Modified"))}
v.defineProperty(E,{da:"model"},function(){return this.Rd},function(a){var b=this.Rd;if(b!==a){v.C(a,F,E,"model");this.$a.doCancel();null!==b&&b.ja!==a.ja&&b.ja.uE&&v.k("Do not replace a Diagram.model while a transaction is in progress.");this.Oa.Xi();this.uw();this.ve=!1;this.Nn=!0;this.Hg=-2;this.Cf=!1;var c=this.Fd;this.Fd=!0;this.Oa.an("Model");null!==b&&(null!==this.Hh&&this.Hh.each(function(a){b.It(a)}),b.It(this.mC),b instanceof Q&&tk(this,b.$h),tk(this,b.dh));this.Rd=a;a.zm(this.lC);uk(this,
a.dh);a instanceof Q&&vk(this,a.$h);a.It(this.lC);a.zm(this.mC);null!==this.Hh&&this.Hh.each(function(b){a.zm(b)});this.Fd=c;this.Uc||this.pa();null!==b&&(a.ja.isEnabled=b.ja.isEnabled)}});v.defineProperty(E,{Qa:null},function(){return this.eC},function(a){this.eC=a});v.u(E,{Zw:null},function(){return this.YF});
function Yi(a,b){if(b.da===a.da){var c=b.Ac,d=b.propertyName;if(c===Pd&&"S"===d[0])if("StartingFirstTransaction"===d)c=a.wb,c.df.each(function(b){b.Fc(a)}),c.Of.each(function(b){b.Fc(a)}),c.Pf.each(function(b){b.Fc(a)}),a.Fd||a.ve||(a.Ju=!0,a.Nn&&(a.Cf=!0));else if("StartingUndo"===d||"StartingRedo"===d){var e=a.Oa;e.pf&&!a.lb&&e.Xi();a.ya("ChangingSelection")}else"StartedTransaction"===d&&(e=a.Oa,e.pf&&!a.lb&&e.Xi());else if(a.Qa){a.Qa=!1;try{var f=b.cf;if(""!==f)if(c===Od){if("linkFromKey"===f){var h=
b.object,k=a.pg(h);if(null!==k){var l=b.newValue,m=a.We(l);k.U=m}}else if("linkToKey"===f)h=b.object,k=a.pg(h),null!==k&&(l=b.newValue,m=a.We(l),k.ba=m);else if("linkFromPortId"===f){if(h=b.object,k=a.pg(h),null!==k){var n=b.newValue;"string"===typeof n&&(k.rg=n)}}else if("linkToPortId"===f)h=b.object,k=a.pg(h),null!==k&&(n=b.newValue,"string"===typeof n&&(k.oh=n));else if("nodeGroupKey"===f){var h=b.object,p=a.Wh(h);if(null!==p){var q=b.newValue;if(void 0!==q){var r=a.We(q);p.Sa=r instanceof T?r:
null}else p.Sa=null}}else if("linkLabelKeys"===f){if(h=b.object,k=a.pg(h),null!==k){var s=b.oldValue,t=b.newValue;if(v.isArray(s))for(var u=v.Va(s),x=0;x<u;x++){var y=v.Pa(s,x),m=a.We(y);null!==m&&(m.ce=null)}if(v.isArray(t))for(u=v.Va(t),x=0;x<u;x++)y=v.Pa(t,x),m=a.We(y),null!==m&&(m.ce=k)}}else if("nodeParentKey"===f){var A=b.object,B=a.We(b.newValue),I=a.Gw(A);if(null!==I){var D=I.$s();null!==D?null===B?a.remove(D):a.Md?D.U=B:D.ba=B:wk(a,B,I)}}else if("parentLinkCategory"===f){var A=b.object,I=
a.Gw(A),V=b.newValue;null!==I&&"string"===typeof V&&(D=I.$s(),null!==D&&(D.Mc=V))}else if("nodeCategory"===f){var h=b.object,ba=a.Wh(h),V=b.newValue;null!==ba&&"string"===typeof V&&(ba.Mc=V)}else if("linkCategory"===f){var h=b.object,U=a.pg(h),V=b.newValue;null!==U&&"string"===typeof V&&(U.Mc=V)}else if("nodeDataArray"===f){var N=b.oldValue;tk(a,N);var Z=b.newValue;uk(a,Z)}else"linkDataArray"===f&&(N=b.oldValue,tk(a,N),Z=b.newValue,vk(a,Z));a.Zh=!0}else c===Qd?(Z=b.newValue,"nodeDataArray"===f&&v.Wa(Z)?
xk(a,Z):"linkDataArray"===f&&v.Wa(Z)?yk(a,Z):"linkLabelKeys"===f&&Pe(Z)&&(k=a.pg(b.object),m=a.We(Z),null!==k&&null!==m&&(m.ce=k)),a.Zh=!0):c===be?(N=b.oldValue,"nodeDataArray"===f&&v.Wa(N)?zk(a,N):"linkDataArray"===f&&v.Wa(N)?zk(a,N):"linkLabelKeys"===f&&Pe(N)&&(m=a.We(N),null!==m&&(m.ce=null)),a.Zh=!0):c===Pd&&("SourceChanged"===f?Xi(a,b.object,b.propertyName):"ModelDisplaced"===f&&a.xl());else if(c===Od){var Ga=b.propertyName,h=b.object;if(h===a.da){if("nodeKeyProperty"===Ga||"nodeCategoryProperty"===
Ga||"linkFromKeyProperty"===Ga||"linkToKeyProperty"===Ga||"linkFromPortIdProperty"===Ga||"linkToPortIdProperty"===Ga||"linkLabelKeysProperty"===Ga||"nodeIsGroupProperty"===Ga||"nodeGroupKeyProperty"===Ga||"nodeParentKeyProperty"===Ga||"linkCategoryProperty"===Ga)a.ja.ib||a.xl()}else Xi(a,h,Ga);a.Zh=!0}else if(c===Qd||c===be)Ak(a,b),a.Zh=!0;else if(c===Pd){if("FinishedUndo"===d||"FinishedRedo"===d)a.ja.ri=!0,a.ya("ChangedSelection"),nj(a),a.ja.ri=!1;a.Ju=!0;a.Nf();e=a.Oa;0===a.ja.ph&&ji(e);"CommittedTransaction"===
d&&a.ja.Hy&&(a.Hg=Math.min(a.Hg,a.ja.Ti-1));sk(a);var ta=b.xE;ta&&a.Zw.clear();!a.Py&&ta&&(a.Py=!0,v.setTimeout(function(){a.$a.standardMouseOver();a.Py=!1},10))}}finally{a.Qa=!0}}}}
function Xi(a,b,c){if("string"===typeof c){var d=a.Wh(b);if(null!==d)d.Ib(c),a.da instanceof te&&(d=a.pg(b),null!==d&&d.Ib(c));else{for(var d=null,e=a.Xl.i;e.next();){for(var f=e.value,h=0;h<f.length;h++){var k=f[h].jH(b);null!==k&&(null===d&&(d=v.jb()),d.push(k))}if(null!==d)break}if(null!==d){for(e=0;e<d.length;e++)d[e].Ib(c);v.ra(d)}}b===a.da.yt&&a.nJ(c)}}v.defineProperty(E,{yx:"skipsModelSourceBindings"},function(){return this.LC},function(a){this.LC=a});
v.defineProperty(E,{Wt:null},function(){return this.Yy},function(a){this.Yy=a});function Ak(a,b){var c=b.Ac===Qd,d=c?b.vg:b.xg,e=c?b.newValue:b.oldValue,f=a.Xl.la(b.object);if(Array.isArray(f))for(var h=0;h<f.length;h++){var k=f[h];if(c)Bk(k,e,d);else{var l=d;if(!(0>l)){var m=l;Ck(k)&&m++;k.Ke(m);Dk(k,m,l)}}}}function Vj(a,b){var c=b.si;if(v.isArray(c)){var d=a.Xl.la(c);if(null===d)d=[],d.push(b),a.Xl.add(c,d);else{for(c=0;c<d.length;c++)if(d[c]===b)return;d.push(b)}}}
function Zj(a,b){var c=b.si;if(v.isArray(c)){var d=a.Xl.la(c);if(null!==d)for(var e=0;e<d.length;e++)if(d[e]===b){d.splice(e,1);0===d.length&&a.Xl.remove(c);break}}}function Uj(a,b){for(var c=b.wa.n,d=c.length,e=0;e<d;e++){var f=c[e];f instanceof Zi&&Ek(a,f)}}function Ek(a,b){var c=b.element;if(null!==c&&c instanceof HTMLImageElement){var c=c.src,d=a.ko.la(c);if(null===d)d=[],d.push(b),a.ko.add(c,d);else{for(c=0;c<d.length;c++)if(d[c]===b)return;d.push(b)}}}
function Yj(a,b){for(var c=b.wa.n,d=c.length,e=0;e<d;e++){var f=c[e];f instanceof Zi&&Fk(a,f)}}function Fk(a,b){var c=b.element;if(null!==c&&c instanceof HTMLImageElement){var c=c.src,d=a.ko.la(c);if(null!==d)for(var e=0;e<d.length;e++)if(d[e]===b){d.splice(e,1);0===d.length&&a.ko.remove(c);break}}}
E.prototype.clear=E.prototype.clear=function(){var a=null;null!==this.kd&&(a=this.kd.V);this.da.clear();for(var b=this.Xb.length,c=0;c<b;c++)this.Xb.n[c].clear();this.Zf.clear();this.Ql.clear();this.io.clear();this.Sk.clear();this.bo.clear();this.zb.clear();this.ki.clear();this.vk.clear();this.Xl.clear();this.Ov.Na();this.Ov.clear();this.Ov.freeze();this.Xu.Na();this.Xu.clear();this.Xu.freeze();hf=this.wn=null;jf="";this.Ku=(new z(NaN,NaN,NaN,NaN)).freeze();null!==a&&(this.add(a),this.zb.remove(a));
this.pa()};
E.prototype.reset=E.prototype.reset=function(){this.Uc=!0;this.clear();this.Xb=new G(ze);this.XE();this.WE();this.Xa=(new w(NaN,NaN)).freeze();this.Tb=1;this.Zu=(new w(NaN,NaN)).freeze();this.$u=NaN;this.pv=1E-4;this.mv=100;this.gw=(new w(NaN,NaN)).freeze();this.Qu=(new z(NaN,NaN,NaN,NaN)).freeze();this.Iv=(new tb(0,0,0,0)).freeze();this.Jv=Ui;this.Fv=this.Bv=null;this.Jl=xf;this.tn=yc;this.Ck=xf;this.Rn=yc;this.av=this.Yu=zb;this.eB=250;this.vu=(new tb(16,16,16,16)).freeze();this.ev=!0;this.bw=Wi;
this.dw=Gg;this.rq="auto";this.ji=this.Hi=this.wi=this.sv=this.xi=this.yi=this.zi=this.ii=this.ni=this.fi=null;this.qi=!1;this.hk=this.gk=this.ju=this.Pe=!0;this.lu=this.ku=!1;this.pu=this.mu=this.Wu=this.Vu=this.qu=this.ou=this.pk=this.ok=this.nk=this.mk=this.kk=this.lk=this.jk=this.nu=this.rk=this.ik=this.qk=!0;this.Lv=this.Hv=16;this.Re=(new tb(5)).freeze();this.nv=999999999;this.Qd=null;cj(this);this.kd=null;this.Ei=!0;bj(this);this.Pb=new Me;this.Ei=!1;this.da=new Q;this.ve=!1;this.Nn=!0;this.Uc=
this.Cf=!1;this.pa()};
E.prototype.rebuildParts=E.prototype.xl=function(){for(var a=this.hA.i;a.next();){var b=a.value,c=a.key;(!b.Ld()||b instanceof T)&&v.k('Invalid node template in Diagram.nodeTemplateMap: template for "'+c+'" must be a Node or a simple Part, not a Group or Link: '+b)}for(a=this.Kz.i;a.next();)b=a.value,c=a.key,b instanceof T||v.k('Invalid group template in Diagram.groupTemplateMap: template for "'+c+'" must be a Group, not a normal Node or Link: '+b);for(a=this.Wz.i;a.next();)b=a.value,c=a.key,b instanceof
W||v.k('Invalid link template in Diagram.linkTemplateMap: template for "'+c+'" must be a Link, not a normal Node or simple Part: '+b);a=v.jb();for(b=this.selection.i;b.next();)(c=b.value.data)&&a.push(c);for(var b=v.jb(),d=this.Kw.i;d.next();)(c=d.value.data)&&b.push(c);c=v.jb();for(d=this.wg.i;d.next();){var e=d.value;null!==e.data&&(c.push(e.data),c.push(e.location))}for(d=this.links.i;d.next();)e=d.value,null!==e.data&&(c.push(e.data),c.push(e.location));for(d=this.bk.i;d.next();)e=d.value,null!==
e.data&&(c.push(e.data),c.push(e.location));d=this.da;d instanceof Q&&tk(this,d.$h);tk(this,d.dh);uk(this,d.dh);d instanceof Q&&vk(this,d.$h);for(d=0;d<a.length;d++)e=this.Wh(a[d]),null!==e&&(e.hb=!0);for(d=0;d<b.length;d++)e=this.Wh(b[d]),null!==e&&(e.Yg=!0);for(d=0;d<c.length;d+=2)e=this.Wh(c[d]),null!==e&&(e.location=c[d+1]);v.ra(a);v.ra(b);v.ra(c)};
function uk(a,b){if(null!==b){for(var c=a.da,d=v.Va(b),e=0;e<d;e++){var f=v.Pa(b,e);c.Fe(f)?xk(a,f,!1):c instanceof Q&&yk(a,f)}if(c instanceof Q||c instanceof te){for(e=0;e<d;e++)f=v.Pa(b,e),c.Fe(f)&&Gk(a,f);if(c instanceof Q)for(c=a.links;c.next();)Hk(c.value)}Ik(a,!1)}}function xk(a,b,c){if(void 0!==b&&null!==b&&!a.ja.ib&&!a.ki.contains(b)){void 0===c&&(c=!0);var d=a.Iz(b),e=Jk(a,b,d);null!==e&&(of(e),e=e.copy(),null!==e&&(e.ei=d,a.ln&&(e.Gk="Tool"),a.add(e),e.data=b,c&&Gk(a,b)))}}
E.prototype.Iz=function(a){return this.da.Iz(a)};var Kk=!1,Lk=!1;function Jk(a,b,c){var d=!1,e=a.da;e instanceof Q&&(d=e.Rz(b));d?(b=a.Kz.la(c),null===b&&(b=a.Kz.la(""),null===b&&(Lk||(Lk=!0,v.trace('No Group template found for category "'+c+'"'),v.trace("  Using default group template")),b=a.wB))):(b=a.hA.la(c),null===b&&(b=a.hA.la(""),null===b&&(Kk||(Kk=!0,v.trace('No Node template found for category "'+c+'"'),v.trace("  Using default node template")),b=a.yB)));return b}
function Gk(a,b){var c=a.da;if(c instanceof Q||c instanceof te){var d=c.mb(b);if(void 0!==d){var e=Qe(c,d),f=a.Wh(b);if(null!==e&&null!==f){for(e=e.i;e.next();){var h=e.value;if(c instanceof Q){var k=c;if(k.Fe(h)){if(f instanceof T&&k.Rm(h)===d){var l=f,h=a.Wh(h);null!==h&&(h.Sa=l)}}else{var m=a.pg(h);if(null!==m&&f instanceof S&&(l=f,k.kl(h)===d&&(m.U=l),k.nl(h)===d&&(m.ba=l),h=k.Xj(h),v.isArray(h)))for(k=0;k<v.Va(h);k++)if(v.Pa(h,k)===d){l.ce=m;break}}}else c instanceof te&&(m=c,m.Fe(h)&&f instanceof
S&&(l=f,m.Sm(h)===d&&(h=a.Gw(h),wk(a,l,h))))}Se(c,d)}c instanceof Q?(c=c.Rm(b),void 0!==c&&(c=a.We(c),c instanceof T&&(f.Sa=c))):c instanceof te&&(c=c.Sm(b),void 0!==c&&f instanceof S&&(l=f,f=a.We(c),wk(a,f,l)))}}}
function wk(a,b,c){if(null!==b&&null!==c){var d=a.wb.CE,e=b,f=c;if(a.Md)for(b=f.ne;b.next();){if(b.value.ba===f)return}else for(e=c,f=b,b=e.ne;b.next();)if(b.value.U===e)return;null!==d&&Ig(d,e,f,null,!0)||(d=a.Iw(c.data),b=Mk(a,d),null!==b&&(of(b),b=b.copy(),null!==b&&(b.ei=d,b.U=e,b.ba=f,a.add(b),b.data=c.data)))}}function vk(a,b){if(null!==b){for(var c=v.Va(b),d=0;d<c;d++){var e=v.Pa(b,d);yk(a,e)}Ik(a,!1)}}
function yk(a,b){if(void 0!==b&&null!==b&&!a.ja.ib&&!a.vk.contains(b)){var c=a.Iw(b),d=Mk(a,c);if(null!==d&&(of(d),d=d.copy(),null!==d)){d.ei=c;var c=a.da,e=c.sH(b);""!==e&&(d.rg=e);e=c.kl(b);void 0!==e&&(e=a.We(e),e instanceof S&&(d.U=e));e=c.vH(b);""!==e&&(d.oh=e);e=c.nl(b);void 0!==e&&(e=a.We(e),e instanceof S&&(d.ba=e));c=c.Xj(b);if(v.isArray(c))for(var e=v.Va(c),f=0;f<e;f++){var h=v.Pa(c,f),h=a.We(h);null!==h&&(h.ce=d)}a.add(d);d.data=b}}}
E.prototype.Iw=function(a){var b=this.da,c="";b instanceof Q?c=b.Iw(a):b instanceof te&&(c=b.uH(a));return c};var Nk=!1;function Mk(a,b){var c=a.Wz.la(b);null===c&&(c=a.Wz.la(""),null===c&&(Nk||(Nk=!0,v.trace('No Link template found for category "'+b+'"'),v.trace("  Using default link template")),c=a.xB));return c}function tk(a,b){for(var c=v.Va(b),d=0;d<c;d++){var e=v.Pa(b,d);zk(a,e)}}
function zk(a,b){if(void 0!==b&&null!==b){var c=a.Wh(b);if(null!==c){c.hb=!1;c.Yg=!1;var d=c.layer;if(null!==d&&d.g===a){var e=a.da;if(e instanceof Q&&c instanceof S){var f=c,h=e.mb(f.data);if(void 0!==h){for(var k=f.ne;k.next();)Re(e,h,k.value.data);f.qf&&(k=f.ce,null!==k&&Re(e,h,k.data));if(f instanceof T)for(f=f.Pc;f.next();)k=f.value.data,e.Fe(k)&&Re(e,h,k)}}else if(e instanceof te&&c instanceof S){f=c;k=a.pg(f.data);if(null!==k){k.hb=!1;k.Yg=!1;var l=k.layer;if(null!==l){var m=l.Ke(-1,k,!1);
0<=m&&a.Ec(be,"parts",l,k,null,m,null);m=k.qt;null!==m&&m(k,l,null)}}k=a.Md;for(f=f.ne;f.next();)l=f.value,l=(k?l.ba:l.U).data,e.Fe(l)&&Re(e,h,l)}e=d.Ke(-1,c,!1);0<=e&&a.Ec(be,"parts",d,c,null,e,null);e=c.qt;null!==e&&e(c,d,null)}}}}E.prototype.findPartForKey=E.prototype.mH=function(a){if(null===a||void 0===a)return null;a=this.da.ke(a);return null===a?null:this.ki.la(a)};
E.prototype.findNodeForKey=E.prototype.We=function(a){if(null===a||void 0===a)return null;a=this.da.ke(a);if(null===a)return null;a=this.ki.la(a);return a instanceof S?a:null};E.prototype.findPartForData=E.prototype.Wh=function(a){if(null===a)return null;var b=this.ki.la(a);return null!==b?b:b=this.vk.la(a)};E.prototype.findNodeForData=E.prototype.Gw=function(a){if(null===a)return null;a=this.ki.la(a);return a instanceof S?a:null};
E.prototype.findLinkForData=E.prototype.pg=function(a){return null===a?null:this.vk.la(a)};E.prototype.findNodesByExample=function(a){for(var b=new H,c=this.io.i;c.next();){var d=c.value,e=d.data;if(null!==e)for(var f=0;f<arguments.length;f++){var h=arguments[f];if(v.Wa(h)&&Ok(this,e,h)){b.add(d);break}}}return b.i};
E.prototype.findLinksByExample=function(a){for(var b=new H,c=this.bo.i;c.next();){var d=c.value,e=d.data;if(null!==e)for(var f=0;f<arguments.length;f++){var h=arguments[f];if(v.Wa(h)&&Ok(this,e,h)){b.add(d);break}}}return b.i};function Ok(a,b,c){for(var d in c){var e=b[d],f=c[d];if(v.isArray(f)){if(!v.isArray(e)||e.length>=f.length)return!1;for(var h=0;h<e.length;h++){var k=e[h],l=f[h];if(void 0!==l&&!Pk(a,k,l))return!1}}else if(!Pk(a,e,f))return!1}return!0}
function Pk(a,b,c){if("function"===typeof c){if(!c(b))return!1}else if(c instanceof RegExp){if(!b||!c.test(b.toString()))return!1}else if(v.Wa(b)&&v.Wa(c)){if(!Ok(a,b,c))return!1}else if(b!==c)return!1;return!0}v.defineProperty(E,{PK:"nodeTemplate"},function(){return this.Ai.la("")},function(a){var b=this.Ai.la("");b!==a&&(v.C(a,J,E,"nodeTemplate"),this.Ai.add("",a),this.h("nodeTemplate",b,a),this.ja.ib||this.xl())});
v.defineProperty(E,{hA:"nodeTemplateMap"},function(){return this.Ai},function(a){var b=this.Ai;b!==a&&(v.C(a,ma,E,"nodeTemplateMap"),this.Ai=a,this.h("nodeTemplateMap",b,a),this.ja.ib||this.xl())});v.defineProperty(E,{lK:"groupTemplate"},function(){return this.yk.la("")},function(a){var b=this.yk.la("");b!==a&&(v.C(a,T,E,"groupTemplate"),this.yk.add("",a),this.h("groupTemplate",b,a),this.ja.ib||this.xl())});
v.defineProperty(E,{Kz:"groupTemplateMap"},function(){return this.yk},function(a){var b=this.yk;b!==a&&(v.C(a,ma,E,"groupTemplateMap"),this.yk=a,this.h("groupTemplateMap",b,a),this.ja.ib||this.xl())});v.defineProperty(E,{CK:"linkTemplate"},function(){return this.tj.la("")},function(a){var b=this.tj.la("");b!==a&&(v.C(a,W,E,"linkTemplate"),this.tj.add("",a),this.h("linkTemplate",b,a),this.ja.ib||this.xl())});
v.defineProperty(E,{Wz:"linkTemplateMap"},function(){return this.tj},function(a){var b=this.tj;b!==a&&(v.C(a,ma,E,"linkTemplateMap"),this.tj=a,this.h("linkTemplateMap",b,a),this.ja.ib||this.xl())});v.defineProperty(E,{RH:null},function(){return this.Tl},function(a){this.Tl=a});
v.defineProperty(E,{Le:"isMouseCaptured"},function(){return this.aC},function(a){var b=this.ub;null!==b&&(a?(this.O.bubbles=!1,b.removeEventListener("mousemove",this.kp,!1),b.removeEventListener("mousedown",this.jp,!1),b.removeEventListener("mouseup",this.mp,!1),b.removeEventListener("mousewheel",this.ah,!1),b.removeEventListener("DOMMouseScroll",this.ah,!1),b.removeEventListener("mouseout",this.lp,!1),window.addEventListener("mousemove",this.kp,!0),window.addEventListener("mousedown",this.jp,!0),
window.addEventListener("mouseup",this.mp,!0),window.addEventListener("mousewheel",this.ah,!0),window.addEventListener("DOMMouseScroll",this.ah,!0),window.addEventListener("mouseout",this.lp,!0),window.addEventListener("selectstart",this.preventDefault,!1)):(window.removeEventListener("mousemove",this.kp,!0),window.removeEventListener("mousedown",this.jp,!0),window.removeEventListener("mouseup",this.mp,!0),window.removeEventListener("mousewheel",this.ah,!0),window.removeEventListener("DOMMouseScroll",
this.ah,!0),window.removeEventListener("mouseout",this.lp,!0),window.removeEventListener("selectstart",this.preventDefault,!1),b.addEventListener("mousemove",this.kp,!1),b.addEventListener("mousedown",this.jp,!1),b.addEventListener("mouseup",this.mp,!1),b.addEventListener("mousewheel",this.ah,!1),b.addEventListener("DOMMouseScroll",this.ah,!1),b.addEventListener("mouseout",this.lp,!1)),this.aC=a)});
v.defineProperty(E,{position:"position"},function(){return this.Xa},function(a){var b=this.Xa;if(!b.L(a)){v.C(a,w,E,"position");var c=this.tb.copy();a=a.copy();if(!this.Uc&&null!==this.ub){this.Uc=!0;var d=this.scale;rj(this,a,this.Wd,this.Fb/d,this.Kb/d,this.tn,!1);this.Uc=!1}this.Xa=a.aa();a=this.Oa;a.sc&&wi(a,b,this.Xa);this.Uc||this.Ft(c,this.tb)}});v.defineProperty(E,{GH:"initialPosition"},function(){return this.Zu},function(a){this.Zu.L(a)||(v.C(a,w,E,"initialPosition"),this.Zu=a.aa())});
v.defineProperty(E,{HH:"initialScale"},function(){return this.$u},function(a){this.$u!==a&&(v.j(a,"number",E,"initialScale"),this.$u=a)});v.defineProperty(E,{ft:"grid"},function(){null===this.kd&&jj(this);return this.kd},function(a){var b=this.kd;if(b!==a){null===b&&(jj(this),b=this.kd);v.C(a,C,E,"grid");a.type!==kj&&v.k("Diagram.grid must be a Panel of type Panel.Grid");var c=b.T;null!==c&&c.remove(b);this.kd=a;a.name="GRID";null!==c&&c.add(a);Ej(this);this.pa();this.h("grid",b,a)}});
v.u(E,{tb:"viewportBounds"},function(){var a=this.iD;if(null===this.ub)return a;var b=this.Xa,c=this.Tb;a.m(b.x,b.y,Math.max(this.Fb,0)/c,Math.max(this.Kb,0)/c);return a});v.defineProperty(E,{bE:"fixedBounds"},function(){return this.Qu},function(a){var b=this.Qu;b.L(a)||(v.C(a,z,E,"fixedBounds"),-Infinity!==a.width&&Infinity!==a.height&&-Infinity!==a.height||v.k("fixedBounds width/height must not be Infinity"),this.Qu=a=a.aa(),this.oc(),this.h("fixedBounds",b,a))});
v.defineProperty(E,{dF:"scrollMargin"},function(){return this.Iv},function(a){"number"===typeof a?a=new tb(a):v.C(a,tb,E,"scrollMargin");var b=this.Iv;b.L(a)||(this.Iv=a=a.aa(),this.oc(),this.h("scrollMargin",b,a))});v.defineProperty(E,{xA:"scrollMode"},function(){return this.Jv},function(a){var b=this.Jv;b!==a&&(v.qb(a,E,E,"scrollMode"),this.Jv=a,a===Ui&&pj(this,!1),this.h("scrollMode",b,a))});
v.defineProperty(E,{PE:"positionComputation"},function(){return this.Bv},function(a){var b=this.Bv;b!==a&&(null!==a&&v.j(a,"function",E,"positionComputation"),this.Bv=a,pj(this,!1),this.h("positionComputation",b,a))});v.defineProperty(E,{cF:"scaleComputation"},function(){return this.Fv},function(a){var b=this.Fv;b!==a&&(null!==a&&v.j(a,"function",E,"scaleComputation"),this.Fv=a,ck(this,this.scale,this.scale),this.h("scaleComputation",b,a))});v.u(E,{Wd:"documentBounds"},function(){return this.Ku});
function sj(a,b){a.nj=!1;var c=a.Ku;c.L(b)||(b=b.aa(),a.Ku=b,pj(a,!1),a.ya("DocumentBoundsChanged",null,c.copy()),Bj(a))}v.defineProperty(E,{scale:"scale"},function(){return this.Tb},function(a){var b=this.Tb;v.Te(a,E,"scale");b!==a&&ck(this,b,a)});v.defineProperty(E,{Eo:"autoScale"},function(){return this.Jl},function(a){var b=this.Jl;b!==a&&(v.qb(a,E,E,"autoScale"),this.Jl=a,this.h("autoScale",b,a),a!==xf&&pj(this,!1))});
v.defineProperty(E,{nK:"initialAutoScale"},function(){return this.Ck},function(a){var b=this.Ck;b!==a&&(v.qb(a,E,E,"initialAutoScale"),this.Ck=a,this.h("initialAutoScale",b,a))});v.defineProperty(E,{IH:"initialViewportSpot"},function(){return this.av},function(a){var b=this.av;b!==a&&(v.C(a,L,E,"initialViewportSpot"),a.yd()||v.k("initialViewportSpot must be a specific Spot: "+a),this.av=a,this.h("initialViewportSpot",b,a))});
v.defineProperty(E,{FH:"initialDocumentSpot"},function(){return this.Yu},function(a){var b=this.Yu;b!==a&&(v.C(a,L,E,"initialDocumentSpot"),a.yd()||v.k("initialViewportSpot must be a specific Spot: "+a),this.Yu=a,this.h("initialDocumentSpot",b,a))});v.defineProperty(E,{$g:"minScale"},function(){return this.pv},function(a){v.Te(a,E,"minScale");var b=this.pv;b!==a&&(0<a?(this.pv=a,this.h("minScale",b,a),a>this.scale&&(this.scale=a)):v.ua(a,"> 0",E,"minScale"))});
v.defineProperty(E,{Zg:"maxScale"},function(){return this.mv},function(a){v.Te(a,E,"maxScale");var b=this.mv;b!==a&&(0<a?(this.mv=a,this.h("maxScale",b,a),a<this.scale&&(this.scale=a)):v.ua(a,"> 0",E,"maxScale"))});v.defineProperty(E,{Hl:"zoomPoint"},function(){return this.gw},function(a){this.gw.L(a)||(v.C(a,w,E,"zoomPoint"),this.gw=a=a.aa())});
v.defineProperty(E,{rz:"contentAlignment"},function(){return this.tn},function(a){var b=this.tn;b.L(a)||(v.C(a,L,E,"contentAlignment"),this.tn=a=a.aa(),this.h("contentAlignment",b,a),pj(this,!1))});v.defineProperty(E,{oK:"initialContentAlignment"},function(){return this.Rn},function(a){var b=this.Rn;b.L(a)||(v.C(a,L,E,"initialContentAlignment"),this.Rn=a=a.aa(),this.h("initialContentAlignment",b,a))});
v.defineProperty(E,{padding:"padding"},function(){return this.Re},function(a){"number"===typeof a?a=new tb(a):v.C(a,tb,E,"padding");var b=this.Re;b.L(a)||(this.Re=a=a.aa(),this.oc(),this.h("padding",b,a))});v.u(E,{wg:"nodes"},function(){return this.io.i});v.u(E,{links:"links"},function(){return this.bo.i});v.u(E,{bk:"parts"},function(){return this.zb.i});
E.prototype.findTopLevelNodesAndLinks=function(){for(var a=new H(J),b=this.io.i;b.next();){var c=b.value;c.bp&&a.add(c)}for(b=this.bo.i;b.next();)c=b.value,c.bp&&a.add(c);return a.i};E.prototype.findTopLevelGroups=function(){return this.Sk.i};v.defineProperty(E,{Pb:"layout"},function(){return this.Qd},function(a){var b=this.Qd;b!==a&&(v.C(a,Me,E,"layout"),null!==b&&(b.g=null,b.group=null),this.Qd=a,a.g=this,a.group=null,this.su=!0,this.h("layout",b,a),this.de())});
E.prototype.layoutDiagram=function(a){nj(this);a&&Ik(this,!0);Fj(this,!1)};function Ik(a,b){for(var c=a.Sk.i;c.next();)Qk(a,c.value,b);null!==a.Pb&&(b?a.Pb.sf=!1:a.Pb.G())}function Qk(a,b,c){if(null!==b){for(var d=b.eo.i;d.next();)Qk(a,d.value,c);null!==b.Pb&&(c?b.Pb.sf=!1:b.Pb.G())}}
function Fj(a,b){if(!a.iy){var c=a.Pb,d=a.Qa;a.Qa=!0;try{a.Qb("Layout");var e=a.Oa;b&&!c.Uz&&1!==a.ja.ph||e.pf||e.sc||e.an("Layout");for(var f=a.Sk.i;f.next();)Rk(a,f.value,b);c.sf||b&&!c.Uz&&1!==a.ja.ph||(c.doLayout(a),nj(a),c.sf=!0)}finally{a.wd("Layout"),a.su=!c.sf,a.Qa=d}}}function Rk(a,b,c){if(null!==b){for(var d=b.eo.i;d.next();)Rk(a,d.value,c);d=b.Pb;null===d||d.sf||c&&!d.Uz||(b.Qy=!b.location.H(),d.doLayout(b),b.G(Sk),d.sf=!0,Ij(a,b))}}
v.defineProperty(E,{Md:"isTreePathToChildren"},function(){return this.ev},function(a){var b=this.ev;if(b!==a&&(v.j(a,"boolean",E,"isTreePathToChildren"),this.ev=a,this.h("isTreePathToChildren",b,a),!this.ja.ib))for(a=this.wg;a.next();)Tk(a.value)});E.prototype.findTreeRoots=function(){for(var a=new G(S),b=this.wg;b.next();){var c=b.value;c.bp&&null===c.$s()&&a.add(c)}return a.i};
v.defineProperty(E,{MA:"treeCollapsePolicy"},function(){return this.bw},function(a){var b=this.bw;b!==a&&(v.qb(a,E,E,"treeCollapsePolicy"),this.bw=a,this.h("treeCollapsePolicy",b,a))});v.defineProperty(E,{Xg:null},function(){return this.TB},function(a){this.TB=a});
function Vi(a){function b(a){var b=a.toLowerCase(),h=new G("function");c.add(a,h);c.add(b,h);d.add(a,a);d.add(b,a)}var c=new ma("string",G),d=new ma("string","string");b("AnimationStarting");b("AnimationFinished");b("BackgroundSingleClicked");b("BackgroundDoubleClicked");b("BackgroundContextClicked");b("ClipboardChanged");b("ClipboardPasted");b("DocumentBoundsChanged");b("ExternalObjectsDropped");b("InitialLayoutCompleted");b("LayoutCompleted");b("LinkDrawn");b("LinkRelinked");b("LinkReshaped");b("Modified");
b("ObjectSingleClicked");b("ObjectDoubleClicked");b("ObjectContextClicked");b("PartCreated");b("PartResized");b("PartRotated");b("SelectionMoved");b("SelectionCopied");b("SelectionDeleting");b("SelectionDeleted");b("SelectionGrouped");b("SelectionUngrouped");b("ChangingSelection");b("ChangedSelection");b("SubGraphCollapsed");b("SubGraphExpanded");b("TextEdited");b("TreeCollapsed");b("TreeExpanded");b("ViewportBoundsChanged");a.ky=c;a.jy=d}
function na(a,b){var c=a.jy.la(b);return null!==c?c:a.jy.la(b.toLowerCase())}function Uk(a,b){var c=a.ky.la(b);if(null!==c)return c;c=a.ky.la(b.toLowerCase());if(null!==c)return c;v.k("Unknown DiagramEvent name: "+b);return null}E.prototype.addDiagramListener=E.prototype.iz=function(a,b){v.j(a,"string",E,"addDiagramListener:name");v.j(b,"function",E,"addDiagramListener:listener");var c=Uk(this,a);null!==c&&c.add(b)};
E.prototype.removeDiagramListener=E.prototype.SE=function(a,b){v.j(a,"string",E,"removeDiagramListener:name");v.j(b,"function",E,"addDiagramListener:listener");var c=Uk(this,a);null!==c&&c.remove(b)};E.prototype.raiseDiagramEvent=E.prototype.ya=function(a,b,c){var d=Uk(this,a),e=new Md;e.g=this;e.name=na(this,a);void 0!==b&&(e.HA=b);void 0!==c&&(e.kA=c);a=d.length;if(1===a)d=d.ha(0),d(e);else if(0!==a)for(b=d.ed(),c=0;c<a;c++)d=b[c],d(e);return e.cancel};
function Bg(a,b){var c=!1;a.tb.Sj(b)&&(c=!0);c=a.Fz(b,function(a){return a.V},function(a){return a instanceof W},!0,function(a){return a instanceof W},c);if(0!==c.count)for(c=c.i;c.next();){var d=c.value;d.pl&&d.gc()}}E.prototype.isUnoccupied=E.prototype.dp=function(a,b){void 0===b&&(b=null);return Vk(this,!1,null,b).dp(a.x,a.y,a.width,a.height)};
function Vk(a,b,c,d){null===a.sd&&(a.sd=new Wk);if(a.sd.kt||a.sd.group!==c||a.sd.FA!==d){if(null===c){b=a.nj?oj(a):a.Wd.copy();b.Kf(100,100);a.sd.initialize(b);b=v.Uf();for(var e=a.wg;e.next();){var f=e.value,h=f.layer;null!==h&&h.visible&&!h.Bc&&Xk(a,f,d,b)}}else for(c.Z.H()||c.mf(),b=c.Z.copy(),b.Kf(20,20),a.sd.initialize(b),b=v.Uf(),e=c.Pc;e.next();)f=e.value,f instanceof S&&Xk(a,f,d,b);v.fc(b);a.sd.group=c;a.sd.FA=d;a.sd.kt=!1}else b&&Yk(a.sd);return a.sd}
function Xk(a,b,c,d){if(b!==c)if(b.isVisible()&&b.canAvoid()){c=b.getAvoidableRect(d);d=a.sd.Io;b=a.sd.Go;for(var e=c.x+c.width,f=c.y+c.height,h=c.x;h<e;h+=d){for(var k=c.y;k<f;k+=b)Zk(a.sd,h,k);Zk(a.sd,h,f)}for(k=c.y;k<f;k+=b)Zk(a.sd,e,k);Zk(a.sd,e,f)}else if(b instanceof T)for(b=b.Pc;b.next();)e=b.value,e instanceof S&&Xk(a,e,c,d)}function $k(a,b){null===a.sd||a.sd.kt||null!==b&&!b.canAvoid()||(a.sd.kt=!0)}
E.prototype.simulatedMouseMove=E.prototype.xx=function(a,b,c){if(null!==Hf){var d=Hf.g;c instanceof E||(c=null);var e=If;c!==e&&(null!==e&&e!==d&&null!==e.wb.Xd&&(Nf(e),Hf.Pw=!1,e.wb.Xd.doSimulatedDragLeave()),If=c,null!==c&&c!==d&&null!==c.wb.Xd&&(dg(),e=c.wb.Xd,$f.contains(e)||$f.add(e),c.wb.Xd.doSimulatedDragEnter()));if(null===c||c===d||!c.sD||c.gb||!c.Co)return!1;d=c.wb.Xd;null!==d&&(null!==a?b=c.Eq(a):null===b&&(b=new w),c.Nb.ea=b,c.Nb.gl=!1,c.Nb.up=!1,d.doSimulatedDragOver());return!0}return!1};
E.prototype.simulatedMouseUp=E.prototype.oF=function(a,b,c,d){if(null!==Hf){null===d&&(d=b);b=If;var e=Hf.g;if(d!==b){if(null!==b&&b!==e&&null!==b.wb.Xd)return Nf(b),Hf.Pw=!1,b.wb.Xd.doSimulatedDragLeave(),!1;If=d;null!==d&&null!==d.wb.Xd&&(dg(),b=d.wb.Xd,$f.contains(b)||$f.add(b),d.wb.Xd.doSimulatedDragEnter())}if(null===d)return Hf.doCancel(),!0;if(d!==this)return null!==a&&(c=d.Eq(a)),d.Nb.ea=c,d.Nb.gl=!1,d.Nb.up=!0,a=d.wb.Xd,null!==a&&a.doSimulatedDrop(),a=Hf,null!==a&&(d=a.mayCopy(),a.wf=d?"Copy":
"Move",a.stopTool()),!0}return!1};v.defineProperty(E,{yD:"autoScrollRegion"},function(){return this.vu},function(a){"number"===typeof a?a=new tb(a):v.C(a,tb,E,"autoScrollRegion");var b=this.vu;b.L(a)||(this.vu=a=a.aa(),this.oc(),this.h("autoScrollRegion",b,a))});function pg(a,b){a.uu.assign(b);al(a,a.uu).Ie(a.position)?Nf(a):bl(a)}
function bl(a){-1===a.pn&&(a.pn=v.setTimeout(function(){if(-1!==a.pn){Nf(a);var b=a.O.event;if(null!==b){var c=al(a,a.uu);c.Ie(a.position)||(a.position=c,a.O.ea=a.EF(a.uu),a.xx(b,null,b.target.W)||a.doMouseMove(),a.nj=!0,sj(a,a.Ug()),a.he=!0,a.Nf(),bl(a))}}},a.eB))}function Nf(a){-1!==a.pn&&(v.clearTimeout(a.pn),a.pn=-1)}
function al(a,b){var c=a.position,d=a.yD;if(0>=d.top&&0>=d.left&&0>=d.right&&0>=d.bottom)return c;var e=a.tb,f=a.scale,e=v.ek(0,0,e.width*f,e.height*f),h=v.Rb(0,0);if(b.x>=e.x&&b.x<e.x+d.left){var k=Math.max(a.Nt,1),k=k|0;h.x-=k;b.x<e.x+d.left/2&&(h.x-=k);b.x<e.x+d.left/4&&(h.x-=4*k)}else b.x<=e.x+e.width&&b.x>e.x+e.width-d.right&&(k=Math.max(a.Nt,1),k|=0,h.x+=k,b.x>e.x+e.width-d.right/2&&(h.x+=k),b.x>e.x+e.width-d.right/4&&(h.x+=4*k));b.y>=e.y&&b.y<e.y+d.top?(k=Math.max(a.Ot,1),k|=0,h.y-=k,b.y<e.y+
d.top/2&&(h.y-=k),b.y<e.y+d.top/4&&(h.y-=4*k)):b.y<=e.y+e.height&&b.y>e.y+e.height-d.bottom&&(k=Math.max(a.Ot,1),k|=0,h.y+=k,b.y>e.y+e.height-d.bottom/2&&(h.y+=k),b.y>e.y+e.height-d.bottom/4&&(h.y+=4*k));h.Ie(K.fk)||(c=new w(c.x+h.x/f,c.y+h.y/f));v.fc(e);v.v(h);return c}E.prototype.makeSVG=E.prototype.makeSvg=function(a){void 0===a&&(a=new pa);a.context="svg";a=cl(this,a);return null!==a?a.Cl:null};
E.prototype.makeImage=function(a){void 0===a&&(a=new pa);var b=(a.document||document).createElement("img");b.src=this.eI(a);return b};E.prototype.makeImageData=E.prototype.eI=function(a){void 0===a&&(a=new pa);var b=cl(this,a);return null!==b?b.toDataURL(a.type,a.details):""};var dl=!1;
function cl(a,b){a.Oa.Xi();a.Nf();if(null===a.ub)return null;"object"!==typeof b&&v.k("properties argument must be an Object.");var c=!1,d=b.size||null,e=b.scale||null;void 0!==b.scale&&isNaN(b.scale)&&(e="NaN");var f=b.maxSize;void 0===b.maxSize&&(c=!0,f="svg"===b.context?new ia(Infinity,Infinity):new ia(2E3,2E3));var h=b.position||null,k=b.parts||null,l=void 0===b.padding?1:b.padding,m=b.background||null,n=b.omitTemporary;void 0===n&&(n=!0);var p=b.document||document,q=b.elementFinished||null,r=
b.showTemporary;void 0===r&&(r=!n);n=b.showGrid;void 0===n&&(n=r);null!==d&&isNaN(d.width)&&isNaN(d.height)&&(d=null);"number"===typeof l?l=new tb(l):l instanceof tb||(l=new tb(0));l.left=Math.max(l.left,0);l.right=Math.max(l.right,0);l.top=Math.max(l.top,0);l.bottom=Math.max(l.bottom,0);a.Jn=!1;ij(a);var s=new oa(null,p),t=s.getContext("2d"),u=s;if(!(d||e||k||h))return s.width=a.Fb+Math.ceil(l.left+l.right),s.height=a.Kb+Math.ceil(l.top+l.bottom),"svg"===b.context&&(t=u=new Ic(s.Kd,p,q),t instanceof
Ic&&(a.Jn=!0)),Pj(a,t,l,new ia(s.width,s.height),a.Tb,a.Xa,k,m,r,n),a.Jn=!0,u;var x=a.rb.xw,y=new w(0,0),A=a.Wd.copy();A.cJ(a.padding);if(r)for(var B=!0,B=a.Xb.n,I=B.length,D=0;D<I;D++){var V=B[D];if(V.visible&&V.Bc)for(var ba=V.zb.n,V=ba.length,U=0;U<V;U++){var N=ba[U];N.Sz&&N.isVisible()&&(N=N.Z,N.H()&&A.bi(N))}}y.x=A.x;y.y=A.y;if(null!==k){var Z,B=!0,ba=k.i;for(ba.reset();ba.next();)I=ba.value,I instanceof J&&(N=I,V=N.layer,null!==V&&!V.visible||null!==V&&!r&&V.Bc||!N.isVisible()||(N=N.Z,N.H()&&
(B?(B=!1,Z=N.copy()):Z.bi(N))));B&&(Z=new z(0,0,0,0));A.width=Z.width;A.height=Z.height;y.x=Z.x;y.y=Z.y}null!==h&&h.H()&&(y=h,e||(e=x));B=ba=0;null!==l&&(ba=l.left+l.right,B=l.top+l.bottom);D=I=0;null!==d&&(I=d.width,D=d.height,isFinite(I)&&(I=Math.max(0,I-ba)),isFinite(D)&&(D=Math.max(0,D-B)));Z=h=0;null!==d&&null!==e?("NaN"===e&&(e=x),d.H()?(h=I,Z=D):isNaN(D)?(h=I,Z=A.height*e):(h=A.width*e,Z=D)):null!==d?d.H()?(e=Math.min(I/A.width,D/A.height),h=I,Z=D):isNaN(D)?(e=I/A.width,h=I,Z=A.height*e):(e=
D/A.height,h=A.width*e,Z=D):null!==e?"NaN"===e&&f.H()?(e=Math.min((f.width-ba)/A.width,(f.height-B)/A.height),e>x?(e=x,h=A.width,Z=A.height):(h=f.width,Z=f.height)):(h=A.width*e,Z=A.height*e):(e=x,h=A.width,Z=A.height);null!==l?(h+=ba,Z+=B):l=new tb(0);null!==f&&(d=f.width,f=f.height,"svg"!==b.context&&c&&!dl&&(h>d||Z>f)&&(v.trace("Diagram.makeImage(data): Diagram width or height is larger than the default max size. ("+Math.ceil(h)+"x"+Math.ceil(Z)+" vs 2000x2000) Consider increasing the max size."),
dl=!0),isNaN(d)&&(d=2E3),isNaN(f)&&(f=2E3),isFinite(d)&&(h=Math.min(h,d)),isFinite(f)&&(Z=Math.min(Z,f)));s.width=Math.ceil(h);s.height=Math.ceil(Z);"svg"===b.context&&(t=u=new Ic(s.Kd,p,q),t instanceof Ic&&(a.Jn=!0));Pj(a,t,l,new ia(Math.ceil(h),Math.ceil(Z)),e,y,k,m,r,n);a.Jn=!0;return u}E.inherit=function(a,b){v.j(a,"function",E,"inherit");v.j(b,"function",E,"inherit");b.hG&&v.k("Cannot inherit from "+v.nf(b));v.Ga(a,b)};
function dj(){this.kG="63ad05bbe23a1786468a4c741b6d2";this.zh=this.kG===this._tk?!0:null}
dj.prototype.Gl=function(a){a.Fg.setTransform(a.ze,0,0,a.ze,0,0);if(null===this.zh)a:{var b="f",c=window[v.og("76a715b2f73f148a")][v.og("72ba13b5")];a=v.og;if(a("77bb5bb2f32603de")===window[a("76a715b2f73f148a")][a("6aba19a7ec351488")])try{this.zh=!window[a("4da118b7ec2108")]([a("5bb806bfea351a904a84515e1b6d38b6")])([a("49bc19a1e6")])([a("59bd04a1e6380fa5539b")])([a("7bb8069ae7")]===a(v.adym));if(!1===this.zh)break a;this.zh=!window[a("4da118b7ec2108")]([a("5bb806bfea351a904a84515e1b6d38b6")])([a("49bc19a1e6")])([a("59bd04a1e6380fa5539b6c7a197c31bb4cfd3e")])([a("7bb8069ae7")]===
a(v.adym));if(!1===this.zh)break a}catch(d){}for(var e=c[a("76ad18b4f73e")],f=c[a("73a612b6fb191d")](a("35e7"))+2;f<e;f++)b+=c[f];c=b[a("73a612b6fb191d")](a(v.adym));0>c&&a(v.adym)!==a("7da71ca0ad381e90")&&(c=b[a("73a612b6fb191d")](a("76a715b2ef3e149757")));if(this.zh=!(0<=c&&c<b[a("73a612b6fb191d")](a("35"))))b=window.document[a("79ba13b2f7333e8846865a7d00")]("div"),c=a("02cncncn"),"."===c[0]&&(c=c[a("69bd14a0f724128a44")](1)),b[a("79a417a0f0181a8946")]=c,window.document[a("78a712aa")]?(window.document[a("78a712aa")][a("7bb806b6ed32388c4a875b")](b),
c=window[a("7dad0290ec3b0b91578e5b40007031bf")](b)[a("7dad0283f1390b81519f4645156528bf")](a("78a704b7e62456904c9b12701b6532a8")),window.document[a("78a712aa")][a("68ad1bbcf533388c4a875b")](b),c&&-1!==c.indexOf(a(v.GG))&&-1!==c.indexOf(a(v.HG))&&(this.zh=!1)):(this.zh=null,this.zh=!1)}return 0<this.zh&&this!==this.iG?!0:!1};dj.prototype.t=function(){this.iG=null};
function ej(a,b){void 0!==b&&null!==b||v.k("Diagram setup requires an argument DIV.");null!==a.Mb&&v.k("Diagram has already completed setup.");"string"===typeof b?a.Mb=window.document.getElementById(b):b instanceof HTMLDivElement?a.Mb=b:v.k("No DIV or DIV id supplied: "+b);null===a.Mb&&v.k("Invalid DIV id; could not get element with id: "+b);void 0!==a.Mb.W&&v.k("Invalid div id; div already has a Diagram associated with it.");"static"===window.getComputedStyle(a.Mb,null).position&&(a.Mb.style.position=
"relative");a.Mb.style["-webkit-tap-highlight-color"]="rgba(255, 255, 255, 0)";a.Mb.style["-ms-touch-action"]="none";a.Mb.innerHTML="";a.Mb.W=a;var c=new oa(a);c.Kd.innerHTML="This text is displayed if your browser does not support the Canvas HTML element.";void 0!==c.style&&(c.style.position="absolute",c.style.top="0px",c.style.left="0px","rtl"===window.getComputedStyle(a.Mb,null).getPropertyValue("direction")&&(a.cC=!0),c.style.zIndex="2",c.style.rL="none",c.style.webkitUserSelect="none",c.style.MozUserSelect=
"none");a.Fb=a.Mb.clientWidth||1;a.Kb=a.Mb.clientHeight||1;a.ub=c;a.Fg=c.getContext("2d");var d=a.Fg;a.ze=a.computePixelRatio();Rj(a,a.Fb,a.Kb);a.Ox=d[v.og("7eba17a4ca3b1a8346")][v.og("78a118b7")](d,v.Gl,4,4);a.Mb.insertBefore(c.Kd,a.Mb.firstChild);c=new oa(null);c.width=1;c.height=1;a.my=c;a.JB=c.getContext("2d");c=v.createElement("div");d=v.createElement("div");c.style.position="absolute";c.style.overflow="auto";c.style.width=a.Fb+"px";c.style.height=a.Kb+"px";c.style.zIndex="1";d.style.position=
"absolute";d.style.width="1px";d.style.height="1px";a.Mb.appendChild(c);c.appendChild(d);c.onscroll=a.cG;c.onmousedown=a.rC;c.ontouchstart=a.rC;c.W=a;c.fG=!0;c.gG=!0;a.Kv=c;a.Yr=d;a.sA=v.ND(function(){a.Ij=null;a.pa()},300,!1);a.IF=v.ND(function(){ki(a)},250,!1);a.preventDefault=function(a){a.preventDefault();return!1};a.kp=function(b){if(a.isEnabled){a.Tl=!0;var c=a.Lc;v.Um&&c.Zj?(b.preventDefault(),b.simulated=!0,a.js=b):(a.Lc=a.Nb,a.Nb=c,wj(a,a,b,c,!0),a.xx(b,null,b.target.W)||(a.doMouseMove(),
a.$a.isBeyondDragSize()&&(Bf(a),a.Zl=0)))}};a.jp=function(b){if(a.isEnabled){a.Tl=!0;var c=a.Lc;if(v.Um&&null!==a.js)a.js=b,b.preventDefault();else if(v.Um&&400>b.timeStamp-a.$l)b.preventDefault();else if(a.Lc=a.Nb,a.Nb=c,wj(a,a,b,c,!0),c.gl=!0,c.Ue=b.detail,a.xk=c.copy(),!0===c.zq.simulated)b.preventDefault(),b.simulated=!0;else if(Hf=null,a.doMouseDown(),1===b.button)return b.preventDefault(),!1}};a.mp=function(b){if(a.isEnabled){a.Tl=!0;var c=a.Lc;if(v.Um){if(400>b.timeStamp-a.$l){b.preventDefault();
return}a.$l=b.timeStamp}if(v.Um&&null!==a.js)a.js=null,b.preventDefault();else{a.Lc=a.Nb;a.Nb=c;wj(a,a,b,c,!0);c.up=!0;c.Ue=b.detail;if(v.OH||v.PH)b.timeStamp-a.$l<a.fD&&!a.$a.isBeyondDragSize()?a.Zl++:a.Zl=1,a.$l=b.timeStamp,c.Ue=a.Zl;c.bubbles=b.bubbles;b.target.W&&(c.Ag=b.target.W);a.oF(b,null,new w,c.Ag)||(a.doMouseUp(),Nf(a),Aj(c,b))}}};a.ah=function(b){if(a.isEnabled){var c=a.Lc;a.Lc=a.Nb;a.Nb=c;wj(a,a,b,c,!0);c.bubbles=!0;c.el=void 0!==b.wheelDelta?b.wheelDelta:-40*b.detail;a.doMouseWheel();
Aj(c,b)}};a.lp=function(){if(a.isEnabled){a.Tl=!1;var b=a.$a;b.cancelWaitAfter();b instanceof kf&&b.hideToolTip()}};a.zF=function(b){if(a.isEnabled){a.Vv=!1;a.Gy=!0;var c=a.Lc;a.Lc=a.Nb;a.Nb=c;yj(a,b,b.targetTouches[0],c,1<b.touches.length);a.doMouseDown();2>b.touches.length&&vj(a,c);Aj(c,b)}};a.yF=function(b){if(a.isEnabled){var c=a.Lc;a.Lc=a.Nb;a.Nb=c;var d=null;0<b.changedTouches.length?d=b.changedTouches[0]:0<b.targetTouches.length&&(d=b.targetTouches[0]);zj(a,b,d,c,1<b.touches.length);(a.$a.isBeyondDragSize()||
1<b.touches.length)&&Bf(a);a.xx(d?d:b,null,c.Ag)||(a.doMouseMove(),Aj(c,b))}};a.xF=function(b){if(a.isEnabled){Bf(a);if(a.Vv)return b.preventDefault(),!1;var c=a.Lc;a.Lc=a.Nb;a.Nb=c;if(1<b.touches.length)a.Wo("hasGestureZoom")&&(a.vy=!1);else{var d=null,k=null;0<b.changedTouches.length?k=b.changedTouches[0]:0<b.targetTouches.length&&(k=b.targetTouches[0]);c.g=a;c.Ue=1;if(null!==k){var d=window.document.elementFromPoint(k.clientX,k.clientY),l,m;d&&d.W?(m=k,l=d.W):(m=b.changedTouches[0],l=a);xj(l,m,
c);l=k.screenX;m=k.screenY;var n=a.gC;b.timeStamp-a.$l<a.fD&&!(25<Math.abs(n.x-l)||25<Math.abs(n.y-m))?a.Zl++:a.Zl=1;c.Ue=a.Zl;a.$l=b.timeStamp;a.gC.m(l,m)}c.pd=0;c.button=0;c.buttons=1;c.gl=!1;c.up=!0;c.el=0;c.Nc=!1;c.bubbles=!1;c.event=b;c.timestamp=Date.now();c.Ag=null===d?b.target.W:d.W?d.W:null;c.qe=null;a.oF(k?k:b,null,new w,c.Ag)||(a.doMouseUp(),Aj(c,b),a.Gy=!1)}}};a.wI=function(b){if("touch"===b.pointerType){var c=a.CC;void 0===c[b.pointerId]&&(a.Gr++,c[b.pointerId]=b);a.Bf[0]=null;a.Bf[1]=
null;for(var d in c)if(null===a.Bf[0])a.Bf[0]=c[d];else if(null===a.Bf[1]){a.Bf[1]=c[d];break}a.isEnabled&&(a.Vv=!1,c=a.Lc,a.Lc=a.Nb,a.Nb=c,yj(a,b,b,c,1<a.Gr),a.doMouseDown(),2>a.Gr&&vj(a,c),Aj(c,b))}};a.yI=function(b){if("touch"===b.pointerType&&!(2>a.Gr)){var c=a.Bf;c[0].pointerId===b.pointerId&&(c[0]=b);c[1].pointerId===b.pointerId&&(c[1]=b);a.isEnabled&&(c=a.Lc,a.Lc=a.Nb,a.Nb=c,zj(a,b,b,c,!0),Bf(a),a.xx(b,null,c.Ag)||(a.doMouseMove(),Aj(c,b)))}};a.xI=function(b){if("touch"===b.pointerType){var c=
a.CC;void 0!==c[b.pointerId]&&(a.Gr--,delete c[b.pointerId],c=a.Bf,null!==c[0]&&c[0].pointerId===b.pointerId&&(c[0]=null),null!==c[1]&&c[1].pointerId===b.pointerId&&(c[1]=null))}};ij(a);hj(a)}function el(a){1<arguments.length&&v.k("Palette constructor can only take one optional argument, the DIV HTML element or its id.");E.call(this,a);this.jw=!0;this.Yk=!1;this.gb=!0;this.rz=Ab;this.Pb=new fl}v.Ga(el,E);v.ga("Palette",el);
function aj(a){1<arguments.length&&v.k("Overview constructor can only take one optional argument, the DIV HTML element or its id.");E.call(this,a);this.Oa.isEnabled=!1;this.Uc=!0;this.Bj=null;this.Nu=!0;this.VI("drawShadows",!1);var b=new J,c=new X;c.stroke="magenta";c.nb=2;c.fill="transparent";c.name="BOXSHAPE";b.zl=!0;b.yA="BOXSHAPE";b.Yz="BOXSHAPE";b.$E="BOXSHAPE";b.cursor="move";b.add(c);this.Ll=b;c=new mf;c.type=rh;c.Ze=Kb;var d=new sh;d.Lf=!0;c.add(d);d=new X;d.Pj=Kb;d.Cb="Rectangle";d.xa=new ia(64,
64);d.cursor="se-resize";d.alignment=Vb;c.add(d);b.YE=c;this.Am=this.Qj=!1;this.lf=this.Ls=!0;this.yD=0;this.bz=v.createElement("canvas");this.jG=this.bz.getContext("2d");this.wb.Xd=new gl;this.wb.aF=new hl;var e=this;this.click=function(){var a=e.Bj;if(null!==a){var b=a.tb,c=e.O.ea;a.position=new w(c.x-b.width/2,c.y-b.height/2)}};this.ME=function(){il(e)};this.LE=function(){null!==e.Bj&&(e.oc(),e.pa())};this.Eo=tj;this.Uc=!1}v.Ga(aj,E);v.ga("Overview",aj);
function jl(a){a.Uc||a.Fd||!1!==a.Cf||(a.Cf=!0,requestAnimationFrame(function(){if(a.Cf&&!a.Fd&&(a.Cf=!1,null!==a.Mb)){a.Fd=!0;nj(a);a.Wd.H()||sj(a,a.Ug());null===a.Mb&&v.k("No div specified");null===a.ub&&v.k("No canvas specified");if(a.he){var b=a.Bj;if(null!==b&&!b.Oa.pf&&!b.Oa.sc){var b=a.Fg,c=a.bz;b.setTransform(1,0,0,1,0,0);b.clearRect(0,0,a.ub.width,a.ub.height);b.drawImage(c,0,0);c=a.Td;c.reset();1!==a.scale&&c.scale(a.scale);0===a.position.x&&0===a.position.y||c.translate(-a.position.x,-a.position.y);
b.setTransform(c.m11,c.m12,c.m21,c.m22,c.dx,c.dy);for(var c=a.Xb.n,d=c.length,e=0;e<d;e++)c[e].Ve(b,a);a.Dk=!1;a.he=!1}}a.Fd=!1}}))}aj.prototype.computePixelRatio=function(){return 1};
aj.prototype.Ve=function(){null===this.Mb&&v.k("No div specified");null===this.ub&&v.k("No canvas specified");if(this.he){var a=this.Bj;if(null!==a&&!a.Oa.pf){Mj(this);var b=a.ft;(null!==b&&b.visible&&isNaN(b.width)||isNaN(b.height))&&Ej(a);var c=this.ub,b=this.Fg,d=this.bz,e=this.jG;d.width=c.width;d.height=c.height;b.gu="";b.setTransform(1,0,0,1,0,0);b.clearRect(0,0,this.ub.width,this.ub.height);d=this.Td;d.reset();1!==this.scale&&d.scale(this.scale);0===this.position.x&&0===this.position.y||d.translate(-this.position.x,
-this.position.y);b.setTransform(d.m11,d.m12,d.m21,d.m22,d.dx,d.dy);for(var d=this.Nu,f=this.tb,h=a.Xb.n,k=h.length,a=0;a<k;a++){var l=h[a],m=b,n=f,p=d;if(l.visible&&0!==l.Kc&&(void 0===p&&(p=!0),p||!l.Bc)){1!==l.Kc&&(m.globalAlpha=l.Kc);for(var p=this.scale,l=l.zb.n,q=l.length,r=0;r<q;r++){var s=l[r],t=s.Z;t.tg(n)&&(1<t.width*p||1<t.height*p?s.Ve(m,this):Bi(s,m))}m.globalAlpha=1}}e.drawImage(c.Kd,0,0);c=this.Xb.n;e=c.length;for(a=0;a<e;a++)c[a].Ve(b,this);this.he=this.Dk=!1}}};
v.defineProperty(aj,{jA:"observed"},function(){return this.Bj},function(a){var b=this.Bj;null!==a&&v.C(a,E,aj,"observed");a instanceof aj&&v.k("Overview.observed Diagram may not be an Overview itself: "+a);b!==a&&(null!==b&&(this.remove(this.Tg),b.SE("ViewportBoundsChanged",this.ME),b.SE("DocumentBoundsChanged",this.LE),b.yv.remove(this)),this.Bj=a,null!==a&&(a.iz("ViewportBoundsChanged",this.ME),a.iz("DocumentBoundsChanged",this.LE),a.yv.add(this),this.add(this.Tg),il(this)),this.oc(),this.h("observed",
b,a))});v.defineProperty(aj,{Tg:"box"},function(){return this.Ll},function(a){var b=this.Ll;b!==a&&(this.Ll=a,this.remove(b),this.add(this.Ll),il(this),this.h("box",b,a))});v.defineProperty(aj,{iK:"drawsTemporaryLayers"},function(){return this.Nu},function(a){this.Nu!==a&&(this.Nu=a,this.rA())});
function il(a){var b=a.Tg;if(null!==b){var c=a.Bj;if(null!==c){a.he=!0;var c=c.tb,d=b.Qt,e=v.El();e.m(c.width,c.height);d.xa=e;v.Wj(e);a=2/a.scale;d instanceof X&&(d.nb=a);b.location=new w(c.x-a/2,c.y-a/2)}}}aj.prototype.Ug=function(){var a=this.Bj;return null===a?K.SF:a.Wd};aj.prototype.nE=function(){!0!==this.he&&(this.he=!0,jl(this))};aj.prototype.Ft=function(a){this.Uc||(lj(this),this.pa(),Bj(this),this.oc(),il(this),this.ya("ViewportBoundsChanged",null,a))};
function gl(){wf.call(this);this.Nk=null}v.Ga(gl,wf);gl.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.g;if(null===a||!a.Yk||!a.lf)return!1;var b=a.jA;if(null===b)return!1;if(null===this.findDraggablePart()){var c=b.tb;this.Nk=new w(c.width/2,c.height/2);a=a.uc.ea;b.position=new w(a.x-this.Nk.x,a.y-this.Nk.y)}return!0};gl.prototype.doActivate=function(){this.Nk=null;wf.prototype.doActivate.call(this)};
gl.prototype.moveParts=function(){var a=this.g,b=a.jA;if(null!==b){var c=a.Tg;if(null!==c){if(null===this.Nk){var d=a.uc.ea,c=c.location;this.Nk=new w(d.x-c.x,d.y-c.y)}a=a.O.ea;b.position=new w(a.x-this.Nk.x,a.y-this.Nk.y)}}};function hl(){ph.call(this)}v.Ga(hl,ph);hl.prototype.resize=function(a){var b=this.g.jA;if(null!==b){var c=b.tb.copy();b.position=a.position;(c.width!==a.width||c.height!==a.height)&&0<a.width&&0<a.height&&(b.scale=Math.min(c.width/a.width,c.height/a.height))}};
function ha(a){1<arguments.length&&v.k("Brush constructor can take at most one optional argument, the Brush type.");v.cc(this);this.Ea=!1;void 0===a?(this.ia=we,this.sn="black"):"string"===typeof a?(this.ia=we,this.sn=a):(this.ia=a,this.sn="black");var b=this.ia;b===xe?(this.so=Ab,this.Ln=Ub):this.Ln=b===ye?this.so=Kb:this.so=xb;this.Sv=0;this.Ou=NaN;this.Eg=this.Av=this.Dg=null;this.Xx=this.Yx=0}v.ga("Brush",ha);var we;ha.Solid=we=v.p(ha,"Solid",0);var xe;ha.Linear=xe=v.p(ha,"Linear",1);var ye;
ha.Radial=ye=v.p(ha,"Radial",2);var kl;ha.Pattern=kl=v.p(ha,"Pattern",4);ha.prototype.copy=function(){var a=new ha;a.ia=this.ia;a.sn=this.sn;a.so=this.so.aa();a.Ln=this.Ln.aa();a.Sv=this.Sv;a.Ou=this.Ou;null!==this.Dg&&(a.Dg=this.Dg.copy());a.Av=this.Av;return a};ha.prototype.Ma=function(){this.freeze();Object.freeze(this);return this};ha.prototype.freeze=function(){this.Ea=!0;null!==this.Dg&&this.Dg.freeze();return this};
ha.prototype.Na=function(){Object.isFrozen(this)&&v.k("cannot thaw constant: "+this);this.Ea=!1;null!==this.Dg&&this.Dg.Na();return this};ha.prototype.toString=function(){var a="Brush(";if(this.type===we)a+=this.color;else if(a=this.type===xe?a+"Linear ":this.type===ye?a+"Radial ":this.type===kl?a+"Pattern ":a+"(unknown) ",a+=this.start+" "+this.end,null!==this.Rs)for(var b=this.Rs.i;b.next();)a+=" "+b.key+":"+b.value;return a+")"};
ha.prototype.addColorStop=ha.prototype.addColorStop=function(a,b){v.I(this);("number"!==typeof a||!isFinite(a)||1<a||0>a)&&v.ua(a,"0 <= loc <= 1",ha,"addColorStop:loc");v.j(b,"string",ha,"addColorStop:color");null===this.Dg&&(this.Dg=new ma("number","string"));this.Dg.add(a,b);this.ia===we&&(this.type=xe);this.Eg=null};
v.defineProperty(ha,{type:"type"},function(){return this.ia},function(a){v.I(this,a);v.qb(a,ha,ha,"type");this.ia=a;this.start.me()&&(a===xe?this.start=Ab:a===ye&&(this.start=Kb));this.end.me()&&(a===xe?this.end=Ub:a===ye&&(this.end=Kb));this.Eg=null});v.defineProperty(ha,{color:"color"},function(){return this.sn},function(a){v.I(this,a);this.sn=a;this.Eg=null});v.defineProperty(ha,{start:"start"},function(){return this.so},function(a){v.I(this,a);v.C(a,L,ha,"start");this.so=a.aa();this.Eg=null});
v.defineProperty(ha,{end:"end"},function(){return this.Ln},function(a){v.I(this,a);v.C(a,L,ha,"end");this.Ln=a.aa();this.Eg=null});v.defineProperty(ha,{Xt:"startRadius"},function(){return this.Sv},function(a){v.I(this,a);v.Te(a,ha,"startRadius");0>a&&v.ua(a,">= zero",ha,"startRadius");this.Sv=a;this.Eg=null});v.defineProperty(ha,{Us:"endRadius"},function(){return this.Ou},function(a){v.I(this,a);v.Te(a,ha,"endRadius");0>a&&v.ua(a,">= zero",ha,"endRadius");this.Ou=a;this.Eg=null});
v.defineProperty(ha,{Rs:"colorStops"},function(){return this.Dg},function(a){v.I(this,a);this.Dg=a;this.Eg=null});v.defineProperty(ha,{pattern:"pattern"},function(){return this.Av},function(a){v.I(this,a);this.Av=a;this.Eg=null});
ha.randomColor=function(a,b){void 0===a&&(a=128);void 0===b&&(b=Math.max(a,255));var c=Math.abs(b-a),d=Math.floor(a+Math.random()*c).toString(16),e=Math.floor(a+Math.random()*c).toString(16),c=Math.floor(a+Math.random()*c).toString(16);2>d.length&&(d="0"+d);2>e.length&&(e="0"+e);2>c.length&&(c="0"+c);return"#"+d+e+c};var ll=v.createElement("canvas").getContext("2d"),ga;
ha.isValidColor=ga=function(a){if("black"===a)return!0;if(""===a)return!1;ll.fillStyle="#000000";var b=ll.fillStyle;ll.fillStyle=a;if(ll.fillStyle!==b)return!0;ll.fillStyle="#FFFFFF";b=ll.fillStyle;ll.fillStyle=a;return ll.fillStyle!==b};
function R(){v.cc(this);this.fa=30723;this.Kc=1;this.Pg=null;this.Ob="";this.lc=this.Jb=null;this.Xa=(new w(NaN,NaN)).freeze();this.gf=(new ia(NaN,NaN)).freeze();this.yj=K.Np;this.wj=K.RF;this.Td=new ja;this.nn=new ja;this.Jk=new ja;this.Tb=this.Lu=1;this.on=0;this.Ph=ml;this.gr=K.Mp;this.Vc=(new z(NaN,NaN,NaN,NaN)).freeze();this.kc=(new z(NaN,NaN,NaN,NaN)).freeze();this.Jc=(new z(0,0,NaN,NaN)).freeze();this.ts=this.Aq=this.S=this.Hr=this.lm=null;this.us=this.Bq=Infinity;this.Up=this.te=yc;this.Vr=
0;this.Di=1;this.aq=0;this.hi=1;this.ns=null;this.$r=-Infinity;this.Zr=0;this.as=K.fk;this.bs=gh;this.kq="";this.Hc=this.R=null;this.qn=-1;this.km=this.hs=this.gi=this.Nl=this.ro=null}v.Uh(R);v.ga("GraphObject",R);
R.prototype.cloneProtected=function(a){a.fa=this.fa|6144;a.Kc=this.Kc;a.Ob=this.Ob;a.Jb=this.Jb;a.lc=this.lc;a.Xa.assign(this.Xa);a.gf.assign(this.gf);a.yj=this.yj.aa();a.wj=this.wj.aa();a.Jk=this.Jk.copy();a.Tb=this.Tb;a.on=this.on;a.Ph=this.Ph;a.gr=this.gr.aa();a.Vc.assign(this.Vc);a.kc.assign(this.kc);a.Jc.assign(this.Jc);a.Hr=this.Hr;a.S=null!==this.S?this.S.copy():null;a.Aq=this.Aq;a.Bq=this.Bq;a.ts=this.ts;a.us=this.us;a.te=this.te.aa();a.Up=this.Up.aa();a.Vr=this.Vr;a.Di=this.Di;a.aq=this.aq;
a.hi=this.hi;a.ns=this.ns;a.$r=this.$r;a.Zr=this.Zr;a.as=this.as.aa();a.bs=this.bs;a.kq=this.kq;a.R=null!==this.R?this.R.copy():null;a.Hc=this.Hc;a.qn=this.qn;if(null!==this.Nl){a.Nl=v.$k(this.Nl);for(var b=0;b<this.Nl.length;b++){var c=this.Nl[b];a[c]=this[c]}}null!==this.gi&&(a.gi=this.gi.copy());a.hs=this.hs};R.prototype.Vh=function(a){a.lm=null;a.km=null;a.P()};R.prototype.clone=function(){var a=new this.constructor;this.cloneProtected(a);return a};R.prototype.copy=function(){return this.clone()};
R.prototype.toString=function(){return v.nf(Object.getPrototypeOf(this))+"#"+v.cd(this)};var th;R.None=th=v.p(R,"None",0);var ml;R.Default=ml=v.p(R,"Default",0);var nl;R.Vertical=nl=v.p(R,"Vertical",4);var ol;R.Horizontal=ol=v.p(R,"Horizontal",5);var ed;R.Fill=ed=v.p(R,"Fill",3);var vh;R.Uniform=vh=v.p(R,"Uniform",1);var wh;R.UniformToFill=wh=v.p(R,"UniformToFill",2);function pl(a){a.R=new ql}
R.prototype.Je=function(){var a=new rl;a.lj=xb;a.Mj=xb;a.jj=10;a.Kj=10;a.ij=sl;a.Jj=sl;a.kj=0;a.Lj=0;this.S=a};function tl(a,b,c,d,e,f,h){var k=.001,l=f.length;a.moveTo(b,c);d-=b;k=e-c;0===d&&(d=.001);e=k/d;for(var m=Math.sqrt(d*d+k*k),n=0,p=!0,q=0===h?!1:!0;.1<=m;){if(q){k=f[n++%l];for(k-=h;0>k;)k+=f[n++%l],p=!p;q=!1}else k=f[n++%l];k>m&&(k=m);var r=Math.sqrt(k*k/(1+e*e));0>d&&(r=-r);b+=r;c+=e*r;p?a.lineTo(b,c):a.moveTo(b,c);m-=k;p=!p}}
R.prototype.raiseChangedEvent=R.prototype.Ec=function(a,b,c,d,e,f,h){var k=this.V;null!==k&&(k.bn(a,b,c,d,e,f,h),0!==(this.fa&1024)&&c===this&&a===Od&&ul(this,k,b))};
function ul(a,b,c){var d=a.So();if(null!==d)for(var e=a.Hc.i;e.next();){var f=e.value,h=null;if(null!==f.dn){h=ff(f,d,a);if(null===h)continue;f.Bx(a,h,c,null)}else if(f.$t){var k=b.g;null!==k&&f.Bx(a,k.da.yt,c,k)}else{var l=d.data;if(null===l)continue;k=b.g;null!==k&&k.yx||f.Bx(a,l,c,k)}null!==h&&(k=d.Dw(f.Dl),null!==k&&f.GF(k,h,c))}}R.prototype.Dw=function(a){return this.qn===a?this:null};R.prototype.raiseChanged=R.prototype.h=function(a,b,c){this.Ec(Od,a,this,b,c)};
function vl(a,b,c,d,e){var f=a.Vc,h=a.Jk;h.reset();wl(a,h,b,c,d,e);a.Jk=h;f.x=b;f.y=c;f.width=d;f.height=e;h.nt()||h.DF(f)}function xl(a,b,c,d){if(!1===a.yg)return!1;d.multiply(a.transform);return c?a.tg(b,d):a.Hm(b,d)}
R.prototype.$D=function(a,b,c){if(!1===this.yg)return!1;var d=this.Fa;b=a.Tj(b);var e=!1;c&&(e=Ya(a.x,a.y,0,0,0,d.height)<b||Ya(a.x,a.y,0,d.height,d.width,d.height)<b||Ya(a.x,a.y,d.width,d.height,d.width,0)<b||Ya(a.x,a.y,d.width,0,0,0)<b);c||(e=Ya(a.x,a.y,0,0,0,d.height)<b&&Ya(a.x,a.y,0,d.height,d.width,d.height)<b&&Ya(a.x,a.y,d.width,d.height,d.width,0)<b&&Ya(a.x,a.y,d.width,0,0,0)<b);return e};R.prototype.Vf=function(){return!0};
R.prototype.containsPoint=R.prototype.Ca=function(a){var b=v.M();b.assign(a);this.transform.xb(b);var c=this.Z;if(!c.H())return!1;var d=this.g;if(null!==d&&d.Gy){var e=d.Wo("extraTouchThreshold"),f=d.Wo("extraTouchArea"),h=f/2,k=this.Fa,d=this.Si()*d.scale,l=1/d;if(k.width*d<e&&k.height*d<e)return a=sb(c.x-h*l,c.y-h*l,c.width+f*l,c.height+f*l,b.x,b.y),v.v(b),a}if(this instanceof mf||this instanceof X?sb(c.x-5,c.y-5,c.width+10,c.height+10,b.x,b.y):c.Ca(b)){if(this.gi&&!this.gi.Ca(b))return!1;if(null!==
this.lc&&c.Ca(b)||null!==this.Jb&&this.Jc.Ca(a))return!0;v.v(b);return this.Rj(a)}v.v(b);return!1};R.prototype.Rj=function(a){var b=this.Fa;return sb(0,0,b.width,b.height,a.x,a.y)};R.prototype.containsRect=R.prototype.Sj=function(a){if(0===this.angle)return this.Z.Sj(a);var b=this.Fa,b=v.ek(0,0,b.width,b.height),c=this.transform,d=!1,e=v.Rb(a.x,a.y);b.Ca(c.Xh(e))&&(e.m(a.x,a.bottom),b.Ca(c.Xh(e))&&(e.m(a.right,a.bottom),b.Ca(c.Xh(e))&&(e.m(a.right,a.y),b.Ca(c.Xh(e))&&(d=!0))));v.v(e);v.fc(b);return d};
R.prototype.containedInRect=R.prototype.Hm=function(a,b){if(void 0===b)return a.Sj(this.Z);var c=this.Fa,d=!1,e=v.Rb(0,0);a.Ca(b.xb(e))&&(e.m(0,c.height),a.Ca(b.xb(e))&&(e.m(c.width,c.height),a.Ca(b.xb(e))&&(e.m(c.width,0),a.Ca(b.xb(e))&&(d=!0))));return d};
R.prototype.intersectsRect=R.prototype.tg=function(a,b){if(void 0===b&&(b=this.transform,0===this.angle))return a.tg(this.Z);var c=this.Fa,d=b,e=v.Rb(0,0),f=v.Rb(0,c.height),h=v.Rb(c.width,c.height),k=v.Rb(c.width,0),l=!1;if(a.Ca(d.xb(e))||a.Ca(d.xb(f))||a.Ca(d.xb(h))||a.Ca(d.xb(k)))l=!0;else{var c=v.ek(0,0,c.width,c.height),m=v.Rb(a.x,a.y);c.Ca(d.Xh(m))?l=!0:(m.m(a.x,a.bottom),c.Ca(d.Xh(m))?l=!0:(m.m(a.right,a.bottom),c.Ca(d.Xh(m))?l=!0:(m.m(a.right,a.y),c.Ca(d.Xh(m))&&(l=!0))));v.v(m);v.fc(c);!l&&
(K.Mw(a,e,f)||K.Mw(a,f,h)||K.Mw(a,h,k)||K.Mw(a,k,e))&&(l=!0)}v.v(e);v.v(f);v.v(h);v.v(k);return l};R.prototype.getDocumentPoint=R.prototype.fb=function(a,b){void 0===b&&(b=new w);a.me()&&v.k("getDocumentPoint:s Spot must be specific: "+a.toString());var c=this.Fa;b.m(a.x*c.width+a.offsetX,a.y*c.height+a.offsetY);this.Ef.xb(b);return b};R.prototype.getDocumentAngle=R.prototype.jl=function(){var a;a=this.Ef;1===a.m11&&0===a.m12?a=0:(a=180*Math.atan2(a.m12,a.m11)/Math.PI,0>a&&(a+=360));return a};
R.prototype.getDocumentScale=R.prototype.Si=function(){if(0!==(this.fa&4096)===!1)return this.Lu;var a=this.Tb;return null!==this.T?a*this.T.Si():a};R.prototype.getLocalPoint=R.prototype.fE=function(a,b){void 0===b&&(b=new w);b.assign(a);this.Ef.Xh(b);return b};R.prototype.getNearestIntersectionPoint=R.prototype.ml=function(a,b,c){return this.Xo(a.x,a.y,b.x,b.y,c)};g=R.prototype;
g.Xo=function(a,b,c,d,e){var f=this.transform,h=1/(f.m11*f.m22-f.m12*f.m21),k=f.m22*h,l=-f.m12*h,m=-f.m21*h,n=f.m11*h,p=h*(f.m21*f.dy-f.m22*f.dx),q=h*(f.m12*f.dx-f.m11*f.dy);if(null!==this.Cm)return f=this.Z,K.ml(f.left,f.top,f.right,f.bottom,a,b,c,d,e);h=a*k+b*m+p;a=a*l+b*n+q;b=c*k+d*m+p;c=c*l+d*n+q;e.m(0,0);d=this.Fa;c=K.ml(0,0,d.width,d.height,h,a,b,c,e);e.transform(f);return c};
function Rh(a,b,c,d,e){if(!1!==Jj(a)){var f=a.margin,h=f.right+f.left,f=f.top+f.bottom;b=Math.max(b-h,0);c=Math.max(c-f,0);e=e||0;d=Math.max((d||0)-h,0);e=Math.max(e-f,0);var h=a.angle,f=0,f=a.xa,k=0;a.nb&&(k=a.nb);90===h||270===h?(b=isFinite(f.height)?f.height+k:b,c=isFinite(f.width)?f.width+k:c):(b=isFinite(f.width)?f.width+k:b,c=isFinite(f.height)?f.height+k:c);var f=d||0,k=e||0,l=a instanceof C;switch(yl(a,!0)){case th:k=f=0;l&&(c=b=Infinity);break;case ed:isFinite(b)&&b>d&&(f=b);isFinite(c)&&
c>e&&(k=c);break;case ol:isFinite(b)&&b>d&&(f=b);k=0;l&&(c=Infinity);break;case nl:isFinite(c)&&c>e&&(k=c),f=0,l&&(b=Infinity)}var l=a.af,m=a.ug;f>l.width&&m.width<l.width&&(f=l.width);k>l.height&&m.height<l.height&&(k=l.height);d=Math.max(f/a.scale,m.width);e=Math.max(k/a.scale,m.height);l.width<d&&(d=Math.min(m.width,d));l.height<e&&(e=Math.min(m.height,e));b=Math.min(l.width,b);c=Math.min(l.height,c);b=Math.max(d,b);c=Math.max(e,c);if(90===h||270===h)f=b,b=c,c=f,f=d,d=e,e=f;a.Vc.Na();a.ip(b,c,
d,e);a.Vc.freeze();a.Vc.H()||v.k("Non-real measuredBounds has been set. Object "+a+", measuredBounds: "+a.Vc.toString());Dj(a,!1)}}
g.zc=function(a,b,c,d,e){this.pi();var f=v.Uf();f.assign(this.kc);this.kc.Na();if(!1===Kj(this)){var h=this.kc;h.x=a;h.y=b;h.width=c;h.height=d}else this.Li(a,b,c,d);this.kc.freeze();this.gi=void 0===e?null:e;c=!1;void 0!==e?c=!0:null!==this.T&&(e=this.T.Jc,d=this.Ba,null!==this.Cm&&(d=this.kc),c=b+d.height,d=a+d.width,c=!(0<=a+.05&&d<=e.width+.05&&0<=b+.05&&c<=e.height+.05),this instanceof ra&&(a=this.Jc,this.lv>a.height||this.sj.Qe>a.width))&&(c=!0);this.fa=c?this.fa|256:this.fa&-257;this.kc.H()||
v.k("Non-real actualBounds has been set. Object "+this+", actualBounds: "+this.kc.toString());this.bx(f,this.kc);v.fc(f)};g.Li=function(){};
function zl(a,b,c,d,e){var f=a.Z;f.x=b;f.y=c;f.width=d;f.height=e;if(!a.xa.H()){f=a.Vc;c=a.margin;b=c.right+c.left;var h=c.top+c.bottom;c=f.width+b;f=f.height+h;d+=b;e+=h;b=yl(a,!0);c===d&&f===e&&(b=th);switch(b){case th:if(c>d||f>e)Dj(a,!0),Rh(a,c>d?d:c,f>e?e:f);break;case ed:Dj(a,!0);Rh(a,d,e,0,0);break;case ol:Dj(a,!0);Rh(a,d,f,0,0);break;case nl:Dj(a,!0),Rh(a,c,e,0,0)}}}
g.bx=function(a,b){Al(this,!1);var c=this.V;if(null!==c&&null!==c.g){var d=this.V;null!==d&&(d.Qt!==this&&d.ZE!==this&&d.bF!==this||Bl(d,!0));this.pa();a.L(b)||(c.ol(),this.uv(c))}};g.uv=function(a){null!==this.Od&&Bl(a,!0)};v.defineProperty(R,{Dp:"shadowVisible"},function(){return this.hs},function(a){var b=this.hs;b!==a&&(this.hs=a,this.h("shadowVisible",b,a))});
R.prototype.Ve=function(a,b){if(this.visible){var c=this.opacity,d=1;if(1!==c){if(0===c)return;d=a.globalAlpha;a.globalAlpha=d*c}if(a instanceof Ic)a:{if(this.visible){var e=null,f=a.Uw;if(this instanceof C&&(this.type===Cl||this.type===Dl))El(this,a,b);else{var h=this.kc;if(0!==h.width&&0!==h.height&&!isNaN(h.x)&&!isNaN(h.y)){var k=this.transform,l=this.T;0!==(this.fa&4096)===!0&&Fl(this);var m=0!==(this.fa&256),n=!1;this instanceof ra&&Gl(this,a);if(m){n=l.Vf()?l.Fa:l.Z;if(this.gi)var p=this.gi,
q=p.x,r=p.y,s=p.width,p=p.height;else q=Math.max(h.x,n.x),r=Math.max(h.y,n.y),s=Math.min(h.right,n.right)-q,p=Math.min(h.bottom,n.bottom)-r;if(q>h.width+h.x||h.x>n.width+n.x||r>h.height+h.y||h.y>n.height+n.y)break a;n=!0;Kc(a,1,0,0,1,0,0);a.save();a.beginPath();a.rect(q,r,s,p);a.clip()}q=!1;if(this instanceof J){var t=this,q=!0;if(!t.isVisible())break a}a.Qi.$e=[1,0,0,1,0,0];r=!1;q&&this.tl&&b.Yj("drawShadows")&&(s=this.tm,b.Wy=s.x*b.scale*b.ze,b.Xy=s.y*b.scale*b.ze,b.Mh=t.Mh,b.Rg=t.Rg,Hl(b,a),a.shadowColor=
b.Rg);t=!1;this.V&&b.Yj("drawShadows")&&(t=this.V.tl);!0===this.Dp?(Hl(b,a),!1===r&&t&&(Kc(a,1,0,0,1,0,0),a.Ya(),r=!0)):!1===this.Dp&&Il(a);null!==this.lc&&(Jl(this,a,this.lc,!0,!0),!1===r&&t&&(Kc(a,1,0,0,1,0,0),a.Ya(),r=!0),this.lc instanceof ha&&this.lc.type===ye?(a.beginPath(),a.rect(h.x,h.y,h.width,h.height),Kl(a,this.lc)):a.fillRect(h.x,h.y,h.width,h.height));this instanceof C?Kc(a,k.m11,k.m12,k.m21,k.m22,k.dx,k.dy):a.Qi.$e=[k.m11,k.m12,k.m21,k.m22,k.dx,k.dy];if(null!==this.Jb){!1===r&&t&&(Kc(a,
1,0,0,1,0,0),a.Ya(),r=!0);var p=this.Fa,k=h=0,s=p.width,p=p.height,u=0;this instanceof X&&(p=this.Ta.pb,h=p.x,k=p.y,s=p.width,p=p.height,u=this.Sg);Jl(this,a,this.Jb,!0,!1);this.Jb instanceof ha&&this.Jb.type===ye?(a.beginPath(),a.rect(h-u/2,k-u/2,s+u,p+u),Kl(a,this.Jb)):a.fillRect(h-u/2,k-u/2,s+u,p+u)}t&&(null!==this.Jb||null!==this.lc||null!==l&&0!==(l.fa&512)||null!==l&&(l.type===gj||l.type===rh)&&l.If()!==this)?(Ll(this,!0),null===this.Dp&&Il(a)):Ll(this,!1);this.Uj(a,b);t&&0!==(this.fa&512)===
!0&&Hl(b,a);q&&t&&Il(a);m&&(a.restore(),n&&a.of.pop(),ij(b,a));this instanceof C&&(e=a.of.pop());!0===r&&a.of.pop();null!==a.VD&&(null===e&&(f===a.Uw?(Kc(a,1,0,0,1,0,0),e=a.of.pop()):e=a.Uw),a.VD(this,e))}}}}else{if(this instanceof C&&(this.type===Cl||this.type===Dl)){El(this,a,b);1!==c&&(a.globalAlpha=d);return}m=this.kc;if(0!==m.width&&0!==m.height&&!isNaN(m.x)&&!isNaN(m.y)){this instanceof W&&this.wt(!1);e=this.transform;f=this.T;0!==(this.fa&4096)===!0&&Fl(this);l=0!==(this.fa&256);this instanceof
ra&&Gl(this,a);if(l){n=f.Vf()?f.Fa:f.Z;this.gi?(r=this.gi,h=r.x,k=r.y,q=r.width,r=r.height):(h=Math.max(m.x,n.x),k=Math.max(m.y,n.y),q=Math.min(m.right,n.right)-h,r=Math.min(m.bottom,n.bottom)-k);if(h>m.width+m.x||m.x>n.width+n.x||k>m.height+m.y||m.y>n.height+n.y){1!==c&&(a.globalAlpha=d);return}a.save();a.beginPath();a.rect(h,k,q,r);a.clip()}n=!1;if(this instanceof J){n=!0;if(!this.isVisible()){1!==c&&(a.globalAlpha=d);return}this.tl&&b.Yj("drawShadows")&&(h=this.tm,b.Wy=h.x*b.scale*b.ze,b.Xy=h.y*
b.scale*b.ze,b.Mh=this.Mh,b.Rg=this.Rg,Hl(b,a),a.shadowColor=b.Rg)}h=!1;this.V&&b.Yj("drawShadows")&&(h=this.V.tl);!0===this.Dp?Hl(b,a):!1===this.Dp&&Il(a);null!==this.lc&&(Jl(this,a,this.lc,!0,!0),this.lc instanceof ha&&this.lc.type===ye?(a.beginPath(),a.rect(m.x,m.y,m.width,m.height),Kl(a,this.lc)):a.fillRect(m.x,m.y,m.width,m.height));e.nt()||a.transform(e.m11,e.m12,e.m21,e.m22,e.dx,e.dy);null!==this.Jb&&(r=this.Fa,k=m=0,q=r.width,r=r.height,t=0,this instanceof X&&(r=this.Ta.pb,m=r.x,k=r.y,q=r.width,
r=r.height,t=this.Sg),Jl(this,a,this.Jb,!0,!1),this.Jb instanceof ha&&this.Jb.type===ye?(a.beginPath(),a.rect(m-t/2,k-t/2,q+t,r+t),Kl(a,this.Jb)):a.fillRect(m-t/2,k-t/2,q+t,r+t));h&&(null!==this.Jb||null!==this.lc||null!==f&&0!==(f.fa&512)||null!==f&&(f.type===gj||f.type===rh)&&f.If()!==this)?(Ll(this,!0),null===this.Dp&&Il(a)):Ll(this,!1);this.Uj(a,b);h&&0!==(this.fa&512)===!0&&Hl(b,a);n&&h&&Il(a);l?(a.restore(),this instanceof C?ij(b,a,!0):ij(b,a,!1)):e.nt()||(f=1/(e.m11*e.m22-e.m12*e.m21),a.transform(e.m22*
f,-e.m12*f,-e.m21*f,e.m11*f,f*(e.m21*e.dy-e.m22*e.dx),f*(e.m12*e.dx-e.m11*e.dy)))}}1!==c&&(a.globalAlpha=d)}};function Il(a){a.shadowOffsetX=0;a.shadowOffsetY=0;a.shadowBlur=0}function Hl(a,b){b.shadowOffsetX=a.Wy;b.shadowOffsetY=a.Xy;b.shadowBlur=a.Mh}
function El(a,b,c){var d=a.kc;0===d.width||0===d.height||isNaN(d.x)||isNaN(d.y)||(null!==a.lc&&(Jl(a,b,a.lc,!0,!0),a.lc instanceof ha&&a.lc.type===ye?(b.beginPath(),b.rect(d.x,d.y,d.width,d.height),Kl(b,a.lc)):b.fillRect(d.x,d.y,d.width,d.height)),null!==a.Jb&&(Jl(a,b,a.Jb,!0,!1),a.Jb instanceof ha&&a.Jb.type===ye?(b.beginPath(),b.rect(d.x,d.y,d.width,d.height),Kl(b,a.Jb)):b.fillRect(d.x,d.y,d.width,d.height)),a.Uj(b,c))}R.prototype.Uj=function(){};
function Kl(a,b){if(b instanceof ha&&b.type===ye&&!(a instanceof Ic)){var c=b.Yx,d=b.Xx;d>c?(a.scale(c/d,1),a.translate((d-c)/2,0)):c>d&&(a.scale(1,d/c),a.translate(0,(c-d)/2));a.hu?a.clip():a.fill();d>c?(a.translate(-(d-c)/2,0),a.scale(1/(c/d),1)):c>d&&(a.translate(0,-(c-d)/2),a.scale(1,1/(d/c)))}else a.hu?a.clip():a.fill()}function Ml(a){a.hu||a.stroke()}
function Jl(a,b,c,d,e){if(null!==c){var f=1,h=1;if("string"===typeof c)d?b.hn!==c&&(b.fillStyle=c,b.hn=c):b.jn!==c&&(b.strokeStyle=c,b.jn=c);else if(c.type===we)c=c.color,d?b.hn!==c&&(b.fillStyle=c,b.hn=c):b.jn!==c&&(b.strokeStyle=c,b.jn=c);else{var k,h=a.Fa,f=h.width,h=h.height;if(e)var l=a.Z,f=l.width,h=l.height;var m=b instanceof CanvasRenderingContext2D;if(m&&(c.Eg&&c.type===kl||c.Yx===f&&c.Xx===h))k=c.Eg;else{var n=l=0,p=0,q=0,r=0,s=0,s=r=0;e&&(l=a.Z,f=l.width,h=l.height,r=l.x,s=l.y);l=c.start.x*
f+c.start.offsetX;n=c.start.y*h+c.start.offsetY;p=c.end.x*f+c.end.offsetX;q=c.end.y*h+c.end.offsetY;l+=r;p+=r;n+=s;q+=s;c.type===xe?k=b.createLinearGradient(l,n,p,q):c.type===ye?(s=isNaN(c.Us)?Math.max(f,h)/2:c.Us,isNaN(c.Xt)?(r=0,s=Math.max(f,h)/2):r=c.Xt,k=b.createRadialGradient(l,n,r,p,q,s)):c.type===kl?k=b.createPattern(c.pattern,"repeat"):v.Ad(c.type,"Brush type");if(c.type!==kl&&(a=c.Rs,null!==a))for(a=a.i;a.next();)k.addColorStop(a.key,a.value);m&&(c.Eg=k,c.Yx=f,c.Xx=h)}d?b.hn!==k&&(b.fillStyle=
k,b.hn=k):b.jn!==k&&(b.strokeStyle=k,b.jn=k)}}}R.prototype.isContainedBy=R.prototype.rl=function(a){if(a instanceof C)a:{if(this!==a&&null!==a)for(var b=this.T;null!==b;){if(b===a){a=!0;break a}b=b.T}a=!1}else a=!1;return a};R.prototype.isVisibleObject=R.prototype.ul=function(){if(!this.visible)return!1;var a=this.T;return null!==a?a.ul():!0};
function Fl(a){if(0!==(a.fa&2048)===!0){var b=a.Td;b.reset();if(!a.kc.H()||!a.Vc.H()){Nl(a,!1);return}b.translate(a.kc.x,a.kc.y);b.translate(-a.Ba.x,-a.Ba.y);var c=a.Fa;wl(a,b,c.x,c.y,c.width,c.height);Nl(a,!1);Ol(a,!0)}0!==(a.fa&4096)===!0&&(b=a.T,null===b?(a.nn.set(a.Td),a.Lu=a.scale,Ol(a,!1)):null!==b.Ef&&(c=a.nn,c.reset(),b.Vf()?c.multiply(b.nn):null!==b.T&&c.multiply(b.T.nn),c.multiply(a.Td),a.Lu=a.scale*b.Lu,Ol(a,!1)))}
function wl(a,b,c,d,e,f){1!==a.scale&&b.scale(a.scale);if(0!==a.angle){var h=Kb;a.Ze&&a.Ze.yd()&&(h=a.Ze);var k=v.M();if(a instanceof J&&a.ac!==a)for(c=a.ac,d=c.Fa,k.Ut(d.x,d.y,d.width,d.height,h),c.Jk.xb(k),k.offset(-c.Ba.x,-c.Ba.y),h=c.T;null!==h&&h!==a;)h.Jk.xb(k),k.offset(-h.Ba.x,-h.Ba.y),h=h.T;else k.Ut(c,d,e,f,h);b.rotate(a.angle,k.x,k.y);v.v(k)}}g=R.prototype;
g.P=function(a){void 0===a&&(a=!1);if(!0!==Jj(this)){Dj(this,!0);Al(this,!0);var b=this.T;null!==b?a||b.P():(a=this.g,null!==a&&(a.Zf.add(this),this instanceof S&&(a.ja.ib||this.invalidateConnectedLinks(),null!==this.ce&&Pl(this.ce)),a.de(!0)));if(this instanceof C){if(this.ia===gj||this.ia===dh)a=this.If(),null!==a&&a.P(!0);a=this.wa.n;for(var b=a.length,c=0;c<b;c++){var d=a[c];!0!==Jj(d)&&(d.xa.H()||(d instanceof sh||d instanceof C||d instanceof ra||yl(d,!1)!==th)&&d.P(!0))}}}};
g.$o=function(){!1===Jj(this)&&(Dj(this,!0),Al(this,!0))};function Pl(a){if(!1===Kj(a)){if(null!==a.T)a.T.P();else{var b=a.g;null!==b&&(b.Zf.add(a),a instanceof S&&a.invalidateConnectedLinks(),b.de())}Al(a,!0)}}g.pi=function(){0!==(this.fa&2048)===!1&&(Nl(this,!0),Ol(this,!0))};g.Oz=function(){Ol(this,!0)};g.pa=function(){var a=this.V;null!==a&&a.pa()};
function yl(a,b){var c=a.stretch,d=a.T;if(null!==d&&d.ia===Ql)return Rl(a,d.bd(a.bc),d.ad(a.column),b);if(null!==d&&d.ia===gj&&d.If()===a)return Sl(a,ed,b);if(c===ml){if(null!==d){if(d.ia===rh&&d.If()===a)return Sl(a,ed,b);c=d.Hd;return c===ml?Sl(a,th,b):Sl(a,c,b)}return Sl(a,th,b)}return Sl(a,c,b)}
function Rl(a,b,c,d){var e=a.stretch;if(e!==ml)return Sl(a,e,d);var f=e=null;switch(b.stretch){case nl:f=!0;break;case ed:f=!0}switch(c.stretch){case ol:e=!0;break;case ed:e=!0}b=a.T.Hd;null===e&&(e=b===ol||b===ed);null===f&&(f=b===nl||b===ed);return!0===e&&!0===f?Sl(a,ed,d):!0===e?Sl(a,ol,d):!0===f?Sl(a,nl,d):Sl(a,th,d)}
function Sl(a,b,c){if(c)return b;if(b===th)return th;c=a.xa;if(c.H())return th;a=a.angle;if(!isNaN(c.width))if(90!==a&&270!==a){if(b===ol)return th;if(b===ed)return nl}else{if(b===nl)return th;if(b===ed)return ol}if(!isNaN(c.height))if(90!==a&&270!==a){if(b===nl)return th;if(b===ed)return ol}else{if(b===ol)return th;if(b===ed)return nl}return b}
v.defineProperty(R,{Pt:"segmentOrientation"},function(){return this.bs},function(a){var b=this.bs;b!==a&&(this.bs=a,this.P(),this.h("segmentOrientation",b,a))});v.defineProperty(R,{pe:"segmentIndex"},function(){return this.$r},function(a){a=Math.round(a);var b=this.$r;b!==a&&(this.$r=a,this.P(),this.h("segmentIndex",b,a))});
v.defineProperty(R,{qx:"segmentFraction"},function(){return this.Zr},function(a){isNaN(a)?a=0:0>a?a=0:1<a&&(a=1);var b=this.Zr;b!==a&&(this.Zr=a,this.P(),this.h("segmentFraction",b,a))});v.defineProperty(R,{hF:"segmentOffset"},function(){return this.as},function(a){var b=this.as;b.L(a)||(this.as=a=a.aa(),this.P(),this.h("segmentOffset",b,a))});v.defineProperty(R,{stretch:"stretch"},function(){return this.Ph},function(a){var b=this.Ph;b!==a&&(this.Ph=a,this.P(),this.h("stretch",b,a))});
v.defineProperty(R,{name:"name"},function(){return this.Ob},function(a){var b=this.Ob;b!==a&&(this.Ob=a,null!==this.V&&(this.V.Mk=null),this.h("name",b,a))});v.defineProperty(R,{opacity:"opacity"},function(){return this.Kc},function(a){var b=this.Kc;b!==a&&(v.j(a,"number",R,"opacity"),(0>a||1<a)&&v.ua(a,"0 <= value <= 1",R,"opacity"),this.Kc=a,this.h("opacity",b,a),a=this.g,b=this.V,null!==a&&null!==b&&a.pa(Pi(b,b.Z)))});
v.defineProperty(R,{visible:"visible"},function(){return 0!==(this.fa&1)},function(a){var b=0!==(this.fa&1);b!==a&&(this.fa^=1,this.h("visible",b,a),b=this.T,null!==b?b.P():this instanceof J&&this.oe(a),this.pa(),Tl(this))});v.defineProperty(R,{yg:"pickable"},function(){return 0!==(this.fa&2)},function(a){var b=0!==(this.fa&2);b!==a&&(this.fa^=2,this.h("pickable",b,a))});
v.defineProperty(R,{oH:"fromLinkableDuplicates"},function(){return 0!==(this.fa&4)},function(a){var b=0!==(this.fa&4);b!==a&&(this.fa^=4,this.h("fromLinkableDuplicates",b,a))});v.defineProperty(R,{pH:"fromLinkableSelfNode"},function(){return 0!==(this.fa&8)},function(a){var b=0!==(this.fa&8);b!==a&&(this.fa^=8,this.h("fromLinkableSelfNode",b,a))});
v.defineProperty(R,{gJ:"toLinkableDuplicates"},function(){return 0!==(this.fa&16)},function(a){var b=0!==(this.fa&16);b!==a&&(this.fa^=16,this.h("toLinkableDuplicates",b,a))});v.defineProperty(R,{hJ:"toLinkableSelfNode"},function(){return 0!==(this.fa&32)},function(a){var b=0!==(this.fa&32);b!==a&&(this.fa^=32,this.h("toLinkableSelfNode",b,a))});
v.defineProperty(R,{Lf:"isPanelMain"},function(){return 0!==(this.fa&64)},function(a){var b=0!==(this.fa&64);b!==a&&(this.fa^=64,this.P(),this.h("isPanelMain",b,a))});v.defineProperty(R,{Nw:"isActionable"},function(){return 0!==(this.fa&128)},function(a){var b=0!==(this.fa&128);b!==a&&(this.fa^=128,this.h("isActionable",b,a))});
v.defineProperty(R,{Cm:"areaBackground"},function(){return this.lc},function(a){var b=this.lc;b!==a&&(a instanceof ha&&a.freeze(),this.lc=a,this.pa(),this.h("areaBackground",b,a))});v.defineProperty(R,{background:"background"},function(){return this.Jb},function(a){var b=this.Jb;b!==a&&(a instanceof ha&&a.freeze(),this.Jb=a,this.pa(),this.h("background",b,a))});function Ll(a,b){a.fa=b?a.fa|512:a.fa&-513}function Ul(a,b){a.fa=b?a.fa|1024:a.fa&-1025}function Nl(a,b){a.fa=b?a.fa|2048:a.fa&-2049}
function Ol(a,b){a.fa=b?a.fa|4096:a.fa&-4097}function Jj(a){return 0!==(a.fa&8192)}function Dj(a,b){a.fa=b?a.fa|8192:a.fa&-8193}function Kj(a){return 0!==(a.fa&16384)}function Al(a,b){a.fa=b?a.fa|16384:a.fa&-16385}v.u(R,{V:"part"},function(){if(this instanceof J)return this;if(this.km)return this.km;var a;for(a=this.T;a;){if(a instanceof J)return this.km=a;a=a.T}return null});v.u(R,{T:"panel"},function(){return this.Pg});R.prototype.Al=function(a){this.Pg=a};
v.u(R,{layer:"layer"},function(){var a=this.V;return null!==a?a.layer:null});v.u(R,{g:"diagram"},function(){var a=this.V;return null!==a?a.g:null},{configurable:!0});v.defineProperty(R,{position:"position"},function(){return this.Xa},function(a){var b=this.Xa;b.L(a)||(a=a.aa(),this.CA(a,b)&&this.h("position",b,a))});R.prototype.CA=function(a){this.Xa=a;Pl(this);this.pi();return!0};R.prototype.DA=function(a,b){this.Xa.m(a,b);Vl(this,!0);this.pi()};v.u(R,{Z:"actualBounds"},function(){return this.kc});
v.defineProperty(R,{scale:"scale"},function(){return this.Tb},function(a){var b=this.Tb;b!==a&&(0>=a&&v.k("GraphObject.scale for "+this+" must be greater than zero, not: "+a),this.Tb=a,this.pi(),this.P(),this.h("scale",b,a))});v.defineProperty(R,{angle:"angle"},function(){return this.on},function(a){var b=this.on;b!==a&&(a%=360,0>a&&(a+=360),b!==a&&(this.on=a,this.P(),this.pi(),this.h("angle",b,a)))});
v.defineProperty(R,{xa:"desiredSize"},function(){return this.gf},function(a){var b=this.gf;b.L(a)||(this.gf=a=a.aa(),this.P(),this instanceof X&&this.Ye(),this.h("desiredSize",b,a),a=this.V,null!==a&&0!==(this.fa&1024)&&(ul(this,a,"width"),ul(this,a,"height")))});
v.defineProperty(R,{width:"width"},function(){return this.gf.width},function(a){if(this.gf.width!==a){var b=this.gf;this.gf=a=(new ia(a,this.gf.height)).freeze();this.P();this instanceof X&&this.Ye();this.h("desiredSize",b,a);b=this.V;null!==b&&0!==(this.fa&1024)&&ul(this,b,"width")}});
v.defineProperty(R,{height:"height"},function(){return this.gf.height},function(a){if(this.gf.height!==a){var b=this.gf;this.gf=a=(new ia(this.gf.width,a)).freeze();this.P();this instanceof X&&this.Ye();this.h("desiredSize",b,a);b=this.V;null!==b&&0!==(this.fa&1024)&&ul(this,b,"height")}});
v.defineProperty(R,{ug:"minSize"},function(){return this.yj},function(a){var b=this.yj;b.L(a)||(a=a.copy(),isNaN(a.width)&&(a.width=0),isNaN(a.height)&&(a.height=0),a.freeze(),this.yj=a,this.P(),this.h("minSize",b,a))});v.defineProperty(R,{af:"maxSize"},function(){return this.wj},function(a){var b=this.wj;b.L(a)||(a=a.copy(),isNaN(a.width)&&(a.width=Infinity),isNaN(a.height)&&(a.height=Infinity),a.freeze(),this.wj=a,this.P(),this.h("maxSize",b,a))});v.u(R,{Ba:"measuredBounds"},function(){return this.Vc});
v.u(R,{Fa:"naturalBounds"},function(){return this.Jc},{configurable:!0});v.defineProperty(R,{margin:"margin"},function(){return this.gr},function(a){"number"===typeof a&&(a=new tb(a));var b=this.gr;b.L(a)||(this.gr=a=a.aa(),this.P(),this.h("margin",b,a))});v.u(R,{transform:null},function(){0!==(this.fa&2048)===!0&&Fl(this);return this.Td});v.u(R,{Ef:null},function(){0!==(this.fa&4096)===!0&&Fl(this);return this.nn});
v.defineProperty(R,{alignment:"alignment"},function(){return this.te},function(a){var b=this.te;b.L(a)||(a.me()&&!a.Oc()&&v.k("GraphObject.alignment for "+this+" must be a real Spot or Spot.Default, not: "+a),this.te=a=a.aa(),Pl(this),this.h("alignment",b,a))});v.defineProperty(R,{column:"column"},function(){return this.aq},function(a){a=Math.round(a);var b=this.aq;b!==a&&(0>a&&v.ua(a,">= 0",R,"column"),this.aq=a,this.P(),this.h("column",b,a))});
v.defineProperty(R,{JG:"columnSpan"},function(){return this.hi},function(a){a=Math.round(a);var b=this.hi;b!==a&&(1>a&&v.ua(a,">= 1",R,"columnSpan"),this.hi=a,this.P(),this.h("columnSpan",b,a))});v.defineProperty(R,{bc:"row"},function(){return this.Vr},function(a){a=Math.round(a);var b=this.Vr;b!==a&&(0>a&&v.ua(a,">= 0",R,"row"),this.Vr=a,this.P(),this.h("row",b,a))});
v.defineProperty(R,{rowSpan:"rowSpan"},function(){return this.Di},function(a){a=Math.round(a);var b=this.Di;b!==a&&(1>a&&v.ua(a,">= 1",R,"rowSpan"),this.Di=a,this.P(),this.h("rowSpan",b,a))});v.defineProperty(R,{zx:"spanAllocation"},function(){return this.ns},function(a){var b=this.ns;b!==a&&(null!==a&&v.j(a,"function",R,"spanAllocation"),this.ns=a,this.h("spanAllocation",b,a))});
v.defineProperty(R,{Pj:"alignmentFocus"},function(){return this.Up},function(a){var b=this.Up;b.L(a)||(!a.me()||a.Oc()||a.L(xb)&&this instanceof S||v.k("GraphObject.alignmentFocus must be a real Spot or Spot.Default, not: "+a),this.Up=a=a.aa(),this.P(),this.h("alignmentFocus",b,a))});
v.defineProperty(R,{Od:"portId"},function(){return this.Hr},function(a){var b=this.Hr;if(b!==a){var c=this.V;null===c||c instanceof S||(v.k("Cannot set portID on a Link: "+a),c=null);null!==b&&null!==c&&Wl(c,this);this.Hr=a;if(null!==a&&c){c.Bh=!0;null===c.Sd&&Xl(c);var d=this.Od;null!==d&&c.Sd.add(d,this)}this.h("portId",b,a)}});function Yl(a){var b={value:null};Zl(a,b);return b.value}function Zl(a,b){var c=a.T;return null===c||!Zl(c,b)&&a.visible?(b.value=a,!1):!0}
function Tl(a){var b=a.V;b instanceof S&&(a=a.g,null===a||a.ja.ib||b.invalidateConnectedLinks())}v.defineProperty(R,{Bb:"toSpot"},function(){return null!==this.S?this.S.Mj:xb},function(a){null===this.S&&this.Je();var b=this.S.Mj;b.L(a)||(a=a.aa(),this.S.Mj=a,this.h("toSpot",b,a),Tl(this))});
v.defineProperty(R,{Fl:"toEndSegmentLength"},function(){return null!==this.S?this.S.Kj:10},function(a){null===this.S&&this.Je();var b=this.S.Kj;b!==a&&(0>a&&v.ua(a,">= 0",R,"toEndSegmentLength"),this.S.Kj=a,this.h("toEndSegmentLength",b,a),Tl(this))});v.defineProperty(R,{Zt:"toEndSegmentDirection"},function(){return null!==this.S?this.S.Jj:sl},function(a){null===this.S&&this.Je();var b=this.S.Jj;b!==a&&(this.S.Jj=a,this.h("toEndSegmentDirection",b,a),Tl(this))});
v.defineProperty(R,{au:"toShortLength"},function(){return null!==this.S?this.S.Lj:0},function(a){null===this.S&&this.Je();var b=this.S.Lj;b!==a&&(this.S.Lj=a,this.h("toShortLength",b,a),Tl(this))});v.defineProperty(R,{uF:"toLinkable"},function(){return this.ts},function(a){var b=this.ts;b!==a&&(this.ts=a,this.h("toLinkable",b,a))});v.defineProperty(R,{iJ:"toMaxLinks"},function(){return this.us},function(a){var b=this.us;b!==a&&(0>a&&v.ua(a,">= 0",R,"toMaxLinks"),this.us=a,this.h("toMaxLinks",b,a))});
v.defineProperty(R,{Ab:"fromSpot"},function(){return null!==this.S?this.S.lj:xb},function(a){null===this.S&&this.Je();var b=this.S.lj;b.L(a)||(a=a.aa(),this.S.lj=a,this.h("fromSpot",b,a),Tl(this))});v.defineProperty(R,{il:"fromEndSegmentLength"},function(){return null!==this.S?this.S.jj:10},function(a){null===this.S&&this.Je();var b=this.S.jj;b!==a&&(0>a&&v.ua(a,">= 0",R,"fromEndSegmentLength"),this.S.jj=a,this.h("fromEndSegmentLength",b,a),Tl(this))});
v.defineProperty(R,{dt:"fromEndSegmentDirection"},function(){return null!==this.S?this.S.ij:sl},function(a){null===this.S&&this.Je();var b=this.S.ij;b!==a&&(this.S.ij=a,this.h("fromEndSegmentDirection",b,a),Tl(this))});v.defineProperty(R,{et:"fromShortLength"},function(){return null!==this.S?this.S.kj:0},function(a){null===this.S&&this.Je();var b=this.S.kj;b!==a&&(this.S.kj=a,this.h("fromShortLength",b,a),Tl(this))});
v.defineProperty(R,{cE:"fromLinkable"},function(){return this.Aq},function(a){var b=this.Aq;b!==a&&(this.Aq=a,this.h("fromLinkable",b,a))});v.defineProperty(R,{qH:"fromMaxLinks"},function(){return this.Bq},function(a){var b=this.Bq;b!==a&&(0>a&&v.ua(a,">= 0",R,"fromMaxLinks"),this.Bq=a,this.h("fromMaxLinks",b,a))});v.defineProperty(R,{cursor:"cursor"},function(){return this.kq},function(a){var b=this.kq;b!==a&&(v.j(a,"string",R,"cursor"),this.kq=a,this.h("cursor",b,a))});
v.defineProperty(R,{click:"click"},function(){return null!==this.R?this.R.fi:null},function(a){null===this.R&&pl(this);var b=this.R.fi;b!==a&&(null!==a&&v.j(a,"function",R,"click"),this.R.fi=a,this.h("click",b,a))});v.defineProperty(R,{Ts:"doubleClick"},function(){return null!==this.R?this.R.ni:null},function(a){null===this.R&&pl(this);var b=this.R.ni;b!==a&&(null!==a&&v.j(a,"function",R,"doubleClick"),this.R.ni=a,this.h("doubleClick",b,a))});
v.defineProperty(R,{sz:"contextClick"},function(){return null!==this.R?this.R.ii:null},function(a){null===this.R&&pl(this);var b=this.R.ii;b!==a&&(null!==a&&v.j(a,"function",R,"contextClick"),this.R.ii=a,this.h("contextClick",b,a))});v.defineProperty(R,{zt:"mouseEnter"},function(){return null!==this.R?this.R.rr:null},function(a){null===this.R&&pl(this);var b=this.R.rr;b!==a&&(null!==a&&v.j(a,"function",R,"mouseEnter"),this.R.rr=a,this.h("mouseEnter",b,a))});
v.defineProperty(R,{At:"mouseLeave"},function(){return null!==this.R?this.R.sr:null},function(a){null===this.R&&pl(this);var b=this.R.sr;b!==a&&(null!==a&&v.j(a,"function",R,"mouseLeave"),this.R.sr=a,this.h("mouseLeave",b,a))});v.defineProperty(R,{dA:"mouseOver"},function(){return null!==this.R?this.R.zi:null},function(a){null===this.R&&pl(this);var b=this.R.zi;b!==a&&(null!==a&&v.j(a,"function",R,"mouseOver"),this.R.zi=a,this.h("mouseOver",b,a))});
v.defineProperty(R,{cA:"mouseHover"},function(){return null!==this.R?this.R.yi:null},function(a){null===this.R&&pl(this);var b=this.R.yi;b!==a&&(null!==a&&v.j(a,"function",R,"mouseHover"),this.R.yi=a,this.h("mouseHover",b,a))});v.defineProperty(R,{bA:"mouseHold"},function(){return null!==this.R?this.R.xi:null},function(a){null===this.R&&pl(this);var b=this.R.xi;b!==a&&(null!==a&&v.j(a,"function",R,"mouseHold"),this.R.xi=a,this.h("mouseHold",b,a))});
v.defineProperty(R,{oI:"mouseDragEnter"},function(){return null!==this.R?this.R.pr:null},function(a){null===this.R&&pl(this);var b=this.R.pr;b!==a&&(null!==a&&v.j(a,"function",R,"mouseDragEnter"),this.R.pr=a,this.h("mouseDragEnter",b,a))});v.defineProperty(R,{pI:"mouseDragLeave"},function(){return null!==this.R?this.R.qr:null},function(a){null===this.R&&pl(this);var b=this.R.qr;b!==a&&(null!==a&&v.j(a,"function",R,"mouseDragLeave"),this.R.qr=a,this.h("mouseDragLeave",b,a))});
v.defineProperty(R,{aA:"mouseDrop"},function(){return null!==this.R?this.R.wi:null},function(a){null===this.R&&pl(this);var b=this.R.wi;b!==a&&(null!==a&&v.j(a,"function",R,"mouseDrop"),this.R.wi=a,this.h("mouseDrop",b,a))});v.defineProperty(R,{nD:"actionDown"},function(){return null!==this.R?this.R.Pp:null},function(a){null===this.R&&pl(this);var b=this.R.Pp;b!==a&&(null!==a&&v.j(a,"function",R,"actionDown"),this.R.Pp=a,this.h("actionDown",b,a))});
v.defineProperty(R,{oD:"actionMove"},function(){return null!==this.R?this.R.Qp:null},function(a){null===this.R&&pl(this);var b=this.R.Qp;b!==a&&(null!==a&&v.j(a,"function",R,"actionMove"),this.R.Qp=a,this.h("actionMove",b,a))});v.defineProperty(R,{pD:"actionUp"},function(){return null!==this.R?this.R.Rp:null},function(a){null===this.R&&pl(this);var b=this.R.Rp;b!==a&&(null!==a&&v.j(a,"function",R,"actionUp"),this.R.Rp=a,this.h("actionUp",b,a))});
v.defineProperty(R,{mD:"actionCancel"},function(){return null!==this.R?this.R.Op:null},function(a){null===this.R&&pl(this);var b=this.R.Op;b!==a&&(null!==a&&v.j(a,"function",R,"actionCancel"),this.R.Op=a,this.h("actionCancel",b,a))});v.defineProperty(R,{LA:"toolTip"},function(){return null!==this.R?this.R.Hi:null},function(a){null===this.R&&pl(this);var b=this.R.Hi;b!==a&&(null!==a&&v.C(a,mf,R,"toolTip"),this.R.Hi=a,this.h("toolTip",b,a))});
v.defineProperty(R,{contextMenu:"contextMenu"},function(){return null!==this.R?this.R.ji:null},function(a){null===this.R&&pl(this);var b=this.R.ji;b!==a&&(null!==a&&v.C(a,mf,R,"contextMenu"),this.R.ji=a,this.h("contextMenu",b,a))});R.prototype.bind=R.prototype.bind=function(a){a.ig=this;var b=this.So();null!==b&&$l(b)&&v.k("Cannot add a Binding to a template that has already been copied: "+a);null===this.Hc&&(this.Hc=new G(cf));this.Hc.add(a)};
R.prototype.findTemplateBinder=R.prototype.So=function(){for(var a=this instanceof C?this:this.T;null!==a;){if(null!==a.Kl)return a;a=a.T}return null};R.prototype.setProperties=function(a){v.Rt(this,a)};var am;
R.make=am=function(a,b){var c=arguments,d=null,e=null;if("function"===typeof a)e=a;else if("string"===typeof a){var f=bm.la(a);"function"===typeof f?(c=v.$k(arguments),d=f(c)):e=ea[a]}null===d&&(void 0===e&&(d=window.$,void 0!==d&&void 0!==d.noop&&v.k("GraphObject.make failed to complete. Is it conflicting with another $ var? (such as jQuery)"),v.k("GraphObject.make failed to complete, it may be conflicting with another var.")),null!==e&&e.constructor||v.k("GraphObject.make requires a class function or class name, not: "+
a),d=new e);f=1;if(d instanceof E&&1<c.length){var h=d,e=c[1];if("string"===typeof e||e instanceof HTMLDivElement)ej(h,e),f++}for(;f<c.length;f++)e=c[f],void 0===e?v.k("Undefined value at argument "+f+" for object being constructed by GraphObject.make: "+d):cm(d,e);return d};
function cm(a,b){if("string"===typeof b)if(a instanceof ra)a.text=b;else if(a instanceof X)a.Cb=b;else if(a instanceof Zi)a.source=b;else if(a instanceof C){var c=Da(C,b);null!==c?a.type=c:v.k("Unknown Panel type as an argument to GraphObject.make: "+b)}else a instanceof ha?(c=Da(ha,b),null!==c?a.type=c:v.k("Unknown Brush type as an argument to GraphObject.make: "+b)):a instanceof Xc?(c=Da(Xc,b),null!==c?a.type=c:v.k("Unknown Geometry type as an argument to GraphObject.make: "+b)):a instanceof Kd?
(c=Da(Kd,b),null!==c?a.type=c:v.k("Unknown PathSegment type as an argument to GraphObject.make: "+b)):v.k("Unable to use a string as an argument to GraphObject.make: "+b);else if(b instanceof R)c=b,a instanceof C||v.k("A GraphObject can only be added to a Panel, not to: "+a),a.add(c);else if(b instanceof Ue){var d=b,c=a,e;d.ae&&c.bd?e=c.bd(d.index):!d.ae&&c.ad?e=c.ad(d.index):v.k("A RowColumnDefinition can only be added to a Panel, not to: "+a);e.Ss(d)}else if(b instanceof fa)a instanceof W&&b.je===
W?2===(b.value&2)?a.ox=b:b===nh||b===fh||b===eh?a.Ge=b:b===dm||b===em||b===fm?a.Is=b:b!==gm&&b!==gh&&v.k("Unknown Link enum value for a Link property: "+b):a instanceof C&&b.je===C?a.type=b:a instanceof ra&&b.je===ra?a.JF=b:a instanceof X&&(b===th||b===vh||b===wh||b===ml)?a.Hz=b:a instanceof Zi&&(b===th||b===vh||b===wh)?a.EH=b:a instanceof R&&b.je===W?(c=a,0===b.name.indexOf("Orient")?c.Pt=b:v.k("Unknown Link enum value for GraphObject.segmentOrientation property: "+b)):a instanceof R&&b.je===R?a.stretch=
b:a instanceof Ue&&b.je===Ue?a.Vt=b:a instanceof E&&b.je===E?a.Eo=b:a instanceof ha&&b.je===ha?a.type=b:a instanceof Xc&&b.je===Xc?a.type=b:a instanceof Kd&&b.je===Kd?a.type=b:a instanceof cf&&b.je===cf?a.mode=b:a instanceof Nd&&b.je===Nd?a.Ac=b:a instanceof Y&&b.je===Y?0===b.name.indexOf("Alignment")?a.alignment=b:0===b.name.indexOf("Arrangement")?a.Ff=b:0===b.name.indexOf("Compaction")?a.compaction=b:0===b.name.indexOf("Path")?a.path=b:0===b.name.indexOf("Sorting")?a.sorting=b:0===b.name.indexOf("Style")?
a.lJ=b:v.k("Unknown enum value: "+b):a instanceof hm&&b.je===hm?0===b.name.indexOf("Aggressive")?a.wG=b:0===b.name.indexOf("Cycle")?a.UG=b:0===b.name.indexOf("Init")?a.JH=b:0===b.name.indexOf("Layer")?a.YH=b:v.k("Unknown enum value: "+b):a instanceof fl&&b.je===fl?b===im||b===jm||b===km||b===lm?a.sorting=b:b===mm||b===nm?a.Ff=b:b===om||b===pm?a.alignment=b:v.k("Unknown enum value: "+b):a instanceof qm&&b.je===qm?b===rm||b===sm||b===tm||b===Bm||b===Cm?a.sorting=b:b===Dm||b===Em||b===Fm||b===Gm?a.direction=
b:b===Hm||b===Im||b===Jm||b===Km?a.Ff=b:b===Lm||b===Mm?a.$w=b:v.k("Unknown enum value: "+b):v.k("No property to set for this enum value: "+b);else if(b instanceof cf)a instanceof R?a.bind(b):a instanceof Ue?a.bind(b):v.k("A Binding can only be applied to a GraphObject or RowColumnDefinition, not to: "+a);else if(b instanceof dd)a instanceof Xc?a.Ub.add(b):v.k("A PathFigure can only be added to a Geometry, not to: "+a);else if(b instanceof Kd)a instanceof dd?a.vb.add(b):v.k("A PathSegment can only be added to a PathFigure, not to: "+
a);else if(b instanceof Me)a instanceof E?a.Pb=b:a instanceof T?a.Pb=b:v.k("A Layout can only be assigned to a Diagram or a Group, not to: "+a);else if(Array.isArray(b))for(c=0;c<b.length;c++)cm(a,b[c]);else if("object"===typeof b&&null!==b)if(a instanceof ha){e=new pa;for(c in b)d=parseFloat(c),isNaN(d)?e[c]=b[c]:a.addColorStop(d,b[c]);v.Rt(a,e)}else if(a instanceof Ue){void 0!==b.row?(e=b.row,(void 0===e||null===e||Infinity===e||isNaN(e)||0>e)&&v.k("Must specify non-negative integer row for RowColumnDefinition "+
b+", not: "+e),a.ae=!0,a.index=e):void 0!==b.column&&(e=b.column,(void 0===e||null===e||Infinity===e||isNaN(e)||0>e)&&v.k("Must specify non-negative integer column for RowColumnDefinition "+b+", not: "+e),a.ae=!1,a.index=e);e=new pa;for(c in b)"row"!==c&&"column"!==c&&(e[c]=b[c]);v.Rt(a,e)}else v.Rt(a,b);else v.k('Unknown initializer "'+b+'" for object being constructed by GraphObject.make: '+a)}var bm=new ma("string","function");
R.getBuilders=function(){var a=new ma("string","function"),b;for(b in bm)if(b!==b.toLowerCase()){var c=bm[b];"function"===typeof c&&a.add(b,c)}a.freeze();return a};var Nm;R.defineBuilder=Nm=function(a,b){v.j(a,"string",R,"defineBuilder:name");v.j(b,"function",R,"defineBuilder:func");var c=a.toLowerCase();""!==a&&"none"!==c&&a!==c||v.k("Shape.defineFigureGenerator name must not be empty or None or all-lower-case: "+a);bm.add(a,b)};var Om;
R.takeBuilderArgument=Om=function(a,b,c){void 0===c&&(c=null);var d=a[1];if("function"===typeof c?c(d):"string"===typeof d)return a.splice(1,1),d;if(void 0===b)throw Error("no "+("function"===typeof c?"satisfactory":"string")+" argument for GraphObject builder "+a[0]);return b};
Nm("Button",function(){var a=new ha(xe);a.addColorStop(0,"white");a.addColorStop(1,"lightgray");var b=new ha(xe);b.addColorStop(0,"white");b.addColorStop(1,"dodgerblue");a=am(C,gj,{Nw:!0},{_buttonFillNormal:a,_buttonStrokeNormal:"gray",_buttonFillOver:b,_buttonStrokeOver:"blue"},am(X,{name:"ButtonBorder",Cb:"Rectangle",A:new L(0,0,2.761423749153968,2.761423749153968),B:new L(1,1,-2.761423749153968,-2.761423749153968),fill:a,stroke:"gray"}));a.zt=function(a,b){var e=b.Yd("ButtonBorder");if(e instanceof
X){var f=b._buttonFillOver;b._buttonFillNormal=e.fill;e.fill=f;f=b._buttonStrokeOver;b._buttonStrokeNormal=e.stroke;e.stroke=f}};a.At=function(a,b){var e=b.Yd("ButtonBorder");e instanceof X&&(e.fill=b._buttonFillNormal,e.stroke=b._buttonStrokeNormal)};return a});
Nm("TreeExpanderButton",function(){var a=am("Button",{_treeExpandedFigure:"MinusLine",_treeCollapsedFigure:"PlusLine"},am(X,{name:"ButtonIcon",Cb:"MinusLine",xa:K.Lp},(new cf("figure","isTreeExpanded",function(a,c){var d=c.T;return a?d._treeExpandedFigure:d._treeCollapsedFigure})).ax()),{visible:!1},(new cf("visible","isTreeLeaf",function(a){return!a})).ax());a.click=function(a,c){var d=c.V;d instanceof mf&&(d=d.Sh);if(d instanceof S){var e=d.g;if(null!==e){e=e.rb;if(d.od){if(!e.canCollapseTree(d))return}else if(!e.canExpandTree(d))return;
a.Nc=!0;d.od?e.collapseTree(d):e.expandTree(d)}}};return a});
Nm("SubGraphExpanderButton",function(){var a=am("Button",{_subGraphExpandedFigure:"MinusLine",_subGraphCollapsedFigure:"PlusLine"},am(X,{name:"ButtonIcon",Cb:"MinusLine",xa:K.Lp},(new cf("figure","isSubGraphExpanded",function(a,c){var d=c.T;return a?d._subGraphExpandedFigure:d._subGraphCollapsedFigure})).ax()));a.click=function(a,c){var d=c.V;d instanceof mf&&(d=d.Sh);if(d instanceof T){var e=d.g;if(null!==e){e=e.rb;if(d.be){if(!e.canCollapseSubGraph(d))return}else if(!e.canExpandSubGraph(d))return;a.Nc=
!0;d.be?e.collapseSubGraph(d):e.expandSubGraph(d)}}};return a});Nm("ContextMenuButton",function(){var a=am("Button");a.stretch=ol;var b=a.Yd("ButtonBorder");b instanceof X&&(b.Cb="Rectangle",b.A=new L(0,0,2,3),b.B=new L(1,1,-2,-2));return a});
Nm("PanelExpanderButton",function(a){var b=Om(a,"COLLAPSIBLE");a=am("Button",am(X,"TriangleUp",{xa:new ia(6,4)},(new cf("figure","visible",function(a){return a?"TriangleUp":"TriangleDown"})).ax(b)));var c=a.Yd("ButtonBorder");c instanceof X&&(c.stroke=null,c.fill="transparent");a.click=function(a,c){var f=c.g;if(null!==f&&!f.gb){var h=c.V.Yd(b);null!==h&&(f.Qb("Collapse/Expand Panel"),h.visible=!h.visible,f.wd("Collapse/Expand Panel"))}};return a});
Nm("CheckBoxButton",function(a){var b=Om(a);a=am("Button",{"ButtonBorder.fill":"white","ButtonBorder.stroke":"gray",width:14,height:14},am(X,{name:"ButtonIcon",rH:"M0 4 L3 9 9 0",nb:2,stretch:ed,Hz:vh,visible:!1},""!==b?(new cf("visible",b)).fI():[]));a.click=function(a,d){if(!(a.g.gb||""!==b&&a.g.da.gb)){a.Nc=!0;var e=d.Yd("ButtonIcon");e.g.Qb("checkbox");e.visible=!e.visible;"function"===typeof d._doClick&&d._doClick(a,d);e.g.wd("checkbox")}};return a});
Nm("CheckBox",function(a){a=Om(a);a=am("CheckBoxButton",a,{name:"Button",margin:new tb(0,1,0,0)});var b=am(C,"Horizontal",a,{Nw:!0,margin:1,_buttonFillNormal:a._buttonFillNormal,_buttonStrokeNormal:a._buttonStrokeNormal,_buttonFillOver:a._buttonFillOver,_buttonStrokeOver:a._buttonStrokeOver,zt:a.zt,At:a.At,click:a.click,_buttonClick:a.click});a.zt=null;a.At=null;a.click=null;return b});
function ql(){this.ji=this.Hi=this.Op=this.Rp=this.Qp=this.Pp=this.wi=this.qr=this.pr=this.xi=this.yi=this.zi=this.sr=this.rr=this.ii=this.ni=this.fi=null}ql.prototype.copy=function(){var a=new ql;a.fi=this.fi;a.ni=this.ni;a.ii=this.ii;a.rr=this.rr;a.sr=this.sr;a.zi=this.zi;a.yi=this.yi;a.xi=this.xi;a.pr=this.pr;a.qr=this.qr;a.wi=this.wi;a.Pp=this.Pp;a.Qp=this.Qp;a.Rp=this.Rp;a.Op=this.Op;a.Hi=this.Hi;a.ji=this.ji;return a};
function C(a){R.call(this);void 0===a?0===arguments.length?this.ia=yh:v.k("invalid argument to Panel constructor: undefined"):(v.qb(a,C,C,"type"),this.ia=a);this.wa=new G(R);this.Re=K.Mp;this.Ig=!1;this.ia===kj&&(this.Ig=!0);this.Kq=!1;this.oq=yc;this.mi=ml;this.ia===Ql&&Pm(this);this.Ao=vh;this.Fq=(new ia(10,10)).freeze();this.Gq=K.fk;this.Kl=this.uh=null;this.Xq=NaN;this.ag=this.si=null;this.Yn="category";this.$f=null;this.Ji=new z(NaN,NaN,NaN,NaN);this.wm=null;this.Bh=!1;this.Wr=null}v.Ga(C,R);
v.Uh(C);v.ga("Panel",C);function Pm(a){a.fj=K.Mp;a.xh=1;a.li=null;a.Pl=null;a.wh=1;a.vh=null;a.Ol=null;a.Gd=[];a.Cd=[];a.qm=Qm;a.Ml=Qm;a.Ii=0;a.ui=0}
C.prototype.cloneProtected=function(a){R.prototype.cloneProtected.call(this,a);a.ia=this.ia;a.Re=this.Re.aa();a.Ig=this.Ig;a.Kq=this.Kq;a.oq=this.oq.aa();a.mi=this.mi;if(a.ia===Ql){a.fj=this.fj.aa();a.xh=this.xh;a.li=this.li;a.Pl=this.Pl;a.wh=this.wh;a.vh=this.vh;a.Ol=this.Ol;var b=[];if(0<this.Gd.length)for(var c=this.Gd,d=c.length,e=0;e<d;e++)if(void 0!==c[e]){var f=c[e].copy();f.Al(a);b[e]=f}a.Gd=b;b=[];if(0<this.Cd.length)for(c=this.Cd,d=c.length,e=0;e<d;e++)void 0!==c[e]&&(f=c[e].copy(),f.Al(a),
b[e]=f);a.Cd=b;a.qm=this.qm;a.Ml=this.Ml;a.Ii=this.Ii;a.ui=this.ui}a.Ao=this.Ao;a.Fq.assign(this.Fq);a.Gq=this.Gq.aa();a.uh=this.uh;a.Kl=this.Kl;a.Xq=this.Xq;a.si=this.si;a.ag=this.ag;a.Yn=this.Yn;a.Ji.assign(this.Ji);a.Bh=this.Bh;null!==this.Wr&&(a.Wr=this.Wr)};C.prototype.Vh=function(a){R.prototype.Vh.call(this,a);a.wa=this.wa;for(var b=a.wa.n,c=b.length,d=0;d<c;d++)b[d].Pg=a;a.wm=null};
C.prototype.copy=function(){var a=R.prototype.copy.call(this);if(null!==a){for(var b=this.wa.n,c=b.length,d=0;d<c;d++){var e=b[d].copy(),f=a;e.Al(f);e.km=null;var h=f.wa,k=h.count;h.xd(k,e);h=f.V;if(null!==h){h.Mk=null;null!==e.Od&&h instanceof S&&(h.Bh=!0);var l=f.g;null!==l&&l.ja.ib||h.Ec(Qd,"elements",f,null,e,null,k)}}return a}return null};C.prototype.toString=function(){return"Panel("+this.type+")#"+v.cd(this)};var yh;C.Position=yh=v.p(C,"Position",0);C.Horizontal=v.p(C,"Horizontal",1);var fj;
C.Vertical=fj=v.p(C,"Vertical",2);var rh;C.Spot=rh=v.p(C,"Spot",3);var gj;C.Auto=gj=v.p(C,"Auto",4);var Ql;C.Table=Ql=v.p(C,"Table",5);C.Viewbox=v.p(C,"Viewbox",6);var Cl;C.TableRow=Cl=v.p(C,"TableRow",7);var Dl;C.TableColumn=Dl=v.p(C,"TableColumn",8);var dh;C.Link=dh=v.p(C,"Link",9);var kj;C.Grid=kj=v.p(C,"Grid",10);
v.defineProperty(C,{type:"type"},function(){return this.ia},function(a){var b=this.ia;b!==a&&(b!==Cl&&b!==Dl||v.k("Cannot change Panel.type when it is already a TableRow or a TableColumn: "+a),this.ia=a,this.ia===kj?this.Ig=!0:this.ia===Ql&&Pm(this),this.P(),this.h("type",b,a))});v.u(C,{elements:"elements"},function(){return this.wa.i});v.u(C,{Fa:"naturalBounds"},function(){return this.Jc});
v.defineProperty(C,{padding:"padding"},function(){return this.Re},function(a){"number"===typeof a?(0>a&&v.ua(a,">= 0",C,"padding"),a=new tb(a)):(v.C(a,tb,C,"padding"),0>a.left&&v.ua(a.left,">= 0",C,"padding:value.left"),0>a.right&&v.ua(a.right,">= 0",C,"padding:value.right"),0>a.top&&v.ua(a.top,">= 0",C,"padding:value.top"),0>a.bottom&&v.ua(a.bottom,">= 0",C,"padding:value.bottom"));var b=this.Re;b.L(a)||(this.Re=a=a.aa(),this.P(),this.h("padding",b,a))});
v.defineProperty(C,{dl:"defaultAlignment"},function(){return this.oq},function(a){var b=this.oq;b.L(a)||(this.oq=a=a.aa(),this.P(),this.h("defaultAlignment",b,a))});v.defineProperty(C,{Hd:"defaultStretch"},function(){return this.mi},function(a){var b=this.mi;b!==a&&(v.qb(a,R,C,"defaultStretch"),this.mi=a,this.P(),this.h("defaultStretch",b,a))});
v.defineProperty(C,{eK:"defaultSeparatorPadding"},function(){return void 0===this.fj?K.Mp:this.fj},function(a){if(void 0!==this.fj){"number"===typeof a&&(a=new tb(a));var b=this.fj;b.L(a)||(this.fj=a=a.aa(),this.h("defaultSeparatorPadding",b,a))}});
v.defineProperty(C,{cK:"defaultRowSeparatorStroke"},function(){return void 0===this.li?null:this.li},function(a){var b=this.li;b!==a&&(null===a||"string"===typeof a||a instanceof ha)&&(a instanceof ha&&a.freeze(),this.li=a,this.h("defaultRowSeparatorStroke",b,a))});v.defineProperty(C,{dK:"defaultRowSeparatorStrokeWidth"},function(){return void 0===this.xh?1:this.xh},function(a){if(void 0!==this.xh){var b=this.xh;b!==a&&isFinite(a)&&0<=a&&(this.xh=a,this.h("defaultRowSeparatorStrokeWidth",b,a))}});
v.defineProperty(C,{bK:"defaultRowSeparatorDashArray"},function(){return void 0===this.Pl?null:this.Pl},function(a){if(void 0!==this.Pl){var b=this.Pl;if(b!==a){null===a||Array.isArray(a)||v.Ad(a,"Array",C,"defaultRowSeparatorDashArray:value");if(null!==a){for(var c=a.length,d=0,e=0;e<c;e++){var f=a[e];"number"===typeof f&&0<=f&&isFinite(f)||v.k("defaultRowSeparatorDashArray value "+f+" at index "+e+" must be a positive number or zero.");d+=f}if(0===d){if(null===b)return;a=null}}this.Pl=a;this.pa();
this.h("defaultRowSeparatorDashArray",b,a)}}});v.defineProperty(C,{XJ:"defaultColumnSeparatorStroke"},function(){return void 0===this.vh?null:this.vh},function(a){if(void 0!==this.vh){var b=this.vh;b!==a&&(null===a||"string"===typeof a||a instanceof ha)&&(a instanceof ha&&a.freeze(),this.vh=a,this.h("defaultColumnSeparatorStroke",b,a))}});
v.defineProperty(C,{YJ:"defaultColumnSeparatorStrokeWidth"},function(){return void 0===this.wh?1:this.wh},function(a){if(void 0!==this.wh){var b=this.wh;b!==a&&isFinite(a)&&0<=a&&(this.wh=a,this.h("defaultColumnSeparatorStrokeWidth",b,a))}});
v.defineProperty(C,{WJ:"defaultColumnSeparatorDashArray"},function(){return void 0===this.Ol?null:this.Ol},function(a){if(void 0!==this.Ol){var b=this.Ol;if(b!==a){null===a||Array.isArray(a)||v.Ad(a,"Array",C,"defaultColumnSeparatorDashArray:value");if(null!==a){for(var c=a.length,d=0,e=0;e<c;e++){var f=a[e];"number"===typeof f&&0<=f&&isFinite(f)||v.k("defaultColumnSeparatorDashArray value "+f+" at index "+e+" must be a positive number or zero.");d+=f}if(0===d){if(null===b)return;a=null}}this.Ol=
a;this.pa();this.h("defaultColumnSeparatorDashArray",b,a)}}});v.defineProperty(C,{tL:"viewboxStretch"},function(){return this.Ao},function(a){var b=this.Ao;b!==a&&(v.qb(a,R,C,"viewboxStretch"),this.Ao=a,this.h("viewboxStretch",b,a))});
v.defineProperty(C,{Jw:"gridCellSize"},function(){return this.Fq},function(a){var b=this.Fq;b.L(a)||(v.C(a,ia,C,"gridCellSize"),a.H()&&0!==a.width&&0!==a.height||v.k("Invalid Panel.gridCellSize: "+a),this.Fq=a.aa(),null!==this.g&&this===this.g.ft&&Ej(this.g),this.pa(),this.h("gridCellSize",b,a))});
v.defineProperty(C,{hE:"gridOrigin"},function(){return this.Gq},function(a){var b=this.Gq;b.L(a)||(v.C(a,w,C,"gridOrigin"),a.H()||v.k("Invalid Panel.gridOrigin: "+a),this.Gq=a.aa(),null!==this.g&&Ej(this.g),this.pa(),this.h("gridOrigin",b,a))});g=C.prototype;g.uv=function(a){R.prototype.uv.call(this,a);for(var b=this.wa.n,c=b.length,d=0;d<c;d++)b[d].uv(a)};
g.Uj=function(a,b){if(this.ia===kj){var c=this.Si()*b.scale;0>=c&&(c=1);var d=this.Jw,e=d.width,d=d.height,f=this.Fa,h=f.width,f=f.height,k=Math.ceil(h/e),l=Math.ceil(f/d),m=this.hE;a.save();a.beginPath();a.rect(0,0,h,f);a.clip();for(var n=[],p=this.wa.n,q=p.length,r=0;r<q;r++){var s=p[r],t=[];n.push(t);if(s.visible)for(var s=ik(s.Cb),u=r+1;u<q;u++){var x=p[u];x.visible&&ik(x.Cb)===s&&(x=x.interval,2<=x&&t.push(x))}}p=this.wa.n;q=p.length;for(r=0;r<q;r++){var y=p[r];if(y.visible){var t=n[r],s=y.interval,
u=!1,A=!0,B=y.sF;null!==B&&(u=!0,void 0!==a.setLineDash?(a.setLineDash(B),a.lineDashOffset=y.nd):void 0!==a.webkitLineDash?(a.webkitLineDash=B,a.webkitLineDashOffset=y.nd):void 0!==a.mozDash?(a.mozDash=B,a.mozDashOffset=y.nd):A=!1);if("LineV"===y.Cb){a.lineWidth=y.nb;Jl(this,a,y.stroke,!1,!1);a.beginPath();for(var I=x=Math.floor(-m.x/e);I<=x+k;I++){var D=I*e+m.x;if(0<=D&&D<h&&Rm(I,s,t)&&(u&&!A?tl(a,D,0,D,f,B,y.nd):(a.moveTo(D,0),a.lineTo(D,f)),2>e*s*c))break}a.stroke()}else if("LineH"===y.Cb){a.lineWidth=
y.nb;Jl(this,a,y.stroke,!1,!1);a.beginPath();for(I=x=Math.floor(-m.y/d);I<=x+l&&!(D=I*d+m.y,0<=D&&D<=f&&Rm(I,s,t)&&(u&&!A?tl(a,0,D,h,D,B,y.nd):(a.moveTo(0,D),a.lineTo(h,D)),2>d*s*c));I++);a.stroke()}else if("BarV"===y.Cb)for(Jl(this,a,y.fill,!0,!1),y=y.width,isNaN(y)&&(y=e),I=x=Math.floor(-m.x/e);I<=x+k&&!(D=I*e+m.x,0<=D&&D<h&&Rm(I,s,t)&&(a.fillRect(D,0,y,f),2>e*s*c));I++);else if("BarH"===y.Cb)for(Jl(this,a,y.fill,!0,!1),y=y.height,isNaN(y)&&(y=d),I=x=Math.floor(-m.y/d);I<=x+l&&!(D=I*d+m.y,0<=D&&
D<=f&&Rm(I,s,t)&&(a.fillRect(0,D,h,y),2>d*s*c));I++);u&&(void 0!==a.setLineDash?(a.setLineDash(v.qh),a.lineDashOffset=0):void 0!==a.webkitLineDash?(a.webkitLineDash=v.qh,a.webkitLineDashOffset=0):void 0!==a.mozDash&&(a.mozDash=null,a.mozDashOffset=0))}}a.restore();ij(b,a,!1)}else{this.ia===Ql&&(a.lineCap="butt",Sm(this,a,!0,this.Gd,!0),Sm(this,a,!1,this.Cd,!0),Tm(this,a,!0,this.Gd),Tm(this,a,!1,this.Cd),Sm(this,a,!0,this.Gd,!1),Sm(this,a,!1,this.Cd,!1));(c=this.qE)&&a.save();e=this.If();d=this.wa.n;
h=d.length;for(f=0;f<h;f++)k=d[f],c&&k===e&&(a.hu=!0),k.Ve(a,b),c&&k===e&&(a.hu=!1);c&&(a.restore(),ij(b,a,!1))}};
function Tm(a,b,c,d){for(var e=d.length,f=a.Z,h=c?a.bd(0):a.ad(0),k=0;k<e;k++){var l=d[k];if(void 0!==l&&l!==h&&0!==l.Ra){var m=l.Bp;isNaN(m)&&(m=c?a.xh:a.wh);var n=l.Ap;null===n&&(n=c?a.li:a.vh);if(0!==m&&null!==n){Jl(a,b,n,!1,!1);var n=!1,p=!0,q=l.TI;null!==q&&(n=!0,void 0!==b.setLineDash?(b.setLineDash(q),b.lineDashOffset=a.nd):void 0!==b.webkitLineDash?(b.webkitLineDash=q,b.webkitLineDashOffset=a.nd):void 0!==b.mozDash?(b.mozDash=q,b.mozDashOffset=a.nd):p=!1);b.beginPath();var r=l.position+m;
c?r>f.height&&(m-=r-f.height):r>f.width&&(m-=r-f.width);l=l.position+m/2;b.lineWidth=m;r=a.padding;c?(l+=r.top,m=r.left,r=f.width-r.right,n&&!p?tl(b,m,l,r,l,q,0):(b.moveTo(m,l),b.lineTo(r,l))):(l+=r.left,m=r.top,r=f.height-r.bottom,n&&!p?tl(b,l,m,l,r,q,0):(b.moveTo(l,m),b.lineTo(l,r)));b.stroke();n&&(void 0!==b.setLineDash?(b.setLineDash(v.qh),b.lineDashOffset=0):void 0!==b.webkitLineDash?(b.webkitLineDash=v.qh,b.webkitLineDashOffset=0):void 0!==b.mozDash&&(b.mozDash=null,b.mozDashOffset=0))}}}}
function Sm(a,b,c,d,e){for(var f=d.length,h=a.Z,k=0;k<f;k++){var l=d[k];if(void 0!==l&&null!==l.background&&l.Az!==e&&0!==l.Ra){var m=c?h.height:h.width;if(!(l.position>m)){var n=l.mg(),p=l.Bp;isNaN(p)&&(p=c?a.xh:a.wh);var q=l.Ap;null===q&&(q=c?a.li:a.vh);null===q&&(p=0);n-=p;p=l.position+p;n+=l.Ra;p+n>m&&(n=m-p);0>=n||(m=a.padding,Jl(a,b,l.background,!0,!1),c?b.fillRect(m.left,p+m.top,h.width-(m.left+m.right),n):b.fillRect(p+m.left,m.top,n,h.height-(m.top+m.bottom)))}}}}
function Rm(a,b,c){if(0!==a%b)return!1;b=c.length;for(var d=0;d<b;d++)if(0===a%c[d])return!1;return!0}function ik(a){return"LineV"===a||"BarV"===a}
g.Xo=function(a,b,c,d,e){var f=this.Vf(),h=this.transform,k=1/(h.m11*h.m22-h.m12*h.m21),l=h.m22*k,m=-h.m12*k,n=-h.m21*k,p=h.m11*k,q=k*(h.m21*h.dy-h.m22*h.dx),r=k*(h.m12*h.dx-h.m11*h.dy);if(null!==this.Cm)return h=this.Z,K.ml(h.left,h.top,h.right,h.bottom,a,b,c,d,e);if(null!==this.background)f=a*l+b*n+q,k=a*m+b*p+r,a=c*l+d*n+q,c=c*m+d*p+r,e.m(0,0),d=this.Fa,c=K.ml(0,0,d.width,d.height,f,k,a,c,e),e.transform(h);else{f||(l=1,n=m=0,p=1,r=q=0);k=a*l+b*n+q;a=a*m+b*p+r;l=c*l+d*n+q;d=c*m+d*p+r;e.m(l,d);m=
(l-k)*(l-k)+(d-a)*(d-a);c=!1;p=this.wa.n;r=p.length;n=v.M();for(q=0;q<r;q++)b=p[q],b.visible&&b.Xo(k,a,l,d,n)&&(c=!0,b=(k-n.x)*(k-n.x)+(a-n.y)*(a-n.y),b<m&&(m=b,e.set(n)));v.v(n);f&&e.transform(h)}return c};g.P=function(a){R.prototype.P.call(this,a);this.ia===gj&&(a=this.If(),null!==a&&a.P(!0));a=this.wa.n;for(var b=a.length,c=0;c<b;c++){var d=a[c];!0!==Jj(d)&&(d.xa.H()||(d instanceof sh||d instanceof C||d instanceof ra||yl(d,!1)!==th)&&d.P(!0))}};
g.$o=function(){if(!1===Jj(this)){Dj(this,!0);Al(this,!0);for(var a=this.wa.n,b=a.length,c=0;c<b;c++)a[c].$o()}};g.pi=function(){if(0!==(this.fa&2048)===!1){Nl(this,!0);Ol(this,!0);for(var a=this.wa.n,b=a.length,c=0;c<b;c++)a[c].Oz()}};g.Oz=function(){Ol(this,!0);for(var a=this.wa.n,b=a.length,c=0;c<b;c++)a[c].Oz()};
g.ip=function(a,b,c,d){var e=this.Ji;e.width=0;e.height=0;var f=this.xa,h=this.ug;void 0===c&&(c=h.width,d=h.height);c=Math.max(c,h.width);d=Math.max(d,h.height);var k=this.af;isNaN(f.width)||(a=Math.min(f.width,k.width));isNaN(f.height)||(b=Math.min(f.height,k.height));a=Math.max(c,a);b=Math.max(d,b);var l=this.padding;a=Math.max(a-l.left-l.right,0);b=Math.max(b-l.top-l.bottom,0);var m=this.wa.n;if(0!==m.length){var n=this.ia.Ob;switch(n){case "Position":var p=a,q=b,r=c,s=d,t=m.length;e.x=0;e.y=
0;e.width=0;for(var u=e.height=0;u<t;u++){var x=m[u];if(x.visible||x===this.ac){var y=x.margin,A=y.right+y.left,B=y.top+y.bottom;Rh(x,p,q,r,s);var I=x.Ba,D=Math.max(I.width+A,0),V=Math.max(I.height+B,0),ba=x.position.x,U=x.position.y;isFinite(ba)||(ba=0);isFinite(U)||(U=0);if(x instanceof X){var N=x;if(N.sE)var Z=N.nb/2,ba=ba-Z,U=U-Z}rb(e,ba,U,D,V)}}break;case "Vertical":for(var Ga=a,ta=c,Pa=m.length,la=v.jb(),Ca=0;Ca<Pa;Ca++){var qa=m[Ca];if(qa.visible||qa===this.ac){var cc=yl(qa,!1);if(cc!==th&&
cc!==nl)la.push(qa);else{var id=qa.margin,Pf=id.right+id.left,dc=id.top+id.bottom;Rh(qa,Ga,Infinity,ta,0);var Ve=qa.Ba,Qf=Math.max(Ve.width+Pf,0),Ta=Math.max(Ve.height+dc,0);e.width=Math.max(e.width,Qf);e.height+=Ta}}}var fb=la.length;if(0!==fb){this.xa.width?Ga=Math.min(this.xa.width,this.af.width):0!==e.width&&(Ga=Math.min(e.width,this.af.width));for(Ca=0;Ca<fb;Ca++)if(qa=la[Ca],qa.visible||qa===this.ac)id=qa.margin,Pf=id.right+id.left,dc=id.top+id.bottom,Rh(qa,Ga,Infinity,ta,0),Ve=qa.Ba,Qf=Math.max(Ve.width+
Pf,0),Ta=Math.max(Ve.height+dc,0),e.width=Math.max(e.width,Qf),e.height+=Ta;v.ra(la)}break;case "Horizontal":for(var xa=b,za=d,kb=m.length,Hb=v.jb(),ab=0;ab<kb;ab++){var jc=m[ab];if(jc.visible||jc===this.ac){var ie=yl(jc,!1);if(ie!==th&&ie!==ol)Hb.push(jc);else{var qc=jc.margin,Rd=qc.right+qc.left,je=qc.top+qc.bottom;Rh(jc,Infinity,xa,0,za);var We=jc.Ba,qf=Math.max(We.width+Rd,0),Sd=Math.max(We.height+je,0);e.width+=qf;e.height=Math.max(e.height,Sd)}}}var Ib=Hb.length;if(0!==Ib){this.xa.height?xa=
Math.min(this.xa.height,this.af.height):0!==e.height&&(xa=Math.min(e.height,this.af.height));for(ab=0;ab<Ib;ab++)if(jc=Hb[ab],jc.visible||jc===this.ac)qc=jc.margin,Rd=qc.right+qc.left,je=qc.top+qc.bottom,Rh(jc,Infinity,xa,0,za),We=jc.Ba,qf=Math.max(We.width+Rd,0),Sd=Math.max(We.height+je,0),e.width+=qf,e.height=Math.max(e.height,Sd);v.ra(Hb)}break;case "Spot":a:{var Mb=a,Lc=b,Og=c,Nb=d,Bb=m.length,ec=this.If(),lb=ec.margin,Ae=0,Td=0,qg=lb.right+lb.left,Rf=lb.top+lb.bottom;Rh(ec,Mb,Lc,Og,Nb);var Cb=
ec.Ba,jd=Cb.width,rc=Cb.height,yb=Math.max(jd+qg,0),Mc=Math.max(rc+Rf,0);e.x=-lb.left;e.y=-lb.top;e.width=yb;e.height=Mc;for(var Ob=0;Ob<Bb;Ob++){var Na=m[Ob];if(Na!==ec&&(Na.visible||Na===this.ac)){lb=Na.margin;Ae=lb.right+lb.left;Td=lb.top+lb.bottom;Rh(Na,Mb,Lc,0,0);var Cb=Na.Ba,yb=Math.max(Cb.width+Ae,0),Mc=Math.max(Cb.height+Td,0),gb=Na.alignment;gb.Oc()&&(gb=this.dl);gb.yd()||(gb=Kb);var Db=Na.Pj;Db.Oc()&&(Db=Kb);rb(e,gb.x*jd+gb.offsetX-(Db.x*Cb.width-Db.offsetX)-lb.left,gb.y*rc+gb.offsetY-(Db.y*
Cb.height-Db.offsetY)-lb.top,yb,Mc)}}var fc=ec.stretch;fc===ml&&(fc=yl(ec,!1));switch(fc){case th:break a;case ed:if(!isFinite(Mb)&&!isFinite(Lc))break a;break;case ol:if(!isFinite(Mb))break a;break;case nl:if(!isFinite(Lc))break a}Cb=ec.Ba;jd=Cb.width;rc=Cb.height;yb=Math.max(jd+qg,0);Mc=Math.max(rc+Rf,0);lb=ec.margin;e.x=-lb.left;e.y=-lb.top;e.width=yb;e.height=Mc;for(Ob=0;Ob<Bb;Ob++)Na=m[Ob],Na===ec||!Na.visible&&Na!==this.ac||(lb=Na.margin,Ae=lb.right+lb.left,Td=lb.top+lb.bottom,Cb=Na.Ba,yb=Math.max(Cb.width+
Ae,0),Mc=Math.max(Cb.height+Td,0),gb=Na.alignment,gb.Oc()&&(gb=this.dl),gb.yd()||(gb=Kb),Db=Na.Pj,Db.Oc()&&(Db=Kb),rb(e,gb.x*jd+gb.offsetX-(Db.x*Cb.width-Db.offsetX)-lb.left,gb.y*rc+gb.offsetY-(Db.y*Cb.height-Db.offsetY)-lb.top,yb,Mc))}break;case "Auto":var Ud=a,Vd=b,rf=c,Be=d,sf=m.length,Sb=this.If(),db=Sb.margin,sc=db.right+db.left,Yc=db.top+db.bottom;Rh(Sb,Ud,Vd,rf,Be);var kd=Sb.Ba,bb=Math.max(kd.width+sc,0),vb=Math.max(kd.height+Yc,0),kc=Um(Sb),ld=kc.x*bb+kc.offsetX,Pg=kc.y*vb+kc.offsetY,kc=Vm(Sb),
Qg=kc.x*bb+kc.offsetX,Rg=kc.y*vb+kc.offsetY,Sf=Ud,Nc=Vd;isFinite(Ud)&&(Sf=Math.abs(ld-Qg));isFinite(Vd)&&(Nc=Math.abs(Pg-Rg));var Zc=v.El();Zc.m(0,0);for(var Oc=0;Oc<sf;Oc++){var mb=m[Oc];if(mb!==Sb&&(mb.visible||mb===this.ac)){var db=mb.margin,ke=db.right+db.left,nb=db.top+db.bottom;Rh(mb,Sf,Nc,0,0);kd=mb.Ba;bb=Math.max(kd.width+ke,0);vb=Math.max(kd.height+nb,0);Zc.m(Math.max(bb,Zc.width),Math.max(vb,Zc.height))}}if(1===sf)e.width=bb,e.height=vb,v.Wj(Zc);else{var Ec=Um(Sb),Ce=Vm(Sb),Eb=0,Fb=0;Ce.x!==
Ec.x&&Ce.y!==Ec.y&&(Eb=Zc.width/Math.abs(Ce.x-Ec.x),Fb=Zc.height/Math.abs(Ce.y-Ec.y));v.Wj(Zc);var md=0;if(Sb instanceof X){var $c=Sb,md=$c.nb*$c.scale;uh($c)===vh&&(Eb=Fb=Math.max(Eb,Fb))}var Eb=Eb+(Math.abs(Ec.offsetX)+Math.abs(Ce.offsetX)+md),Fb=Fb+(Math.abs(Ec.offsetY)+Math.abs(Ce.offsetY)+md),Wd=Sb.stretch;Wd===ml&&(Wd=yl(Sb,!1));switch(Wd){case th:Be=rf=0;break;case ed:isFinite(Ud)&&(Eb=Ud);isFinite(Vd)&&(Fb=Vd);break;case ol:isFinite(Ud)&&(Eb=Ud);Be=0;break;case nl:rf=0,isFinite(Vd)&&(Fb=Vd)}Sb instanceof
X&&!Sb.xa.H()&&($c=Sb,$c.Qg?$c.tk=null:$c.Ta=null);Sb.$o();Rh(Sb,Eb,Fb,rf,Be);e.width=Sb.Ba.width+sc;e.height=Sb.Ba.height+Yc}break;case "Table":for(var Xd=a,Xe=b,um=c,Di=d,Ea=m.length,De=v.jb(),Yd=v.jb(),da=0;da<Ea;da++){var ca=m[da],rg=ca instanceof C?ca:null;if(null===rg||rg.type!==Cl&&rg.type!==Dl||!ca.visible)De.push(ca);else{Yd.push(ca);for(var Sg=rg.wa.n,Ih=Sg.length,ad=0;ad<Ih;ad++){var Jh=Sg[ad];rg.type===Cl?Jh.bc=ca.bc:rg.type===Dl&&(Jh.column=ca.column);De.push(Jh)}}}Ea=De.length;0===Ea&&
(this.bd(0),this.ad(0));for(var Tb=[],da=0;da<Ea;da++)ca=De[da],Dj(ca,!0),Al(ca,!0),Tb[ca.bc]||(Tb[ca.bc]=[]),Tb[ca.bc][ca.column]||(Tb[ca.bc][ca.column]=[]),Tb[ca.bc][ca.column].push(ca);v.ra(De);for(var Tg=v.jb(),bd=v.jb(),le=v.jb(),Pc={count:0},nd={count:0},Fc=Xd,od=Xe,Tf=this.Gd,Ea=Tf.length,da=0;da<Ea;da++){var aa=Tf[da];void 0!==aa&&(aa.Ra=0)}Tf=this.Cd;Ea=Tf.length;for(da=0;da<Ea;da++)aa=Tf[da],void 0!==aa&&(aa.Ra=0);for(var me=Tb.length,Ee=0,da=0;da<me;da++)Tb[da]&&(Ee=Math.max(Ee,Tb[da].length));
for(var dk=Math.min(this.Ii,me-1),ek=Math.min(this.ui,Ee-1),Gc=0,me=Tb.length,da=dk;da<me;da++)if(Tb[da]){var Ee=Tb[da].length,hb=this.bd(da);hb.Ra=0;for(ad=ek;ad<Ee;ad++)if(Tb[da][ad]){var ib=this.ad(ad);void 0===Tg[ad]&&(ib.Ra=0,Tg[ad]=!0);for(var fk=Tb[da][ad],Uf=fk.length,sg=0;sg<Uf;sg++)if(ca=fk[sg],ca.visible||ca===this.ac){var tg=1<ca.Di||1<ca.hi;tg&&bd.push(ca);var Pb=ca.margin,Vf=Pb.right+Pb.left,Wf=Pb.top+Pb.bottom,Zd=Rl(ca,hb,ib,!1),ne=ca.xa,vm=!isNaN(ne.height),Kh=!isNaN(ne.width)&&vm;
tg||Zd===th||Kh||(void 0===Pc[ad]&&(Pc[ad]=-1,Pc.count++),void 0===nd[da]&&(nd[da]=-1,nd.count++),le.push(ca));Rh(ca,Infinity,Infinity,0,0);var Fe=ca.Ba,Ge=Math.max(Fe.width+Vf,0),pd=Math.max(Fe.height+Wf,0);1!==ca.Di||Zd!==th&&Zd!==ol||(aa=this.bd(da),Gc=Math.max(pd-aa.Ra,0),Gc>od&&(Gc=od),aa.Ra+=Gc,od=Math.max(od-Gc,0));1!==ca.hi||Zd!==th&&Zd!==nl||(aa=this.ad(ad),Gc=Math.max(Ge-aa.Ra,0),Gc>Fc&&(Gc=Fc),aa.Ra+=Gc,Fc=Math.max(Fc-Gc,0));tg&&ca.$o()}}}v.ra(Tg);for(var tc=0,$d=0,Ea=this.Ko,da=0;da<Ea;da++)void 0!==
this.Cd[da]&&(tc+=this.ad(da).ab);Ea=this.zp;for(da=0;da<Ea;da++)void 0!==this.Gd[da]&&($d+=this.bd(da).ab);for(var Fc=Math.max(Xd-tc,0),gk=od=Math.max(Xe-$d,0),hk=Fc,Ea=le.length,da=0;da<Ea;da++){var ca=le[da],hb=this.bd(ca.bc),ib=this.ad(ca.column),Ei=ca.Ba,Pb=ca.margin,Vf=Pb.right+Pb.left,Wf=Pb.top+Pb.bottom;Pc[ca.column]=0===ib.Ra?Math.max(Ei.width+Vf,Pc[ca.column]):null;nd[ca.bc]=0===hb.Ra?Math.max(Ei.height+Wf,nd[ca.bc]):null}var Ug=0,uc=0;for(da in nd)"count"!==da&&(Ug+=nd[da]);for(da in Pc)"count"!==
da&&(uc+=Pc[da]);for(var ob=v.El(),da=0;da<Ea;da++)if(ca=le[da],ca.visible||ca===this.ac){var hb=this.bd(ca.bc),ib=this.ad(ca.column),oe=0;isFinite(ib.width)?oe=ib.width:(oe=isFinite(Fc)&&null!==Pc[ca.column]?0===uc?ib.Ra+Fc:Pc[ca.column]/uc*hk:null!==Pc[ca.column]?Fc:ib.Ra||Fc,oe=Math.max(0,oe-ib.mg()));var Qc=0;isFinite(hb.height)?Qc=hb.height:(Qc=isFinite(od)&&null!==nd[ca.bc]?0===Ug?hb.Ra+od:nd[ca.bc]/Ug*gk:null!==nd[ca.bc]?od:hb.Ra||od,Qc=Math.max(0,Qc-hb.mg()));ob.m(Math.max(ib.Vi,Math.min(oe,
ib.bf)),Math.max(hb.Vi,Math.min(Qc,hb.bf)));Zd=Rl(ca,hb,ib,!1);switch(Zd){case ol:ob.height=Infinity;break;case nl:ob.width=Infinity}Pb=ca.margin;Vf=Pb.right+Pb.left;Wf=Pb.top+Pb.bottom;ca.$o();Rh(ca,ob.width,ob.height,ib.Vi,hb.Vi);Fe=ca.Ba;Ge=Math.max(Fe.width+Vf,0);pd=Math.max(Fe.height+Wf,0);isFinite(Fc)&&(Ge=Math.min(Ge,ob.width));isFinite(od)&&(pd=Math.min(pd,ob.height));var Vg=0,Vg=hb.Ra;hb.Ra=Math.max(hb.Ra,pd);Gc=hb.Ra-Vg;od=Math.max(od-Gc,0);Vg=ib.Ra;ib.Ra=Math.max(ib.Ra,Ge);Gc=ib.Ra-Vg;
Fc=Math.max(Fc-Gc,0)}v.ra(le);for(var pe=v.El(),Ea=bd.length,da=0;da<Ea;da++)if(ca=bd[da],ca.visible||ca===this.ac){hb=this.bd(ca.bc);ib=this.ad(ca.column);ob.m(Math.max(ib.Vi,Math.min(Xd,ib.bf)),Math.max(hb.Vi,Math.min(Xe,hb.bf)));Zd=Rl(ca,hb,ib,!1);switch(Zd){case ed:0!==ib.Ra&&(ob.width=Math.min(ob.width,ib.Ra));0!==hb.Ra&&(ob.height=Math.min(ob.height,hb.Ra));break;case ol:0!==ib.Ra&&(ob.width=Math.min(ob.width,ib.Ra));break;case nl:0!==hb.Ra&&(ob.height=Math.min(ob.height,hb.Ra))}isFinite(ib.width)&&
(ob.width=ib.width);isFinite(hb.height)&&(ob.height=hb.height);pe.m(0,0);for(var cb=1;cb<ca.Di&&!(ca.bc+cb>=this.zp);cb++)aa=this.bd(ca.bc+cb),pe.height+=Math.max(aa.Vi,isNaN(aa.Se)?aa.bf:Math.min(aa.Se,aa.bf));for(cb=1;cb<ca.hi&&!(ca.column+cb>=this.Ko);cb++)aa=this.ad(ca.column+cb),pe.width+=Math.max(aa.Vi,isNaN(aa.Se)?aa.bf:Math.min(aa.Se,aa.bf));ob.width+=pe.width;ob.height+=pe.height;Pb=ca.margin;Vf=Pb.right+Pb.left;Wf=Pb.top+Pb.bottom;Rh(ca,ob.width,ob.height,um,Di);for(var Fe=ca.Ba,Ge=Math.max(Fe.width+
Vf,0),pd=Math.max(Fe.height+Wf,0),Wg=0,cb=0;cb<ca.Di&&!(ca.bc+cb>=this.zp);cb++)aa=this.bd(ca.bc+cb),Wg+=aa.total||0;if(Wg<pd){var gc=pd-Wg,tf=pd-Wg;if(null!==ca.zx)for(var ug=ca.zx,cb=0;cb<ca.Di&&!(0>=gc)&&!(ca.bc+cb>=this.zp);cb++){var aa=this.bd(ca.bc+cb),vc=aa.ab||0,vg=ug(ca,aa,tf);aa.Ra=Math.min(aa.bf,vc+vg);aa.ab!==vc&&(gc-=aa.ab-vc)}for(;0<gc;){vc=aa.ab||0;isNaN(aa.height)&&aa.bf>vc&&(aa.Ra=Math.min(aa.bf,vc+gc),aa.ab!==vc&&(gc-=aa.ab-vc));if(0===aa.index)break;aa=this.bd(aa.index-1)}}for(var qd=
0,cb=0;cb<ca.hi&&!(ca.column+cb>=this.Ko);cb++)aa=this.ad(ca.column+cb),qd+=aa.total||0;if(qd<Ge){gc=Ge-qd;tf=Ge-qd;if(null!==ca.zx)for(ug=ca.zx,cb=0;cb<ca.hi&&!(0>=gc)&&!(ca.column+cb>=this.Ko);cb++)aa=this.ad(ca.column+cb),vc=aa.ab||0,vg=ug(ca,aa,tf),aa.Ra=Math.min(aa.bf,vc+vg),aa.ab!==vc&&(gc-=aa.ab-vc);for(;0<gc;){vc=aa.ab||0;isNaN(aa.width)&&aa.bf>vc&&(aa.Ra=Math.min(aa.bf,vc+gc),aa.ab!==vc&&(gc-=aa.ab-vc));if(0===aa.index)break;aa=this.ad(aa.index-1)}}}v.ra(bd);v.Wj(pe);v.Wj(ob);for(var qe=
0,uf=0,Zd=yl(this,!0),Ye=this.xa,Fi=this.af,Ed=$d=tc=0,Rc=0,Ea=this.Ko,da=0;da<Ea;da++)void 0!==this.Cd[da]&&(aa=this.ad(da),isFinite(aa.width)?(Ed+=aa.width,Ed+=aa.mg()):Wm(aa)===Xm?(Ed+=aa.ab,Ed+=aa.mg()):0!==aa.ab&&(tc+=aa.ab,tc+=aa.mg()));var qe=isFinite(Ye.width)?Math.min(Ye.width,Fi.width):Zd!==th&&isFinite(Xd)?Xd:tc,qe=Math.max(qe,this.ug.width),qe=Math.max(qe-Ed,0),Yg=Math.max(qe/tc,1);isFinite(Yg)||(Yg=1);for(da=0;da<Ea;da++)void 0!==this.Cd[da]&&(aa=this.ad(da),isFinite(aa.width)||Wm(aa)===
Xm||(aa.Ra=aa.ab*Yg),aa.position=e.width,0!==aa.ab&&(e.width+=aa.ab,e.width+=aa.mg()));Ea=this.zp;for(da=0;da<Ea;da++)void 0!==this.Gd[da]&&(aa=this.bd(da),isFinite(aa.height)?(Rc+=aa.height,Rc+=aa.mg()):Wm(aa)===Xm?(Rc+=aa.ab,Rc+=aa.mg()):0!==aa.ab&&($d+=aa.ab,$d+=aa.mg()));var uf=isFinite(Ye.height)?Math.min(Ye.height,Fi.height):Zd!==th&&isFinite(Xe)?Xe:$d,uf=Math.max(uf,this.ug.height),uf=Math.max(uf-Rc,0),Zg=Math.max(uf/$d,1);isFinite(Zg)||(Zg=1);for(da=0;da<Ea;da++)void 0!==this.Gd[da]&&(aa=
this.bd(da),isFinite(aa.height)||Wm(aa)===Xm||(aa.Ra=aa.ab*Zg),aa.position=e.height,0!==aa.ab&&(e.height+=aa.ab,e.height+=aa.mg()));Ea=Yd.length;for(da=0;da<Ea;da++){var hc=Yd[da];hc.type===Cl?(oe=e.width,aa=this.bd(hc.bc),Qc=aa.Ra):(aa=this.ad(hc.column),oe=aa.Ra,Qc=e.height);hc.Vc.m(0,0,oe,Qc);Dj(hc,!1);Tb[hc.bc]||(Tb[hc.bc]=[]);Tb[hc.bc][hc.column]||(Tb[hc.bc][hc.column]=[]);Tb[hc.bc][hc.column].push(hc)}v.ra(Yd);this.Wr=Tb;break;case "Viewbox":var $g=a,jk=b,Sp=c,Tp=d;1<m.length&&v.k("Viewbox Panel cannot contain more than one GraphObject.");
var He=m[0];He.Tb=1;He.$o();Rh(He,Infinity,Infinity,Sp,Tp);var Gi=He.Ba,kk=He.margin,Up=kk.right+kk.left,Vp=kk.top+kk.bottom;if(isFinite($g)||isFinite(jk)){var Tr=He.scale,lk=Gi.width,mk=Gi.height,Wp=Math.max($g-Up,0),Xp=Math.max(jk-Vp,0),Hi=1;this.Ao===vh?0!==lk&&0!==mk&&(Hi=Math.min(Wp/lk,Xp/mk)):0!==lk&&0!==mk&&(Hi=Math.max(Wp/lk,Xp/mk));0===Hi&&(Hi=1E-4);He.Tb*=Hi;Tr!==He.scale&&(Dj(He,!0),Rh(He,Infinity,Infinity,Sp,Tp))}Gi=He.Ba;e.width=isFinite($g)?$g:Math.max(Gi.width+Up,0);e.height=isFinite(jk)?
jk:Math.max(Gi.height+Vp,0);break;case "Link":var Yp=m.length,wg=this instanceof mf?this.Sh:this;if(wg instanceof W)if(0===Yp){var nk=this.Jc;eb(nk,0,0);var ae=this.Ba;ae.m(0,0,0,0)}else{var ok=this instanceof mf?null:wg.path,Ze=wg.cn,Ie=this.Ji;Ie.assign(Ze);Ie.x=0;var Lh=Ie.y=0,Ii=wg.points,Lh=void 0!==this.ma?this.ma:Ii.count;this.Kg.m(Ze.x,Ze.y);this.ej.clear();null!==ok&&(Ym(ok,Ze.width,Ze.height),ae=ok.Ba,Ie.bi(ae),this.ej.add(ae));for(var Mh=v.nh(),Ji=v.M(),Xf=v.M(),wm=0;wm<Yp;wm++){var Qb=
m[wm];if(Qb!==ok)if(Qb.Lf&&Qb instanceof X)Ym(Qb,Ze.width,Ze.height),ae=Qb.Ba,Ie.bi(ae),this.ej.add(ae);else if(2>Lh)Rh(Qb,Infinity,Infinity),ae=Qb.Ba,Ie.bi(ae),this.ej.add(ae);else{var Yf=Qb.pe,$p=Qb.qx,xm=Qb.Pj;xm.me()&&(xm=Kb);var Ki=Qb.Pt,Ur=Qb.hF,Li=0,Mi=0,pk=0;if(Yf<-Lh||Yf>=Lh){var aq=wg.HE,Ni=wg.GE;Ki!==gh&&(pk=wg.computeAngle(Qb,Ki,Ni),Qb.angle=pk);Li=aq.x-Ze.x;Mi=aq.y-Ze.y}else{var vf,Nh;if(0<=Yf)vf=Ii.ha(Yf),Nh=Yf<Lh-1?Ii.ha(Yf+1):vf;else{var ym=Lh+Yf;vf=Ii.ha(ym);Nh=0<ym?Ii.ha(ym-1):vf}Ni=
0<=Yf?vf.Wg(Nh):Nh.Wg(vf);Ki!==gh&&(pk=wg.computeAngle(Qb,Ki,Ni),Qb.on=pk);Li=vf.x+(Nh.x-vf.x)*$p-Ze.x;Mi=vf.y+(Nh.y-vf.y)*$p-Ze.y}Rh(Qb,Infinity,Infinity);var ae=Qb.Ba,nk=Qb.Fa,Oi=0;Qb instanceof X&&(Oi=Qb.nb);var qk=nk.width+Oi,zm=nk.height+Oi;Mh.reset();Mh.translate(-ae.x,-ae.y);Mh.scale(Qb.scale,Qb.scale);Mh.rotate(Ki===gh?Qb.angle:Ni,qk/2,zm/2);var Oh=new z(0,0,qk,zm);Ji.St(Oh,xm);Mh.xb(Ji);var Vr=-Ji.x+Oi/2,Wr=-Ji.y+Oi/2;Xf.assign(Ur);isNaN(Xf.x)&&(Xf.x=0<=Yf?qk/2+3:-(qk/2+3));isNaN(Xf.y)&&
(Xf.y=-(zm/2+3));Xf.rotate(Ni);Li+=Xf.x;Mi+=Xf.y;Oh.set(ae);Oh.x=Li+Vr;Oh.y=Mi+Wr;this.ej.add(Oh);Ie.bi(Oh)}}if(this.we)for(var bq=this.Mf;bq.next();)Rh(bq.value,Infinity,Infinity);this.Ji=Ie;var Am=this.Kg;Am.m(Am.x+Ie.x,Am.y+Ie.y);eb(e,Ie.width||0,Ie.height||0);v.Xe(Mh);v.v(Ji);v.v(Xf)}break;case "Grid":break;case "TableRow":case "TableColumn":v.k(this.toString()+" is not an element of a Table Panel. TableRow and TableColumn Panels can only be elements of a Table Panel.");break;default:v.k("Unknown panel type: "+
n)}}var Je=e.width,Ke=e.height,rk=this.padding,Xr=rk.top+rk.bottom,Je=Je+(rk.left+rk.right),Ke=Ke+Xr;isFinite(f.width)&&(Je=f.width);isFinite(f.height)&&(Ke=f.height);Je=Math.min(k.width,Je);Ke=Math.min(k.height,Ke);Je=Math.max(h.width,Je);Ke=Math.max(h.height,Ke);Je=Math.max(c,Je);Ke=Math.max(d,Ke);e.width=Je;e.height=Ke;eb(this.Jc,Je,Ke);vl(this,0,0,Je,Ke)};
C.prototype.findMainElement=C.prototype.If=function(){if(null===this.wm){var a=this.wa.n,b=a.length;if(0===b)return null;for(var c=0;c<b;c++){var d=a[c];if(!0===d.Lf)return this.wm=d}this.wm=a[0]}return this.wm};
C.prototype.Li=function(a,b,c,d){var e=this.Ji,f=this.wa.n,h=v.ek(0,0,0,0);if(0===f.length){var k=this.Z;k.x=a;k.y=b;k.width=c;k.height=d}else{if(!this.xa.H()){var l=yl(this,!0),m=this.Vc,n=m.width,p=m.height,q=this.margin,r=q.left+q.right,s=q.top+q.bottom;n===c&&p===d&&(l=th);switch(l){case th:if(n>c||p>d)this.P(),Rh(this,n>c?c:n,p>d?d:p);break;case ed:this.P(!0);Rh(this,c+r,d+s,0,0);break;case ol:this.P(!0);Rh(this,c+r,p+s,0,0);break;case nl:this.P(!0),Rh(this,n+r,d+s,0,0)}}k=this.Z;k.x=a;k.y=b;
k.width=c;k.height=d;var t=this.ia.Ob;switch(t){case "Position":for(var u=f.length,x=e.x-this.padding.left,y=e.y-this.padding.top,A=0;A<u;A++){var B=f[A],I=B.Ba,D=B.margin,V=B.position.x,ba=B.position.y;h.x=isNaN(V)?-x:V-x;h.y=isNaN(ba)?-y:ba-y;if(B instanceof X){var U=B;if(U.sE){var N=U.nb/2;h.x-=N;h.y-=N}}h.x+=D.left;h.y+=D.top;h.width=I.width;h.height=I.height;B.visible&&B.zc(h.x,h.y,h.width,h.height)}break;case "Vertical":for(var Z=f.length,Ga=this.padding.left,ta=this.padding.top,Pa=0;Pa<Z;Pa++){var la=
Ga,Ca=f[Pa];if(Ca.visible){var qa=Ca.Ba,cc=Ca.margin,id=cc.left+cc.right,Pf=Ga+this.padding.right,dc=qa.width,Ve=yl(Ca,!1);if(isNaN(Ca.xa.width)&&Ve===ed||Ve===ol)dc=Math.max(e.width-id-Pf,0);var Qf=dc+id+Pf,Ta=Ca.alignment;Ta.Oc()&&(Ta=this.dl);Ta.yd()||(Ta=Kb);Ca.zc(la+Ta.offsetX+cc.left+(e.width*Ta.x-Qf*Ta.x),ta+Ta.offsetY+cc.top,dc,qa.height);ta+=qa.height+cc.bottom+cc.top}}break;case "Horizontal":for(var fb=f.length,xa=this.padding.top,za=this.padding.left,kb=0;kb<fb;kb++){var Hb=xa,ab=f[kb];
if(ab.visible){var jc=ab.Ba,ie=ab.margin,qc=ie.top+ie.bottom,Rd=xa+this.padding.bottom,je=jc.height,We=yl(ab,!1);if(isNaN(ab.xa.height)&&We===ed||We===nl)je=Math.max(e.height-qc-Rd,0);var qf=je+qc+Rd,Sd=ab.alignment;Sd.Oc()&&(Sd=this.dl);Sd.yd()||(Sd=Kb);ab.zc(za+Sd.offsetX+ie.left,Hb+Sd.offsetY+ie.top+(e.height*Sd.y-qf*Sd.y),jc.width,je);za+=jc.width+ie.left+ie.right}}break;case "Spot":var Ib=f.length,Mb=this.If(),Lc=Mb.Ba,Og=Lc.width,Nb=Lc.height,Bb=this.padding,ec=Bb.left,lb=Bb.top;h.x=ec-e.x;
h.y=lb-e.y;Mb.zc(h.x,h.y,Og,Nb);for(var Ae=0;Ae<Ib;Ae++){var Td=f[Ae];if(Td!==Mb){var qg=Td.Ba,Rf=qg.width,Cb=qg.height,jd=Td.alignment;jd.Oc()&&(jd=this.dl);jd.yd()||(jd=Kb);var rc=Td.Pj;rc.Oc()&&(rc=Kb);h.x=jd.x*Og+jd.offsetX-(rc.x*Rf-rc.offsetX);h.y=jd.y*Nb+jd.offsetY-(rc.y*Cb-rc.offsetY);h.x-=e.x;h.y-=e.y;Td.visible&&Td.zc(ec+h.x,lb+h.y,Rf,Cb)}}break;case "Auto":var yb=f.length,Mc=this.If(),Ob=Mc.Ba,Na=v.Uf();Na.m(0,0,1,1);var gb=Mc.margin,Db=gb.left,fc=gb.top,Ud=this.padding,Vd=Ud.left,rf=Ud.top;
h.x=Db;h.y=fc;h.width=Ob.width;h.height=Ob.height;Mc.zc(Vd+h.x,rf+h.y,h.width,h.height);var Be=Um(Mc),sf=Vm(Mc),Sb=0+Be.y*Ob.height+Be.offsetY,db=0+sf.x*Ob.width+sf.offsetX,sc=0+sf.y*Ob.height+sf.offsetY;Na.x=0+Be.x*Ob.width+Be.offsetX;Na.y=Sb;rb(Na,db,sc,0,0);Na.x+=Db+Vd;Na.y+=fc+rf;for(var Yc=0;Yc<yb;Yc++){var kd=f[Yc];if(kd!==Mc){var bb=kd.Ba,gb=kd.margin,vb=Math.max(bb.width+gb.right+gb.left,0),kc=Math.max(bb.height+gb.top+gb.bottom,0),ld=kd.alignment;ld.Oc()&&(ld=this.dl);ld.yd()||(ld=Kb);h.x=
Na.width*ld.x+ld.offsetX-vb*ld.x+gb.left+Na.x;h.y=Na.height*ld.y+ld.offsetY-kc*ld.y+gb.top+Na.y;h.width=Na.width;h.height=Na.height;kd.visible&&(sb(Na.x,Na.y,Na.width,Na.height,h.x,h.y,bb.width,bb.height)?kd.zc(h.x,h.y,bb.width,bb.height):kd.zc(h.x,h.y,bb.width,bb.height,new z(Na.x,Na.y,Na.width,Na.height)))}}v.fc(Na);break;case "Table":for(var Pg=f.length,Qg=this.padding,Rg=Qg.left,Sf=Qg.top,Nc=this.Wr,Zc=0,Oc=0,mb=Nc.length,ke=0,nb=0;nb<mb;nb++)Nc[nb]&&(ke=Math.max(ke,Nc[nb].length));for(var Ec=
Math.min(this.Ii,mb-1);Ec!==mb&&(void 0===this.Gd[Ec]||0===this.Gd[Ec].ab);)Ec++;for(var Ec=Math.min(Ec,mb-1),Ce=-this.Gd[Ec].Xa,Eb=Math.min(this.ui,ke-1);Eb!==ke&&(void 0===this.Cd[Eb]||0===this.Cd[Eb].ab);)Eb++;for(var Eb=Math.min(Eb,ke-1),Fb=-this.Cd[Eb].Xa,md=v.El(),nb=0;nb<mb;nb++)if(Nc[nb])for(var ke=Nc[nb].length,$c=this.bd(nb),Oc=$c.Xa+Ce+Sf+$c.GD(),Wd=0;Wd<ke;Wd++)if(Nc[nb][Wd])for(var Xd=this.ad(Wd),Zc=Xd.Xa+Fb+Rg+Xd.GD(),Xe=Nc[nb][Wd],um=Xe.length,Di=0;Di<um;Di++){var Ea=Xe[Di],De=Ea.Ba,
Yd=Ea instanceof C?Ea:null;if(null===Yd||Yd.type!==Cl&&Yd.type!==Dl){md.m(0,0);for(var da=1;da<Ea.rowSpan&&!(nb+da>=this.zp);da++){var ca=this.bd(nb+da);md.height+=ca.total}for(da=1;da<Ea.JG&&!(Wd+da>=this.Ko);da++){var rg=this.ad(Wd+da);md.width+=rg.total}var Sg=Xd.ab+md.width,Ih=$c.ab+md.height;h.x=Zc;h.y=Oc;h.width=Sg;h.height=Ih;var ad=Zc,Jh=Oc,Tb=Sg,Tg=Ih;Zc+Sg>e.width&&(Tb=Math.max(e.width-Zc,0));Oc+Ih>e.height&&(Tg=Math.max(e.height-Oc,0));var bd=Ea.alignment,le=0,Pc=0,nd=0,Fc=0;if(bd.Oc()){bd=
this.dl;bd.yd()||(bd=Kb);var le=bd.x,Pc=bd.y,nd=bd.offsetX,Fc=bd.offsetY,od=Xd.alignment,Tf=$c.alignment;od.yd()&&(le=od.x,nd=od.offsetX);Tf.yd()&&(Pc=Tf.y,Fc=Tf.offsetY)}else le=bd.x,Pc=bd.y,nd=bd.offsetX,Fc=bd.offsetY;if(isNaN(le)||isNaN(Pc))Pc=le=.5,Fc=nd=0;var aa=De.width,me=De.height,Ee=Ea.margin,dk=Ee.left+Ee.right,ek=Ee.top+Ee.bottom,Gc=Rl(Ea,$c,Xd,!1);!isNaN(Ea.xa.width)||Gc!==ed&&Gc!==ol||(aa=Math.max(Sg-dk,0));!isNaN(Ea.xa.height)||Gc!==ed&&Gc!==nl||(me=Math.max(Ih-ek,0));var hb=Ea.af,ib=
Ea.ug,aa=Math.min(hb.width,aa),me=Math.min(hb.height,me),aa=Math.max(ib.width,aa),me=Math.max(ib.height,me),fk=me+ek;h.x+=h.width*le-(aa+dk)*le+nd+Ee.left;h.y+=h.height*Pc-fk*Pc+Fc+Ee.top;Ea.visible&&(sb(ad,Jh,Tb,Tg,h.x,h.y,De.width,De.height)?Ea.zc(h.x,h.y,aa,me):Ea.zc(h.x,h.y,aa,me,new z(ad,Jh,Tb,Tg)))}else{Ea.pi();Ea.kc.Na();var Uf=Ea.kc;Uf.x=Yd.type===Cl?Rg:Zc;Uf.y=Yd.type===Dl?Sf:Oc;Uf.width=De.width;Uf.height=De.height;Ea.kc.freeze();Al(Ea,!1)}}v.Wj(md);for(nb=0;nb<Pg;nb++)Ea=f[nb],Yd=Ea instanceof
C?Ea:null,null===Yd||Yd.type!==Cl&&Yd.type!==Dl||(Uf=Ea.kc,Ea.Jc.Na(),Ea.Jc.m(0,0,Uf.width,Uf.height),Ea.Jc.freeze());break;case "Viewbox":var sg=f[0],tg=sg.Ba,Pb=sg.margin,Vf=Pb.top+Pb.bottom,Wf=Math.max(tg.width+(Pb.right+Pb.left),0),Zd=Math.max(tg.height+Vf,0),ne=sg.alignment;ne.Oc()&&(ne=this.dl);ne.yd()||(ne=Kb);h.x=e.width*ne.x-Wf*ne.x+ne.offsetX;h.y=e.height*ne.y-Zd*ne.y+ne.offsetY;h.width=tg.width;h.height=tg.height;sg.zc(h.x,h.y,h.width,h.height);break;case "Link":var vm=f.length,Kh=this instanceof
mf?this.Sh:this;if(Kh instanceof W){var Fe=this instanceof mf?null:Kh.path,Ge=this.ej.n,pd=0;if(null!==Fe&&pd<this.ej.count){var tc=Ge[pd];pd++;Fe.zc(tc.x-this.Ji.x,tc.y-this.Ji.y,tc.width,tc.height)}for(var $d=0;$d<vm;$d++){var gk=f[$d];gk!==Fe&&pd<this.ej.count&&(tc=Ge[pd],pd++,gk.zc(tc.x-this.Ji.x,tc.y-this.Ji.y,tc.width,tc.height))}var hk=Kh.points,Ei=hk.count;if(2<=Ei&&this.we)for(var Ug=this.Mf;Ug.next();){var uc=Ug.value,ob=Ei,oe=hk,Qc=uc.pe,Vg=uc.qx,pe=uc.Pj,cb=uc.Pt,Wg=uc.hF,gc=0,tf=0,ug=
0;if(Qc<-ob||Qc>=ob){var vc=this.HE,vg=this.GE;cb!==gh&&(ug=this.computeAngle(uc,cb,vg),uc.angle=ug);gc=vc.x;tf=vc.y}else{var qd=void 0,qe=void 0;if(0<=Qc)qd=oe.n[Qc],qe=Qc<ob-1?oe.n[Qc+1]:qd;else var uf=ob+Qc,qd=oe.n[uf],qe=0<uf?oe.n[uf-1]:qd;vg=0<=Qc?qd.Wg(qe):qe.Wg(qd);cb!==gh&&(ug=this.computeAngle(uc,cb,vg),uc.angle=ug);gc=qd.x+(qe.x-qd.x)*Vg;tf=qd.y+(qe.y-qd.y)*Vg}if(pe.L(xb))uc.location=new w(gc,tf);else{pe.me()&&(pe=Kb);var Ye=v.nh();Ye.reset();Ye.scale(uc.scale,uc.scale);Ye.rotate(uc.angle,
0,0);var Fi=uc.Fa,Ed=v.ek(0,0,Fi.width,Fi.height),Rc=v.M();Rc.St(Ed,pe);Ye.xb(Rc);var Yg=-Rc.x,Zg=-Rc.y,hc=Wg.copy();isNaN(hc.x)&&(hc.x=0<=Qc?Rc.x+3:-(Rc.x+3));isNaN(hc.y)&&(hc.y=-(Rc.y+3));hc.rotate(vg);gc+=hc.x;tf+=hc.y;Ye.DF(Ed);var Yg=Yg+Ed.x,Zg=Zg+Ed.y,$g=v.Rb(gc+Yg,tf+Zg);uc.move($g);v.v($g);v.v(Rc);v.fc(Ed);v.Xe(Ye)}}this instanceof mf?this.wt(!1):Kh.wt(!1)}break;case "Grid":break;case "TableRow":case "TableColumn":v.k(this.toString()+" is not an element of a Table Panel.TableRow and TableColumn panels can only be elements of a Table Panel.");
break;default:v.k("Unknown panel type: "+t)}v.fc(h)}};C.prototype.Rj=function(a){var b=this.Fa;if(sb(0,0,b.width,b.height,a.x,a.y)){for(var b=this.wa.n,c=b.length,d=v.Rb(0,0);c--;){var e=b[c];if(e.visible||e===this.ac)if(Xa(d.set(a),e.transform),e.Ca(d))return v.v(d),!0}v.v(d);return null===this.Jb&&null===this.lc?!1:!0}return!1};C.prototype.Dw=function(a){if(this.qn===a)return this;for(var b=this.wa.n,c=b.length,d=0;d<c;d++){var e=b[d].Dw(a);if(null!==e)return e}return null};
function Zm(a,b,c){c(a,b);if(b instanceof C){b=b.wa.n;for(var d=b.length,e=0;e<d;e++)Zm(a,b[e],c)}}function Tj(a,b){$m(a,a,b)}function $m(a,b,c){c(b);b=b.wa.n;for(var d=b.length,e=0;e<d;e++){var f=b[e];f instanceof C&&$m(a,f,c)}}C.prototype.walkVisualTree=function(a){an(this,this,a)};function an(a,b,c){c(b);if(b instanceof C){b=b.wa.n;for(var d=b.length,e=0;e<d;e++)an(a,b[e],c)}}C.prototype.findInVisualTree=C.prototype.Vs=function(a){return bn(this,this,a)};
function bn(a,b,c){if(c(b))return b;if(b instanceof C){b=b.wa.n;for(var d=b.length,e=0;e<d;e++){var f=bn(a,b[e],c);if(null!==f)return f}}return null}C.prototype.findObject=C.prototype.Yd=function(a){if(this.name===a)return this;for(var b=this.wa.n,c=b.length,d=0;d<c;d++){var e=b[d];if(e.name===a)return e;if(e instanceof C)if(null===e.si&&null===e.ag){if(e=e.Yd(a),null!==e)return e}else if(Ck(e)&&(e=e.wa.first(),null!==e&&(e=e.Yd(a),null!==e)))return e}return null};
function cn(a){a=a.wa.n;for(var b=a.length,c=0,d=0;d<b;d++){var e=a[d];if(e instanceof C)c=Math.max(c,cn(e));else if(e instanceof X){a:{if(!e.Qg)switch(e.Mn){case "None":case "Square":case "Ellipse":case "Circle":case "LineH":case "LineV":case "FramedRectangle":case "RoundedRectangle":case "Line1":case "Line2":case "Border":case "Cube1":case "Cube2":case "Junction":case "Cylinder1":case "Cylinder2":case "Cylinder3":case "Cylinder4":case "PlusLine":case "XLine":case "ThinCross":case "ThickCross":e=
0;break a}e=e.Sg/2*e.vm*e.Si()}c=Math.max(c,e)}}return c}g=C.prototype;g.Vf=function(){return!(this.type===Cl||this.type===Dl)};
g.le=function(a,b,c){if(!1===this.yg)return null;void 0===b&&(b=null);void 0===c&&(c=null);if(Kj(this))return null;var d=this.Fa,e=1/this.Si(),f=this.Vf(),h=f?a:Xa(v.Rb(a.x,a.y),this.transform),k=this.g,l=10,m=5;null!==k&&(l=k.Wo("extraTouchArea"),m=l/2);if(sb(-(m*e),-(m*e),d.width+l*e,d.height+l*e,h.x,h.y)){if(!this.Ig){var e=this.wa.n,n=e.length,k=v.M(),m=(l=this.qE)?this.If():null;if(l&&(m.Vf()?Xa(k.set(a),m.transform):k.set(a),!m.Ca(k)))return v.v(k),f||v.v(h),null;for(;n--;){var p=e[n];if(p.visible||
p===this.ac)if(p.Vf()?Xa(k.set(a),p.transform):k.set(a),!l||p!==m){var q=null;p instanceof C?q=p.le(k,b,c):!0===p.yg&&p.Ca(k)&&(q=p);if(null!==q&&(null!==b&&(q=b(q)),null!==q&&(null===c||c(q))))return v.v(k),f||v.v(h),q}}v.v(k)}if(null===this.background&&null===this.Cm)return f||v.v(h),null;a=sb(0,0,d.width,d.height,h.x,h.y)?this:null;f||v.v(h);return a}f||v.v(h);return null};
g.Ys=function(a,b,c,d){if(!1===this.yg)return!1;void 0===b&&(b=null);void 0===c&&(c=null);d instanceof G||d instanceof H||(d=new G(R));var e=this.Fa,f=this.Vf(),h=f?a:Xa(v.Rb(a.x,a.y),this.transform);if(sb(0,0,e.width,e.height,h.x,h.y)){if(!this.Ig){for(var e=this.wa.n,k=e.length,l=v.M();k--;){var m=e[k];if(m.visible||m===this.ac){m.Vf()?Xa(l.set(a),m.transform):l.set(a);var n=m,m=m instanceof C?m:null;(null!==m?m.Ys(l,b,c,d):n.Ca(l))&&!1!==n.yg&&(null!==b&&(n=b(n)),null===n||null!==c&&!c(n)||d.add(n))}}v.v(l)}f||
v.v(h);return null!==this.background||null!==this.Cm}f||v.v(h);return!1};
g.Vj=function(a,b,c,d,e,f){if(!1===this.yg)return!1;void 0===b&&(b=null);void 0===c&&(c=null);var h=f;void 0===f&&(h=v.nh(),h.reset());h.multiply(this.transform);if(this.Hm(a,h))return dn(this,b,c,e),void 0===f&&v.Xe(h),!0;if(this.tg(a,h)){if(!this.Ig)for(var k=this.wa.n,l=k.length;l--;){var m=k[l];if(m.visible||m===this.ac){var n=m.Z,p=this.Fa;if(!(n.x>p.width||n.y>p.height||0>n.x+n.width||0>n.y+n.height)){n=m;m=m instanceof C?m:null;p=v.nh();p.set(h);if(null!==m?m.Vj(a,b,c,d,e,p):xl(n,a,d,p))null!==
b&&(n=b(n)),null===n||null!==c&&!c(n)||e.add(n);v.Xe(p)}}}void 0===f&&v.Xe(h);return d}void 0===f&&v.Xe(h);return!1};function dn(a,b,c,d){for(var e=a.wa.n,f=e.length;f--;){var h=e[f];if(h.visible){var k=h.Z,l=a.Fa;k.x>l.width||k.y>l.height||0>k.x+k.width||0>k.y+k.height||(h instanceof C&&dn(h,b,c,d),null!==b&&(h=b(h)),null===h||null!==c&&!c(h)||d.add(h))}}}
g.Om=function(a,b,c,d,e,f){if(!1===this.yg)return!1;void 0===c&&(c=null);void 0===d&&(d=null);var h=this.Fa,k=this.Vf(),l=k?a:Xa(v.Rb(a.x,a.y),this.transform),m=k?b:Xa(v.Rb(b.x,b.y),this.transform),n=l.Tj(m),p=0<l.x&&l.x<h.width&&0<l.y&&l.y<h.height||Ya(l.x,l.y,0,0,0,h.height)<n||Ya(l.x,l.y,0,h.height,h.width,h.height)<n||Ya(l.x,l.y,h.width,h.height,h.width,0)<n||Ya(l.x,l.y,h.width,0,0,0)<n,h=0<l.x&&l.x<h.width&&0<l.y&&l.y<h.height&&Ya(l.x,l.y,0,0,0,h.height)<n&&Ya(l.x,l.y,0,h.height,h.width,h.height)<
n&&Ya(l.x,l.y,h.width,h.height,h.width,0)<n&&Ya(l.x,l.y,h.width,0,0,0)<n;k||(v.v(l),v.v(m));if(p){if(!this.Ig){k=v.M();l=v.M();m=this.wa.n;for(n=m.length;n--;){var q=m[n];if(q.visible||q===this.ac){var r=q.Z,s=this.Fa;r.x>s.width||r.y>s.height||0>r.x+r.width||0>r.y+r.height||(q.Vf()?(r=q.transform,Xa(k.set(a),r),Xa(l.set(b),r)):(k.set(a),l.set(b)),r=q,q=q instanceof C?q:null,null!==q?!q.Om(k,l,c,d,e,f):!r.$D(k,l,e))||(null!==c&&(r=c(r)),null===r||null!==d&&!d(r)||f.add(r))}}v.v(k);v.v(l)}return e?
p:h}return!1};function Um(a){var b=a.A;if(void 0===b||b===yc)b=null;null===b&&a instanceof X&&(a=a.Ta,null!==a&&(b=a.A));null===b&&(b=zb);return b}function Vm(a){var b=a.B;if(void 0===b||b===yc)b=null;null===b&&a instanceof X&&(a=a.Ta,null!==a&&(b=a.B));null===b&&(b=Vb);return b}C.prototype.add=C.prototype.add=function(a){v.C(a,R,C,"add:element");this.xd(this.wa.count,a)};C.prototype.elt=C.prototype.ha=function(a){return this.wa.ha(a)};
C.prototype.insertAt=C.prototype.xd=function(a,b){b instanceof J&&v.k("Cannot add a Part to a Panel: "+b);if(this===b||this.rl(b))this===b&&v.k("Cannot make a Panel contain itself: "+this.toString()),v.k("Cannot make a Panel indirectly contain itself: "+this.toString()+" already contains "+b.toString());var c=b.T;null!==c&&c!==this&&v.k("Cannot add a GraphObject that already belongs to another Panel to this Panel: "+b.toString()+", already contained by "+c.toString()+", cannot be shared by this Panel: "+
this.toString());this.ia!==kj||b instanceof X||v.k("Can only add Shapes to a Grid Panel, not: "+b);b.Al(this);b.km=null;if(null!==this.yE){var d=b.data;null!==d&&"object"===typeof d&&(null===this.$f&&(this.$f=new ma(Object,C)),this.$f.add(d,b))}var e=this.wa,d=-1;if(c===this){for(var f=-1,h=this.wa.n,k=h.length,l=0;l<k;l++)if(h[l]===b){f=l;break}if(-1!==f){if(f===a||f+1>=e.count&&a>=e.count)return;e.Rc(f);d=f}else v.k("element "+b.toString()+" has panel "+c.toString()+" but is not contained by it.")}if(0>
a||a>e.count)a=e.count;e.xd(a,b);this.P();b.P();null!==b.Od?this.Bh=!0:b instanceof C&&!0===b.Bh&&(this.Bh=!0);c=this.V;null!==c&&(c.Mk=null,c.vj=NaN,this.Bh&&c instanceof S&&(c.Bh=!0),c.Bh&&(c.Sd=null),e=this.g,null!==e&&e.ja.ib||(-1!==d&&c.Ec(be,"elements",this,b,null,d,null),c.Ec(Qd,"elements",this,null,b,null,a)))};C.prototype.remove=C.prototype.remove=function(a){v.C(a,R,C,"remove:element");for(var b=this.wa.n,c=b.length,d=-1,e=0;e<c;e++)if(b[e]===a){d=e;break}-1!==d&&this.Ke(d)};
C.prototype.removeAt=C.prototype.Rc=function(a){0<=a&&this.Ke(a)};C.prototype.Ke=function(a){var b=this.wa,c=b.ha(a);c.km=null;c.Al(null);if(null!==this.$f){var d=c.data;"object"===typeof d&&this.$f.remove(d)}b.Rc(a);Dj(this,!1);this.P();this.wm===c&&(this.wm=null);b=this.V;null!==b&&(b.Mk=null,b.vj=NaN,d=this.g,null!==d&&d.ja.ib||b.Ec(be,"elements",this,c,null,a,null))};v.u(C,{zp:"rowCount"},function(){return void 0===this.Gd?0:this.Gd.length});
C.prototype.getRowDefinition=C.prototype.bd=function(a){0>a&&v.ua(a,">= 0",C,"getRowDefinition:idx");a=Math.round(a);var b=this.Gd;if(void 0===b[a]){var c=new Ue;c.Al(this);c.ae=!0;c.index=a;b[a]=c}return b[a]};C.prototype.removeRowDefinition=C.prototype.VE=function(a){0>a&&v.ua(a,">= 0",C,"removeRowDefinition:idx");a=Math.round(a);var b=this.Gd;this.Ec(be,"coldefs",this,b[a],null,a,null);b[a]&&delete b[a];this.P()};v.u(C,{Ko:"columnCount"},function(){return void 0===this.Cd?0:this.Cd.length});
C.prototype.getColumnDefinition=C.prototype.ad=function(a){0>a&&v.ua(a,">= 0",C,"getColumnDefinition:idx");a=Math.round(a);var b=this.Cd;if(void 0===b[a]){var c=new Ue;c.Al(this);c.ae=!1;c.index=a;b[a]=c}return b[a]};C.prototype.removeColumnDefinition=C.prototype.RE=function(a){0>a&&v.ua(a,">= 0",C,"removeColumnDefinition:idx");a=Math.round(a);var b=this.Cd;this.Ec(be,"coldefs",this,b[a],null,a,null);b[a]&&delete b[a];this.P()};
v.defineProperty(C,{OI:"rowSizing"},function(){return void 0===this.qm?Qm:this.qm},function(a){if(void 0!==this.qm){var b=this.qm;b!==a&&(a!==Qm&&a!==Xm&&v.k("Panel.rowSizing must be RowColumnDefinition.ProportionalExtra or RowColumnDefinition.None, not: "+a),this.qm=a,this.P(),this.h("rowSizing",b,a))}});
v.defineProperty(C,{IG:"columnSizing"},function(){return void 0===this.Ml?Qm:this.Ml},function(a){if(void 0!==this.Ml){var b=this.Ml;b!==a&&(a!==Qm&&a!==Xm&&v.k("Panel.columnSizing must be RowColumnDefinition.ProportionalExtra or RowColumnDefinition.None, not: "+a),this.Ml=a,this.P(),this.h("columnSizing",b,a))}});
v.defineProperty(C,{qL:"topIndex"},function(){return void 0===this.Ii?0:this.Ii},function(a){if(void 0!==this.Ii){var b=this.Ii;b!==a&&((!isFinite(a)||0>a)&&v.k("Panel.topIndex must be greater than zero and a real number, not: "+a),this.Ii=a,this.P(),this.h("topIndex",b,a))}});
v.defineProperty(C,{AK:"leftIndex"},function(){return void 0===this.ui?0:this.ui},function(a){if(void 0!==this.ui){var b=this.ui;b!==a&&((!isFinite(a)||0>a)&&v.k("Panel.leftIndex must be greater than zero and a real number, not: "+a),this.ui=a,this.P(),this.h("leftIndex",b,a))}});C.prototype.findRowForLocalY=function(a){if(0>a)return-1;if(this.type!==Ql)return NaN;for(var b=0,c=this.Gd,d=c.length,e=this.Ii;e<d;e++){var f=c[e];if(void 0!==f&&(b+=f.total,a<b))return e}return-1};
C.prototype.findColumnForLocalX=function(a){if(0>a)return-1;if(this.type!==Ql)return NaN;for(var b=0,c=this.Cd,d=c.length,e=this.ui;e<d;e++){var f=c[e];if(void 0!==f&&(b+=f.total,a<b))return e}return-1};
v.defineProperty(C,{data:"data"},function(){return this.uh},function(a){var b=this.uh;if(b!==a){var c=this instanceof J&&!(this instanceof mf);c&&v.j(a,"object",C,"data");of(this);this.uh=a;var d=this.g;null!==d&&(c?this instanceof W?(null!==b&&d.vk.remove(b),null!==a&&d.vk.add(a,this)):this instanceof J&&(null!==b&&d.ki.remove(b),null!==a&&d.ki.add(a,this)):(c=this.T,null!==c&&null!==c.$f&&(null!==b&&c.$f.remove(b),null!==a&&c.$f.add(a,this))));this.h("data",b,a);null!==d&&d.ja.ib||null!==a&&this.Ib()}});
v.defineProperty(C,{UH:"itemIndex"},function(){return this.Xq},function(a){var b=this.Xq;b!==a&&(this.Xq=a,this.h("itemIndex",b,a))});function $l(a){a=a.Kl;return null!==a&&a.Ea}
function of(a){var b=a.Kl;if(null===b)null!==a.data&&v.k("Template cannot have .data be non-null: "+a),a.Kl=b=new G(cf);else if(b.Ea)return;var c=new G(R);Zm(a,a,function(a,d){var e=d.Hc;if(null!==e)for(Ul(d,!1),e=e.i;e.next();){var f=e.value;f.mode===ef&&Ul(d,!0);if(null!==f.dn){var h=ff(f,a,d);null!==h&&(c.add(h),null===h.ro&&(h.ro=new G(cf)),h.ro.add(f))}b.add(f)}if(d instanceof C&&d.type===Ql){if(0<d.Gd.length)for(e=d.Gd,f=e.length,h=0;h<f;h++){var k=e[h];if(void 0!==k&&null!==k.Hc)for(var l=
k.Hc.i;l.next();){var u=l.value;u.ig=k;u.$y=2;u.Xv=k.index;b.add(u)}}if(0<d.Cd.length)for(e=d.Cd,f=e.length,h=0;h<f;h++)if(k=e[h],void 0!==k&&null!==k.Hc)for(l=k.Hc.i;l.next();)u=l.value,u.ig=k,u.$y=1,u.Xv=k.index,b.add(u)}});for(var d=c.i;d.next();){var e=d.value;if(null!==e.ro){Ul(e,!0);for(var f=e.ro.i;f.next();){var h=f.value;null===e.Hc&&(e.Hc=new G(cf));e.Hc.add(h)}}e.ro=null}for(d=b.i;d.next();)if(e=d.value,f=e.ig,null!==f){e.ig=null;var k=e.Ax,l=k.indexOf(".");0<l&&f instanceof C&&(h=k.substring(0,
l),k=k.substr(l+1),l=f.Yd(h),null!==l?(f=l,e.Ax=k):v.trace('Warning: unable to find GraphObject named "'+h+'" for Binding: '+e.toString()));f instanceof Ue?(e.Dl=v.cd(f.T),f.T.qn=e.Dl):(e.Dl=v.cd(f),f.qn=e.Dl)}b.freeze();a instanceof J&&a.Ld()&&(Rh(a,Infinity,Infinity),a.zc())}
C.prototype.updateTargetBindings=C.prototype.Ib=function(a){var b=this.Kl;if(null!==b)for(void 0===a&&(a=""),b=b.i;b.next();){var c=b.value,d=c.qF;if(""===a||""===d||d===a)if(d=c.Ax,null!==c.OG||""!==d){var d=this.data,e=c.dn;if(null!==e)d=""===e?this:"."===e?this:".."===e?this:this.Yd(e);else{var f=this.g;null!==f&&c.$t&&(d=f.da.yt)}if(null!==d){var f=this,h=c.Dl;if(-1!==h){if(f=this.Dw(h),null===f)continue}else null!==c.ig&&(f=c.ig);"."===e?d=f:".."===e&&(d=f.T);e=c.$y;if(0!==e){if(!(f instanceof
C))continue;h=f;1===e?f=h.ad(c.Xv):2===e&&(f=h.bd(c.Xv))}void 0!==f&&c.GF(f,d)}}}};v.defineProperty(C,{yE:"itemArray"},function(){return this.si},function(a){var b=this.si;if(b!==a){var c=this.g;null!==c&&null!==b&&Zj(c,this);this.si=a;null!==c&&null!==a&&Vj(c,this);this.h("itemArray",b,a);null!==c&&c.ja.ib||this.qA()}});function Ck(a){return a.type===rh||a.type===gj||a.type===dh||a.type===Ql&&0<a.wa.length&&(a=a.wa.ha(0),a.Lf&&a instanceof C&&(a.type===Cl||a.type===Dl))?!0:!1}
C.prototype.rebuildItemElements=C.prototype.qA=function(){var a=0;for(Ck(this)&&(a=1);this.wa.length>a;)this.Ke(a);a=this.yE;if(null!==a)for(var b=v.Va(a),c=0;c<b;c++)Bk(this,v.Pa(a,c),c)};C.prototype.findItemPanelForData=C.prototype.jH=function(a){if(void 0===a||null===a||null===this.$f)return null;v.j(a,"object",C,"findItemPanelForData");return this.$f.la(a)};
function Bk(a,b,c){if(!(void 0===b||null===b||0>c)){var d;d=en(a,b);var e=a.VH,f=null;null!==e&&(f=e.la(d));null===f&&(fn||(fn=!0,v.trace('No item template Panel found for category "'+d+'" on '+a),v.trace("  Using default item template."),d=new C,e=new ra,e.bind(new cf("text","",ce)),d.add(e),gn=d),f=gn);d=f;null!==d&&(of(d),d=d.copy(),"object"===typeof b&&(null===a.$f&&(a.$f=new ma(Object,C)),a.$f.add(b,d)),e=c,Ck(a)&&e++,a.xd(e,d),Dk(a,e,c),d.data=b)}}
function Dk(a,b,c){for(a=a.wa;b<a.length;){var d=a.ha(b);if(d instanceof C){var e=b,f=c;d.type===Cl?d.bc=e:d.type===Dl&&(d.column=e);d.UH=f}b++;c++}}function Ai(a){a=a.wa.n;for(var b=a.length,c=0;c<b;c++){var d=a[c];if(d instanceof hn||d instanceof C&&Ai(d))return!0}return!1}
v.defineProperty(C,{xK:"itemTemplate"},function(){return null===this.ag?null:this.ag.la("")},function(a){if(null===this.ag){if(null===a)return;this.ag=new ma("string",C)}var b=this.ag.la("");b!==a&&(v.C(a,C,C,"itemTemplate"),(a instanceof J||a.Lf)&&v.k("Panel.itemTemplate must not be a Part or be Panel.isPanelMain: "+a),this.ag.add("",a),this.h("itemTemplate",b,a),a=this.g,null!==a&&a.ja.ib||this.qA())});
v.defineProperty(C,{VH:"itemTemplateMap"},function(){return this.ag},function(a){var b=this.ag;if(b!==a){v.C(a,ma,C,"itemTemplateMap");for(var c=a.i;c.next();){var d=c.value;(d instanceof J||d.Lf)&&v.k("Template in Panel.itemTemplateMap must not be a Part or be Panel.isPanelMain: "+d)}this.ag=a;this.h("itemTemplateMap",b,a);a=this.g;null!==a&&a.ja.ib||this.qA()}});
v.defineProperty(C,{wK:"itemCategoryProperty"},function(){return this.Yn},function(a){var b=this.Yn;b!==a&&("string"!==typeof a&&"function"!==typeof a&&v.Ad(a,"string or function",C,"itemCategoryProperty"),this.Yn=a,this.h("itemCategoryProperty",b,a))});
function en(a,b){if(null===b)return"";var c=a.Yn,d="";if("function"===typeof c)d=c(b);else if("string"===typeof c&&"object"===typeof b){if(""===c)return"";d=v.kb(b,c)}else return"";if(void 0===d)return"";if("string"===typeof d)return d;v.k("Panel.getCategoryForItemData found a non-string category for "+b+": "+d);return""}var fn=!1,gn=null;v.defineProperty(C,{pK:"isAtomic"},function(){return this.Ig},function(a){var b=this.Ig;b!==a&&(v.j(a,"boolean",C,"isAtomic"),this.Ig=a,this.h("isAtomic",b,a))});
v.defineProperty(C,{qE:"isClipping"},function(){return this.Kq},function(a){var b=this.Kq;b!==a&&(v.j(a,"boolean",C,"isClipping"),this.Kq=a,this.h("isClipping",b,a))});function Ue(){v.cc(this);this.Pg=null;this.dv=!0;this.Ic=0;this.Se=NaN;this.zj=0;this.xj=Infinity;this.te=yc;this.Xa=this.ab=0;this.Hc=null;this.ks=jn;this.Ph=ml;this.fs=this.Dj=null;this.gs=NaN;this.Jb=this.Jh=null;this.jq=!1}v.ga("RowColumnDefinition",Ue);
Ue.prototype.copy=function(){var a=new Ue;a.dv=this.dv;a.Ic=this.Ic;a.Se=this.Se;a.zj=this.zj;a.xj=this.xj;a.te=this.te;a.ab=this.ab;a.Xa=this.Xa;a.Ph=this.Ph;a.ks=this.ks;a.Dj=null===this.Dj?null:this.Dj.aa();a.fs=this.fs;a.gs=this.gs;a.Jh=null;null!==this.Jh&&(a.Jh=v.$k(this.Jh));a.Jb=this.Jb;a.jq=this.jq;a.Hc=this.Hc;return a};
Ue.prototype.Ss=function(a){v.C(a,Ue,Ue,"copyFrom:pd");a.ae?this.height=a.height:this.width=a.width;this.Vi=a.Vi;this.bf=a.bf;this.alignment=a.alignment;this.stretch=a.stretch;this.Vt=a.Vt;this.Dj=null===a.Dj?null:a.Dj.aa();this.Ap=a.Ap;this.Bp=a.Bp;this.Jh=null;a.Jh&&(this.Jh=v.$k(a.Jh));this.background=a.background;this.Az=a.Az;this.Hc=a.Hc};Ue.prototype.toString=function(){return"RowColumnDefinition "+(this.ae?"(Row ":"(Column ")+this.index+") #"+v.cd(this)};var jn;
Ue.Default=jn=v.p(Ue,"Default",0);var Xm;Ue.None=Xm=v.p(Ue,"None",1);var Qm;Ue.ProportionalExtra=Qm=v.p(Ue,"ProportionalExtra",2);Ue.prototype.Al=function(a){this.Pg=a};Ue.prototype.computeEffectiveSpacingTop=Ue.prototype.GD=function(){var a=0;if(0!==this.index){var b=this.Pg,c=this.Ap;null===c&&null!==b&&(c=this.ae?b.li:b.vh);null!==c&&(a=this.Bp,isNaN(a)&&(a=null!==b?this.ae?b.xh:b.wh:0))}b=this.jF;if(null===b)if(b=this.Pg,null!==b)b=b.fj;else return a;return a+(this.ae?b.top:b.left)};
Ue.prototype.computeEffectiveSpacing=Ue.prototype.mg=function(){var a=0;if(0!==this.index){var b=this.Pg,c=this.Ap;null===c&&null!==b&&(c=this.ae?b.li:b.vh);null!==c&&(a=this.Bp,isNaN(a)&&(a=null!==b?this.ae?b.xh:b.wh:0))}b=this.jF;if(null===b)if(b=this.Pg,null!==b)b=b.fj;else return a;return a+(this.ae?b.top+b.bottom:b.left+b.right)};
Ue.prototype.Xc=function(a,b,c,d,e){var f=this.Pg;if(null!==f&&(f.Ec(Od,a,this,b,c,d,e),null!==this.Hc&&(b=f.So(),null!==b&&(b=b.data,null!==b))))for(c=this.Hc.i;c.next();)c.value.Bx(this,b,a,null)};v.u(Ue,{T:"panel"},function(){return this.Pg});v.defineProperty(Ue,{ae:"isRow"},function(){return this.dv},function(a){this.dv=a});v.defineProperty(Ue,{index:"index"},function(){return this.Ic},function(a){this.Ic=a});
v.defineProperty(Ue,{height:"height"},function(){return this.Se},function(a){var b=this.Se;b!==a&&(0>a&&v.ua(a,">= 0",Ue,"height"),this.Se=a,this.Ra=this.ab,null!==this.T&&this.T.P(),this.Xc("height",b,a))});v.defineProperty(Ue,{width:"width"},function(){return this.Se},function(a){var b=this.Se;b!==a&&(0>a&&v.ua(a,">= 0",Ue,"width"),this.Se=a,this.Ra=this.ab,null!==this.T&&this.T.P(),this.Xc("width",b,a))});
v.defineProperty(Ue,{Vi:"minimum"},function(){return this.zj},function(a){var b=this.zj;b!==a&&((0>a||!isFinite(a))&&v.ua(a,">= 0",Ue,"minimum"),this.zj=a,this.Ra=this.ab,null!==this.T&&this.T.P(),this.Xc("minimum",b,a))});v.defineProperty(Ue,{bf:"maximum"},function(){return this.xj},function(a){var b=this.xj;b!==a&&(0>a&&v.ua(a,">= 0",Ue,"maximum"),this.xj=a,this.Ra=this.ab,null!==this.T&&this.T.P(),this.Xc("maximum",b,a))});
v.defineProperty(Ue,{alignment:"alignment"},function(){return this.te},function(a){var b=this.te;b.L(a)||(this.te=a.aa(),null!==this.T&&this.T.P(),this.Xc("alignment",b,a))});v.defineProperty(Ue,{stretch:"stretch"},function(){return this.Ph},function(a){var b=this.Ph;b!==a&&(this.Ph=a,null!==this.T&&this.T.P(),this.Xc("stretch",b,a))});
v.defineProperty(Ue,{jF:"separatorPadding"},function(){return this.Dj},function(a){"number"===typeof a&&(a=new tb(a));var b=this.Dj;null!==a&&null!==b&&b.L(a)||(null!==a&&(a=a.aa()),this.Dj=a,null!==this.T&&this.T.P(),this.Xc("separatorPadding",b,a))});v.defineProperty(Ue,{Ap:"separatorStroke"},function(){return this.fs},function(a){var b=this.fs;b!==a&&(null===a||"string"===typeof a||a instanceof ha)&&(a instanceof ha&&a.freeze(),this.fs=a,null!==this.T&&this.T.P(),this.Xc("separatorStroke",b,a))});
v.defineProperty(Ue,{Bp:"separatorStrokeWidth"},function(){return this.gs},function(a){var b=this.gs;b!==a&&(this.gs=a,null!==this.T&&this.T.P(),this.Xc("separatorStrokeWidth",b,a))});
v.defineProperty(Ue,{TI:"separatorDashArray"},function(){return this.Jh},function(a){var b=this.Jh;if(b!==a){null===a||Array.isArray(a)||v.Ad(a,"Array",Ue,"separatorDashArray:value");if(null!==a){for(var c=a.length,d=0,e=0;e<c;e++){var f=a[e];"number"===typeof f&&0<=f&&isFinite(f)||v.k("separatorDashArray value "+f+" at index "+e+" must be a positive number or zero.");d+=f}if(0===d){if(null===b)return;a=null}}this.Jh=a;null!==this.T&&this.T.pa();this.Xc("separatorDashArray",b,a)}});
v.defineProperty(Ue,{background:"background"},function(){return this.Jb},function(a){var b=this.Jb;b!==a&&(null===a||"string"===typeof a||a instanceof ha)&&(a instanceof ha&&a.freeze(),this.Jb=a,null!==this.T&&this.T.pa(),this.Xc("background",b,a))});v.defineProperty(Ue,{Az:"coversSeparators"},function(){return this.jq},function(a){var b=this.jq;b!==a&&(v.j(a,"boolean",Ue,"coversSeparators"),this.jq=a,null!==this.T&&this.T.pa(),this.Xc("coversSeparators",b,a))});
v.defineProperty(Ue,{Vt:"sizing"},function(){return this.ks},function(a){var b=this.ks;b!==a&&(this.ks=a,null!==this.T&&this.T.P(),this.Xc("sizing",b,a))});function Wm(a){if(a.Vt===jn){var b=a.Pg;return a.ae?b.OI:b.IG}return a.Vt}v.defineProperty(Ue,{Ra:"actual"},function(){return this.ab},function(a){this.ab=isNaN(this.Se)?Math.max(Math.min(this.xj,a),this.zj):Math.max(Math.min(this.xj,this.Se),this.zj)});
v.defineProperty(Ue,{total:"total"},function(){return this.ab+this.mg()},function(a){this.ab=isNaN(this.Se)?Math.max(Math.min(this.xj,a),this.zj):Math.max(Math.min(this.xj,this.Se),this.zj);this.ab=Math.max(0,this.ab-this.mg())});v.defineProperty(Ue,{position:"position"},function(){return this.Xa},function(a){this.Xa=a});
Ue.prototype.bind=Ue.prototype.bind=function(a){a.ig=this;var b=this.T;if(null!==b){var c=b.So();null!==c&&$l(c)&&v.k("Cannot add a Binding to a RowColumnDefinition that is already frozen: "+a+" on "+b)}null===this.Hc&&(this.Hc=new G(cf));this.Hc.add(a)};
function X(){R.call(this);this.Ta=null;this.Mn="None";this.Qg=!1;this.Dq=ml;this.tk=null;this.yc=this.qd="black";this.Sg=1;this.vo="butt";this.wo="miter";this.vm=10;this.um=null;this.nd=0;this.Gi=this.Fi=yc;this.Dr=this.Cr=NaN;this.Lq=!1;this.Qq=!0;this.Fr=null;this.Pn=this.xo="None";this.Iq=1}v.Ga(X,R);v.ga("Shape",X);
X.prototype.cloneProtected=function(a){R.prototype.cloneProtected.call(this,a);a.Ta=this.Ta;a.Mn=this.Mn;a.Qg=this.Qg;a.Dq=this.Dq;a.tk=this.tk;a.qd=this.qd;a.yc=this.yc;a.Sg=this.Sg;a.vo=this.vo;a.wo=this.wo;a.vm=this.vm;a.um=null;null!==this.um&&(a.um=v.$k(this.um));a.nd=this.nd;a.Fi=this.Fi.aa();a.Gi=this.Gi.aa();a.Cr=this.Cr;a.Dr=this.Dr;a.Lq=this.Lq;a.Qq=this.Qq;a.Fr=this.Fr;a.xo=this.xo;a.Pn=this.Pn;a.Iq=this.Iq};
X.prototype.toString=function(){return"Shape("+("None"!==this.Cb?this.Cb:"None"!==this.Hp?this.Hp:this.Gz)+")#"+v.cd(this)};
function kn(a,b,c,d){var e=.001,f=d.Ba,h=f.width,f=f.height,k=0,l=0,m=0,n=0,e=c.length;if(!(4>e)){for(var k=c[0],l=c[1],p=0,q=0,r=0,s=m=0,t=q=0,u=v.jb(),x=2;x<e;x+=2)m=c[x],n=c[x+1],p=m-k,q=n-l,0===p&&(p=.001),r=q/p,s=Math.atan2(q,p),q=Math.sqrt(p*p+q*q),k=[],k[0]=p,k[1]=s,k[2]=r,k[3]=q,u.push(k),t+=q,k=m,l=n;k=c[0];l=c[1];c=0;for(var e=h,n=h/2,x=0===n?!1:!0,q=0,m=u[q],p=m[0],s=m[1],r=m[2],m=m[3],y=0;.1<=t;){0===y&&(x?(e=h,c++,e-=n,t-=n,x=!1):(e=h,c++),0===e&&(e=1));if(e>t){v.ra(u);return}e>m?(y=
e-m,e=m):y=0;var A=Math.sqrt(e*e/(1+r*r));0>p&&(A=-A);k+=A;l+=r*A;a.translate(k,l);a.rotate(s);a.translate(-(h/2),-(f/2));0===y&&d.Uj(a,b);a.translate(h/2,f/2);a.rotate(-s);a.translate(-k,-l);t-=e;m-=e;if(0!==y){q++;if(q===u.length){v.ra(u);return}m=u[q];p=m[0];s=m[1];r=m[2];m=m[3];e=y}}v.ra(u)}}
X.prototype.Uj=function(a,b){if(null!==this.yc||null!==this.qd){null!==this.qd&&Jl(this,a,this.qd,!0,!1);null!==this.yc&&Jl(this,a,this.yc,!1,!1);var c=this.Sg;if(0===c){var d=this.V;d instanceof mf&&d.type===dh&&d.ec instanceof X&&(c=d.ec.nb)}a.lineWidth=c;a.lineJoin=this.wo;a.lineCap=this.vo;a.miterLimit=this.vm;var e=!1;this.V&&b.Yj("drawShadows")&&(e=this.V.tl);var f=!0;null!==this.yc&&null===this.qd&&(f=!1);var d=!1,h=!0,k=this.sF;null!==k&&(d=!0,void 0!==a.setLineDash?(a.setLineDash(k),a.lineDashOffset=
this.nd):void 0!==a.webkitLineDash?(a.webkitLineDash=k,a.webkitLineDashOffset=this.nd):void 0!==a.mozDash?(a.mozDash=k,a.mozDashOffset=this.nd):h=!1);var l=this.Ta;if(null!==l){if(l.ia===fd)a.beginPath(),d&&!h?tl(a,l.tc,l.xc,l.yb,l.Db,k,this.nd):(a.moveTo(l.tc,l.xc),a.lineTo(l.yb,l.Db)),null!==this.qd&&Kl(a,this.qd),0!==c&&null!==this.yc&&Ml(a);else if(l.ia===gd){var m=l.tc,n=l.xc,p=l.yb,q=l.Db,l=Math.min(m,p),r=Math.min(n,q),m=Math.abs(p-m),n=Math.abs(q-n);null!==this.qd&&(a.beginPath(),a.rect(l,
r,m,n),Kl(a,this.qd));if(null!==this.yc){var s=p=0,t=0;f&&e&&(p=a.shadowOffsetX,s=a.shadowOffsetY,t=a.shadowBlur,a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0);d&&!h?(h=v.jb(),h.push(l),h.push(r),h.push(l+m),h.push(r),h.push(l+m),h.push(r+n),h.push(l),h.push(r+n),h.push(l),h.push(r),a.beginPath(),ln(a,h,k,this.nd),Ml(a),v.ra(h)):0!==c&&(a.beginPath(),a.rect(l,r,m,n),Ml(a));f&&e&&(a.shadowOffsetX=p,a.shadowOffsetY=s,a.shadowBlur=t)}}else if(l.ia===hd)m=l.tc,n=l.xc,p=l.yb,q=l.Db,l=Math.abs(p-m)/
2,r=Math.abs(q-n)/2,m=Math.min(m,p)+l,n=Math.min(n,q)+r,a.beginPath(),a.moveTo(m,n-r),a.bezierCurveTo(m+K.za*l,n-r,m+l,n-K.za*r,m+l,n),a.bezierCurveTo(m+l,n+K.za*r,m+K.za*l,n+r,m,n+r),a.bezierCurveTo(m-K.za*l,n+r,m-l,n+K.za*r,m-l,n),a.bezierCurveTo(m-l,n-K.za*r,m-K.za*l,n-r,m,n-r),a.closePath(),null!==this.qd&&Kl(a,this.qd),d&&!h&&(h=v.jb(),K.De(m,n-r,m+K.za*l,n-r,m+l,n-K.za*r,m+l,n,.5,h),K.De(m+l,n,m+l,n+K.za*r,m+K.za*l,n+r,m,n+r,.5,h),K.De(m,n+r,m-K.za*l,n+r,m-l,n+K.za*r,m-l,n,.5,h),K.De(m-l,n,
m-l,n-K.za*r,m-K.za*l,n-r,m,n-r,.5,h),a.beginPath(),ln(a,h,k,this.nd),v.ra(h)),0!==c&&null!==this.yc&&(t=s=p=0,f&&e&&(p=a.shadowOffsetX,s=a.shadowOffsetY,t=a.shadowBlur,a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0),Ml(a),f&&e&&(a.shadowOffsetX=p,a.shadowOffsetY=s,a.shadowBlur=t));else if(l.ia===cd){r=l.hj;n=r.length;for(q=0;q<n;q++){m=r.n[q];a.beginPath();a.moveTo(m.Ia,m.Ja);for(var p=m.vb.n,s=p.length,u=null,t=0;t<s;t++){var x=p[t];switch(x.ia){case Ad:a.moveTo(x.J,x.K);break;case sd:a.lineTo(x.J,
x.K);break;case Bd:a.bezierCurveTo(x.md,x.Ae,x.gg,x.hg,x.yb,x.Db);break;case Cd:a.quadraticCurveTo(x.md,x.Ae,x.yb,x.Db);break;case Dd:if(x.radiusX===x.radiusY)u=Math.PI/180,a.arc(x.md,x.Ae,x.radiusX,x.Ne*u,(x.Ne+x.Sf)*u,0>x.Sf);else{var u=Gd(x,m),y=u.length;if(0===y){a.lineTo(x.oa,x.va);break}for(var A=0;A<y;A++){var B=u[A];0===A&&a.lineTo(B[0],B[1]);a.bezierCurveTo(B[2],B[3],B[4],B[5],B[6],B[7])}}break;case Fd:A=y=0;if(null!==u&&u.type===Dd){u=Gd(u,m);B=u.length;if(0===B){a.lineTo(x.oa,x.va);break}u=
u[B-1]||null;null!==u&&(y=u[6],A=u[7])}else y=null!==u?u.J:m.Ia,A=null!==u?u.K:m.Ja;u=Hd(x,m,y,A);y=u.length;if(0===y){a.lineTo(x.oa,x.va);break}for(A=0;A<y;A++)B=u[A],a.bezierCurveTo(B[2],B[3],B[4],B[5],B[6],B[7]);break;default:v.k("Segment not of valid type: "+x.ia)}x.Dh&&a.closePath();u=x}e?(t=s=p=0,m.Wn?(!0===m.Sl&&null!==this.qd?(Kl(a,this.qd),f=!0):f=!1,0!==c&&null!==this.yc&&(f&&(p=a.shadowOffsetX,s=a.shadowOffsetY,t=a.shadowBlur,a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0),d&&!h||Ml(a),
f&&(a.shadowOffsetX=p,a.shadowOffsetY=s,a.shadowBlur=t))):(f&&(p=a.shadowOffsetX,s=a.shadowOffsetY,t=a.shadowBlur,a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0),!0===m.Sl&&null!==this.qd&&Kl(a,this.qd),0!==c&&null!==this.yc&&(d&&!h||Ml(a)),f&&(a.shadowOffsetX=p,a.shadowOffsetY=s,a.shadowBlur=t))):(!0===m.Sl&&null!==this.qd&&Kl(a,this.qd),0===c||null===this.yc||d&&!h||Ml(a))}if(d&&!h)for(c=f,f=l.hj,h=f.length,l=0;l<h;l++){r=f.n[l];a.beginPath();n=v.jb();n.push(r.Ia);n.push(r.Ja);q=r.Ia;m=r.Ja;
p=q;s=m;t=r.vb.n;x=t.length;for(u=0;u<x;u++){y=t[u];switch(y.ia){case Ad:ln(a,n,k,this.nd);n.length=0;n.push(y.J);n.push(y.K);q=y.J;m=y.K;p=q;s=m;break;case sd:n.push(y.J);n.push(y.K);q=y.J;m=y.K;break;case Bd:K.De(q,m,y.md,y.Ae,y.gg,y.hg,y.yb,y.Db,.5,n);q=y.J;m=y.K;break;case Cd:K.rp(q,m,y.md,y.Ae,y.yb,y.Db,.5,n);q=y.J;m=y.K;break;case Dd:A=Gd(y,r);B=A.length;if(0===B){n.push(y.oa);n.push(y.va);q=y.oa;m=y.va;break}for(var I=0;I<B;I++){var D=A[I];K.De(q,m,D[2],D[3],D[4],D[5],D[6],D[7],.5,n);q=D[6];
m=D[7]}break;case Fd:A=Hd(y,r,q,m);B=A.length;if(0===B){n.push(y.oa);n.push(y.va);q=y.oa;m=y.va;break}for(I=0;I<B;I++)D=A[I],K.De(q,m,D[2],D[3],D[4],D[5],D[6],D[7],.5,n),q=D[6],m=D[7];break;default:v.k("Segment not of valid type: "+y.ia)}y.Dh&&(n.push(p),n.push(s),ln(a,n,k,this.nd))}ln(a,n,k,this.nd);v.ra(n);null!==this.yc&&(q=n=r=0,c&&e&&(r=a.shadowOffsetX,n=a.shadowOffsetY,q=a.shadowBlur,a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0),Ml(a),c&&e&&(a.shadowOffsetX=r,a.shadowOffsetY=n,a.shadowBlur=
q))}}d&&(void 0!==a.setLineDash?(a.setLineDash(v.qh),a.lineDashOffset=0):void 0!==a.webkitLineDash?(a.webkitLineDash=v.qh,a.webkitLineDashOffset=0):void 0!==a.mozDash&&(a.mozDash=null,a.mozDashOffset=0));if(null!==this.NE){d=this.NE;Rh(d,Infinity,Infinity);k=d.Ba;d.zc(0,0,k.width,k.height);a.save();k=this.Uo.Ub.first();a.beginPath();c=v.jb();c.push(k.Ia);c.push(k.Ja);e=k.Ia;f=k.Ja;h=e;l=f;r=k.vb.n;n=r.length;for(q=0;q<n;q++){m=r[q];switch(m.ia){case Ad:kn(a,b,c,d);c.length=0;c.push(m.J);c.push(m.K);
e=m.J;f=m.K;h=e;l=f;break;case sd:c.push(m.J);c.push(m.K);e=m.J;f=m.K;break;case Bd:K.De(e,f,m.md,m.Ae,m.gg,m.hg,m.yb,m.Db,.5,c);e=m.J;f=m.K;break;case Cd:K.rp(e,f,m.md,m.Ae,m.yb,m.Db,.5,c);e=m.J;f=m.K;break;case Dd:p=Gd(m,k);s=p.length;if(0===s){c.push(m.oa);c.push(m.va);e=m.oa;f=m.va;break}for(t=0;t<s;t++)x=p[t],K.De(e,f,x[2],x[3],x[4],x[5],x[6],x[7],.5,c),e=x[6],f=x[7];break;case Fd:p=Hd(m,k,e,f);s=p.length;if(0===s){c.push(m.oa);c.push(m.va);e=m.oa;f=m.va;break}for(t=0;t<s;t++)x=p[t],K.De(e,f,
x[2],x[3],x[4],x[5],x[6],x[7],.5,c),e=x[6],f=x[7];break;default:v.k("Segment not of valid type: "+m.ia)}m.Dh&&(c.push(h),c.push(l),kn(a,b,c,d))}kn(a,b,c,d);v.ra(c);a.restore()}}}};
function ln(a,b,c,d){var e=.001,f=c.length,h=0,k=0,l=0,m=0,e=b.length;if(!(4>e))if(h=b[0],k=b[1],4===e)tl(a,h,k,b[2],b[3],c,d);else{a.moveTo(h,k);for(var n=0,p=0,q=0,r=p=l=0,s=v.jb(),t=2;t<e;t+=2)l=b[t],m=b[t+1],n=l-h,p=m-k,0===n&&(n=.001),q=p/n,p=Math.sqrt(n*n+p*p),h=[],h[0]=n,h[1]=q,h[2]=p,s.push(h),r+=p,h=l,k=m;h=b[0];k=b[1];b=0;for(var m=!0,e=c[b%f],t=0!==d,p=0,l=s[p],n=l[0],q=l[1],l=l[2],u=0;.1<=r;){0===u&&(e=c[b%f],b++,t&&(d%=e,e-=d,t=!1));e>r&&(e=r);e>l?(u=e-l,e=l):u=0;var x=Math.sqrt(e*e/
(1+q*q));0>n&&(x=-x);h+=x;k+=q*x;m?a.lineTo(h,k):a.moveTo(h,k);r-=e;l-=e;if(0!==u){p++;if(p===s.length){v.ra(s);return}l=s[p];n=l[0];q=l[1];l=l[2];e=u}else m=!m}v.ra(s)}}X.prototype.getDocumentPoint=X.prototype.fb=function(a,b){void 0===b&&(b=new w);a.me()&&v.k("getDocumentPoint Spot must be a real, specific Spot, not: "+a.toString());var c=this.Fa,d=this.nb;b.m(a.x*(c.width+d)-d/2+c.x+a.offsetX,a.y*(c.height+d)-d/2+c.y+a.offsetY);this.Ef.xb(b);return b};
X.prototype.Rj=function(a,b){var c=this.Ta;if(null===c||null===this.fill&&null===this.stroke)return!1;var d=c.pb,e=this.nb/2;c.type!==fd||b||(e+=2);var f=v.Uf();f.assign(d);f.Kf(e+2,e+2);if(!f.Ca(a))return v.fc(f),!1;d=e+1E-4;if(c.type===fd){if(null===this.stroke)return!1;d=(c.J-c.Ia)*(a.x-c.Ia)+(c.K-c.Ja)*(a.y-c.Ja);if(0>(c.Ia-c.J)*(a.x-c.J)+(c.Ja-c.K)*(a.y-c.K)||0>d)return!1;v.fc(f);return K.zd(c.Ia,c.Ja,c.J,c.K,e,a.x,a.y)}if(c.type===gd){var h=c.Ia,k=c.Ja,l=c.J,m=c.K,c=Math.min(h,l),n=Math.min(k,
m),h=Math.abs(l-h),k=Math.abs(m-k);f.x=c;f.y=n;f.width=h;f.height=k;if(null===this.fill){f.Kf(-d,-d);if(f.Ca(a))return v.fc(f),!1;f.Kf(d,d)}null!==this.stroke&&f.Kf(e,e);e=f.Ca(a);v.fc(f);return e}if(c.type===hd){h=c.Ia;k=c.Ja;l=c.J;m=c.K;c=Math.min(h,l);n=Math.min(k,m);h=Math.abs(l-h);k=Math.abs(m-k);h/=2;k/=2;c=a.x-(c+h);n=a.y-(n+k);if(null===this.fill){h-=d;k-=d;if(0>=h||0>=k||1>=c*c/(h*h)+n*n/(k*k))return v.fc(f),!1;h+=d;k+=d}null!==this.stroke&&(h+=e,k+=e);v.fc(f);return 0>=h||0>=k?!1:1>=c*c/
(h*h)+n*n/(k*k)}if(c.type===cd)return v.fc(f),null===this.fill?Jd(c,a.x,a.y,e):c.Ca(a,e,1<this.nb,b);v.k("Unknown Geometry type: "+c.type);return!1};
X.prototype.ip=function(a,b,c,d){var e=this.xa,f=this.Sg;a=Math.max(a,0);b=Math.max(b,0);var h;if(this.Qg)h=this.Ta.pb;else{var k=this.Cb,l=K.Jx[k];if(void 0===l){var m=K.sg[k];"string"===typeof m&&(m=K.sg[m]);"function"===typeof m?(l=m(null,100,100),K.Jx[k]=l):v.k("Unsupported Figure: "+k)}h=l.pb}var k=h.width,l=h.height,m=h.width,n=h.height;switch(yl(this,!0)){case th:d=c=0;break;case ed:m=Math.max(a-f,0);n=Math.max(b-f,0);break;case ol:m=Math.max(a-f,0);d=0;break;case nl:c=0,n=Math.max(b-f,0)}isFinite(e.width)&&
(m=e.width);isFinite(e.height)&&(n=e.height);e=this.af;h=this.ug;c=Math.max(c,h.width)-f;d=Math.max(d,h.height)-f;m=Math.min(e.width,m);n=Math.min(e.height,n);m=isFinite(m)?Math.max(c,m):Math.max(k,c);n=isFinite(n)?Math.max(d,n):Math.max(l,d);c=uh(this);switch(c){case th:break;case ed:k=m;l=n;break;case vh:c=Math.min(m/k,n/l);isFinite(c)||(c=1);k*=c;l*=c;break;default:v.k(c+" is not a valid geometryStretch.")}if(this.Qg)h=this.Uo,e=k,d=l,c=h.copy(),h=h.pb,e/=h.width,d/=h.height,isFinite(e)||(e=1),
isFinite(d)||(d=1),1===e&&1===d||c.scale(e,d),this.Ta=c;else if(null===this.Ta||this.Ta.Vn!==a-f||this.Ta.Tn!==b-f)this.Ta=K.makeGeometry(this,k,l);h=this.Ta.pb;Infinity===a||Infinity===b?vl(this,h.x-f/2,h.y-f/2,0===a&&0===k?0:h.width+f,0===b&&0===l?0:h.height+f):vl(this,-(f/2),-(f/2),m+f,n+f)};
function Ym(a,b,c){if(!1!==Jj(a)){a.Vc.Na();var d=a.Sg;if(0===d){var e=a.V;e instanceof mf&&e.type===dh&&e.ec instanceof X&&(d=e.ec.nb)}d*=a.Tb;vl(a,-(d/2),-(d/2),b+d,c+d);b=a.Vc;c=a.af;d=a.ug;b.width=Math.min(c.width,b.width);b.height=Math.min(c.height,b.height);b.width=Math.max(d.width,b.width);b.height=Math.max(d.height,b.height);a.Vc.freeze();a.Vc.H()||v.k("Non-real measuredBounds has been set. Object "+a+", measuredBounds: "+a.Vc.toString());Dj(a,!1)}}
function uh(a){var b=a.Hz;return a.Qg?b===ml?ed:b:b===ml?K.Jx[a.Cb].Hd:b}X.prototype.Li=function(a,b,c,d){zl(this,a,b,c,d)};X.prototype.getNearestIntersectionPoint=X.prototype.ml=function(a,b,c){return this.Xo(a.x,a.y,b.x,b.y,c)};
X.prototype.Xo=function(a,b,c,d,e){var f=this.transform,h=1/(f.m11*f.m22-f.m12*f.m21),k=f.m22*h,l=-f.m12*h,m=-f.m21*h,n=f.m11*h,p=h*(f.m21*f.dy-f.m22*f.dx),q=h*(f.m12*f.dx-f.m11*f.dy),f=a*k+b*m+p,h=a*l+b*n+q,k=c*k+d*m+p,l=c*l+d*n+q,m=this.nb/2,p=this.Ta;null===p&&(Rh(this,Infinity,Infinity),p=this.Ta);q=p.pb;n=!1;if(p.type===fd)if(1.5>=this.nb)n=K.bh(p.tc,p.xc,p.yb,p.Db,f,h,k,l,e);else{var r=0,s=0;p.tc===p.yb?(r=m,s=0):(b=(p.Db-p.xc)/(p.yb-p.tc),s=m/Math.sqrt(1+b*b),r=s*b);d=v.jb();b=new w;K.bh(p.tc+
r,p.xc+s,p.yb+r,p.Db+s,f,h,k,l,b)&&d.push(b);b=new w;K.bh(p.tc-r,p.xc-s,p.yb-r,p.Db-s,f,h,k,l,b)&&d.push(b);b=new w;K.bh(p.tc+r,p.xc+s,p.tc-r,p.xc-s,f,h,k,l,b)&&d.push(b);b=new w;K.bh(p.yb+r,p.Db+s,p.yb-r,p.Db-s,f,h,k,l,b)&&d.push(b);b=d.length;if(0===b)return v.ra(d),!1;n=!0;s=Infinity;for(r=0;r<b;r++){var k=d[r],t=(k.x-f)*(k.x-f)+(k.y-h)*(k.y-h);t<s&&(s=t,e.x=k.x,e.y=k.y)}v.ra(d)}else if(p.type===gd)b=q.x-m,n=K.ml(b,q.y-m,q.x+q.width+m,q.y+q.height+m,f,h,k,l,e);else if(p.type===hd)a:if(b=q.copy().Kf(m,
m),0===b.width)n=K.bh(b.x,b.y,b.x,b.y+b.height,f,h,k,l,e);else if(0===b.height)n=K.bh(b.x,b.y,b.x+b.width,b.y,f,h,k,l,e);else{a=b.width/2;var u=b.height/2;d=b.x+a;b=b.y+u;c=9999;f!==k&&(c=(h-l)/(f-k));if(9999>Math.abs(c)){n=h-b-c*(f-d);if(0>a*a*c*c+u*u-n*n){e.x=NaN;e.y=NaN;n=!1;break a}m=Math.sqrt(a*a*c*c+u*u-n*n);k=(-(a*a*c*n)+a*u*m)/(u*u+a*a*c*c)+d;a=(-(a*a*c*n)-a*u*m)/(u*u+a*a*c*c)+d;l=c*(k-d)+n+b;b=c*(a-d)+n+b;d=Math.abs((f-k)*(f-k))+Math.abs((h-l)*(h-l));h=Math.abs((f-a)*(f-a))+Math.abs((h-b)*
(h-b));d<h?(e.x=k,e.y=l):(e.x=a,e.y=b)}else{k=u*u;l=f-d;k-=k/(a*a)*l*l;if(0>k){e.x=NaN;e.y=NaN;n=!1;break a}m=Math.sqrt(k);l=b+m;b-=m;d=Math.abs(l-h);h=Math.abs(b-h);d<h?(e.x=f,e.y=l):(e.x=f,e.y=b)}n=!0}else if(p.type===cd){var x=0,y=0,A=t=0,q=v.M(),r=k-f,s=l-h,s=r*r+s*s;e.x=k;e.y=l;for(r=0;r<p.Ub.count;r++)for(var B=p.Ub.n[r],I=B.vb,x=B.Ia,y=B.Ja,D=x,V=y,ba=0;ba<I.count;ba++){var U=I.n[ba],N=U.type,t=U.J,A=U.K,Z=!1;switch(N){case Ad:D=t;V=A;break;case sd:Z=mn(x,y,t,A,f,h,k,l,q);break;case Bd:var Z=
U.ic,N=U.Qc,Ga=U.ih,ta=U.jh,Z=K.Ms(x,y,Z,N,Ga,ta,t,A,f,h,k,l,.5,q);break;case Cd:Z=(x+2*U.ic)/3;N=(y+2*U.Qc)/3;Ga=(2*U.ic+t)/3;ta=(2*U.ic+t)/3;Z=K.Ms(x,y,Z,N,Ga,ta,t,A,f,h,k,l,.5,q);break;case Dd:case Fd:N=U.type===Dd?Gd(U,B):Hd(U,B,x,y);Ga=N.length;if(0===Ga){Z=mn(x,y,U.oa,U.va,f,h,k,l,q);break}for(A=0;A<Ga;A++)u=N[A],0===A&&mn(x,y,u[0],u[1],f,h,k,l,q)&&(t=nn(f,h,q,s,e),t<s&&(s=t,n=!0)),K.Ms(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],f,h,k,l,.5,q)&&(t=nn(f,h,q,s,e),t<s&&(s=t,n=!0));t=u[6];A=u[7];break;
default:v.k("Unknown Segment type: "+N)}x=t;y=A;Z&&(t=nn(f,h,q,s,e),t<s&&(s=t,n=!0));U.Ow&&(t=D,A=V,mn(x,y,t,A,f,h,k,l,q)&&(t=nn(f,h,q,s,e),t<s&&(s=t,n=!0)))}f=c-a;h=d-b;b=Math.sqrt(f*f+h*h);0!==b&&(f/=b,h/=b);e.x-=f*m;e.y-=h*m;v.v(q)}else v.k("Unknown Geometry type: "+p.type);if(!n)return!1;this.transform.xb(e);return!0};function nn(a,b,c,d,e){a=c.x-a;b=c.y-b;b=a*a+b*b;return b<d?(e.x=c.x,e.y=c.y,b):d}
function mn(a,b,c,d,e,f,h,k,l){var m=!1,n=(e-h)*(b-d)-(f-k)*(a-c);if(0===n)return!1;l.x=((e*k-f*h)*(a-c)-(e-h)*(a*d-b*c))/n;l.y=((e*k-f*h)*(b-d)-(f-k)*(a*d-b*c))/n;(a>c?a-c:c-a)<(b>d?b-d:d-b)?(e=b<d?b:d,a=b<d?d:b,(l.y>e||K.sb(l.y,e))&&(l.y<a||K.sb(l.y,a))&&(m=!0)):(e=a<c?a:c,a=a<c?c:a,(l.x>e||K.sb(l.x,e))&&(l.x<a||K.sb(l.x,a))&&(m=!0));return m}
X.prototype.containedInRect=X.prototype.Hm=function(a,b){if(void 0===b)return a.Sj(this.Z);var c=this.Ta;null===c&&(Rh(this,Infinity,Infinity),c=this.Ta);var c=c.pb,d=this.nb/2,e=!1,f=v.M();f.m(c.x-d,c.y-d);a.Ca(b.xb(f))&&(f.m(c.x-d,c.bottom+d),a.Ca(b.xb(f))&&(f.m(c.right+d,c.bottom+d),a.Ca(b.xb(f))&&(f.m(c.right+d,c.y-d),a.Ca(b.xb(f))&&(e=!0))));v.v(f);return e};
X.prototype.intersectsRect=X.prototype.tg=function(a,b){if(this.Hm(a,b)||void 0===b&&(b=this.transform,a.Sj(this.Z)))return!0;var c=v.nh();c.set(b);c.Pz();var d=a.left,e=a.right,f=a.top,h=a.bottom,k=v.M();k.m(d,f);c.xb(k);if(this.Rj(k,!0))return v.v(k),!0;k.m(e,f);c.xb(k);if(this.Rj(k,!0))return v.v(k),!0;k.m(d,h);c.xb(k);if(this.Rj(k,!0))return v.v(k),!0;k.m(e,h);c.xb(k);if(this.Rj(k,!0))return v.v(k),!0;var l=v.M(),m=v.M();c.set(b);c.JE(this.transform);c.Pz();l.x=e;l.y=f;l.transform(c);k.x=d;k.y=
f;k.transform(c);var n=!1;on(this,k,l,m)?n=!0:(k.x=e,k.y=h,k.transform(c),on(this,k,l,m)?n=!0:(l.x=d,l.y=h,l.transform(c),on(this,k,l,m)?n=!0:(k.x=d,k.y=f,k.transform(c),on(this,k,l,m)&&(n=!0))));v.v(k);v.Xe(c);v.v(l);v.v(m);return n};function on(a,b,c,d){if(!a.ml(b,c,d))return!1;a=b.x;b=b.y;var e=c.x;c=c.y;var f=d.x;d=d.y;if(a===e){var h=0;a=0;b<c?(h=b,a=c):(h=c,a=b);return d>=h&&d<=a}a<e?(h=a,a=e):h=e;return f>=h&&f<=a}
X.prototype.$D=function(a,b,c){function d(a,b){for(var c=a.length,d=0;d<c;d+=2)if(b.Po(a[d],a[d+1])>e)return!0;return!1}if(c&&null!==this.fill&&this.Rj(a,!0))return!0;var e=a.Tj(b);b=e;1.5<this.nb&&(e=this.nb/2+Math.sqrt(e),e*=e);var f=this.Ta;null===f&&(Rh(this,Infinity,Infinity),f=this.Ta);if(!c){var h=f.pb,k=h.x,l=h.y,m=h.x+h.width,h=h.y+h.height;if(Za(a.x,a.y,k,l)<=e&&Za(a.x,a.y,m,l)<=e&&Za(a.x,a.y,k,h)<=e&&Za(a.x,a.y,m,h)<=e)return!0}k=f.tc;l=f.xc;m=f.yb;h=f.Db;if(f.type===fd){if(c=Ya(a.x,a.y,
k,l,m,h),f=(k-m)*(a.x-m)+(l-h)*(a.y-h),c<=(0<=(m-k)*(a.x-k)+(h-l)*(a.y-l)&&0<=f?e:b))return!0}else{if(f.type===gd)return b=!1,c&&(b=Ya(a.x,a.y,k,l,k,h)<=e||Ya(a.x,a.y,k,l,m,l)<=e||Ya(a.x,a.y,m,l,m,h)<=e||Ya(a.x,a.y,k,h,m,h)<=e),b;if(f.type===hd){b=a.x-(k+m)/2;var f=a.y-(l+h)/2,n=Math.abs(m-k)/2,p=Math.abs(h-l)/2;if(0===n||0===p)return c=Ya(a.x,a.y,k,l,m,h),c<=e?!0:!1;if(c){if(a=K.bH(n,p,b,f),a*a<=e)return!0}else return Za(b,f,-n,0)>=e||Za(b,f,0,-p)>=e||Za(b,f,0,p)>=e||Za(b,f,n,0)>=e?!1:!0}else if(f.type===
cd){h=f.pb;k=h.x;l=h.y;m=h.x+h.width;h=h.y+h.height;if(a.x>m&&a.x<k&&a.y>h&&a.y<l&&Ya(a.x,a.y,k,l,k,h)>e&&Ya(a.x,a.y,k,l,m,l)>e&&Ya(a.x,a.y,m,h,k,h)>e&&Ya(a.x,a.y,m,h,m,l)>e)return!1;b=Math.sqrt(e);if(c){if(null===this.fill?Jd(f,a.x,a.y,b):f.Ca(a,b,!0))return!0}else{c=f.Ub;for(b=0;b<c.count;b++){k=c.n[b];n=k.Ia;p=k.Ja;if(a.Po(n,p)>e)return!1;l=k.vb.n;m=l.length;for(h=0;h<m;h++){var q=l[h];switch(q.type){case Ad:case sd:n=q.J;p=q.K;if(a.Po(n,p)>e)return!1;break;case Bd:f=v.jb();K.De(n,p,q.ic,q.Qc,
q.ih,q.jh,q.J,q.K,.8,f);n=d(f,a);v.ra(f);if(n)return!1;n=q.J;p=q.K;if(a.Po(n,p)>e)return!1;break;case Cd:f=v.jb();K.rp(n,p,q.ic,q.Qc,q.J,q.K,.8,f);n=d(f,a);v.ra(f);if(n)return!1;n=q.J;p=q.K;if(a.Po(n,p)>e)return!1;break;case Dd:case Fd:var r=q.type===Dd?Gd(q,k):Hd(q,k,n,p),s=r.length;if(0===s){n=q.oa;p=q.va;if(a.Po(n,p)>e)return!1;break}q=null;f=v.jb();for(b=0;b<s;b++)if(q=r[b],f.length=0,K.De(q[0],q[1],q[2],q[3],q[4],q[5],q[6],q[7],.8,f),d(f,a))return v.ra(f),!1;v.ra(f);null!==q&&(n=q[6],p=q[7]);
break;default:v.k("Unknown Segment type: "+q.type)}}}return!0}}}return!1};v.defineProperty(X,{Uo:"geometry"},function(){return this.tk?this.tk:this.Ta},function(a){var b=this.Ta;if(b!==a){this.tk=null!==a?this.Ta=a.freeze():this.Ta=null;var c=this.V;null!==c&&(c.vj=NaN);this.Qg=!0;this.P();this.h("geometry",b,a);a=this.V;null!==a&&0!==(this.fa&1024)&&ul(this,a,"geometryString")}});
v.defineProperty(X,{rH:"geometryString"},function(){return null===this.Uo?"":this.Uo.toString()},function(a){var b=ud(a);a=b.normalize();this.Uo=b;var b=v.M(),c=this.position;c.H()?b.m(c.x-a.x,c.y-a.y):b.m(-a.x,-a.y);this.position=b;v.v(b)});v.defineProperty(X,{sE:"isGeometryPositioned"},function(){return this.Lq},function(a){var b=this.Lq;b!==a&&(this.Lq=a,this.P(),this.h("isGeometryPositioned",b,a))});X.prototype.Ye=function(){this.Qg?this.tk=null:this.Ta=null;this.P()};
v.defineProperty(X,{fill:"fill"},function(){return this.qd},function(a){var b=this.qd;b!==a&&(a instanceof ha&&a.freeze(),this.qd=a,this.pa(),this.h("fill",b,a))});v.defineProperty(X,{stroke:"stroke"},function(){return this.yc},function(a){var b=this.yc;b!==a&&(a instanceof ha&&a.freeze(),this.yc=a,this.pa(),this.h("stroke",b,a))});
v.defineProperty(X,{nb:"strokeWidth"},function(){return this.Sg},function(a){var b=this.Sg;if(b!==a)if(0<=a){this.Sg=a;this.P();var c=this.V;null!==c&&(c.vj=NaN);this.h("strokeWidth",b,a)}else v.ua(a,"value >= 0",X,"strokeWidth:value")});v.defineProperty(X,{jL:"strokeCap"},function(){return this.vo},function(a){var b=this.vo;b!==a&&("string"!==typeof a||"butt"!==a&&"round"!==a&&"square"!==a?v.ua(a,'"butt", "round", or "square"',X,"strokeCap"):(this.vo=a,this.pa(),this.h("strokeCap",b,a)))});
v.defineProperty(X,{lL:"strokeJoin"},function(){return this.wo},function(a){var b=this.wo;b!==a&&("string"!==typeof a||"miter"!==a&&"bevel"!==a&&"round"!==a?v.ua(a,'"miter", "bevel", or "round"',X,"strokeJoin"):(this.wo=a,this.pa(),this.h("strokeJoin",b,a)))});v.defineProperty(X,{mL:"strokeMiterLimit"},function(){return this.vm},function(a){var b=this.vm;if(b!==a)if(0<a){this.vm=a;this.pa();var c=this.V;null!==c&&(c.vj=NaN);this.h("strokeMiterLimit",b,a)}else v.ua(a,"value > 0",X,"strokeWidth:value")});
v.defineProperty(X,{sF:"strokeDashArray"},function(){return this.um},function(a){var b=this.um;if(b!==a){null===a||Array.isArray(a)||v.Ad(a,"Array",X,"strokeDashArray:value");if(null!==a){for(var c=a.length,d=0,e=0;e<c;e++){var f=a[e];"number"===typeof f&&0<=f&&isFinite(f)||v.k("strokeDashArray:value "+f+" at index "+e+" must be a positive number or zero.");d+=f}if(0===d){if(null===b)return;a=null}}this.um=a;this.pa();this.h("strokeDashArray",b,a)}});
v.defineProperty(X,{kL:"strokeDashOffset"},function(){return this.nd},function(a){var b=this.nd;b!==a&&0<=a&&(this.nd=a,this.pa(),this.h("strokeDashOffset",b,a))});v.defineProperty(X,{Cb:"figure"},function(){return this.Mn},function(a){var b=this.Mn;if(b!==a){var c=K.sg[a];"function"===typeof c?c=a:(c=K.sg[a.toLowerCase()])||v.k("Unknown Shape.figure: "+a);b!==c&&(a=this.V,null!==a&&(a.vj=NaN),this.Mn=c,this.Qg=!1,this.Ye(),this.h("figure",b,c))}});
v.defineProperty(X,{Hp:"toArrow"},function(){return this.xo},function(a){var b=this.xo;!0===a?a="Standard":!1===a&&(a="");if(b!==a){var c=K.AD(a);null===c?v.k("Unknown Shape.toArrow: "+a):b!==c&&(this.xo=c,this.Qg=!1,this.Ye(),pn(this),this.h("toArrow",b,c))}});
v.defineProperty(X,{Gz:"fromArrow"},function(){return this.Pn},function(a){var b=this.Pn;!0===a?a="Standard":!1===a&&(a="");if(b!==a){var c=K.AD(a);null===c?v.k("Unknown Shape.fromArrow: "+a):b!==c&&(this.Pn=c,this.Qg=!1,this.Ye(),pn(this),this.h("fromArrow",b,c))}});function pn(a){var b=a.g;null!==b&&b.ja.ib||(a.Pt=qn,"None"!==a.xo?(a.pe=-1,a.Pj=Bc):"None"!==a.Pn&&(a.pe=0,a.Pj=new L(1-Bc.x,Bc.y)))}
v.defineProperty(X,{A:"spot1"},function(){return this.Fi},function(a){v.C(a,L,X,"spot1");var b=this.Fi;b.L(a)||(this.Fi=a=a.aa(),this.P(),this.h("spot1",b,a))});v.defineProperty(X,{B:"spot2"},function(){return this.Gi},function(a){v.C(a,L,X,"spot2");var b=this.Gi;b.L(a)||(this.Gi=a=a.aa(),this.P(),this.h("spot2",b,a))});v.defineProperty(X,{vc:"parameter1"},function(){return this.Cr},function(a){var b=this.Cr;b!==a&&(this.Cr=a,this.Ye(),this.h("parameter1",b,a))});
v.defineProperty(X,{Gt:"parameter2"},function(){return this.Dr},function(a){var b=this.Dr;b!==a&&(this.Dr=a,this.Ye(),this.h("parameter2",b,a))});v.u(X,{Fa:"naturalBounds"},function(){if(null!==this.Ta)return this.Jc.assign(this.Ta.pb),this.Jc;var a=this.xa;return new z(0,0,a.width,a.height)});v.defineProperty(X,{sK:"isRectangular"},function(){return this.Qq},function(a){var b=this.Qq;b!==a&&(this.Qq=a,this.P(),this.h("isRectangular",b,a))});
v.defineProperty(X,{NE:"pathObject"},function(){return this.Fr},function(a){var b=this.Fr;b!==a&&(this.Fr=a,this.pa(),this.h("pathObject",b,a))});v.defineProperty(X,{Hz:"geometryStretch"},function(){return this.Dq},function(a){var b=this.Dq;b!==a&&(v.qb(a,R,X,"geometryStretch"),this.Dq=a,this.h("geometryStretch",b,a))});
v.defineProperty(X,{interval:"interval"},function(){return this.Iq},function(a){var b=this.Iq;a=Math.floor(a);b!==a&&0<=a&&(this.Iq=a,null!==this.g&&Ej(this.g),this.P(),this.h("interval",b,a))});X.getFigureGenerators=function(){var a=new ma("string","function"),b;for(b in K.sg)if(b!==b.toLowerCase()){var c=K.sg[b];"function"===typeof c&&a.add(b,c)}a.freeze();return a};
X.defineFigureGenerator=function(a,b){v.j(a,"string",X,"defineFigureGenerator:name");"string"===typeof b?""!==b&&K.sg[b]||v.k("Shape.defineFigureGenerator synonym must not be empty or None or not a defined figure name: "+b):v.j(b,"function",X,"defineFigureGenerator:func");var c=a.toLowerCase();""!==a&&"none"!==c&&a!==c||v.k("Shape.defineFigureGenerator name must not be empty or None or all-lower-case: "+a);var d=K.sg;d[a]=b;d[c]=a};
X.getArrowheadGeometries=function(){var a=new ma("string",Xc),b;for(b in K.aj)if(b!==b.toLowerCase()){var c=K.aj[b];c instanceof Xc&&a.add(b,c)}a.freeze();return a};
X.defineArrowheadGeometry=function(a,b){v.j(a,"string",X,"defineArrowheadGeometry:name");var c=null;"string"===typeof b?(v.j(b,"string",X,"defineArrowheadGeometry:pathstr"),c=ud(b,!1)):(v.C(b,Xc,X,"defineArrowheadGeometry:pathstr"),c=b);var d=a.toLowerCase();""!==a&&"none"!==d&&a!==d||v.k("Shape.defineArrowheadGeometry name must not be empty or None or all-lower-case: "+a);var e=K.aj;e[a]=c;e[d]=a};
function ra(){R.call(this);this.ie="";this.yc="black";this.Gg="13px sans-serif";this.vd="start";this.Nq=!0;this.Ul=this.Vl=!1;this.Pk=rn;this.ym=sn;this.lv=this.xe=0;this.On=this.Ky=this.Ly=null;this.sj=new tn;this.xq=!1;this.hf=this.Rk=this.ss=null;this.Gj=this.Fj=0;this.vi=Infinity;this.gv=0}v.Ga(ra,R);v.ga("TextBlock",ra);var un=new pa,vn=0,wn=new pa,xn=0,yn="...",zn="",An=v.createElement("canvas").getContext("2d");ra.getEllipsis=function(){return yn};
ra.setEllipsis=function(a){yn=a;wn=new pa;xn=0};ra.prototype.cloneProtected=function(a){R.prototype.cloneProtected.call(this,a);a.ie=this.ie;a.yc=this.yc;a.Gg=this.Gg;a.vd=this.vd;a.Nq=this.Nq;a.Vl=this.Vl;a.Ul=this.Ul;a.ym=this.ym;a.Pk=this.Pk;a.xe=this.xe;a.lv=this.lv;a.Ly=this.Ly;a.Ky=this.Ky;a.On=this.On;a.sj.Ss(this.sj);a.xq=this.xq;a.ss=this.ss;a.Rk=this.Rk;a.hf=this.hf;a.Fj=this.Fj;a.Gj=this.Gj;a.vi=this.vi;a.gv=this.gv};
ra.prototype.toString=function(){return 22<this.ie.length?'TextBlock("'+this.ie.substring(0,20)+'"...)':'TextBlock("'+this.ie+'")'};var Bn;ra.None=Bn=v.p(ra,"None",0);var Cn;ra.WrapFit=Cn=v.p(ra,"WrapFit",1);var sn;ra.WrapDesiredSize=sn=v.p(ra,"WrapDesiredSize",2);var rn;ra.OverflowClip=rn=v.p(ra,"OverflowClip",0);var Dn;ra.OverflowEllipsis=Dn=v.p(ra,"OverflowEllipsis",1);ra.prototype.P=function(){R.prototype.P.call(this);this.Ky=this.Ly=null};
v.defineProperty(ra,{font:"font"},function(){return this.Gg},function(a){var b=this.Gg;b!==a&&(this.Gg=a,this.On=null,this.P(),this.h("font",b,a))});ra.isValidFont=function(a){var b=An.font;if(a===b||"10px sans-serif"===a)return!0;An.font="10px sans-serif";var c;An.font=a;var d=An.font;if("10px sans-serif"!==d)return An.font=b,!0;An.font="19px serif";c=An.font;An.font=a;d=An.font;An.font=b;return d!==c};
v.defineProperty(ra,{text:"text"},function(){return this.ie},function(a){var b=this.ie;a=null!==a&&void 0!==a?a.toString():"";b!==a&&(this.ie=a,this.P(),this.h("text",b,a))});v.defineProperty(ra,{textAlign:"textAlign"},function(){return this.vd},function(a){var b=this.vd;b!==a&&("start"===a||"end"===a||"left"===a||"right"===a||"center"===a?(this.vd=a,this.pa(),this.h("textAlign",b,a)):v.ua(a,'"start", "end", "left", "right", or "center"',ra,"textAlign"))});
v.u(ra,{Fa:"naturalBounds"},function(){if(!this.Jc.H()){var a=En(this,this.ie,this.sj,999999).width,b=Fn(this,a,this.sj),c=this.xa;isNaN(c.width)||(a=c.width);isNaN(c.height)||(b=c.height);eb(this.Jc,a,b)}return this.Jc});v.defineProperty(ra,{Sw:"isMultiline"},function(){return this.Nq},function(a){var b=this.Nq;b!==a&&(this.Nq=a,this.P(),this.h("isMultiline",b,a))});
v.defineProperty(ra,{vK:"isUnderline"},function(){return this.Vl},function(a){var b=this.Vl;b!==a&&(this.Vl=a,this.pa(),this.h("isUnderline",b,a))});v.defineProperty(ra,{tK:"isStrikethrough"},function(){return this.Ul},function(a){var b=this.Ul;b!==a&&(this.Ul=a,this.pa(),this.h("isStrikethrough",b,a))});v.defineProperty(ra,{JF:"wrap"},function(){return this.ym},function(a){var b=this.ym;b!==a&&(this.ym=a,this.P(),this.h("wrap",b,a))});
v.defineProperty(ra,{overflow:"overflow"},function(){return this.Pk},function(a){var b=this.Pk;b!==a&&(this.Pk=a,this.P(),this.h("overflow",b,a))});v.defineProperty(ra,{stroke:"stroke"},function(){return this.yc},function(a){var b=this.yc;b!==a&&(a instanceof ha&&a.freeze(),this.yc=a,this.pa(),this.h("stroke",b,a))});v.u(ra,{$H:"lineCount"},function(){return this.xe});v.defineProperty(ra,{Dz:"editable"},function(){return this.xq},function(a){var b=this.xq;b!==a&&(this.xq=a,this.h("editable",b,a))});
v.defineProperty(ra,{tF:"textEditor"},function(){return this.ss},function(a){var b=this.ss;b!==a&&(a instanceof HTMLElement||v.k("textEditor must be an HTMLElement, not: "+a),this.ss=a,this.h("textEditor",b,a))});v.defineProperty(ra,{Ez:"errorFunction"},function(){return this.hf},function(a){var b=this.hf;b!==a&&(null!==a&&v.j(a,"function",ra,"errorFunction"),this.hf=a,this.h("errorFunction",b,a))});function Gl(a,b){var c=a.Gg;null!==c&&b.gu!==c&&(b.font=c,b.gu=c)}
ra.prototype.Uj=function(a,b){if(null!==this.yc&&0!==this.ie.length&&null!==this.Gg){var c=this.Fa.width,d=Gn(this);a.textAlign=this.vd;Jl(this,a,this.yc,!0,!1);(this.Vl||this.Ul)&&Jl(this,a,this.yc,!1,!1);var e=this.sj,f=0,h=!1,k=v.Rb(0,0);this.Ef.xb(k);var l=v.Rb(0,d);this.Ef.xb(l);var m=k.Tj(l);v.v(k);v.v(l);k=b.scale;8>m*k*k&&(h=!0);b.Fg!==a&&(h=!1);!1===b.Yj("textGreeking")&&(h=!1);for(var m=this.Fj,k=this.Gj,l=this.xe,n=0;n<l;n++){var p=e.ff[n],q=e.ue[n];p>c&&(p=c);var f=f+m,r=q,q=a,s=f,t=c,
u=d,x=0;h?("start"===this.vd||"left"===this.vd?x=0:"end"===this.vd||"right"===this.vd?x=t-p:"center"===this.vd?x=(t-p)/2:v.k("textAlign must be start, end, left, right, or center: "+this.vd),q.fillRect(0+x,s+.25*u,p,1)):("start"===this.vd||"left"===this.vd?x=0:"end"===this.vd||"right"===this.vd?x=t:"center"===this.vd?x=t/2:v.k("textAlign must be start, end, left, right, or center: "+this.vd),q.fillText(r,0+x,s+u-.25*u),r=u/20|0,0===r&&(r=1),"end"===this.vd||"right"===this.vd?x-=p:"center"===this.vd&&
(x-=p/2),this.Vl&&(q.beginPath(),q.lineWidth=r,q.moveTo(0+x,s+u-.2*u),q.lineTo(0+x+p,s+u-.2*u),q.stroke()),this.Ul&&(q.beginPath(),q.lineWidth=r,s=s+u-u/2.2|0,0!==r%2&&(s+=.5),q.moveTo(0+x,s),q.lineTo(0+x+p,s),q.stroke()));f+=d+k}}};
ra.prototype.ip=function(a,b,c,d){this.gv=a;var e=this.sj;e.reset();var f=0,h=0;if(isNaN(this.xa.width)){f=this.ie.replace(/\r\n/g,"\n").replace(/\r/g,"\n");if(0===f.length)f=0;else if(this.Sw){for(var k=h=0,l=!1;!l;){var m=f.indexOf("\n",k);-1===m&&(m=f.length,l=!0);k=Hn(f.substr(k,m-k).replace(/^\s+|\s+$/g,""),this.Gg);k>h&&(h=k);k=m+1}f=h}else h=f.indexOf("\n",0),0<=h&&(f=f.substr(0,h)),f=k=Hn(f,this.Gg);f=Math.min(f,a/this.scale);f=Math.max(8,f)}else f=this.xa.width;null!==this.T&&(f=Math.min(f,
this.T.af.width),f=Math.max(f,this.T.ug.width));h=Fn(this,f,e);m=h=isNaN(this.xa.height)?Math.min(h,b/this.scale):this.xa.height;if(0!==e.Qe&&1!==e.ue.length&&this.Pk===Dn&&(b=this.Gg,l=this.Pk===Dn?In(b):0,k=this.Fj+this.Gj,k=Math.max(0,Gn(this)+k),m=Math.max(Math.floor(m/k)-1,0),!(m+1>=e.ue.length))){k=e.ue[m];for(a=Math.max(1,a-l);Hn(k,b)>a&&1<k.length;)k=k.substr(0,k.length-1);k+=yn;a=Hn(k,b);e.ue[m]=k;e.ue=e.ue.slice(0,m+1);e.ff[m]=a;e.ff=e.ff.slice(0,m+1);e.Ki=e.ue.length;e.Qe=Math.max(e.Qe,
a);this.xe=e.Ki}if(this.JF===Cn||isNaN(this.xa.width))f=e.Qe,isNaN(this.xa.width)&&(f=Math.max(8,f));f=Math.max(c,f);h=Math.max(d,h);eb(this.Jc,f,h);vl(this,0,0,f,h)};ra.prototype.Li=function(a,b,c,d){zl(this,a,b,c,d)};
function En(a,b,c,d){b=b.replace(/^\s+|\s+$/g,"");var e=0,f=0,h=0,k=a.Gg,f=a.Fj+a.Gj,l=Math.max(0,Gn(a)+f),h=a.Pk===Dn?In(k):0;if(a.xe>=a.vi)return new ia(0,l);if(a.ym===Bn){c.Ki=1;f=Hn(b,k);if(0===h||f<=d)return c.Qe=f,c.ff.push(c.Qe),c.ue.push(b),new ia(f,l);var m=Jn(b);b=b.substr(m.length);for(var n=Jn(b),f=Hn(m+n,k);0<n.length&&f<=d;)m+=n,b=b.substr(n.length),n=Jn(b),f=Hn((m+n).replace(/^\s+|\s+$/g,""),k);m+=n.replace(/^\s+|\s+$/g,"");for(d=Math.max(1,d-h);Hn(m,k)>d&&1<m.length;)m=m.substr(0,
m.length-1);m+=yn;h=Hn(m,k);c.ff.push(h);c.Qe=h;c.ue.push(m);return new ia(h,l)}var p=0;0===b.length&&(p=1,c.ff.push(0),c.ue.push(b));for(;0<b.length;){m=Jn(b);for(b=b.substr(m.length);Hn(m,k)>d;){n=1;f=Hn(m.substr(0,n),k);for(h=0;f<=d;)n++,h=f,f=Hn(m.substr(0,n),k);1===n?(c.ff[a.xe+p]=f,e=Math.max(e,f)):(c.ff[a.xe+p]=h,e=Math.max(e,h));n--;1>n&&(n=1);c.ue[a.xe+p]=m.substr(0,n);p++;m=m.substr(n);if(a.xe+p>a.vi)break}n=Jn(b);for(f=Hn(m+n,k);0<n.length&&f<=d;)m+=n,b=b.substr(n.length),n=Jn(b),f=Hn((m+
n).replace(/^\s+|\s+$/g,""),k);m=m.replace(/^\s+|\s+$/g,"");if(""!==m&&(0===n.length?(c.ff.push(f),e=Math.max(e,f)):(h=Hn(m,k),c.ff.push(h),e=Math.max(e,h)),c.ue.push(m),p++,a.xe+p>a.vi))break}c.Ki=Math.min(a.vi,p);c.Qe=Math.max(c.Qe,e);return new ia(c.Qe,l*c.Ki)}function Jn(a){for(var b=a.length,c=0;c<b&&" "!==a.charAt(c);)c++;for(;c<b&&" "===a.charAt(c);)c++;return c>=b?a:a.substr(0,c)}function Hn(a,b){zn!==b&&(zn=An.font=b);return An.measureText(a).width}
function Gn(a){if(null!==a.On)return a.On;var b=a.Gg;zn!==b&&(zn=An.font=b);var c=0;void 0!==un[b]&&5E3>vn?c=un[b]:(c=1.3*An.measureText("M").width,un[b]=c,vn++);return a.On=c}function In(a){zn!==a&&(zn=An.font=a);var b=0;void 0!==wn[a]&&5E3>xn?b=wn[a]:(b=An.measureText(yn).width,wn[a]=b,xn++);return b}
function Fn(a,b,c){var d=a.ie.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e=a.Fj+a.Gj,e=Math.max(0,Gn(a)+e);if(0===d.length)return c.Qe=0,a.xe=1,e;if(!a.Sw){var f=d.indexOf("\n",0);0<=f&&(d=d.substr(0,f))}for(var f=0,h=a.xe=0,k=-1,l=!1;!l;)k=d.indexOf("\n",h),-1===k&&(k=d.length,l=!0),h<=k&&(h=d.substr(h,k-h),a.ym!==Bn?(c.Ki=0,h=En(a,h,c,b),f+=h.height,a.xe+=c.Ki):(En(a,h,c,b),f+=e,a.xe++),a.xe===a.vi&&(l=!0)),h=k+1;return a.lv=f}
v.defineProperty(ra,{JA:"textValidation"},function(){return this.Rk},function(a){var b=this.Rk;b!==a&&(null!==a&&v.j(a,"function",ra,"textValidation"),this.Rk=a,this.h("textValidation",b,a))});v.defineProperty(ra,{gL:"spacingAbove"},function(){return this.Fj},function(a){var b=this.Fj;b!==a&&(this.Fj=a,this.h("spacingAbove",b,a))});v.defineProperty(ra,{hL:"spacingBelow"},function(){return this.Gj},function(a){var b=this.Gj;b!==a&&(this.Gj=a,this.h("spacingBelow",b,a))});
v.defineProperty(ra,{JK:"maxLines"},function(){return this.vi},function(a){var b=this.vi;b!==a&&(a=Math.floor(a),0>=a&&v.ua(a,"> 0",ra,"maxLines"),this.vi=a,this.h("maxLines",b,a),this.P())});v.u(ra,{KK:"metrics"},function(){return this.sj});function tn(){this.Qe=this.Ki=0;this.ff=[];this.ue=[]}tn.prototype.reset=function(){this.Qe=this.Ki=0;this.ff=[];this.ue=[]};tn.prototype.Ss=function(a){this.Ki=a.Ki;this.Qe=a.Qe;this.ff=v.$k(a.ff);this.ue=v.$k(a.ue)};v.u(tn,{OJ:"arrSize"},function(){return this.ff});
v.u(tn,{PJ:"arrText"},function(){return this.ue});v.u(tn,{IK:"maxLineWidth"},function(){return this.Qe});function Zi(){R.call(this);this.Oe=null;this.ms="";this.Ej=(new z(NaN,NaN,NaN,NaN)).freeze();this.Qn=ed;this.rs=this.Hj=this.hf=null;this.By=!1;this.qo=null;this.pC=0}v.Ga(Zi,R);v.ga("Picture",Zi);var Kn=new pa,Ln=0,Ti=[];
function Mn(){var a=Ti;if(0===a.length)for(var b=window.document.getElementsByTagName("canvas"),c=b.length,d=0;d<c;d++){var e=b[d];e.parentElement&&e.parentElement.W&&a.push(e.parentElement.W)}return a}var Nn;Zi.clearCache=Nn=function(a){void 0===a&&(a="");v.j(a,"string",Zi,"clearCache:url");""!==a?Kn[a]&&(delete Kn[a],Ln--):(Kn=new pa,Ln=0)};
Zi.prototype.cloneProtected=function(a){R.prototype.cloneProtected.call(this,a);a.element=this.Oe;a.ms=this.ms;a.Ej.assign(this.Ej);a.Qn=this.Qn;a.hf=this.hf;a.Hj=this.Hj;a.qo=this.qo};Zi.prototype.toString=function(){return"Picture("+this.source+")#"+v.cd(this)};
v.defineProperty(Zi,{element:"element"},function(){return this.Oe},function(a){var b=this.Oe;b!==a&&(null===a||a instanceof HTMLImageElement||a instanceof HTMLVideoElement||a instanceof HTMLCanvasElement||v.k("Picture.element must be an instance of Image, Canvas, or Video, not: "+a),this.By=a instanceof HTMLCanvasElement,this.Oe=a,null!==a&&(!0===a.complete||void 0===a.complete?(a.Uu instanceof Event&&null!==this.hf&&this.hf(this,a.Uu),!0===a.Dy&&null!==this.Hj&&this.Hj(this,null),a.Dy=!0,this.xa.H()||
(Dj(this,!1),this.P())):a.OB||(a.addEventListener("load",function(b){On(a,b)}),a.addEventListener("error",function(b){Pn(a,b)}),a.OB=!0)),this.h("element",b,a),this.pa())});
v.defineProperty(Zi,{source:"source"},function(){return this.ms},function(a){var b=this.ms;if(b!==a){v.j(a,"string",Zi,"source");this.ms=a;var c=Kn,d=this.g;if(void 0!==c[a])var e=c[a].Do[0].source;else{30<Ln&&(Nn(),c=Kn);e=v.createElement("img");e.addEventListener("load",function(a){On(e,a)});e.addEventListener("error",function(a){Pn(e,a)});e.OB=!0;e.src=a;var f=this.qo;null!==f&&(e.crossOrigin=f(this));c[a]=new Qn(e);Ln++}null!==d&&Fk(d,this);this.element=e;null!==d&&Ek(d,this);this.pa();this.h("source",
b,a)}});function On(a,b){a.Dy=!0;a.Uu=!1;for(var c=null,d=Mn(),e=d.length,f=0;f<e;f++){var h=d[f],k=h.ko.la(a.src);if(null!==k){e=k.length;for(f=0;f<e;f++)c=k[f],c.xa.H()||(h.BC.add(c),h.de()),null!==c.Hj&&c.Hj(c,b);h.pa()}}}function Pn(a,b){a.Uu=b;for(var c=null,d=Mn(),e=d.length,f=0;f<e;f++)if(c=d[f].ko.la(a.src),null!==c){for(var e=c.length,h=v.jb(),f=0;f<e;f++)h.push(c[f]);for(f=0;f<e;f++)c=h[f],null!==c.hf&&c.hf(c,b);v.ra(h)}}
v.defineProperty(Zi,{fL:"sourceCrossOrigin"},function(){return this.qo},function(a){if(this.qo!==a&&(null!==a&&v.j(a,"function",Zi,"sourceCrossOrigin"),this.qo=a,null!==this.element)){var b=this.element.src;null===a&&"string"===typeof b?this.element.crossOrigin=null:null!==a&&(this.element.crossOrigin=a(this))}});v.defineProperty(Zi,{Wi:"sourceRect"},function(){return this.Ej},function(a){var b=this.Ej;b.L(a)||(v.C(a,z,Zi,"sourceRect"),this.Ej=a=a.aa(),this.pa(),this.h("sourceRect",b,a))});
v.defineProperty(Zi,{EH:"imageStretch"},function(){return this.Qn},function(a){var b=this.Qn;b!==a&&(v.qb(a,R,Zi,"imageStretch"),this.Qn=a,this.pa(),this.h("imageStretch",b,a))});v.defineProperty(Zi,{Ez:"errorFunction"},function(){return this.hf},function(a){var b=this.hf;b!==a&&(null!==a&&v.j(a,"function",Zi,"errorFunction"),this.hf=a,this.h("errorFunction",b,a))});
v.defineProperty(Zi,{pL:"successFunction"},function(){return this.Hj},function(a){var b=this.Hj;b!==a&&(null!==a&&v.j(a,"function",Zi,"successFunction"),this.Hj=a,this.h("successFunction",b,a))});
Zi.prototype.Uj=function(a,b){var c=this.Oe;if(null!==c){var d=c.src;null!==d&&""!==d||v.k('Element has no source ("src") attribute: '+c);if(!(c.Uu instanceof Event)&&!0===c.Dy){var d=this.Fa,e=0,f=0,h=this.By,k=h?+c.width:c.naturalWidth,h=h?+c.height:c.naturalHeight;void 0===k&&c.videoWidth&&(k=c.videoWidth);void 0===h&&c.videoHeight&&(h=c.videoHeight);k=k||d.width;h=h||d.height;if(0!==k&&0!==h){var l=k,m=h;this.Wi.H()&&(e=this.Ej.x,f=this.Ej.y,k=this.Ej.width,h=this.Ej.height);var n=k,p=h,q=this.Qn;
switch(q){case th:if(this.Wi.H())break;e+=Math.max((n-d.width)/2,0);f+=Math.max((p-d.height)/2,0);k=Math.min(d.width,n);h=Math.min(d.height,p);break;case ed:n=d.width;p=d.height;break;case vh:case wh:var r=0;q===vh?(r=Math.min(d.height/p,d.width/n),n*=r,p*=r):q===wh&&(r=Math.max(d.height/p,d.width/n),n*=r,p*=r,e+=(n-d.width)/2,f+=(p-d.height)/2,k*=1/(n/d.width),h*=1/(p/d.height),n=d.width,p=d.height)}this.pC=k*h;var q=this.Si()*b.scale,s=this.pC/(n*q*p*q),r=Kn[this.source],q=null;if(void 0!==r&&16<
s){2>r.Do.length&&(Rn(r,4,l,m),Rn(r,16,l,m));for(var l=r.Do,m=l.length,q=l[0],t=0;t<m;t++)if(l[t].sp*l[t].sp<s)q=l[t];else break}if(!b.Jn){if(null===this.rs)if(null===this.Oe)this.rs=!1;else{l=v.createElement("canvas").getContext("2d");l.drawImage(this.Oe,0,0);try{l.getImageData(0,0,1,1),this.rs=!1}catch(u){this.rs=!0}}if(this.rs)return}if(b.Yj("pictureRatioOptimization")&&!b.Cy&&void 0!==r&&null!==q&&1!==q.sp){a.save();r=q.sp;try{a.drawImage(q.source,e/r,f/r,Math.min(q.source.width,k/r),Math.min(q.source.height,
h/r),Math.max((d.width-n)/2,0),Math.max((d.height-p)/2,0),Math.min(d.width,n),Math.min(d.height,p))}catch(x){}a.restore()}else try{a.drawImage(c,e,f,k,h,Math.max((d.width-n)/2,0),Math.max((d.height-p)/2,0),Math.min(d.width,n),Math.min(d.height,p))}catch(y){}}}}};v.u(Zi,{Fa:"naturalBounds"},function(){return this.Jc});
Zi.prototype.ip=function(a,b,c,d){var e=this.xa,f=yl(this,!0),h=this.Oe,k=this.By;if(k||!this.Jy&&h&&h.complete)this.Jy=!0;null===h&&(isFinite(a)||(a=0),isFinite(b)||(b=0));isFinite(e.width)||f===ed||f===ol?(isFinite(a)||(a=this.Wi.H()?this.Wi.width:k?+h.width:h.naturalWidth),c=0):null!==h&&!1!==this.Jy&&(a=this.Wi.H()?this.Wi.width:k?+h.width:h.naturalWidth);isFinite(e.height)||f===ed||f===nl?(isFinite(b)||(b=this.Wi.H()?this.Wi.height:k?+h.height:h.naturalHeight),d=0):null!==h&&!1!==this.Jy&&(b=
this.Wi.H()?this.Wi.height:k?+h.height:h.naturalHeight);isFinite(e.width)&&(a=e.width);isFinite(e.height)&&(b=e.height);e=this.af;f=this.ug;c=Math.max(c,f.width);d=Math.max(d,f.height);a=Math.min(e.width,a);b=Math.min(e.height,b);a=Math.max(c,a);b=Math.max(d,b);null===h||h.complete||(isFinite(a)||(a=0),isFinite(b)||(b=0));eb(this.Jc,a,b);vl(this,0,0,a,b)};Zi.prototype.Li=function(a,b,c,d){zl(this,a,b,c,d)};function Qn(a){this.Do=[new Sn(a,1)]}
function Rn(a,b,c,d){var e=new oa(null),f=e.getContext("2d"),h=1/b;e.width=c/b;e.height=d/b;b=new Sn(e.Kd,b);c=a.Do[a.Do.length-1];f.setTransform(h*c.sp,0,0,h*c.sp,0,0);f.drawImage(c.source,0,0);a.Do.push(b)}function Sn(a,b){this.source=a;this.sp=b}function ka(){this.o=new Xc;this.Sb=null}g=ka.prototype;g.reset=function(){this.o=new Xc;this.Sb=null};
function M(a,b,c,d,e,f){null===a.o&&v.k("StreamGeometryContext has been closed");void 0!==e&&!0===e?(null===a.Sb&&v.k("Need to call beginFigure first"),d=new Kd(Ad),d.J=b,d.K=c,a.Sb.vb.add(d)):(a.Sb=new dd,a.Sb.Ia=b,a.Sb.Ja=c,a.Sb.mt=d,a.o.Ub.add(a.Sb));void 0!==f&&(a.Sb.Wn=f)}function P(a){null===a.o&&v.k("StreamGeometryContext has been closed");null===a.Sb&&v.k("Need to call beginFigure first");var b=a.Sb.vb.length;0<b&&a.Sb.vb.ha(b-1).close()}
function xd(a){null===a.o&&v.k("StreamGeometryContext has been closed");null===a.Sb&&v.k("Need to call beginFigure first");0<a.Sb.vb.length&&(a.Sb.mt=!0)}g.Ya=function(a){null===this.o&&v.k("StreamGeometryContext has been closed");null===this.Sb&&v.k("Need to call beginFigure first");this.Sb.tl=a};g.moveTo=function(a,b,c){void 0===c&&(c=!1);null===this.o&&v.k("StreamGeometryContext has been closed");null===this.Sb&&v.k("Need to call beginFigure first");var d=new Kd(Ad);d.J=a;d.K=b;c&&d.close();this.Sb.vb.add(d)};
g.lineTo=function(a,b,c){void 0===c&&(c=!1);null===this.o&&v.k("StreamGeometryContext has been closed");null===this.Sb&&v.k("Need to call beginFigure first");var d=new Kd(sd);d.J=a;d.K=b;c&&d.close();this.Sb.vb.add(d)};function O(a,b,c,d,e,f,h,k){void 0===k&&(k=!1);null===a.o&&v.k("StreamGeometryContext has been closed");null===a.Sb&&v.k("Need to call beginFigure first");var l=new Kd(Bd);l.ic=b;l.Qc=c;l.ih=d;l.jh=e;l.J=f;l.K=h;k&&l.close();a.Sb.vb.add(l)}
function vd(a,b,c,d,e){var f;void 0===f&&(f=!1);null===a.o&&v.k("StreamGeometryContext has been closed");null===a.Sb&&v.k("Need to call beginFigure first");var h=new Kd(Cd);h.ic=b;h.Qc=c;h.J=d;h.K=e;f&&h.close();a.Sb.vb.add(h)}g.arcTo=function(a,b,c,d,e,f,h){void 0===f&&(f=0);void 0===h&&(h=!1);null===this.o&&v.k("StreamGeometryContext has been closed");null===this.Sb&&v.k("Need to call beginFigure first");var k=new Kd(Dd);k.Ne=a;k.Sf=b;k.oa=c;k.va=d;k.radiusX=e;k.radiusY=0!==f?f:e;h&&k.close();this.Sb.vb.add(k)};
function wd(a,b,c,d,e,f,h,k){var l;void 0===l&&(l=!1);null===a.o&&v.k("StreamGeometryContext has been closed");null===a.Sb&&v.k("Need to call beginFigure first");b=new Kd(Fd,h,k,b,c,d,e,f);l&&b.close();a.Sb.vb.add(b)}
K.makeGeometry=function(a,b,c){var d=a.xa,e=d.width,d=d.height;void 0!==b&&!isNaN(b)&&isFinite(b)&&(e=b);void 0!==c&&!isNaN(c)&&isFinite(c)&&(d=c);isFinite(e)||(e=100);isFinite(d)||(d=100);b=null;"None"!==a.Hp?b=K.aj[a.Hp]:"None"!==a.Gz?b=K.aj[a.Gz]:(c=K.sg[a.Cb],"string"===typeof c&&(c=K.sg[c]),void 0===c&&v.k("Unknown Shape.figure: "+a.Cb),b=c(a,e,d),b.Vn=e,b.Tn=d);null===b&&(c=K.sg.Rectangle,"function"===typeof c&&(b=c(a,e,d)));return b};
K.Ni=function(a,b,c,d,e,f,h,k,l,m,n,p,q,r){var s=1-l;a=a*s+c*l;b=b*s+d*l;c=c*s+e*l;d=d*s+f*l;e=e*s+h*l;f=f*s+k*l;k=a*s+c*l;h=b*s+d*l;c=c*s+e*l;d=d*s+f*l;m.x=a;m.y=b;n.x=k;n.y=h;p.x=k*s+c*l;p.y=h*s+d*l;q.x=c;q.y=d;r.x=e;r.y=f};K.Mo=function(a){a=K.Lm(a);var b=v.jb();b[0]=a[0];for(var c=1,d=1;d<a.length;)b[c]=a[d],b[c+1]=a[d],b[c+2]=a[d+1],d+=2,c+=3;v.ra(a);return b};
K.Lm=function(a){var b=K.al(a),c=v.jb(),d=Math.floor(b.length/2),e=b.length-1;a=0===a%2?2:1;for(var f=0;f<e;f++){var h=b[f],k=b[f+1],l=b[(d+f-1)%e],m=b[(d+f+a)%e];c[2*f]=h;c[2*f+1]=K.ll(h.x,h.y,l.x,l.y,k.x,k.y,m.x,m.y,new w)}c[c.length]=c[0];v.ra(b);return c};K.ll=function(a,b,c,d,e,f,h,k,l){c=a-c;var m=e-h,n=h=0;0===c||0===m?0===c?(k=(f-k)/m,h=a,n=k*h+(f-k*e)):(d=(b-d)/c,h=e,n=d*h+(b-d*a)):(d=(b-d)/c,k=(f-k)/m,a=b-d*a,h=(f-k*e-a)/(d-k),n=d*h+a);l.m(h,n);return l};
K.al=function(a){for(var b=v.jb(),c=1.5*Math.PI,d=0,e=0;e<a;e++)d=2*Math.PI/a*e+c,b[e]=new w(.5+.5*Math.cos(d),.5+.5*Math.sin(d));b.push(b[0]);return b};K.VA=(new L(.156,.156)).Ma();K.WA=(new L(.844,.844)).Ma();
K.sg={None:"Rectangle",Rectangle:function(a,b,c){a=new Xc;a.type=gd;a.Ia=0;a.Ja=0;a.J=b;a.K=c;return a},Square:function(a,b,c){a=new Xc;a.Hd=vh;a.type=gd;a.Ia=0;a.Ja=0;a.J=Math.min(b,c);a.K=Math.min(b,c);return a},Ellipse:function(a,b,c){a=new Xc;a.type=hd;a.Ia=0;a.Ja=0;a.J=b;a.K=c;a.A=K.VA;a.B=K.WA;return a},Circle:function(a,b,c){a=new Xc;a.Hd=vh;a.type=hd;a.Ia=0;a.Ja=0;a.J=Math.min(b,c);a.K=Math.min(b,c);a.A=K.VA;a.B=K.WA;return a},Connector:"Ellipse",TriangleRight:function(a,b,c){a=new Xc;var d=
new dd,e=new Kd;e.J=b;e.K=.5*c;d.vb.add(e);b=new Kd;b.J=0;b.K=c;d.vb.add(b.close());a.Ub.add(d);a.A=new L(0,.25);a.B=new L(.5,.75);return a},TriangleDown:function(a,b,c){a=new Xc;var d=new dd,e=new Kd;e.J=b;e.K=0;d.vb.add(e);e=new Kd;e.J=.5*b;e.K=c;d.vb.add(e.close());a.Ub.add(d);a.A=new L(.25,0);a.B=new L(.75,.5);return a},TriangleLeft:function(a,b,c){a=new Xc;var d=new dd;d.Ia=b;d.Ja=c;var e=new Kd;e.J=0;e.K=.5*c;d.vb.add(e);c=new Kd;c.J=b;c.K=0;d.vb.add(c.close());a.Ub.add(d);a.A=new L(.5,.25);
a.B=new L(1,.75);return a},TriangleUp:function(a,b,c){a=new Xc;var d=new dd;d.Ia=b;d.Ja=c;var e=new Kd;e.J=0;e.K=c;d.vb.add(e);c=new Kd;c.J=.5*b;c.K=0;d.vb.add(c.close());a.Ub.add(d);a.A=new L(.25,.5);a.B=new L(.75,1);return a},Line1:function(a,b,c){a=new Xc;a.type=fd;a.Ia=0;a.Ja=0;a.J=b;a.K=c;return a},Line2:function(a,b,c){a=new Xc;a.type=fd;a.Ia=b;a.Ja=0;a.J=0;a.K=c;return a},MinusLine:"LineH",LineH:function(a,b,c){a=new Xc;a.type=fd;a.Ia=0;a.Ja=c/2;a.J=b;a.K=c/2;return a},LineV:function(a,b,c){a=
new Xc;a.type=fd;a.Ia=b/2;a.Ja=0;a.J=b/2;a.K=c;return a},BarH:"Rectangle",BarV:"Rectangle",Curve1:function(a,b,c){var d=K.za;a=v.q();M(a,0,0,!1);O(a,d*b,0,1*b,(1-d)*c,b,c);b=a.o;v.s(a);return b},Curve2:function(a,b,c){var d=K.za;a=v.q();M(a,0,0,!1);O(a,0,d*c,(1-d)*b,c,b,c);b=a.o;v.s(a);return b},Curve3:function(a,b,c){var d=K.za;a=v.q();M(a,1*b,0,!1);O(a,1*b,d*c,d*b,1*c,0,1*c);b=a.o;v.s(a);return b},Curve4:function(a,b,c){var d=K.za;a=v.q();M(a,1*b,0,!1);O(a,(1-d)*b,0,0,(1-d)*c,0,1*c);b=a.o;v.s(a);
return b},Alternative:"Triangle",Merge:"Triangle",Triangle:function(a,b,c){a=v.q();M(a,.5*b,0*c,!0);a.lineTo(0*b,1*c);a.lineTo(1*b,1*c,!0);b=a.o;b.A=new L(.25,.5);b.B=new L(.75,1);v.s(a);return b},Decision:"Diamond",Diamond:function(a,b,c){a=v.q();M(a,.5*b,0,!0);a.lineTo(0,.5*c);a.lineTo(.5*b,1*c);a.lineTo(1*b,.5*c,!0);b=a.o;b.A=new L(.25,.25);b.B=new L(.75,.75);v.s(a);return b},Pentagon:function(a,b,c){var d=K.al(5);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;5>e;e++)a.lineTo(d[e].x*b,d[e].y*c);
v.ra(d);P(a);b=a.o;b.A=new L(.2,.22);b.B=new L(.8,.9);v.s(a);return b},DataTransmission:"Hexagon",Hexagon:function(a,b,c){var d=K.al(6);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;6>e;e++)a.lineTo(d[e].x*b,d[e].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.07,.25);b.B=new L(.93,.75);v.s(a);return b},Heptagon:function(a,b,c){var d=K.al(7);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;7>e;e++)a.lineTo(d[e].x*b,d[e].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.2,.15);b.B=new L(.8,.85);v.s(a);return b},Octagon:function(a,
b,c){var d=K.al(8);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;8>e;e++)a.lineTo(d[e].x*b,d[e].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.15,.15);b.B=new L(.85,.85);v.s(a);return b},Nonagon:function(a,b,c){var d=K.al(9);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;9>e;e++)a.lineTo(d[e].x*b,d[e].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.17,.13);b.B=new L(.82,.82);v.s(a);return b},Decagon:function(a,b,c){var d=K.al(10);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;10>e;e++)a.lineTo(d[e].x*b,d[e].y*c);v.ra(d);P(a);
b=a.o;b.A=new L(.16,.16);b.B=new L(.84,.84);v.s(a);return b},Dodecagon:function(a,b,c){var d=K.al(12);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;12>e;e++)a.lineTo(d[e].x*b,d[e].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.16,.16);b.B=new L(.84,.84);v.s(a);return b},FivePointedStar:function(a,b,c){var d=K.Lm(5);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;10>e;e++)a.lineTo(d[e].x*b,d[e].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.312,.383);b.B=new L(.693,.765);v.s(a);return b},SixPointedStar:function(a,b,c){var d=
K.Lm(6);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;12>e;e++)a.lineTo(d[e].x*b,d[e].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.17,.251);b.B=new L(.833,.755);v.s(a);return b},SevenPointedStar:function(a,b,c){var d=K.Lm(7);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;14>e;e++)a.lineTo(d[e].x*b,d[e].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.363,.361);b.B=new L(.641,.709);v.s(a);return b},EightPointedStar:function(a,b,c){var d=K.Lm(8);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;16>e;e++)a.lineTo(d[e].x*b,d[e].y*
c);v.ra(d);P(a);b=a.o;b.A=new L(.252,.255);b.B=new L(.75,.75);v.s(a);return b},NinePointedStar:function(a,b,c){var d=K.Lm(9);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;18>e;e++)a.lineTo(d[e].x*b,d[e].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.355,.361);b.B=new L(.645,.651);v.s(a);return b},TenPointedStar:function(a,b,c){var d=K.Lm(10);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;20>e;e++)a.lineTo(d[e].x*b,d[e].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.281,.261);b.B=new L(.723,.748);v.s(a);return b},FivePointedBurst:function(a,
b,c){var d=K.Mo(5);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;e<d.length;e+=3)O(a,d[e].x*b,d[e].y*c,d[e+1].x*b,d[e+1].y*c,d[e+2].x*b,d[e+2].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.312,.383);b.B=new L(.693,.765);v.s(a);return b},SixPointedBurst:function(a,b,c){var d=K.Mo(6);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;e<d.length;e+=3)O(a,d[e].x*b,d[e].y*c,d[e+1].x*b,d[e+1].y*c,d[e+2].x*b,d[e+2].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.17,.251);b.B=new L(.833,.755);v.s(a);return b},SevenPointedBurst:function(a,
b,c){var d=K.Mo(7);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;e<d.length;e+=3)O(a,d[e].x*b,d[e].y*c,d[e+1].x*b,d[e+1].y*c,d[e+2].x*b,d[e+2].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.363,.361);b.B=new L(.641,.709);v.s(a);return b},EightPointedBurst:function(a,b,c){var d=K.Mo(8);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;e<d.length;e+=3)O(a,d[e].x*b,d[e].y*c,d[e+1].x*b,d[e+1].y*c,d[e+2].x*b,d[e+2].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.252,.255);b.B=new L(.75,.75);v.s(a);return b},NinePointedBurst:function(a,
b,c){var d=K.Mo(9);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;e<d.length;e+=3)O(a,d[e].x*b,d[e].y*c,d[e+1].x*b,d[e+1].y*c,d[e+2].x*b,d[e+2].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.355,.361);b.B=new L(.645,.651);v.s(a);return b},TenPointedBurst:function(a,b,c){var d=K.Mo(10);a=v.q();M(a,d[0].x*b,d[0].y*c,!0);for(var e=1;e<d.length;e+=3)O(a,d[e].x*b,d[e].y*c,d[e+1].x*b,d[e+1].y*c,d[e+2].x*b,d[e+2].y*c);v.ra(d);P(a);b=a.o;b.A=new L(.281,.261);b.B=new L(.723,.748);v.s(a);return b},Cloud:function(a,b,c){a=
v.q();M(a,.08034461*b,.1944299*c,!0);O(a,-.09239631*b,.07836421*c,.1406031*b,-.0542823*c,.2008615*b,.05349299*c);O(a,.2450511*b,-.00697547*c,.3776197*b,-.01112067*c,.4338609*b,.074219*c);O(a,.4539471*b,0,.6066018*b,-.02526587*c,.6558228*b,.07004196*c);O(a,.6914277*b,-.01904177*c,.8921095*b,-.01220843*c,.8921095*b,.08370865*c);O(a,1.036446*b,.04105738*c,1.020377*b,.3022052*c,.9147671*b,.3194596*c);O(a,1.04448*b,.360238*c,.992256*b,.5219009*c,.9082935*b,.562044*c);O(a,1.032337*b,.5771781*c,1.018411*
b,.8120651*c,.9212406*b,.8217117*c);O(a,1.028411*b,.9571472*c,.8556702*b,1.052487*c,.7592566*b,.9156953*c);O(a,.7431877*b,1.009325*c,.5624123*b,1.021761*c,.5101666*b,.9310455*c);O(a,.4820677*b,1.031761*c,.3030112*b,1.002796*c,.2609328*b,.9344623*c);O(a,.2329994*b,1.01518*c,.03213784*b,1.01518*c,.08034461*b,.870098*c);O(a,-.02812061*b,.9032597*c,-.01205169*b,.6835638*c,.06829292*b,.6545475*c);O(a,-.01812061*b,.6089503*c,-.00606892*b,.4555777*c,.06427569*b,.4265613*c);O(a,-.01606892*b,.3892545*c,-.01205169*
b,.1944299*c,.08034461*b,.1944299*c);P(a);b=a.o;b.A=new L(.1,.1);b.B=new L(.9,.9);v.s(a);return b},Gate:"Crescent",Crescent:function(a,b,c){a=v.q();M(a,0,0,!0);O(a,1*b,0,1*b,1*c,0,1*c);O(a,.5*b,.75*c,.5*b,.25*c,0,0);P(a);b=a.o;b.A=new L(.511,.19);b.B=new L(.776,.76);v.s(a);return b},FramedRectangle:function(a,b,c){var d=v.q(),e=a?a.vc:NaN;a=a?a.Gt:NaN;isNaN(e)&&(e=.1);isNaN(a)&&(a=.1);M(d,0,0,!0);d.lineTo(1*b,0);d.lineTo(1*b,1*c);d.lineTo(0,1*c,!0);M(d,e*b,a*c,!1,!0);d.lineTo(e*b,(1-a)*c);d.lineTo((1-
e)*b,(1-a)*c);d.lineTo((1-e)*b,a*c,!0);b=d.o;b.A=new L(e,a);b.B=new L(1-e,1-a);v.s(d);return b},Delay:"HalfEllipse",HalfEllipse:function(a,b,c){var d=K.za;a=v.q();M(a,0,0,!0);O(a,d*b,0,1*b,(.5-d/2)*c,1*b,.5*c);O(a,1*b,(.5+d/2)*c,d*b,1*c,0,1*c);P(a);b=a.o;b.A=new L(0,.2);b.B=new L(.75,.8);v.s(a);return b},Heart:function(a,b,c){a=v.q();M(a,.5*b,1*c,!0);O(a,.1*b,.8*c,0,.5*c,0*b,.3*c);O(a,0*b,0,.45*b,0,.5*b,.3*c);O(a,.55*b,0,1*b,0,1*b,.3*c);O(a,b,.5*c,.9*b,.8*c,.5*b,1*c);P(a);b=a.o;b.A=new L(.15,.29);
b.B=new L(.86,.68);v.s(a);return b},Spade:function(a,b,c){a=v.q();M(a,.5*b,0,!0);a.lineTo(.51*b,.01*c);O(a,.6*b,.2*c,b,.25*c,b,.5*c);O(a,b,.8*c,.6*b,.8*c,.55*b,.7*c);O(a,.5*b,.75*c,.55*b,.95*c,.75*b,c);a.lineTo(.25*b,c);O(a,.45*b,.95*c,.5*b,.75*c,.45*b,.7*c);O(a,.4*b,.8*c,0,.8*c,0,.5*c);O(a,0,.25*c,.4*b,.2*c,.49*b,.01*c);P(a);b=a.o;b.A=new L(.19,.26);b.B=new L(.8,.68);v.s(a);return b},Club:function(a,b,c){a=v.q();M(a,.4*b,.6*c,!0);O(a,.5*b,.75*c,.45*b,.95*c,.15*b,1*c);a.lineTo(.85*b,c);O(a,.55*b,
.95*c,.5*b,.75*c,.6*b,.6*c);var d=.2,e=.3,f=0,h=4*(Math.SQRT2-1)/3*d;O(a,(.5-d+e)*b,(.5+h+f)*c,(.5-h+e)*b,(.5+d+f)*c,(.5+e)*b,(.5+d+f)*c);O(a,(.5+h+e)*b,(.5+d+f)*c,(.5+d+e)*b,(.5+h+f)*c,(.5+d+e)*b,(.5+f)*c);O(a,(.5+d+e)*b,(.5-h+f)*c,(.5+h+e)*b,(.5-d+f)*c,(.5+e)*b,(.5-d+f)*c);O(a,(.5-h+e)*b,(.5-d+f)*c,(.5-d+e+.05)*b,(.5-h+f-.02)*c,.65*b,.36771243*c);d=.2;e=0;f=-.3;h=4*(Math.SQRT2-1)/3*d;O(a,(.5+h+e)*b,(.5+d+f)*c,(.5+d+e)*b,(.5+h+f)*c,(.5+d+e)*b,(.5+f)*c);O(a,(.5+d+e)*b,(.5-h+f)*c,(.5+h+e)*b,(.5-d+
f)*c,(.5+e)*b,(.5-d+f)*c);O(a,(.5-h+e)*b,(.5-d+f)*c,(.5-d+e)*b,(.5-h+f)*c,(.5-d+e)*b,(.5+f)*c);O(a,(.5-d+e)*b,(.5+h+f)*c,(.5-h+e)*b,(.5+d+f)*c,.35*b,.36771243*c);d=.2;e=-.3;f=0;h=4*(Math.SQRT2-1)/3*d;O(a,(.5+d+e-.05)*b,(.5-h+f-.02)*c,(.5+h+e)*b,(.5-d+f)*c,(.5+e)*b,(.5-d+f)*c);O(a,(.5-h+e)*b,(.5-d+f)*c,(.5-d+e)*b,(.5-h+f)*c,(.5-d+e)*b,(.5+f)*c);O(a,(.5-d+e)*b,(.5+h+f)*c,(.5-h+e)*b,(.5+d+f)*c,(.5+e)*b,(.5+d+f)*c);O(a,(.5+h+e)*b,(.5+d+f)*c,(.5+d+e)*b,(.5+h+f)*c,.4*b,.6*c);P(a);b=a.o;b.A=new L(.06,.39);
b.B=new L(.93,.58);v.s(a);return b},Ring:function(a,b,c){a=v.q();var d=4*(Math.SQRT2-1)/3*.5;M(a,b,.5*c,!0);O(a,b,(.5-d)*c,(.5+d)*b,0,.5*b,0);O(a,(.5-d)*b,0,0,(.5-d)*c,0,.5*c);O(a,0,(.5+d)*c,(.5-d)*b,c,.5*b,c);O(a,(.5+d)*b,c,b,(.5+d)*c,b,.5*c);d=4*(Math.SQRT2-1)/3*.4;M(a,.5*b,.1*c,!0,!0);O(a,(.5+d)*b,.1*c,.9*b,(.5-d)*c,.9*b,.5*c);O(a,.9*b,(.5+d)*c,(.5+d)*b,.9*c,.5*b,.9*c);O(a,(.5-d)*b,.9*c,.1*b,(.5+d)*c,.1*b,.5*c);O(a,.1*b,(.5-d)*c,(.5-d)*b,.1*c,.5*b,.1*c);b=a.o;b.A=new L(.146,.146);b.B=new L(.853,
.853);b.Hd=vh;v.s(a);return b},YinYang:function(a,b,c){var d=.5;a=v.q();d=.5;M(a,.5*b,0,!0);a.arcTo(270,180,.5*b,.5*b,.5*b);O(a,1*b,d*c,0,d*c,d*b,0,!0);var d=.1,e=.25;M(a,(.5+d)*b,e*c,!0,!0);a.arcTo(0,-360,.5*b,c*e,d*b);P(a);M(a,.5*b,0,!1);a.arcTo(270,-180,.5*b,.5*b,.5*b);a.Ya(!1);e=.75;M(a,(.5+d)*b,e*c,!0);a.arcTo(0,360,.5*b,c*e,d*b);P(a);b=a.o;b.Hd=vh;v.s(a);return b},Peace:function(a,b,c){a=v.q();var d=4*(Math.SQRT2-1)/3*.5;M(a,b,.5*c,!0);O(a,b,(.5-d)*c,(.5+d)*b,0,.5*b,0);O(a,(.5-d)*b,0,0,(.5-
d)*c,0,.5*c);O(a,0,(.5+d)*c,(.5-d)*b,c,.5*b,c);O(a,(.5+d)*b,c,b,(.5+d)*c,b,.5*c);d=4*(Math.SQRT2-1)/3*.4;M(a,.5*b,.1*c,!0,!0);O(a,(.5+d)*b,.1*c,.9*b,(.5-d)*c,.9*b,.5*c);O(a,.9*b,(.5+d)*c,(.5+d)*b,.9*c,.5*b,.9*c);O(a,(.5-d)*b,.9*c,.1*b,(.5+d)*c,.1*b,.5*c);O(a,.1*b,(.5-d)*c,(.5-d)*b,.1*c,.5*b,.1*c);var d=.07,e=0,f=-.707*.11,h=4*(Math.SQRT2-1)/3*d;M(a,(.5+d+e)*b,(.5+f)*c,!0);O(a,(.5+d+e)*b,(.5-h+f)*c,(.5+h+e)*b,(.5-d+f)*c,(.5+e)*b,(.5-d+f)*c);O(a,(.5-h+e)*b,(.5-d+f)*c,(.5-d+e)*b,(.5-h+f)*c,(.5-d+e)*
b,(.5+f)*c);O(a,(.5-d+e)*b,(.5+h+f)*c,(.5-h+e)*b,(.5+d+f)*c,(.5+e)*b,(.5+d+f)*c);O(a,(.5+h+e)*b,(.5+d+f)*c,(.5+d+e)*b,(.5+h+f)*c,(.5+d+e)*b,(.5+f)*c);d=.07;e=-.707*.11;f=.707*.11;h=4*(Math.SQRT2-1)/3*d;M(a,(.5+d+e)*b,(.5+f)*c,!0);O(a,(.5+d+e)*b,(.5-h+f)*c,(.5+h+e)*b,(.5-d+f)*c,(.5+e)*b,(.5-d+f)*c);O(a,(.5-h+e)*b,(.5-d+f)*c,(.5-d+e)*b,(.5-h+f)*c,(.5-d+e)*b,(.5+f)*c);O(a,(.5-d+e)*b,(.5+h+f)*c,(.5-h+e)*b,(.5+d+f)*c,(.5+e)*b,(.5+d+f)*c);O(a,(.5+h+e)*b,(.5+d+f)*c,(.5+d+e)*b,(.5+h+f)*c,(.5+d+e)*b,(.5+f)*
c);d=.07;e=.707*.11;f=.707*.11;h=4*(Math.SQRT2-1)/3*d;M(a,(.5+d+e)*b,(.5+f)*c,!0);O(a,(.5+d+e)*b,(.5-h+f)*c,(.5+h+e)*b,(.5-d+f)*c,(.5+e)*b,(.5-d+f)*c);O(a,(.5-h+e)*b,(.5-d+f)*c,(.5-d+e)*b,(.5-h+f)*c,(.5-d+e)*b,(.5+f)*c);O(a,(.5-d+e)*b,(.5+h+f)*c,(.5-h+e)*b,(.5+d+f)*c,(.5+e)*b,(.5+d+f)*c);O(a,(.5+h+e)*b,(.5+d+f)*c,(.5+d+e)*b,(.5+h+f)*c,(.5+d+e)*b,(.5+f)*c);b=a.o;b.A=new L(.146,.146);b.B=new L(.853,.853);b.Hd=vh;v.s(a);return b},NotAllowed:function(a,b,c){var d=K.za,e=.5*d,f=.5;a=v.q();M(a,.5*b,(.5-
f)*c,!0);O(a,(.5-e)*b,(.5-f)*c,(.5-f)*b,(.5-e)*c,(.5-f)*b,.5*c);O(a,(.5-f)*b,(.5+e)*c,(.5-e)*b,(.5+f)*c,.5*b,(.5+f)*c);O(a,(.5+e)*b,(.5+f)*c,(.5+f)*b,(.5+e)*c,(.5+f)*b,.5*c);O(a,(.5+f)*b,(.5-e)*c,(.5+e)*b,(.5-f)*c,.5*b,(.5-f)*c);var f=.4,e=.4*d,d=v.M(),h=v.M(),k=v.M(),l=v.M();K.Ni(.5,.5-f,.5+e,.5-f,.5+f,.5-e,.5+f,.5,.42,d,h,k,l,l);var m=v.M(),n=v.M(),p=v.M();K.Ni(.5,.5-f,.5+e,.5-f,.5+f,.5-e,.5+f,.5,.58,l,l,p,m,n);var q=v.M(),r=v.M(),s=v.M();K.Ni(.5,.5+f,.5-e,.5+f,.5-f,.5+e,.5-f,.5,.42,q,r,s,l,l);
var t=v.M(),u=v.M(),x=v.M();K.Ni(.5,.5+f,.5-e,.5+f,.5-f,.5+e,.5-f,.5,.58,l,l,x,t,u);M(a,x.x*b,x.y*c,!0,!0);O(a,t.x*b,t.y*c,u.x*b,u.y*c,(.5-f)*b,.5*c);O(a,(.5-f)*b,(.5-e)*c,(.5-e)*b,(.5-f)*c,.5*b,(.5-f)*c);O(a,d.x*b,d.y*c,h.x*b,h.y*c,k.x*b,k.y*c);a.lineTo(x.x*b,x.y*c);P(a);M(a,s.x*b,s.y*c,!0,!0);a.lineTo(p.x*b,p.y*c);O(a,m.x*b,m.y*c,n.x*b,n.y*c,(.5+f)*b,.5*c);O(a,(.5+f)*b,(.5+e)*c,(.5+e)*b,(.5+f)*c,.5*b,(.5+f)*c);O(a,q.x*b,q.y*c,r.x*b,r.y*c,s.x*b,s.y*c);P(a);v.v(d);v.v(h);v.v(k);v.v(l);v.v(m);v.v(n);
v.v(p);v.v(q);v.v(r);v.v(s);v.v(t);v.v(u);v.v(x);b=a.o;v.s(a);b.Hd=vh;return b},Fragile:function(a,b,c){a=v.q();M(a,0,0,!0);a.lineTo(.25*b,0);a.lineTo(.2*b,.15*c);a.lineTo(.3*b,.25*c);a.lineTo(.29*b,.33*c);a.lineTo(.35*b,.25*c);a.lineTo(.3*b,.15*c);a.lineTo(.4*b,0);a.lineTo(1*b,0);O(a,1*b,.25*c,.75*b,.5*c,.55*b,.5*c);a.lineTo(.55*b,.9*c);a.lineTo(.7*b,.9*c);a.lineTo(.7*b,1*c);a.lineTo(.3*b,1*c);a.lineTo(.3*b,.9*c);a.lineTo(.45*b,.9*c);a.lineTo(.45*b,.5*c);O(a,.25*b,.5*c,0,.25*c,0,0);P(a);b=a.o;b.A=
new L(.25,0);b.B=new L(.75,.4);v.s(a);return b},HourGlass:function(a,b,c){a=v.q();M(a,.65*b,.5*c,!0);a.lineTo(1*b,1*c);a.lineTo(0,1*c);a.lineTo(.35*b,.5*c);a.lineTo(0,0);a.lineTo(1*b,0);P(a);b=a.o;v.s(a);return b},Lightning:function(a,b,c){a=v.q();M(a,0*b,.55*c,!0);a.lineTo(.75*b,0);a.lineTo(.25*b,.45*c);a.lineTo(.9*b,.48*c);a.lineTo(.4*b,1*c);a.lineTo(.65*b,.55*c);P(a);b=a.o;v.s(a);return b},Parallelogram1:function(a,b,c){a=a?a.vc:NaN;isNaN(a)&&(a=.1);var d=v.q();M(d,a*b,0,!0);d.lineTo(1*b,0);d.lineTo((1-
a)*b,1*c);d.lineTo(0,1*c);P(d);b=d.o;b.A=new L(a,0);b.B=new L(1-a,1);v.s(d);return b},Input:"Output",Output:function(a,b,c){a=v.q();M(a,0,1*c,!0);a.lineTo(.1*b,0);a.lineTo(1*b,0);a.lineTo(.9*b,1*c);P(a);b=a.o;b.A=new L(.1,0);b.B=new L(.9,1);v.s(a);return b},Parallelogram2:function(a,b,c){a=a?a.vc:NaN;isNaN(a)&&(a=.25);var d=v.q();M(d,a*b,0,!0);d.lineTo(1*b,0);d.lineTo((1-a)*b,1*c);d.lineTo(0,1*c);P(d);b=d.o;b.A=new L(a,0);b.B=new L(1-a,1);v.s(d);return b},ThickCross:function(a,b,c){a=a?a.vc:NaN;isNaN(a)&&
(a=.25);var d=v.q();M(d,(.5-a/2)*b,0,!0);d.lineTo((.5+a/2)*b,0);d.lineTo((.5+a/2)*b,(.5-a/2)*c);d.lineTo(1*b,(.5-a/2)*c);d.lineTo(1*b,(.5+a/2)*c);d.lineTo((.5+a/2)*b,(.5+a/2)*c);d.lineTo((.5+a/2)*b,1*c);d.lineTo((.5-a/2)*b,1*c);d.lineTo((.5-a/2)*b,(.5+a/2)*c);d.lineTo(0,(.5+a/2)*c);d.lineTo(0,(.5-a/2)*c);d.lineTo((.5-a/2)*b,(.5-a/2)*c);P(d);b=d.o;b.A=new L(.5-a/2,.5-a/2);b.B=new L(.5+a/2,.5+a/2);v.s(d);return b},ThickX:function(a,b,c){a=.25/Math.SQRT2;var d=v.q();M(d,.3*b,0,!0);d.lineTo(.5*b,.2*c);
d.lineTo(.7*b,0);d.lineTo(1*b,.3*c);d.lineTo(.8*b,.5*c);d.lineTo(1*b,.7*c);d.lineTo(.7*b,1*c);d.lineTo(.5*b,.8*c);d.lineTo(.3*b,1*c);d.lineTo(0,.7*c);d.lineTo(.2*b,.5*c);d.lineTo(0,.3*c);P(d);b=d.o;b.A=new L(.5-a,.5-a);b.B=new L(.5+a,.5+a);v.s(d);return b},ThinCross:function(a,b,c){var d=a?a.vc:NaN;isNaN(d)&&(d=.1);a=v.q();M(a,(.5-d/2)*b,0,!0);a.lineTo((.5+d/2)*b,0);a.lineTo((.5+d/2)*b,(.5-d/2)*c);a.lineTo(1*b,(.5-d/2)*c);a.lineTo(1*b,(.5+d/2)*c);a.lineTo((.5+d/2)*b,(.5+d/2)*c);a.lineTo((.5+d/2)*
b,1*c);a.lineTo((.5-d/2)*b,1*c);a.lineTo((.5-d/2)*b,(.5+d/2)*c);a.lineTo(0,(.5+d/2)*c);a.lineTo(0,(.5-d/2)*c);a.lineTo((.5-d/2)*b,(.5-d/2)*c);P(a);b=a.o;v.s(a);return b},ThinX:function(a,b,c){a=v.q();M(a,.1*b,0,!0);a.lineTo(.5*b,.4*c);a.lineTo(.9*b,0);a.lineTo(1*b,.1*c);a.lineTo(.6*b,.5*c);a.lineTo(1*b,.9*c);a.lineTo(.9*b,1*c);a.lineTo(.5*b,.6*c);a.lineTo(.1*b,1*c);a.lineTo(0,.9*c);a.lineTo(.4*b,.5*c);a.lineTo(0,.1*c);P(a);return a.o},RightTriangle:function(a,b,c){a=v.q();M(a,0,0,!0);a.lineTo(1*b,
1*c);a.lineTo(0,1*c);P(a);b=a.o;b.A=new L(0,.5);b.B=new L(.5,1);v.s(a);return b},RoundedIBeam:function(a,b,c){a=v.q();M(a,0,0,!0);a.lineTo(1*b,0);O(a,.5*b,.25*c,.5*b,.75*c,1*b,1*c);a.lineTo(0,1*c);O(a,.5*b,.75*c,.5*b,.25*c,0,0);P(a);b=a.o;v.s(a);return b},RoundedRectangle:function(a,b,c){var d=a?a.vc:NaN;isNaN(d)&&(d=5);d=Math.min(d,b/3);d=Math.min(d,c/3);a=d*K.za;var e=v.q();M(e,d,0,!0);e.lineTo(b-d,0);O(e,b-a,0,b,a,b,d);e.lineTo(b,c-d);O(e,b,c-a,b-a,c,b-d,c);e.lineTo(d,c);O(e,a,c,0,c-a,0,c-d);e.lineTo(0,
d);O(e,0,a,a,0,d,0);P(e);b=e.o;1<a?(b.A=new L(0,0,a,a),b.B=new L(1,1,-a,-a)):(b.A=zb,b.B=Vb);v.s(e);return b},Border:function(a,b,c){var d=a?a.vc:NaN;isNaN(d)&&(d=5);d=Math.min(d,b/3);d=Math.min(d,c/3);a=v.q();M(a,d,0,!0);a.lineTo(b-d,0);O(a,b-0,0,b,0,b,d);a.lineTo(b,c-d);O(a,b,c-0,b-0,c,b-d,c);a.lineTo(d,c);O(a,0,c,0,c-0,0,c-d);a.lineTo(0,d);O(a,0,0,0,0,d,0);P(a);b=a.o;b.A=zb;b.B=Vb;v.s(a);return b},SquareIBeam:function(a,b,c){var d=a?a.vc:NaN;isNaN(d)&&(d=.2);a=v.q();M(a,0,0,!0);a.lineTo(1*b,0);
a.lineTo(1*b,d*c);a.lineTo((.5+d/2)*b,d*c);a.lineTo((.5+d/2)*b,(1-d)*c);a.lineTo(1*b,(1-d)*c);a.lineTo(1*b,1*c);a.lineTo(0,1*c);a.lineTo(0,(1-d)*c);a.lineTo((.5-d/2)*b,(1-d)*c);a.lineTo((.5-d/2)*b,d*c);a.lineTo(0,d*c);P(a);b=a.o;v.s(a);return b},Trapezoid:function(a,b,c){a=a?a.vc:NaN;isNaN(a)&&(a=.2);var d=v.q();M(d,a*b,0,!0);d.lineTo((1-a)*b,0);d.lineTo(1*b,1*c);d.lineTo(0,1*c);P(d);b=d.o;b.A=new L(a,0);b.B=new L(1-a,1);v.s(d);return b},ManualLoop:"ManualOperation",ManualOperation:function(a,b,c){var d=
a?a.vc:NaN;isNaN(d)&&(d=0);a=v.q();M(a,d,0,!0);a.lineTo(0,0);a.lineTo(1*b,0);a.lineTo(.9*b,1*c);a.lineTo(.1*b,1*c);P(a);b=a.o;b.A=new L(.1,0);b.B=new L(.9,1);v.s(a);return b},GenderMale:function(a,b,c){a=v.q();var d=K.za,e=.4*d,f=.4,h=v.M(),k=v.M(),l=v.M(),m=v.M();M(a,(.5-f)*b,.5*c,!0);O(a,(.5-f)*b,(.5-e)*c,(.5-e)*b,(.5-f)*c,.5*b,(.5-f)*c);K.Ni(.5,.5-f,.5+e,.5-f,.5+f,.5-e,.5+f,.5,.44,l,m,k,h,h);O(a,l.x*b,l.y*c,m.x*b,m.y*c,k.x*b,k.y*c);var n=v.Rb(k.x,k.y);K.Ni(.5,.5-f,.5+e,.5-f,.5+f,.5-e,.5+f,.5,.56,
h,h,k,l,m);var p=v.Rb(k.x,k.y);a.lineTo((.1*n.x+.855)*b,.1*n.y*c);a.lineTo(.85*b,.1*n.y*c);a.lineTo(.85*b,0);a.lineTo(1*b,0);a.lineTo(1*b,.15*c);a.lineTo((.1*p.x+.9)*b,.15*c);a.lineTo((.1*p.x+.9)*b,(.1*p.y+.05*.9)*c);a.lineTo(p.x*b,p.y*c);O(a,l.x*b,l.y*c,m.x*b,m.y*c,(.5+f)*b,.5*c);O(a,(.5+f)*b,(.5+e)*c,(.5+e)*b,(.5+f)*c,.5*b,(.5+f)*c);O(a,(.5-e)*b,(.5+f)*c,(.5-f)*b,(.5+e)*c,(.5-f)*b,.5*c);f=.35;e=.35*d;M(a,.5*b,(.5-f)*c,!0,!0);O(a,(.5-e)*b,(.5-f)*c,(.5-f)*b,(.5-e)*c,(.5-f)*b,.5*c);O(a,(.5-f)*b,(.5+
e)*c,(.5-e)*b,(.5+f)*c,.5*b,(.5+f)*c);O(a,(.5+e)*b,(.5+f)*c,(.5+f)*b,(.5+e)*c,(.5+f)*b,.5*c);O(a,(.5+f)*b,(.5-e)*c,(.5+e)*b,(.5-f)*c,.5*b,(.5-f)*c);M(a,(.5-f)*b,.5*c,!0);v.v(h);v.v(k);v.v(l);v.v(m);v.v(n);v.v(p);b=a.o;b.A=new L(.202,.257);b.B=new L(.692,.839);b.Hd=vh;v.s(a);return b},GenderFemale:function(a,b,c){a=v.q();var d=.375,e=0,f=-.125,h=4*(Math.SQRT2-1)/3*d;M(a,(.525+e)*b,(.5+d+f)*c,!0);O(a,(.5+h+e)*b,(.5+d+f)*c,(.5+d+e)*b,(.5+h+f)*c,(.5+d+e)*b,(.5+f)*c);O(a,(.5+d+e)*b,(.5-h+f)*c,(.5+h+e)*
b,(.5-d+f)*c,(.5+e)*b,(.5-d+f)*c);O(a,(.5-h+e)*b,(.5-d+f)*c,(.5-d+e)*b,(.5-h+f)*c,(.5-d+e)*b,(.5+f)*c);O(a,(.5-d+e)*b,(.5+h+f)*c,(.5-h+e)*b,(.5+d+f)*c,(.475+e)*b,(.5+d+f)*c);a.lineTo(.475*b,.85*c);a.lineTo(.425*b,.85*c);a.lineTo(.425*b,.9*c);a.lineTo(.475*b,.9*c);a.lineTo(.475*b,1*c);a.lineTo(.525*b,1*c);a.lineTo(.525*b,.9*c);a.lineTo(.575*b,.9*c);a.lineTo(.575*b,.85*c);a.lineTo(.525*b,.85*c);P(a);d=.325;e=0;f=-.125;h=4*(Math.SQRT2-1)/3*d;M(a,(.5+d+e)*b,(.5+f)*c,!0,!0);O(a,(.5+d+e)*b,(.5+h+f)*c,(.5+
h+e)*b,(.5+d+f)*c,(.5+e)*b,(.5+d+f)*c);O(a,(.5-h+e)*b,(.5+d+f)*c,(.5-d+e)*b,(.5+h+f)*c,(.5-d+e)*b,(.5+f)*c);O(a,(.5-d+e)*b,(.5-h+f)*c,(.5-h+e)*b,(.5-d+f)*c,(.5+e)*b,(.5-d+f)*c);O(a,(.5+h+e)*b,(.5-d+f)*c,(.5+d+e)*b,(.5-h+f)*c,(.5+d+e)*b,(.5+f)*c);M(a,(.525+e)*b,(.5+d+f)*c,!0);b=a.o;b.A=new L(.232,.136);b.B=new L(.782,.611);b.Hd=vh;v.s(a);return b},PlusLine:function(a,b,c){a=v.q();M(a,0,.5*c,!1);a.lineTo(1*b,.5*c);a.moveTo(.5*b,0);a.lineTo(.5*b,1*c);b=a.o;v.s(a);return b},XLine:function(a,b,c){a=v.q();
M(a,0,1*c,!1);a.lineTo(1*b,0);a.moveTo(0,0);a.lineTo(1*b,1*c);b=a.o;v.s(a);return b},AsteriskLine:function(a,b,c){a=v.q();var d=.2/Math.SQRT2;M(a,d*b,(1-d)*c,!1);a.lineTo((1-d)*b,d*c);a.moveTo(d*b,d*c);a.lineTo((1-d)*b,(1-d)*c);a.moveTo(0*b,.5*c);a.lineTo(1*b,.5*c);a.moveTo(.5*b,0*c);a.lineTo(.5*b,1*c);b=a.o;v.s(a);return b},CircleLine:function(a,b,c){var d=.5*K.za;a=v.q();M(a,1*b,.5*c,!1);O(a,1*b,(.5+d)*c,(.5+d)*b,1*c,.5*b,1*c);O(a,(.5-d)*b,1*c,0,(.5+d)*c,0,.5*c);O(a,0,(.5-d)*c,(.5-d)*b,0,.5*b,0);
O(a,(.5+d)*b,0,1*b,(.5-d)*c,1*b,.5*c);b=a.o;b.A=new L(.146,.146);b.B=new L(.853,.853);b.Hd=vh;v.s(a);return b},Pie:function(a,b,c){a=v.q();var d=4*(Math.SQRT2-1)/3*.5;M(a,(.5*Math.SQRT2/2+.5)*b,(.5-.5*Math.SQRT2/2)*c,!0);O(a,.7*b,0*c,.5*b,0*c,.5*b,0*c);O(a,(.5-d+0)*b,0*c,0*b,(.5-d+0)*c,0*b,.5*c);O(a,0*b,(.5+d+0)*c,(.5-d+0)*b,1*c,.5*b,1*c);O(a,(.5+d+0)*b,1*c,1*b,(.5+d+0)*c,1*b,.5*c);a.lineTo(.5*b,.5*c);P(a);b=a.o;v.s(a);return b},PiePiece:function(a,b,c){var d=K.za/Math.SQRT2*.5,e=Math.SQRT2/2,f=1-
Math.SQRT2/2;a=v.q();M(a,b,c,!0);O(a,b,(1-d)*c,(e+d)*b,(f+d)*c,e*b,f*c);a.lineTo(0,c);P(a);b=a.o;v.s(a);return b},StopSign:function(a,b,c){a=1/(Math.SQRT2+2);var d=v.q();M(d,a*b,0,!0);d.lineTo((1-a)*b,0);d.lineTo(1*b,a*c);d.lineTo(1*b,(1-a)*c);d.lineTo((1-a)*b,1*c);d.lineTo(a*b,1*c);d.lineTo(0,(1-a)*c);d.lineTo(0,a*c);P(d);b=d.o;b.A=new L(a/2,a/2);b.B=new L(1-a/2,1-a/2);v.s(d);return b},LogicImplies:function(a,b,c){var d=a?a.vc:NaN;isNaN(d)&&(d=.2);a=v.q();M(a,(1-d)*b,0*c,!1);a.lineTo(1*b,.5*c);a.lineTo((1-
d)*b,c);a.moveTo(0,.5*c);a.lineTo(b,.5*c);b=a.o;b.A=zb;b.B=new L(.8,.5);v.s(a);return b},LogicIff:function(a,b,c){var d=a?a.vc:NaN;isNaN(d)&&(d=.2);a=v.q();M(a,(1-d)*b,0*c,!1);a.lineTo(1*b,.5*c);a.lineTo((1-d)*b,c);a.moveTo(0,.5*c);a.lineTo(b,.5*c);a.moveTo(d*b,0);a.lineTo(0,.5*c);a.lineTo(d*b,c);b=a.o;b.A=new L(.2,0);b.B=new L(.8,.5);v.s(a);return b},LogicNot:function(a,b,c){a=v.q();M(a,0,0,!1);a.lineTo(1*b,0);a.lineTo(1*b,1*c);b=a.o;v.s(a);return b},LogicAnd:function(a,b,c){a=v.q();M(a,0,1*c,!1);
a.lineTo(.5*b,0);a.lineTo(1*b,1*c);b=a.o;b.A=new L(.25,.5);b.B=new L(.75,1);v.s(a);return b},LogicOr:function(a,b,c){a=v.q();M(a,0,0,!1);a.lineTo(.5*b,1*c);a.lineTo(1*b,0);b=a.o;b.A=new L(.219,0);b.B=new L(.78,.409);v.s(a);return b},LogicXor:function(a,b,c){a=v.q();M(a,.5*b,0,!1);a.lineTo(.5*b,1*c);a.moveTo(0,.5*c);a.lineTo(1*b,.5*c);var d=.5*K.za;O(a,1*b,(.5+d)*c,(.5+d)*b,1*c,.5*b,1*c);O(a,(.5-d)*b,1*c,0,(.5+d)*c,0,.5*c);O(a,0,(.5-d)*c,(.5-d)*b,0,.5*b,0);O(a,(.5+d)*b,0,1*b,(.5-d)*c,1*b,.5*c);b=a.o;
b.Hd=vh;v.s(a);return b},LogicTruth:function(a,b,c){a=v.q();M(a,0,0,!1);a.lineTo(1*b,0);a.moveTo(.5*b,0);a.lineTo(.5*b,1*c);b=a.o;v.s(a);return b},LogicFalsity:function(a,b,c){a=v.q();M(a,0,1*c,!1);a.lineTo(1*b,1*c);a.moveTo(.5*b,1*c);a.lineTo(.5*b,0);b=a.o;v.s(a);return b},LogicThereExists:function(a,b,c){a=v.q();M(a,0,0,!1);a.lineTo(1*b,0);a.lineTo(1*b,.5*c);a.lineTo(0,.5*c);a.moveTo(1*b,.5*c);a.lineTo(1*b,1*c);a.lineTo(0,1*c);b=a.o;v.s(a);return b},LogicForAll:function(a,b,c){a=v.q();M(a,0,0,!1);
a.lineTo(.5*b,1*c);a.lineTo(1*b,0);a.moveTo(.25*b,.5*c);a.lineTo(.75*b,.5*c);b=a.o;b.A=new L(.25,0);b.B=new L(.75,.5);v.s(a);return b},LogicIsDefinedAs:function(a,b,c){a=v.q();M(a,0,0,!1);a.lineTo(b,0);a.moveTo(0,.5*c);a.lineTo(b,.5*c);a.moveTo(0,c);a.lineTo(b,c);b=a.o;b.A=new L(.01,.01);b.B=new L(.99,.49);v.s(a);return b},LogicIntersect:function(a,b,c){var d=.5*K.za;a=v.q();M(a,0,1*c,!1);a.lineTo(0,.5*c);O(a,0,(.5-d)*c,(.5-d)*b,0,.5*b,0);O(a,(.5+d)*b,0,1*b,(.5-d)*c,1*b,.5*c);a.lineTo(1*b,1*c);b=
a.o;b.A=new L(0,.5);b.B=Vb;v.s(a);return b},LogicUnion:function(a,b,c){var d=.5*K.za;a=v.q();M(a,1*b,0,!1);a.lineTo(1*b,.5*c);O(a,1*b,(.5+d)*c,(.5+d)*b,1*c,.5*b,1*c);O(a,(.5-d)*b,1*c,0,(.5+d)*c,0,.5*c);a.lineTo(0,0);b=a.o;b.A=zb;b.B=new L(1,.5);v.s(a);return b},Arrow:function(a,b,c){var d=a?a.vc:NaN,e=a?a.Gt:NaN;isNaN(d)&&(d=.3);isNaN(e)&&(e=.3);a=v.q();M(a,0,(.5-e/2)*c,!0);a.lineTo((1-d)*b,(.5-e/2)*c);a.lineTo((1-d)*b,0);a.lineTo(1*b,.5*c);a.lineTo((1-d)*b,1*c);a.lineTo((1-d)*b,(.5+e/2)*c);a.lineTo(0,
(.5+e/2)*c);P(a);b=a.o;b.A=new L(0,.5-e/2);d=K.ll(0,.5+e/2,1,.5+e/2,1-d,1,1,.5,v.M());b.B=new L(d.x,d.y);v.v(d);v.s(a);return b},ISOProcess:"Chevron",Chevron:function(a,b,c){a=v.q();M(a,0,0,!0);a.lineTo(.5*b,0);a.lineTo(1*b,.5*c);a.lineTo(.5*b,1*c);a.lineTo(0,1*c);a.lineTo(.5*b,.5*c);P(a);b=a.o;v.s(a);return b},DoubleArrow:function(a,b,c){a=v.q();M(a,0,0,!0);a.lineTo(.3*b,.214*c);a.lineTo(.3*b,0);a.lineTo(1*b,.5*c);a.lineTo(.3*b,1*c);a.lineTo(.3*b,.786*c);a.lineTo(0,1*c);P(a);M(a,.3*b,.214*c,!1);
a.lineTo(.3*b,.786*c);a.Ya(!1);b=a.o;v.s(a);return b},DoubleEndArrow:function(a,b,c){a=v.q();M(a,1*b,.5*c,!0);a.lineTo(.7*b,1*c);a.lineTo(.7*b,.7*c);a.lineTo(.3*b,.7*c);a.lineTo(.3*b,1*c);a.lineTo(0,.5*c);a.lineTo(.3*b,0);a.lineTo(.3*b,.3*c);a.lineTo(.7*b,.3*c);a.lineTo(.7*b,0);P(a);b=a.o;c=K.ll(0,.5,.3,0,0,.3,.3,.3,v.M());b.A=new L(c.x,c.y);c=K.ll(.7,1,1,.5,.7,.7,1,.7,c);b.B=new L(c.x,c.y);v.v(c);v.s(a);return b},IBeamArrow:function(a,b,c){a=v.q();M(a,1*b,.5*c,!0);a.lineTo(.7*b,1*c);a.lineTo(.7*
b,.7*c);a.lineTo(.2*b,.7*c);a.lineTo(.2*b,1*c);a.lineTo(0,1*c);a.lineTo(0,0);a.lineTo(.2*b,0);a.lineTo(.2*b,.3*c);a.lineTo(.7*b,.3*c);a.lineTo(.7*b,0);P(a);b=a.o;b.A=new L(0,.3);c=K.ll(.7,1,1,.5,.7,.7,1,.7,v.M());b.B=new L(c.x,c.y);v.v(c);v.s(a);return b},Pointer:function(a,b,c){a=v.q();M(a,1*b,.5*c,!0);a.lineTo(0,1*c);a.lineTo(.2*b,.5*c);a.lineTo(0,0);P(a);b=a.o;b.A=new L(.2,.35);c=K.ll(.2,.65,1,.65,0,1,1,.5,v.M());b.B=new L(c.x,c.y);v.v(c);v.s(a);return b},RoundedPointer:function(a,b,c){a=v.q();
M(a,1*b,.5*c,!0);a.lineTo(0,1*c);O(a,.5*b,.75*c,.5*b,.25*c,0,0);P(a);b=a.o;b.A=new L(.4,.35);c=K.ll(.2,.65,1,.65,0,1,1,.5,v.M());b.B=new L(c.x,c.y);v.v(c);v.s(a);return b},SplitEndArrow:function(a,b,c){a=v.q();M(a,1*b,.5*c,!0);a.lineTo(.7*b,1*c);a.lineTo(.7*b,.7*c);a.lineTo(0,.7*c);a.lineTo(.2*b,.5*c);a.lineTo(0,.3*c);a.lineTo(.7*b,.3*c);a.lineTo(.7*b,0);P(a);b=a.o;b.A=new L(.2,.3);c=K.ll(.7,1,1,.5,.7,.7,1,.7,v.M());b.B=new L(c.x,c.y);v.v(c);v.s(a);return b},MessageToUser:"SquareArrow",SquareArrow:function(a,
b,c){a=v.q();M(a,1*b,.5*c,!0);a.lineTo(.7*b,1*c);a.lineTo(0,1*c);a.lineTo(0,0);a.lineTo(.7*b,0);P(a);b=a.o;b.A=zb;b.B=new L(.7,1);v.s(a);return b},Cone1:function(a,b,c){var d=K.za;a=.5*d;var e=.1*d,d=v.q();M(d,0,.9*c,!0);d.lineTo(.5*b,0);d.lineTo(1*b,.9*c);O(d,1*b,(.9+e)*c,(.5+a)*b,1*c,.5*b,1*c);O(d,(.5-a)*b,1*c,0,(.9+e)*c,0,.9*c);P(d);b=d.o;b.A=new L(.25,.5);b.B=new L(.75,.97);v.s(d);return b},Cone2:function(a,b,c){a=v.q();M(a,0,.9*c,!0);O(a,(1-.85/.9)*b,1*c,.85/.9*b,1*c,1*b,.9*c);a.lineTo(.5*b,
0);a.lineTo(0,.9*c);P(a);M(a,0,.9*c,!1);O(a,(1-.85/.9)*b,.8*c,.85/.9*b,.8*c,1*b,.9*c);a.Ya(!1);b=a.o;b.A=new L(.25,.5);b.B=new L(.75,.82);v.s(a);return b},Cube1:function(a,b,c){a=v.q();M(a,.5*b,1*c,!0);a.lineTo(1*b,.85*c);a.lineTo(1*b,.15*c);a.lineTo(.5*b,0*c);a.lineTo(0*b,.15*c);a.lineTo(0*b,.85*c);P(a);M(a,.5*b,1*c,!1);a.lineTo(.5*b,.3*c);a.lineTo(0,.15*c);a.moveTo(.5*b,.3*c);a.lineTo(1*b,.15*c);a.Ya(!1);b=a.o;b.A=new L(0,.3);b.B=new L(.5,.85);v.s(a);return b},Cube2:function(a,b,c){a=v.q();M(a,
0,.3*c,!0);a.lineTo(0*b,1*c);a.lineTo(.7*b,c);a.lineTo(1*b,.7*c);a.lineTo(1*b,0*c);a.lineTo(.3*b,0*c);P(a);M(a,0,.3*c,!1);a.lineTo(.7*b,.3*c);a.lineTo(1*b,0*c);a.moveTo(.7*b,.3*c);a.lineTo(.7*b,1*c);a.Ya(!1);b=a.o;b.A=new L(0,.3);b.B=new L(.7,1);v.s(a);return b},MagneticData:"Cylinder1",Cylinder1:function(a,b,c){var d=K.za;a=.5*d;var e=.1*d,d=v.q();M(d,0,.1*c,!0);O(d,0,(.1-e)*c,(.5-a)*b,0,.5*b,0);O(d,(.5+a)*b,0,1*b,(.1-e)*c,1*b,.1*c);d.lineTo(b,.9*c);O(d,1*b,(.9+e)*c,(.5+a)*b,1*c,.5*b,1*c);O(d,(.5-
a)*b,1*c,0,(.9+e)*c,0,.9*c);d.lineTo(0,.1*c);M(d,0,.1*c,!1);O(d,0,(.1+e)*c,(.5-a)*b,.2*c,.5*b,.2*c);O(d,(.5+a)*b,.2*c,1*b,(.1+e)*c,1*b,.1*c);d.Ya(!1);b=d.o;b.A=new L(0,.2);b.B=new L(1,.9);v.s(d);return b},Cylinder2:function(a,b,c){var d=K.za;a=.5*d;var e=.1*d,d=v.q();M(d,0,.9*c,!0);d.lineTo(0,.1*c);O(d,0,(.1-e)*c,(.5-a)*b,0,.5*b,0);O(d,(.5+a)*b,0,1*b,(.1-e)*c,1*b,.1*c);d.lineTo(1*b,.9*c);O(d,1*b,(.9+e)*c,(.5+a)*b,1*c,.5*b,1*c);O(d,(.5-a)*b,1*c,0,(.9+e)*c,0,.9*c);M(d,0,.9*c,!1);O(d,0,(.9-e)*c,(.5-
a)*b,.8*c,.5*b,.8*c);O(d,(.5+a)*b,.8*c,1*b,(.9-e)*c,1*b,.9*c);d.Ya(!1);b=d.o;b.A=new L(0,.1);b.B=new L(1,.8);v.s(d);return b},Cylinder3:function(a,b,c){var d=K.za;a=.1*d;var e=.5*d,d=v.q();M(d,.1*b,0,!0);d.lineTo(.9*b,0);O(d,(.9+a)*b,0,1*b,(.5-e)*c,1*b,.5*c);O(d,1*b,(.5+e)*c,(.9+a)*b,1*c,.9*b,1*c);d.lineTo(.1*b,1*c);O(d,(.1-a)*b,1*c,0,(.5+e)*c,0,.5*c);O(d,0,(.5-e)*c,(.1-a)*b,0,.1*b,0);M(d,.1*b,0,!1);O(d,(.1+a)*b,0,.2*b,(.5-e)*c,.2*b,.5*c);O(d,.2*b,(.5+e)*c,(.1+a)*b,1*c,.1*b,1*c);d.Ya(!1);b=d.o;b.A=
new L(.2,0);b.B=new L(.9,1);v.s(d);return b},DirectData:"Cylinder4",Cylinder4:function(a,b,c){var d=K.za;a=.1*d;var e=.5*d,d=v.q();M(d,.9*b,0,!0);O(d,(.9+a)*b,0,1*b,(.5-e)*c,1*b,.5*c);O(d,1*b,(.5+e)*c,(.9+a)*b,1*c,.9*b,1*c);d.lineTo(.1*b,1*c);O(d,(.1-a)*b,1*c,0,(.5+e)*c,0,.5*c);O(d,0,(.5-e)*c,(.1-a)*b,0,.1*b,0);d.lineTo(.9*b,0);M(d,.9*b,0,!1);O(d,(.9-a)*b,0,.8*b,(.5-e)*c,.8*b,.5*c);O(d,.8*b,(.5+e)*c,(.9-a)*b,1*c,.9*b,1*c);d.Ya(!1);b=d.o;b.A=new L(.1,0);b.B=new L(.8,1);v.s(d);return b},Prism1:function(a,
b,c){a=v.q();M(a,.25*b,.25*c,!0);a.lineTo(.75*b,0);a.lineTo(b,.5*c);a.lineTo(.5*b,c);a.lineTo(0,c);P(a);M(a,.25*b,.25*c,!1);a.lineTo(.5*b,c);a.Ya(!1);b=a.o;b.A=new L(.408,.172);b.B=new L(.833,.662);v.s(a);return b},Prism2:function(a,b,c){a=v.q();M(a,0,.25*c,!0);a.lineTo(.75*b,0);a.lineTo(1*b,.25*c);a.lineTo(.75*b,.75*c);a.lineTo(0,1*c);P(a);M(a,0,c,!1);a.lineTo(.25*b,.5*c);a.lineTo(b,.25*c);a.moveTo(0,.25*c);a.lineTo(.25*b,.5*c);a.Ya(!1);b=a.o;b.A=new L(.25,.5);b.B=new L(.75,.75);v.s(a);return b},
Pyramid1:function(a,b,c){a=v.q();M(a,.5*b,0,!0);a.lineTo(b,.75*c);a.lineTo(.5*b,1*c);a.lineTo(0,.75*c);P(a);M(a,.5*b,0,!1);a.lineTo(.5*b,1*c);a.Ya(!1);b=a.o;b.A=new L(.25,.367);b.B=new L(.75,.875);v.s(a);return b},Pyramid2:function(a,b,c){a=v.q();M(a,.5*b,0,!0);a.lineTo(b,.85*c);a.lineTo(.5*b,1*c);a.lineTo(0,.85*c);P(a);M(a,.5*b,0,!1);a.lineTo(.5*b,.7*c);a.lineTo(0,.85*c);a.moveTo(.5*b,.7*c);a.lineTo(1*b,.85*c);a.Ya(!1);b=a.o;b.A=new L(.25,.367);b.B=new L(.75,.875);v.s(a);return b},Actor:function(a,
b,c){var d=K.za,e=.2*d,f=.1*d,h=.5,k=.1;a=v.q();M(a,h*b,(k+.1)*c,!0);O(a,(h-e)*b,(k+.1)*c,(h-.2)*b,(k+f)*c,(h-.2)*b,k*c);O(a,(h-.2)*b,(k-f)*c,(h-e)*b,(k-.1)*c,h*b,(k-.1)*c);O(a,(h+e)*b,(k-.1)*c,(h+.2)*b,(k-f)*c,(h+.2)*b,k*c);O(a,(h+.2)*b,(k+f)*c,(h+e)*b,(k+.1)*c,h*b,(k+.1)*c);e=.05;f=d*e;M(a,.5*b,.2*c,!0);a.lineTo(.95*b,.2*c);h=.95;k=.25;O(a,(h+f)*b,(k-e)*c,(h+e)*b,(k-f)*c,(h+e)*b,k*c);a.lineTo(1*b,.6*c);a.lineTo(.85*b,.6*c);a.lineTo(.85*b,.35*c);e=.025;f=d*e;h=.825;k=.35;O(a,(h+e)*b,(k-f)*c,(h+f)*
b,(k-e)*c,h*b,(k-e)*c);O(a,(h-f)*b,(k-e)*c,(h-e)*b,(k-f)*c,(h-e)*b,k*c);a.lineTo(.8*b,1*c);a.lineTo(.55*b,1*c);a.lineTo(.55*b,.7*c);e=.05;f=d*e;h=.5;k=.7;O(a,(h+e)*b,(k-f)*c,(h+f)*b,(k-e)*c,h*b,(k-e)*c);O(a,(h-f)*b,(k-e)*c,(h-e)*b,(k-f)*c,(h-e)*b,k*c);a.lineTo(.45*b,1*c);a.lineTo(.2*b,1*c);a.lineTo(.2*b,.35*c);e=.025;f=d*e;h=.175;k=.35;O(a,(h+e)*b,(k-f)*c,(h+f)*b,(k-e)*c,h*b,(k-e)*c);O(a,(h-f)*b,(k-e)*c,(h-e)*b,(k-f)*c,(h-e)*b,k*c);a.lineTo(.15*b,.6*c);a.lineTo(0*b,.6*c);a.lineTo(0*b,.25*c);e=.05;
f=d*e;h=.05;k=.25;O(a,(h-e)*b,(k-f)*c,(h-f)*b,(k-e)*c,h*b,(k-e)*c);a.lineTo(.5*b,.2*c);b=a.o;b.A=new L(.2,.2);b.B=new L(.8,.65);v.s(a);return b},Card:function(a,b,c){a=v.q();M(a,1*b,0*c,!0);a.lineTo(1*b,1*c);a.lineTo(0*b,1*c);a.lineTo(0*b,.2*c);a.lineTo(.2*b,0*c);P(a);b=a.o;b.A=new L(0,.2);b.B=Vb;v.s(a);return b},Collate:function(a,b,c){a=v.q();M(a,.5*b,.5*c,!0);a.lineTo(0,0);a.lineTo(1*b,0);a.lineTo(.5*b,.5*c);M(a,.5*b,.5*c,!0);a.lineTo(1*b,1*c);a.lineTo(0,1*c);a.lineTo(.5*b,.5*c);b=a.o;b.A=new L(.25,
0);b.B=new L(.75,.25);v.s(a);return b},CreateRequest:function(a,b,c){a=a?a.vc:NaN;isNaN(a)&&(a=.1);var d=v.q();M(d,0,0,!0);d.lineTo(1*b,0);d.lineTo(1*b,1*c);d.lineTo(0,1*c);P(d);M(d,0,a*c,!1);d.lineTo(1*b,a*c);d.moveTo(0,(1-a)*c);d.lineTo(1*b,(1-a)*c);d.Ya(!1);b=d.o;b.A=new L(0,a);b.B=new L(1,1-a);v.s(d);return b},Database:function(a,b,c){a=v.q();var d=K.za,e=.5*d,d=.1*d;M(a,1*b,.1*c,!0);a.lineTo(1*b,.9*c);O(a,1*b,(.9+d)*c,(.5+e)*b,1*c,.5*b,1*c);O(a,(.5-e)*b,1*c,0,(.9+d)*c,0,.9*c);a.lineTo(0,.1*c);
O(a,0,(.1-d)*c,(.5-e)*b,0,.5*b,0);O(a,(.5+e)*b,0,1*b,(.1-d)*c,1*b,.1*c);M(a,1*b,.1*c,!1);O(a,1*b,(.1+d)*c,(.5+e)*b,.2*c,.5*b,.2*c);O(a,(.5-e)*b,.2*c,0,(.1+d)*c,0,.1*c);a.moveTo(1*b,.2*c);O(a,1*b,(.2+d)*c,(.5+e)*b,.3*c,.5*b,.3*c);O(a,(.5-e)*b,.3*c,0,(.2+d)*c,0,.2*c);a.moveTo(1*b,.3*c);O(a,1*b,(.3+d)*c,(.5+e)*b,.4*c,.5*b,.4*c);O(a,(.5-e)*b,.4*c,0,(.3+d)*c,0,.3*c);a.Ya(!1);b=a.o;b.A=new L(0,.4);b.B=new L(1,.9);v.s(a);return b},StoredData:"DataStorage",DataStorage:function(a,b,c){a=v.q();M(a,0,0,!0);
a.lineTo(.75*b,0);O(a,1*b,0,1*b,1*c,.75*b,1*c);a.lineTo(0,1*c);O(a,.25*b,.9*c,.25*b,.1*c,0,0);P(a);b=a.o;b.A=new L(.226,0);b.B=new L(.81,1);v.s(a);return b},DiskStorage:function(a,b,c){a=v.q();var d=K.za,e=.5*d,d=.1*d;M(a,1*b,.1*c,!0);a.lineTo(1*b,.9*c);O(a,1*b,(.9+d)*c,(.5+e)*b,1*c,.5*b,1*c);O(a,(.5-e)*b,1*c,0,(.9+d)*c,0,.9*c);a.lineTo(0,.1*c);O(a,0,(.1-d)*c,(.5-e)*b,0,.5*b,0);O(a,(.5+e)*b,0,1*b,(.1-d)*c,1*b,.1*c);M(a,1*b,.1*c,!1);O(a,1*b,(.1+d)*c,(.5+e)*b,.2*c,.5*b,.2*c);O(a,(.5-e)*b,.2*c,0,(.1+
d)*c,0,.1*c);a.moveTo(1*b,.2*c);O(a,1*b,(.2+d)*c,(.5+e)*b,.3*c,.5*b,.3*c);O(a,(.5-e)*b,.3*c,0,(.2+d)*c,0,.2*c);a.Ya(!1);b=a.o;b.A=new L(0,.3);b.B=new L(1,.9);v.s(a);return b},Display:function(a,b,c){a=v.q();M(a,.25*b,0,!0);a.lineTo(.75*b,0);O(a,1*b,0,1*b,1*c,.75*b,1*c);a.lineTo(.25*b,1*c);a.lineTo(0,.5*c);P(a);b=a.o;b.A=new L(.25,0);b.B=new L(.75,1);v.s(a);return b},DividedEvent:function(a,b,c){a=a?a.vc:NaN;isNaN(a)?a=.2:.15>a&&(a=.15);var d=v.q(),e=.2*K.za;M(d,0,.2*c,!0);O(d,0,(.2-e)*c,(.2-e)*b,
0,.2*b,0);d.lineTo(.8*b,0);O(d,(.8+e)*b,0,1*b,(.2-e)*c,1*b,.2*c);d.lineTo(1*b,.8*c);O(d,1*b,(.8+e)*c,(.8+e)*b,1*c,.8*b,1*c);d.lineTo(.2*b,1*c);O(d,(.2-e)*b,1*c,0,(.8+e)*c,0,.8*c);d.lineTo(0,.2*c);M(d,0,a*c,!1);d.lineTo(1*b,a*c);d.Ya(!1);b=d.o;b.A=new L(0,a);b.B=new L(1,1-a);v.s(d);return b},DividedProcess:function(a,b,c){a=a?a.vc:NaN;if(isNaN(a)||.1>a)a=.1;var d=v.q();M(d,0,0,!0);d.lineTo(1*b,0);d.lineTo(1*b,1*c);d.lineTo(0,1*c);P(d);M(d,0,a*c,!1);d.lineTo(1*b,a*c);d.Ya(!1);b=d.o;b.A=new L(0,a);b.B=
Vb;v.s(d);return b},Document:function(a,b,c){c/=.8;a=v.q();M(a,0,.7*c,!0);a.lineTo(0,0);a.lineTo(1*b,0);a.lineTo(1*b,.7*c);O(a,.5*b,.4*c,.5*b,1*c,0,.7*c);P(a);b=a.o;b.A=zb;b.B=new L(1,.6);v.s(a);return b},ExternalOrganization:function(a,b,c){a=a?a.vc:NaN;if(isNaN(a)||.2>a)a=.2;var d=v.q();M(d,0,0,!0);d.lineTo(1*b,0);d.lineTo(1*b,1*c);d.lineTo(0,1*c);P(d);M(d,a*b,0,!1);d.lineTo(0,a*c);d.moveTo(1*b,a*c);d.lineTo((1-a)*b,0);d.moveTo(0,(1-a)*c);d.lineTo(a*b,1*c);d.moveTo((1-a)*b,1*c);d.lineTo(1*b,(1-
a)*c);d.Ya(!1);b=d.o;b.A=new L(a/2,a/2);b.B=new L(1-a/2,1-a/2);v.s(d);return b},ExternalProcess:function(a,b,c){a=v.q();M(a,.5*b,0,!0);a.lineTo(1*b,.5*c);a.lineTo(.5*b,1*c);a.lineTo(0,.5*c);P(a);M(a,.1*b,.4*c,!1);a.lineTo(.1*b,.6*c);a.moveTo(.9*b,.6*c);a.lineTo(.9*b,.4*c);a.moveTo(.6*b,.1*c);a.lineTo(.4*b,.1*c);a.moveTo(.4*b,.9*c);a.lineTo(.6*b,.9*c);a.Ya(!1);b=a.o;b.A=new L(.25,.25);b.B=new L(.75,.75);v.s(a);return b},File:function(a,b,c){a=v.q();M(a,0,0,!0);a.lineTo(.75*b,0);a.lineTo(1*b,.25*c);
a.lineTo(1*b,1*c);a.lineTo(0,1*c);P(a);M(a,.75*b,0,!1);a.lineTo(.75*b,.25*c);a.lineTo(1*b,.25*c);a.Ya(!1);b=a.o;b.A=new L(0,.25);b.B=Vb;v.s(a);return b},Interrupt:function(a,b,c){a=v.q();M(a,1*b,.5*c,!0);a.lineTo(0,1*c);a.lineTo(0,0);a.lineTo(1*b,.5*c);M(a,1*b,.5*c,!1);a.lineTo(1*b,1*c);M(a,1*b,.5*c,!1);a.lineTo(1*b,0);b=a.o;b.A=new L(0,.25);b.B=new L(.5,.75);v.s(a);return b},InternalStorage:function(a,b,c){var d=a?a.vc:NaN;a=a?a.Gt:NaN;isNaN(d)&&(d=.1);isNaN(a)&&(a=.1);var e=v.q();M(e,0,0,!0);e.lineTo(1*
b,0);e.lineTo(1*b,1*c);e.lineTo(0,1*c);P(e);M(e,d*b,0,!1);e.lineTo(d*b,1*c);e.moveTo(0,a*c);e.lineTo(1*b,a*c);e.Ya(!1);b=e.o;b.A=new L(d,a);b.B=Vb;v.s(e);return b},Junction:function(a,b,c){a=v.q();var d=1/Math.SQRT2,e=(1-1/Math.SQRT2)/2,f=.5*K.za;M(a,1*b,.5*c,!0);O(a,1*b,(.5+f)*c,(.5+f)*b,1*c,.5*b,1*c);O(a,(.5-f)*b,1*c,0,(.5+f)*c,0,.5*c);O(a,0,(.5-f)*c,(.5-f)*b,0,.5*b,0);O(a,(.5+f)*b,0,1*b,(.5-f)*c,1*b,.5*c);M(a,(e+d)*b,(e+d)*c,!1);a.lineTo(e*b,e*c);a.moveTo(e*b,(e+d)*c);a.lineTo((e+d)*b,e*c);a.Ya(!1);
b=a.o;b.Hd=vh;v.s(a);return b},LinedDocument:function(a,b,c){c/=.8;a=v.q();M(a,0,.7*c,!0);a.lineTo(0,0);a.lineTo(1*b,0);a.lineTo(1*b,.7*c);O(a,.5*b,.4*c,.5*b,1*c,0,.7*c);P(a);M(a,.1*b,0,!1);a.lineTo(.1*b,.75*c);a.Ya(!1);b=a.o;b.A=new L(.1,0);b.B=new L(1,.6);v.s(a);return b},LoopLimit:function(a,b,c){a=v.q();M(a,0,1*c,!0);a.lineTo(0,.25*c);a.lineTo(.25*b,0);a.lineTo(.75*b,0);a.lineTo(1*b,.25*c);a.lineTo(1*b,1*c);P(a);b=a.o;b.A=new L(0,.25);b.B=Vb;v.s(a);return b},SequentialData:"MagneticTape",MagneticTape:function(a,
b,c){a=v.q();var d=.5*K.za;M(a,.5*b,1*c,!0);O(a,(.5-d)*b,1*c,0,(.5+d)*c,0,.5*c);O(a,0,(.5-d)*c,(.5-d)*b,0,.5*b,0);O(a,(.5+d)*b,0,1*b,(.5-d)*c,1*b,.5*c);O(a,1*b,(.5+d)*c,(.5+d)*b,.9*c,.6*b,.9*c);a.lineTo(1*b,.9*c);a.lineTo(1*b,1*c);a.lineTo(.5*b,1*c);b=a.o;b.A=new L(.15,.15);b.B=new L(.85,.8);v.s(a);return b},ManualInput:function(a,b,c){a=v.q();M(a,1*b,0,!0);a.lineTo(1*b,1*c);a.lineTo(0,1*c);a.lineTo(0,.25*c);P(a);b=a.o;b.A=new L(0,.25);b.B=Vb;v.s(a);return b},MessageFromUser:function(a,b,c){a=a?a.vc:
NaN;isNaN(a)&&(a=.7);var d=v.q();M(d,0,0,!0);d.lineTo(1*b,0);d.lineTo(a*b,.5*c);d.lineTo(1*b,1*c);d.lineTo(0,1*c);P(d);b=d.o;b.A=zb;b.B=new L(a,1);v.s(d);return b},MicroformProcessing:function(a,b,c){a=a?a.vc:NaN;isNaN(a)&&(a=.25);var d=v.q();M(d,0,0,!0);d.lineTo(.5*b,a*c);d.lineTo(1*b,0);d.lineTo(1*b,1*c);d.lineTo(.5*b,(1-a)*c);d.lineTo(0,1*c);P(d);b=d.o;b.A=new L(0,a);b.B=new L(1,1-a);v.s(d);return b},MicroformRecording:function(a,b,c){a=v.q();M(a,0,0,!0);a.lineTo(.75*b,.25*c);a.lineTo(1*b,.15*
c);a.lineTo(1*b,.85*c);a.lineTo(.75*b,.75*c);a.lineTo(0,1*c);P(a);b=a.o;b.A=new L(0,.25);b.B=new L(1,.75);v.s(a);return b},MultiDocument:function(a,b,c){c/=.8;a=v.q();M(a,b,0,!0);a.lineTo(b,.5*c);O(a,.96*b,.47*c,.93*b,.45*c,.9*b,.44*c);a.lineTo(.9*b,.6*c);O(a,.86*b,.57*c,.83*b,.55*c,.8*b,.54*c);a.lineTo(.8*b,.7*c);O(a,.4*b,.4*c,.4*b,1*c,0,.7*c);a.lineTo(0,.2*c);a.lineTo(.1*b,.2*c);a.lineTo(.1*b,.1*c);a.lineTo(.2*b,.1*c);a.lineTo(.2*b,0);P(a);M(a,.1*b,.2*c,!1);a.lineTo(.8*b,.2*c);a.lineTo(.8*b,.54*
c);a.moveTo(.2*b,.1*c);a.lineTo(.9*b,.1*c);a.lineTo(.9*b,.44*c);a.Ya(!1);b=a.o;b.A=new L(0,.25);b.B=new L(.8,.77);v.s(a);return b},MultiProcess:function(a,b,c){a=v.q();M(a,.1*b,.1*c,!0);a.lineTo(.2*b,.1*c);a.lineTo(.2*b,0);a.lineTo(1*b,0);a.lineTo(1*b,.8*c);a.lineTo(.9*b,.8*c);a.lineTo(.9*b,.9*c);a.lineTo(.8*b,.9*c);a.lineTo(.8*b,1*c);a.lineTo(0,1*c);a.lineTo(0,.2*c);a.lineTo(.1*b,.2*c);P(a);M(a,.2*b,.1*c,!1);a.lineTo(.9*b,.1*c);a.lineTo(.9*b,.8*c);a.moveTo(.1*b,.2*c);a.lineTo(.8*b,.2*c);a.lineTo(.8*
b,.9*c);a.Ya(!1);b=a.o;b.A=new L(0,.2);b.B=new L(.8,1);v.s(a);return b},OfflineStorage:function(a,b,c){a=a?a.vc:NaN;isNaN(a)&&(a=.1);var d=1-a,e=v.q();M(e,0,0,!0);e.lineTo(1*b,0);e.lineTo(.5*b,1*c);P(e);M(e,.5*a*b,a*c,!1);e.lineTo((1-.5*a)*b,a*c);e.Ya(!1);b=e.o;b.A=new L(d/4+.5*a,a);b.B=new L(3*d/4+.5*a,a+.5*d);v.s(e);return b},OffPageConnector:function(a,b,c){a=v.q();M(a,0,0,!0);a.lineTo(.75*b,0);a.lineTo(1*b,.5*c);a.lineTo(.75*b,1*c);a.lineTo(0,1*c);P(a);b=a.o;b.A=zb;b.B=new L(.75,1);v.s(a);return b},
Or:function(a,b,c){a=v.q();var d=.5*K.za;M(a,1*b,.5*c,!0);O(a,1*b,(.5+d)*c,(.5+d)*b,1*c,.5*b,1*c);O(a,(.5-d)*b,1*c,0,(.5+d)*c,0,.5*c);O(a,0,(.5-d)*c,(.5-d)*b,0,.5*b,0);O(a,(.5+d)*b,0,1*b,(.5-d)*c,1*b,.5*c);M(a,1*b,.5*c,!1);a.lineTo(0,.5*c);a.moveTo(.5*b,1*c);a.lineTo(.5*b,0);a.Ya(!1);b=a.o;b.Hd=vh;v.s(a);return b},PaperTape:function(a,b,c){c/=.8;a=v.q();M(a,0,.7*c,!0);a.lineTo(0,.3*c);O(a,.5*b,.6*c,.5*b,0,1*b,.3*c);a.lineTo(1*b,.7*c);O(a,.5*b,.4*c,.5*b,1*c,0,.7*c);P(a);b=a.o;b.A=new L(0,.49);b.B=
new L(1,.75);v.s(a);return b},PrimitiveFromCall:function(a,b,c){var d=a?a.vc:NaN;a=a?a.Gt:NaN;isNaN(d)&&(d=.1);isNaN(a)&&(a=.3);var e=v.q();M(e,0,0,!0);e.lineTo(1*b,0);e.lineTo((1-a)*b,.5*c);e.lineTo(1*b,1*c);e.lineTo(0,1*c);P(e);b=e.o;b.A=new L(d,0);b.B=new L(1-a,1);v.s(e);return b},PrimitiveToCall:function(a,b,c){var d=a?a.vc:NaN;a=a?a.Gt:NaN;isNaN(d)&&(d=.1);isNaN(a)&&(a=.3);var e=v.q();M(e,0,0,!0);e.lineTo((1-a)*b,0);e.lineTo(1*b,.5*c);e.lineTo((1-a)*b,1*c);e.lineTo(0,1*c);P(e);b=e.o;b.A=new L(d,
0);b.B=new L(1-a,1);v.s(e);return b},Subroutine:"Procedure",Procedure:function(a,b,c){a=a?a.vc:NaN;isNaN(a)&&(a=.1);var d=v.q();M(d,0,0,!0);d.lineTo(1*b,0);d.lineTo(1*b,1*c);d.lineTo(0,1*c);P(d);M(d,(1-a)*b,0,!1);d.lineTo((1-a)*b,1*c);d.moveTo(a*b,0);d.lineTo(a*b,1*c);d.Ya(!1);b=d.o;b.A=new L(a,0);b.B=new L(1-a,1);v.s(d);return b},Process:function(a,b,c){a=a?a.vc:NaN;isNaN(a)&&(a=.1);var d=v.q();M(d,0,0,!0);d.lineTo(1*b,0);d.lineTo(1*b,1*c);d.lineTo(0,1*c);P(d);M(d,a*b,0,!1);d.lineTo(a*b,1*c);d.Ya(!1);
b=d.o;b.A=new L(a,0);b.B=Vb;v.s(d);return b},Sort:function(a,b,c){a=v.q();M(a,.5*b,0,!0);a.lineTo(1*b,.5*c);a.lineTo(.5*b,1*c);a.lineTo(0,.5*c);P(a);M(a,0,.5*c,!1);a.lineTo(1*b,.5*c);a.Ya(!1);b=a.o;b.A=new L(.25,.25);b.B=new L(.75,.5);v.s(a);return b},Start:function(a,b,c){a=v.q();M(a,.25*b,0,!0);M(a,.25*b,0,!0);a.arcTo(270,180,.75*b,.5*c,.25*b,.5*c);a.arcTo(90,180,.25*b,.5*c,.25*b,.5*c);M(a,.25*b,0,!1);a.lineTo(.25*b,1*c);a.moveTo(.75*b,0);a.lineTo(.75*b,1*c);a.Ya(!1);b=a.o;b.A=new L(.25,0);b.B=
new L(.75,1);v.s(a);return b},Terminator:function(a,b,c){a=v.q();M(a,.25*b,0,!0);a.arcTo(270,180,.75*b,.5*c,.25*b,.5*c);a.arcTo(90,180,.25*b,.5*c,.25*b,.5*c);b=a.o;b.A=new L(.23,0);b.B=new L(.77,1);v.s(a);return b},TransmittalTape:function(a,b,c){a=a?a.vc:NaN;isNaN(a)&&(a=.1);var d=v.q();M(d,0,0,!0);d.lineTo(1*b,0);d.lineTo(1*b,1*c);d.lineTo(.75*b,(1-a)*c);d.lineTo(0,(1-a)*c);P(d);b=d.o;b.A=zb;b.B=new L(1,1-a);v.s(d);return b},AndGate:function(a,b,c){a=v.q();var d=.5*K.za;M(a,0,0,!0);a.lineTo(.5*
b,0);O(a,(.5+d)*b,0,1*b,(.5-d)*c,1*b,.5*c);O(a,1*b,(.5+d)*c,(.5+d)*b,1*c,.5*b,1*c);a.lineTo(0,1*c);P(a);b=a.o;b.A=zb;b.B=new L(.55,1);v.s(a);return b},Buffer:function(a,b,c){a=v.q();M(a,0,0,!0);a.lineTo(1*b,.5*c);a.lineTo(0,1*c);P(a);b=a.o;b.A=new L(0,.25);b.B=new L(.5,.75);v.s(a);return b},Clock:function(a,b,c){a=v.q();var d=.5*K.za;M(a,1*b,.5*c,!0);O(a,1*b,(.5+d)*c,(.5+d)*b,1*c,.5*b,1*c);O(a,(.5-d)*b,1*c,0,(.5+d)*c,0,.5*c);O(a,0,(.5-d)*c,(.5-d)*b,0,.5*b,0);O(a,(.5+d)*b,0,1*b,(.5-d)*c,1*b,.5*c);
M(a,1*b,.5*c,!1);a.lineTo(1*b,.5*c);M(a,.8*b,.75*c,!1);a.lineTo(.8*b,.25*c);a.lineTo(.6*b,.25*c);a.lineTo(.6*b,.75*c);a.lineTo(.4*b,.75*c);a.lineTo(.4*b,.25*c);a.lineTo(.2*b,.25*c);a.lineTo(.2*b,.75*c);a.Ya(!1);b=a.o;b.Hd=vh;v.s(a);return b},Ground:function(a,b,c){a=v.q();M(a,.5*b,0,!1);a.lineTo(.5*b,.4*c);a.moveTo(.2*b,.6*c);a.lineTo(.8*b,.6*c);a.moveTo(.3*b,.8*c);a.lineTo(.7*b,.8*c);a.moveTo(.4*b,1*c);a.lineTo(.6*b,1*c);b=a.o;v.s(a);return b},Inverter:function(a,b,c){a=v.q();var d=.1*K.za;M(a,.8*
b,.5*c,!0);a.lineTo(0,1*c);a.lineTo(0,0);a.lineTo(.8*b,.5*c);M(a,1*b,.5*c,!0);O(a,1*b,(.5+d)*c,(.9+d)*b,.6*c,.9*b,.6*c);O(a,(.9-d)*b,.6*c,.8*b,(.5+d)*c,.8*b,.5*c);O(a,.8*b,(.5-d)*c,(.9-d)*b,.4*c,.9*b,.4*c);O(a,(.9+d)*b,.4*c,1*b,(.5-d)*c,1*b,.5*c);b=a.o;b.A=new L(0,.25);b.B=new L(.4,.75);v.s(a);return b},NandGate:function(a,b,c){a=v.q();var d=K.za,e=.5*d,f=.4*d,d=.1*d;M(a,.8*b,.5*c,!0);O(a,.8*b,(.5+f)*c,(.4+e)*b,1*c,.4*b,1*c);a.lineTo(0,1*c);a.lineTo(0,0);a.lineTo(.4*b,0);O(a,(.4+e)*b,0,.8*b,(.5-f)*
c,.8*b,.5*c);M(a,1*b,.5*c,!0);O(a,1*b,(.5+d)*c,(.9+d)*b,.6*c,.9*b,.6*c);O(a,(.9-d)*b,.6*c,.8*b,(.5+d)*c,.8*b,.5*c);O(a,.8*b,(.5-d)*c,(.9-d)*b,.4*c,.9*b,.4*c);O(a,(.9+d)*b,.4*c,1*b,(.5-d)*c,1*b,.5*c);b=a.o;b.A=new L(0,.05);b.B=new L(.55,.95);v.s(a);return b},NorGate:function(a,b,c){a=v.q();var d=K.za,e=.5,f=d*e,h=0,k=.5;M(a,.8*b,.5*c,!0);O(a,.7*b,(k+f)*c,(h+f)*b,(k+e)*c,0,1*c);O(a,.25*b,.75*c,.25*b,.25*c,0,0);O(a,(h+f)*b,(k-e)*c,.7*b,(k-f)*c,.8*b,.5*c);e=.1;f=.1*d;h=.9;k=.5;M(a,(h-e)*b,k*c,!0);O(a,
(h-e)*b,(k-f)*c,(h-f)*b,(k-e)*c,h*b,(k-e)*c);O(a,(h+f)*b,(k-e)*c,(h+e)*b,(k-f)*c,(h+e)*b,k*c);O(a,(h+e)*b,(k+f)*c,(h+f)*b,(k+e)*c,h*b,(k+e)*c);O(a,(h-f)*b,(k+e)*c,(h-e)*b,(k+f)*c,(h-e)*b,k*c);b=a.o;b.A=new L(.2,.25);b.B=new L(.6,.75);v.s(a);return b},OrGate:function(a,b,c){a=v.q();var d=.5*K.za;M(a,0,0,!0);O(a,(0+d+d)*b,0*c,.8*b,(.5-d)*c,1*b,.5*c);O(a,.8*b,(.5+d)*c,(0+d+d)*b,1*c,0,1*c);O(a,.25*b,.75*c,.25*b,.25*c,0,0);P(a);b=a.o;b.A=new L(.2,.25);b.B=new L(.75,.75);v.s(a);return b},XnorGate:function(a,
b,c){a=v.q();var d=K.za,e=.5,f=d*e,h=.2,k=.5;M(a,.1*b,0,!1);O(a,.35*b,.25*c,.35*b,.75*c,.1*b,1*c);M(a,.8*b,.5*c,!0);O(a,.7*b,(k+f)*c,(h+f)*b,(k+e)*c,.2*b,1*c);O(a,.45*b,.75*c,.45*b,.25*c,.2*b,0);O(a,(h+f)*b,(k-e)*c,.7*b,(k-f)*c,.8*b,.5*c);e=.1;f=.1*d;h=.9;k=.5;M(a,(h-e)*b,k*c,!0);O(a,(h-e)*b,(k-f)*c,(h-f)*b,(k-e)*c,h*b,(k-e)*c);O(a,(h+f)*b,(k-e)*c,(h+e)*b,(k-f)*c,(h+e)*b,k*c);O(a,(h+e)*b,(k+f)*c,(h+f)*b,(k+e)*c,h*b,(k+e)*c);O(a,(h-f)*b,(k+e)*c,(h-e)*b,(k+f)*c,(h-e)*b,k*c);b=a.o;b.A=new L(.4,.25);
b.B=new L(.65,.75);v.s(a);return b},XorGate:function(a,b,c){a=v.q();var d=.5*K.za;M(a,.1*b,0,!1);O(a,.35*b,.25*c,.35*b,.75*c,.1*b,1*c);M(a,.2*b,0,!0);O(a,(.2+d)*b,0*c,.9*b,(.5-d)*c,1*b,.5*c);O(a,.9*b,(.5+d)*c,(.2+d)*b,1*c,.2*b,1*c);O(a,.45*b,.75*c,.45*b,.25*c,.2*b,0);P(a);b=a.o;b.A=new L(.4,.25);b.B=new L(.8,.75);v.s(a);return b},Capacitor:function(a,b,c){a=v.q();M(a,0,0,!1);a.lineTo(0,1*c);a.moveTo(1*b,0);a.lineTo(1*b,1*c);b=a.o;v.s(a);return b},Resistor:function(a,b,c){a=v.q();M(a,0,.5*c,!1);a.lineTo(.1*
b,0);a.lineTo(.2*b,1*c);a.lineTo(.3*b,0);a.lineTo(.4*b,1*c);a.lineTo(.5*b,0);a.lineTo(.6*b,1*c);a.lineTo(.7*b,.5*c);b=a.o;v.s(a);return b},Inductor:function(a,b,c){a=v.q();var d=.1*K.za,e=.1;M(a,(e-.5*d)*b,c,!1);O(a,(e-d)*b,c,(e-.1)*b,0,(e+.1)*b,0);e=.3;O(a,(e+.1)*b,0,(e+d)*b,c,e*b,c);O(a,(e-d)*b,c,(e-.1)*b,0,(e+.1)*b,0);e=.5;O(a,(e+.1)*b,0,(e+d)*b,c,e*b,c);O(a,(e-d)*b,c,(e-.1)*b,0,(e+.1)*b,0);e=.7;O(a,(e+.1)*b,0,(e+d)*b,c,e*b,c);O(a,(e-d)*b,c,(e-.1)*b,0,(e+.1)*b,0);e=.9;O(a,(e+.1)*b,0,(e+d)*b,c,
(e+.5*d)*b,c);b=a.o;v.s(a);return b},ACvoltageSource:function(a,b,c){a=v.q();var d=.5*K.za;M(a,0*b,.5*c,!1);O(a,0*b,(.5-d)*c,(.5-d)*b,0*c,.5*b,0*c);O(a,(.5+d)*b,0*c,1*b,(.5-d)*c,1*b,.5*c);O(a,1*b,(.5+d)*c,(.5+d)*b,1*c,.5*b,1*c);O(a,(.5-d)*b,1*c,0*b,(.5+d)*c,0*b,.5*c);a.moveTo(.1*b,.5*c);O(a,.5*b,0*c,.5*b,1*c,.9*b,.5*c);b=a.o;b.Hd=vh;v.s(a);return b},DCvoltageSource:function(a,b,c){a=v.q();M(a,0,.75*c,!1);a.lineTo(0,.25*c);a.moveTo(1*b,0);a.lineTo(1*b,1*c);b=a.o;v.s(a);return b},Diode:function(a,b,
c){a=v.q();M(a,1*b,0,!1);a.lineTo(1*b,.5*c);a.lineTo(0,1*c);a.lineTo(0,0);a.lineTo(1*b,.5*c);a.lineTo(1*b,1*c);b=a.o;b.A=new L(0,.25);b.B=new L(.5,.75);v.s(a);return b},Wifi:function(a,b,c){var d=b,e=c;b*=.38;c*=.6;a=v.q();var f=K.za,h=.8*f,k=.8,l=0,m=.5,d=(d-b)/2,e=(e-c)/2;M(a,l*b+d,(m+k)*c+e,!0);O(a,(l-h)*b+d,(m+k)*c+e,(l-k)*b+d,(m+h)*c+e,(l-k)*b+d,m*c+e);O(a,(l-k)*b+d,(m-h)*c+e,(l-h)*b+d,(m-k)*c+e,l*b+d,(m-k)*c+e);O(a,l*b+d,(m-k)*c+e,(l-k+.5*h)*b+d,(m-h)*c+e,(l-k+.5*h)*b+d,m*c+e);O(a,(l-k+.5*h)*
b+d,(m+h)*c+e,l*b+d,(m+k)*c+e,l*b+d,(m+k)*c+e);P(a);h=.4*f;k=.4;l=.2;m=.5;M(a,l*b+d,(m+k)*c+e,!0);O(a,(l-h)*b+d,(m+k)*c+e,(l-k)*b+d,(m+h)*c+e,(l-k)*b+d,m*c+e);O(a,(l-k)*b+d,(m-h)*c+e,(l-h)*b+d,(m-k)*c+e,l*b+d,(m-k)*c+e);O(a,l*b+d,(m-k)*c+e,(l-k+.5*h)*b+d,(m-h)*c+e,(l-k+.5*h)*b+d,m*c+e);O(a,(l-k+.5*h)*b+d,(m+h)*c+e,l*b+d,(m+k)*c+e,l*b+d,(m+k)*c+e);P(a);h=.2*f;k=.2;m=l=.5;M(a,(l-k)*b+d,m*c+e,!0);O(a,(l-k)*b+d,(m-h)*c+e,(l-h)*b+d,(m-k)*c+e,l*b+d,(m-k)*c+e);O(a,(l+h)*b+d,(m-k)*c+e,(l+k)*b+d,(m-h)*c+e,
(l+k)*b+d,m*c+e);O(a,(l+k)*b+d,(m+h)*c+e,(l+h)*b+d,(m+k)*c+e,l*b+d,(m+k)*c+e);O(a,(l-h)*b+d,(m+k)*c+e,(l-k)*b+d,(m+h)*c+e,(l-k)*b+d,m*c+e);h=.4*f;k=.4;l=.8;m=.5;M(a,l*b+d,(m-k)*c+e,!0);O(a,(l+h)*b+d,(m-k)*c+e,(l+k)*b+d,(m-h)*c+e,(l+k)*b+d,m*c+e);O(a,(l+k)*b+d,(m+h)*c+e,(l+h)*b+d,(m+k)*c+e,l*b+d,(m+k)*c+e);O(a,l*b+d,(m+k)*c+e,(l+k-.5*h)*b+d,(m+h)*c+e,(l+k-.5*h)*b+d,m*c+e);O(a,(l+k-.5*h)*b+d,(m-h)*c+e,l*b+d,(m-k)*c+e,l*b+d,(m-k)*c+e);P(a);h=.8*f;k=.8;l=1;m=.5;M(a,l*b+d,(m-k)*c+e,!0);O(a,(l+h)*b+d,(m-
k)*c+e,(l+k)*b+d,(m-h)*c+e,(l+k)*b+d,m*c+e);O(a,(l+k)*b+d,(m+h)*c+e,(l+h)*b+d,(m+k)*c+e,l*b+d,(m+k)*c+e);O(a,l*b+d,(m+k)*c+e,(l+k-.5*h)*b+d,(m+h)*c+e,(l+k-.5*h)*b+d,m*c+e);O(a,(l+k-.5*h)*b+d,(m-h)*c+e,l*b+d,(m-k)*c+e,l*b+d,(m-k)*c+e);P(a);b=a.o;v.s(a);return b},Email:function(a,b,c){a=v.q();M(a,0,0,!0);a.lineTo(1*b,0);a.lineTo(1*b,1*c);a.lineTo(0,1*c);a.lineTo(0,0);P(a);M(a,0,0,!1);a.lineTo(.5*b,.6*c);a.lineTo(1*b,0);a.moveTo(0,1*c);a.lineTo(.45*b,.54*c);a.moveTo(1*b,1*c);a.lineTo(.55*b,.54*c);a.Ya(!1);
b=a.o;v.s(a);return b},Ethernet:function(a,b,c){a=v.q();M(a,.35*b,0,!0);a.lineTo(.65*b,0);a.lineTo(.65*b,.4*c);a.lineTo(.35*b,.4*c);a.lineTo(.35*b,0);P(a);M(a,.1*b,1*c,!0,!0);a.lineTo(.4*b,1*c);a.lineTo(.4*b,.6*c);a.lineTo(.1*b,.6*c);a.lineTo(.1*b,1*c);P(a);M(a,.6*b,1*c,!0,!0);a.lineTo(.9*b,1*c);a.lineTo(.9*b,.6*c);a.lineTo(.6*b,.6*c);a.lineTo(.6*b,1*c);P(a);M(a,0,.5*c,!1);a.lineTo(1*b,.5*c);a.moveTo(.5*b,.5*c);a.lineTo(.5*b,.4*c);a.moveTo(.75*b,.5*c);a.lineTo(.75*b,.6*c);a.moveTo(.25*b,.5*c);a.lineTo(.25*
b,.6*c);a.Ya(!1);b=a.o;v.s(a);return b},Power:function(a,b,c){a=v.q();var d=K.za,e=.4*d,f=.4,h=v.M(),k=v.M(),l=v.M(),m=v.M();K.Ni(.5,.5-f,.5+e,.5-f,.5+f,.5-e,.5+f,.5,.5,h,h,k,l,m);var n=v.Rb(k.x,k.y);M(a,k.x*b,k.y*c,!0);O(a,l.x*b,l.y*c,m.x*b,m.y*c,(.5+f)*b,.5*c);O(a,(.5+f)*b,(.5+e)*c,(.5+e)*b,(.5+f)*c,.5*b,(.5+f)*c);O(a,(.5-e)*b,(.5+f)*c,(.5-f)*b,(.5+e)*c,(.5-f)*b,.5*c);K.Ni(.5-f,.5,.5-f,.5-e,.5-e,.5-f,.5,.5-f,.5,l,m,k,h,h);O(a,l.x*b,l.y*c,m.x*b,m.y*c,k.x*b,k.y*c);e=.3*d;f=.3;K.Ni(.5-f,.5,.5-f,.5-
e,.5-e,.5-f,.5,.5-f,.5,l,m,k,h,h);a.lineTo(k.x*b,k.y*c);O(a,m.x*b,m.y*c,l.x*b,l.y*c,(.5-f)*b,.5*c);O(a,(.5-f)*b,(.5+e)*c,(.5-e)*b,(.5+f)*c,.5*b,(.5+f)*c);O(a,(.5+e)*b,(.5+f)*c,(.5+f)*b,(.5+e)*c,(.5+f)*b,.5*c);K.Ni(.5,.5-f,.5+e,.5-f,.5+f,.5-e,.5+f,.5,.5,h,h,k,l,m);O(a,m.x*b,m.y*c,l.x*b,l.y*c,k.x*b,k.y*c);P(a);M(a,.45*b,0,!0);a.lineTo(.45*b,.5*c);a.lineTo(.55*b,.5*c);a.lineTo(.55*b,0);P(a);v.v(h);v.v(k);v.v(l);v.v(m);v.v(n);b=a.o;b.A=new L(.25,.55);b.B=new L(.75,.8);v.s(a);return b},Fallout:function(a,
b,c){a=v.q();var d=.5*K.za;M(a,0*b,.5*c,!0);O(a,0*b,(.5-d)*c,(.5-d)*b,0*c,.5*b,0*c);O(a,(.5+d)*b,0*c,1*b,(.5-d)*c,1*b,.5*c);O(a,1*b,(.5+d)*c,(.5+d)*b,1*c,.5*b,1*c);O(a,(.5-d)*b,1*c,0*b,(.5+d)*c,0*b,.5*c);var e=d=0;M(a,(.3+d)*b,(.8+e)*c,!0,!0);a.lineTo((.5+d)*b,(.5+e)*c);a.lineTo((.1+d)*b,(.5+e)*c);a.lineTo((.3+d)*b,(.8+e)*c);d=.4;e=0;P(a);M(a,(.3+d)*b,(.8+e)*c,!0,!0);a.lineTo((.5+d)*b,(.5+e)*c);a.lineTo((.1+d)*b,(.5+e)*c);a.lineTo((.3+d)*b,(.8+e)*c);d=.2;e=-.3;P(a);M(a,(.3+d)*b,(.8+e)*c,!0,!0);a.lineTo((.5+
d)*b,(.5+e)*c);a.lineTo((.1+d)*b,(.5+e)*c);a.lineTo((.3+d)*b,(.8+e)*c);P(a);b=a.o;b.Hd=vh;v.s(a);return b},IrritationHazard:function(a,b,c){a=v.q();M(a,.2*b,0*c,!0);a.lineTo(.5*b,.3*c);a.lineTo(.8*b,0*c);a.lineTo(1*b,.2*c);a.lineTo(.7*b,.5*c);a.lineTo(1*b,.8*c);a.lineTo(.8*b,1*c);a.lineTo(.5*b,.7*c);a.lineTo(.2*b,1*c);a.lineTo(0*b,.8*c);a.lineTo(.3*b,.5*c);a.lineTo(0*b,.2*c);P(a);b=a.o;b.A=new L(.3,.3);b.B=new L(.7,.7);v.s(a);return b},ElectricalHazard:function(a,b,c){a=v.q();M(a,.37*b,0*c,!0);a.lineTo(.5*
b,.11*c);a.lineTo(.77*b,.04*c);a.lineTo(.33*b,.49*c);a.lineTo(1*b,.37*c);a.lineTo(.63*b,.86*c);a.lineTo(.77*b,.91*c);a.lineTo(.34*b,1*c);a.lineTo(.34*b,.78*c);a.lineTo(.44*b,.8*c);a.lineTo(.65*b,.56*c);a.lineTo(0*b,.68*c);P(a);b=a.o;v.s(a);return b},FireHazard:function(a,b,c){a=v.q();M(a,.1*b,1*c,!0);O(a,-.25*b,.63*c,.45*b,.44*c,.29*b,0*c);O(a,.48*b,.17*c,.54*b,.35*c,.51*b,.42*c);O(a,.59*b,.29*c,.58*b,.28*c,.59*b,.18*c);O(a,.8*b,.34*c,.88*b,.43*c,.75*b,.6*c);O(a,.87*b,.48*c,.88*b,.43*c,.88*b,.31*
c);O(a,1.17*b,.76*c,.82*b,.8*c,.9*b,1*c);P(a);b=a.o;b.A=new L(.05,.645);b.B=new L(.884,.908);v.s(a);return b},BpmnActivityLoop:function(a,b,c){a=v.q();var d=4*(Math.SQRT2-1)/3*.5;M(a,.65*b,1*c,!1);O(a,(1-d+0)*b,1*c,1*b,(.5+d+0)*c,1*b,.5*c);O(a,1*b,(.5-d+0)*c,(.5+d+0)*b,0*c,.5*b,0*c);O(a,(.5-d+0)*b,0*c,0*b,(.5-d+0)*c,0*b,.5*c);O(a,0*b,(.5+d+0)*c,(.5-d+0)*b,1*c,.35*b,.98*c);a.moveTo(.25*b,.8*c);a.lineTo(.35*b,1*c);a.lineTo(.1*b,1*c);b=a.o;v.s(a);return b},BpmnActivityParallel:function(a,b,c){a=v.q();
M(a,0,0,!1);a.lineTo(0,1*c);a.moveTo(.5*b,0);a.lineTo(.5*b,1*c);a.moveTo(1*b,0);a.lineTo(1*b,1*c);b=a.o;v.s(a);return b},BpmnActivitySequential:function(a,b,c){a=v.q();M(a,0,0,!1);a.lineTo(1*b,0);a.moveTo(0,.5*c);a.lineTo(1*b,.5*c);a.moveTo(0,1*c);a.lineTo(1*b,1*c);b=a.o;v.s(a);return b},BpmnActivityAdHoc:function(a,b,c){a=v.q();M(a,0,0,!1);M(a,1*b,1*c,!1);M(a,0,.5*c,!1);O(a,.2*b,.35*c,.3*b,.35*c,.5*b,.5*c);O(a,.7*b,.65*c,.8*b,.65*c,1*b,.5*c);b=a.o;v.s(a);return b},BpmnActivityCompensation:function(a,
b,c){a=v.q();M(a,0,.5*c,!0);a.lineTo(.5*b,0);a.lineTo(.5*b,.5*c);a.lineTo(1*b,1*c);a.lineTo(1*b,0);a.lineTo(.5*b,.5*c);a.lineTo(.5*b,1*c);P(a);b=a.o;v.s(a);return b},BpmnTaskMessage:function(a,b,c){a=v.q();M(a,0,.2*c,!0);a.lineTo(1*b,.2*c);a.lineTo(1*b,.8*c);a.lineTo(0,.8*c);a.lineTo(0,.8*c);P(a);M(a,0,.2*c,!1);a.lineTo(.5*b,.5*c);a.lineTo(1*b,.2*c);a.Ya(!1);b=a.o;v.s(a);return b},BpmnTaskScript:function(a,b,c){a=v.q();M(a,.7*b,1*c,!0);a.lineTo(.3*b,1*c);O(a,.6*b,.5*c,0,.5*c,.3*b,0);a.lineTo(.7*b,
0);O(a,.4*b,.5*c,1*b,.5*c,.7*b,1*c);P(a);M(a,.45*b,.73*c,!1);a.lineTo(.7*b,.73*c);a.moveTo(.38*b,.5*c);a.lineTo(.63*b,.5*c);a.moveTo(.31*b,.27*c);a.lineTo(.56*b,.27*c);a.Ya(!1);b=a.o;v.s(a);return b},BpmnTaskUser:function(a,b,c){a=v.q();M(a,0,0,!1);M(a,.335*b,(1-.555)*c,!0);a.lineTo(.335*b,.595*c);a.lineTo(.665*b,.595*c);a.lineTo(.665*b,(1-.555)*c);O(a,.88*b,.46*c,.98*b,.54*c,1*b,.68*c);a.lineTo(1*b,1*c);a.lineTo(0,1*c);a.lineTo(0,.68*c);O(a,.02*b,.54*c,.12*b,.46*c,.335*b,(1-.555)*c);a.lineTo(.365*
b,.405*c);var d=.5-.285,e=Math.PI/4,f=4*(1-Math.cos(e))/(3*Math.sin(e)),e=f*d,f=f*d;O(a,(.5-(e+d)/2)*b,(d+(d+f)/2)*c,(.5-d)*b,(d+f)*c,(.5-d)*b,d*c);O(a,(.5-d)*b,(d-f)*c,(.5-e)*b,(d-d)*c,.5*b,(d-d)*c);O(a,(.5+e)*b,(d-d)*c,(.5+d)*b,(d-f)*c,(.5+d)*b,d*c);O(a,(.5+d)*b,(d+f)*c,(.5+(e+d)/2)*b,(d+(d+f)/2)*c,.635*b,.405*c);a.lineTo(.635*b,.405*c);a.lineTo(.665*b,(1-.555)*c);a.lineTo(.665*b,.595*c);a.lineTo(.335*b,.595*c);M(a,.2*b,1*c,!1);a.lineTo(.2*b,.8*c);M(a,.8*b,1*c,!1);a.lineTo(.8*b,.8*c);b=a.o;v.s(a);
return b},BpmnEventConditional:function(a,b,c){a=v.q();M(a,.1*b,0,!0);a.lineTo(.9*b,0);a.lineTo(.9*b,1*c);a.lineTo(.1*b,1*c);P(a);M(a,.2*b,.2*c,!1);a.lineTo(.8*b,.2*c);a.moveTo(.2*b,.4*c);a.lineTo(.8*b,.4*c);a.moveTo(.2*b,.6*c);a.lineTo(.8*b,.6*c);a.moveTo(.2*b,.8*c);a.lineTo(.8*b,.8*c);a.Ya(!1);b=a.o;v.s(a);return b},BpmnEventError:function(a,b,c){a=v.q();M(a,0,1*c,!0);a.lineTo(.33*b,0);a.lineTo(.66*b,.5*c);a.lineTo(1*b,0);a.lineTo(.66*b,1*c);a.lineTo(.33*b,.5*c);P(a);b=a.o;v.s(a);return b},BpmnEventEscalation:function(a,
b,c){a=v.q();M(a,0,0,!1);M(a,1*b,1*c,!1);M(a,.1*b,1*c,!0);a.lineTo(.5*b,0);a.lineTo(.9*b,1*c);a.lineTo(.5*b,.5*c);P(a);b=a.o;v.s(a);return b},BpmnEventTimer:function(a,b,c){a=v.q();var d=.5*K.za;M(a,1*b,.5*c,!0);O(a,1*b,(.5+d)*c,(.5+d)*b,1*c,.5*b,1*c);O(a,(.5-d)*b,1*c,0,(.5+d)*c,0,.5*c);O(a,0,(.5-d)*c,(.5-d)*b,0,.5*b,0);O(a,(.5+d)*b,0,1*b,(.5-d)*c,1*b,.5*c);M(a,.5*b,0,!1);a.lineTo(.5*b,.15*c);a.moveTo(.5*b,1*c);a.lineTo(.5*b,.85*c);a.moveTo(0,.5*c);a.lineTo(.15*b,.5*c);a.moveTo(1*b,.5*c);a.lineTo(.85*
b,.5*c);a.moveTo(.5*b,.5*c);a.lineTo(.58*b,.1*c);a.moveTo(.5*b,.5*c);a.lineTo(.78*b,.54*c);a.Ya(!1);b=a.o;b.Hd=vh;v.s(a);return b}};for(var Tn in K.sg)K.sg[Tn.toLowerCase()]=Tn;
K.qw={"":"",Standard:"F1 m 0,0 l 8,4 -8,4 2,-4 z",Backward:"F1 m 8,0 l -2,4 2,4 -8,-4 z",Triangle:"F1 m 0,0 l 8,4.62 -8,4.62 z",BackwardTriangle:"F1 m 8,4 l 0,4 -8,-4 8,-4 0,4 z",Boomerang:"F1 m 0,0 l 8,4 -8,4 4,-4 -4,-4 z",BackwardBoomerang:"F1 m 8,0 l -8,4 8,4 -4,-4 4,-4 z",SidewaysV:"m 0,0 l 8,4 -8,4 0,-1 6,-3 -6,-3 0,-1 z",BackwardV:"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z",OpenTriangle:"m 0,0 l 8,4 -8,4",BackwardOpenTriangle:"m 8,0 l -8,4 8,4",OpenTriangleLine:"m 0,0 l 8,4 -8,4 m 8.5,0 l 0,-8",
BackwardOpenTriangleLine:"m 8,0 l  -8,4 8,4 m -8.5,0 l 0,-8",OpenTriangleTop:"m 0,0 l 8,4 m 0,4",BackwardOpenTriangleTop:"m 8,0 l -8,4 m 0,4",OpenTriangleBottom:"m 0,8 l 8,-4",BackwardOpenTriangleBottom:"m 0,4 l 8,4",HalfTriangleTop:"F1 m 0,0 l 0,4 8,0 z m 0,8",BackwardHalfTriangleTop:"F1 m 8,0 l 0,4 -8,0 z m 0,8",HalfTriangleBottom:"F1 m 0,4 l 0,4 8,-4 z",BackwardHalfTriangleBottom:"F1 m 8,4 l 0,4 -8,-4 z",ForwardSemiCircle:"m 4,0 b 270 180 0 4 4",BackwardSemiCircle:"m 4,8 b 90 180 0 -4 4",Feather:"m 0,0 l 3,4 -3,4",
BackwardFeather:"m 3,0 l -3,4 3,4",DoubleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardDoubleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4",TripleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardTripleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4 m 3,-8 l -3,4 3,4",ForwardSlash:"m 0,8 l 5,-8",BackSlash:"m 0,0 l 5,8",DoubleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8",DoubleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8",TripleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8 m -2,8 l 4,-8",
TripleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8 m -2,-8 l 4,8",Fork:"m 0,4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4",LineFork:"m 0,0 l 0,8 m 0,-4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardLineFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4 m 8,-8 l 0,8",CircleFork:"F1 m 6,4 b 0 360 -3 0 3 z m 0,0 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 6,0 b 0 360 -3 0 3",CircleLineFork:"F1 m 6,4 b 0 360 -3 0 3 z m 1,-4 l 0,8 m 0,-4 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",
BackwardCircleLineFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 0,-4 l 0,8 m 7,-4 b 0 360 -3 0 3",Circle:"F1 m 8,4 b 0 360 -4 0 4 z",Block:"F1 m 0,0 l 0,8 8,0 0,-8 z",StretchedDiamond:"F1 m 0,3 l 5,-3 5,3 -5,3 -5,-3 z",Diamond:"F1 m 0,4 l 4,-4 4,4 -4,4 -4,-4 z",Chevron:"F1 m 0,0 l 5,0 3,4 -3,4 -5,0 3,-4 -3,-4 z",StretchedChevron:"F1 m 0,0 l 8,0 3,4 -3,4 -8,0 3,-4 -3,-4 z",NormalArrow:"F1 m 0,2 l 4,0 0,-2 4,4 -4,4 0,-2 -4,0 z",X:"m 0,0 l 8,8 m 0,-8 l -8,8",TailedNormalArrow:"F1 m 0,0 l 2,0 1,2 3,0 0,-2 2,4 -2,4 0,-2 -3,0 -1,2 -2,0 1,-4 -1,-4 z",
DoubleTriangle:"F1 m 0,0 l 4,4 -4,4 0,-8 z  m 4,0 l 4,4 -4,4 0,-8 z",BigEndArrow:"F1 m 0,0 l 5,2 0,-2 3,4 -3,4 0,-2 -5,2 0,-8 z",ConcaveTailArrow:"F1 m 0,2 h 4 v -2 l 4,4 -4,4 v -2 h -4 l 2,-2 -2,-2 z",RoundedTriangle:"F1 m 0,1 a 1,1 0 0 1 1,-1 l 7,3 a 0.5,1 0 0 1 0,2 l -7,3 a 1,1 0 0 1 -1,-1 l 0,-6 z",SimpleArrow:"F1 m 1,2 l -1,-2 2,0 1,2 -1,2 -2,0 1,-2 5,0 0,-2 2,2 -2,2 0,-2 z",AccelerationArrow:"F1 m 0,0 l 0,8 0.2,0 0,-8 -0.2,0 z m 2,0 l 0,8 1,0 0,-8 -1,0 z m 3,0 l 2,0 2,4 -2,4 -2,0 0,-8 z",BoxArrow:"F1 m 0,0 l 4,0 0,2 2,0 0,-2 2,4 -2,4 0,-2 -2,0 0,2 -4,0 0,-8 z",
TriangleLine:"F1 m 8,4 l -8,-4 0,8 8,-4 z m 0.5,4 l 0,-8",CircleEndedArrow:"F1 m 10,4 l -2,-3 0,2 -2,0 0,2 2,0 0,2 2,-3 z m -4,0 b 0 360 -3 0 3 z",DynamicWidthArrow:"F1 m 0,3 l 2,0 2,-1 2,-2 2,4 -2,4 -2,-2 -2,-1 -2,0 0,-2 z",EquilibriumArrow:"m 0,3 l 8,0 -3,-3 m 3,5 l -8,0 3,3",FastForward:"F1 m 0,0 l 3.5,4 0,-4 3.5,4 0,-4 1,0 0,8 -1,0 0,-4 -3.5,4 0,-4 -3.5,4 0,-8 z",Kite:"F1 m 0,4 l 2,-4 6,4 -6,4 -2,-4 z",HalfArrowTop:"F1 m 0,0 l 4,4 4,0 -8,-4 z m 0,8",HalfArrowBottom:"F1 m 0,8 l 4,-4 4,0 -8,4 z",
OpposingDirectionDoubleArrow:"F1 m 0,4 l 2,-4 0,2 4,0 0,-2 2,4 -2,4 0,-2 -4,0 0,2 -2,-4 z",PartialDoubleTriangle:"F1 m 0,0 4,3 0,-3 4,4 -4,4 0,-3 -4,3 0,-8 z",LineCircle:"F1 m 0,0 l 0,8 m 7 -4 b 0 360 -3 0 3 z",DoubleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",TripleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",CircleLine:"F1 m 6 4 b 0 360 -3 0 3 z m 1,-4 l 0,8",DiamondCircle:"F1 m 8,4 l -4,4 -4,-4 4,-4 4,4 m 8,0 b 0 360 -4 0 4 z",PlusCircle:"F1 m 8,4 b 0 360 -4 0 4 l -8 0 z m -4 -4 l 0 8",
OpenRightTriangleTop:"m 8,0 l 0,4 -8,0 m 0,4",OpenRightTriangleBottom:"m 8,8 l 0,-4 -8,0",Line:"m 0,0 l 0,8",DoubleLine:"m 0,0 l 0,8 m 2,0 l 0,-8",TripleLine:"m 0,0 l 0,8 m 2,0 l 0,-8 m 2,0 l 0,8",PentagonArrow:"F1 m 8,4 l -4,-4 -4,0 0,8 4,0 4,-4 z"};K.WI=function(){if(null!==K.qw){for(var a in K.qw){var b=ud(K.qw[a],!1);K.aj[a]=b;a.toLowerCase()!==a&&(K.aj[a.toLowerCase()]=a)}K.qw=null}};
K.AD=function(a){K.WI();var b=K.aj[a];if(void 0===b){b=a.toLowerCase();if("none"===b)return"None";b=K.aj[b]}return"string"===typeof b?b:b instanceof Xc?a:null};
function J(a){0===arguments.length?C.call(this):C.call(this,a);this.Q=311807;this.Gk=this.ei="";this.Tr=this.Qr=this.cs=this.Zq=null;this.es="";this.ci=this.ds=this.sm=null;this.Sr="";this.mo=null;this.Rr=(new ia(NaN,NaN)).freeze();this.Ur="";this.no=null;this.ie="";this.hv=this.eq=this.uk=null;this.Kg=(new w(NaN,NaN)).freeze();this.dr="";this.Kk=null;this.er=zb;this.or=K.NF;this.hr=K.MF;this.uq=null;this.$q=Un;this.tm=(new w(6,6)).freeze();this.Rg="gray";this.Mh=4;this.hC=-1;this.Es=NaN;this.VF=
new z;this.Mk=null;this.vj=NaN}v.Ga(J,C);v.ga("Part",J);
J.prototype.cloneProtected=function(a){C.prototype.cloneProtected.call(this,a);a.Q=this.Q&-4097|49152;a.ei=this.ei;a.Gk=this.Gk;a.Zq=this.Zq;a.cs=this.cs;a.Qr=this.Qr;a.Tr=this.Tr;a.es=this.es;a.ds=this.ds;a.ci=null;a.Sr=this.Sr;a.Rr.assign(this.Rr);a.Ur=this.Ur;a.ie=this.ie;a.eq=this.eq;a.Kg.assign(this.Kg);a.dr=this.dr;a.er=this.er.aa();a.or=this.or.aa();a.hr=this.hr.aa();a.uq=this.uq;a.$q=this.$q;a.tm.assign(this.tm);a.Rg=this.Rg;a.Mh=this.Mh;a.Es=this.Es};
J.prototype.Vh=function(a){C.prototype.Vh.call(this,a);a.ol();a.sm=null;a.mo=null;a.no=null;a.Kk=null;a.Mk=null};J.prototype.toString=function(){var a=v.nf(Object.getPrototypeOf(this))+"#"+v.cd(this);null!==this.data&&(a+="("+ce(this.data)+")");return a};J.LayoutNone=0;var Sj;J.LayoutAdded=Sj=1;var ak;J.LayoutRemoved=ak=2;J.LayoutShown=4;J.LayoutHidden=8;J.LayoutNodeSized=16;var Sk;J.LayoutGroupLayout=Sk=32;J.LayoutNodeReplaced=64;var Un;J.LayoutStandard=Un=Sj|ak|28|Sk|64;J.LayoutAll=16777215;
J.prototype.bn=function(a,b,c,d,e,f,h){var k=this.g;null!==k&&(a===Qd&&"elements"===b?e instanceof C?Tj(e,function(a){Vj(k,a);Uj(k,a)}):e instanceof Zi&&Ek(k,e):a===be&&"elements"===b&&(e instanceof C?Tj(e,function(a){Zj(k,a);Yj(k,a)}):e instanceof Zi&&Fk(k,e)),k.Ec(a,b,c,d,e,f,h))};J.prototype.updateTargetBindings=J.prototype.Ib=function(a){C.prototype.Ib.call(this,a);if(null!==this.data){a=this.wa.n;for(var b=a.length,c=0;c<b;c++){var d=a[c];d instanceof C&&Tj(d,function(a){null!==a.data&&a.Ib()})}}};
J.prototype.updateRelationshipsFromData=function(){var a=this.data;if(null!==a){var b=this.g;if(null!==b){var c=b.da;if(c instanceof Q){var d=c.Rm(a),b=b.mH(d),e=this.Sa;b!==e&&(b=null!==e?c.mb(e.data):void 0,e=c.pp,"function"===typeof e?e(a,b):a[e]=b,c.ux(a,d))}}}};v.u(J,{iw:"adornments"},function(){return null===this.ci?Ia:this.ci.zE});J.prototype.findAdornment=J.prototype.Qo=function(a){var b=this.ci;return null===b?null:b.la(a)};
J.prototype.addAdornment=J.prototype.Uk=function(a,b){if(null!==b){var c=null,d=this.ci;null!==d&&(c=d.la(a));if(c!==b){if(null!==c){var e=c.g;null!==e&&e.remove(c)}null===d&&(this.ci=d=new ma("string",mf));b.ei!==a&&(b.Mc=a);d.add(a,b);c=this.g;null!==c&&(c.add(b),b.data=this.data)}}};J.prototype.removeAdornment=J.prototype.yl=function(a){var b=this.ci;if(null!==b){var c=b.la(a);if(null!==c){var d=c.g;null!==d&&d.remove(c)}b.remove(a);0===b.count&&(this.ci=null)}};
J.prototype.clearAdornments=J.prototype.Os=function(){var a=this.ci;if(null!==a){for(var b=v.jb(),a=a.i;a.next();)b.push(a.key);for(var a=b.length,c=0;c<a;c++)this.yl(b[c]);v.ra(b)}};
J.prototype.updateAdornments=function(){var a=this.g;if(null!==a){a:{if(this.hb&&this.QI){var b=this.Qt;if(!(null!==b&&this.Z.H()&&this.isVisible()&&b.ul()&&b.Z.H()))break a;var c=this.Qo("Selection");if(null===c){c=this.RI;null===c&&(c=this instanceof W?a.dI:this instanceof T?a.zH:a.tI);if(!(c instanceof mf))break a;of(c);c=c.copy();null!==c&&(c.Mc="Selection",c.ec=b)}if(null!==c){var d=c.placeholder;if(null!==d){var e=b.Si(),f=0;b instanceof X&&(f=b.nb);var h=v.El();h.m((b.Fa.width+f)*e,(b.Fa.height+
f)*e);d.xa=h;v.Wj(h)}c.angle=b.jl();c.type!==dh&&(d=v.M(),c.location=b.fb(zb,d),v.v(d));this.Uk("Selection",c);break a}}this.yl("Selection")}Vn(this,a);for(a=this.iw;a.next();)b=a.value,b.Ib(),b.P()}};function Vn(a,b){b.wb.df.each(function(b){b.isEnabled&&b.updateAdornments(a)})}v.u(J,{layer:"layer"},function(){return this.hv});v.u(J,{g:"diagram"},function(){var a=this.hv;return null!==a?a.g:null});
v.defineProperty(J,{tf:"layerName"},function(){return this.Gk},function(a){var b=this.Gk;if(b!==a){v.j(a,"string",J,"layerName");var c=this.g;if(null===c||null!==c.Ws(a)&&!c.ln)if(this.Gk=a,null!==c&&c.oc(),this.h("layerName",b,a),b=this.layer,null!==b&&b.name!==a&&(c=b.g,null!==c&&(a=c.Ws(a),null!==a&&a!==b))){var d=b.Ke(-1,this,!0);0<=d&&c.Ec(be,"parts",b,this,null,d,!0);d=a.Zo(99999999,this,!0);0<=d&&c.Ec(Qd,"parts",a,null,this,!0,d);d=this.qt;if(null!==d){var e=c.Qa;c.Qa=!0;d(this,b,a);c.Qa=e}}}});
v.defineProperty(J,{qt:"layerChanged"},function(){return this.Zq},function(a){var b=this.Zq;b!==a&&(null!==a&&v.j(a,"function",J,"layerChanged"),this.Zq=a,this.h("layerChanged",b,a))});v.defineProperty(J,{Kp:"zOrder"},function(){return this.Es},function(a){var b=this.Es;if(b!==a){v.j(a,"number",J,"zOrder");this.Es=a;var c=this.layer;null!==c&&Qi(c,-1,this);this.h("zOrder",b,a);a=this.g;null!==a&&a.pa()}});
J.prototype.invalidateAdornments=J.prototype.Zd=function(){var a=this.g;null!==a&&(lj(a),0!==(this.Q&16384)!==!0&&(this.Q|=16384,a.de()))};function zi(a){0!==(a.Q&16384)!==!1&&(a.updateAdornments(),a.Q&=-16385)}function Vl(a,b){if(!1===Lj(a)){var c=a.g;null!==c&&(c.Zf.add(a),a instanceof S&&!c.ja.ib&&a.invalidateConnectedLinks(),b||c.de());Wn(a,!0);a.pi()}}
function Xn(a){if(!1!==Lj(a)){var b=a.position,c=a.location;c.H()&&b.H()||Yn(a,b,c);var b=a.Xa,c=a.kc,d=c.copy();c.Na();c.x=b.x;c.y=b.y;c.freeze();a.bx(d,c);Wn(a,!1)}}v.u(J,{ac:"locationObject"},function(){if(null===this.Kk){var a=this.Yz;""!==a?(a=this.Yd(a),this.Kk=null!==a?a:this):this.Kk=this instanceof mf?this.type!==dh&&null!==this.placeholder?this.placeholder:this:this}return this.Kk.visible?this.Kk:this});
v.defineProperty(J,{mI:"minLocation"},function(){return this.or},function(a){var b=this.or;b.L(a)||(this.or=a=a.aa(),this.h("minLocation",b,a))});v.defineProperty(J,{hI:"maxLocation"},function(){return this.hr},function(a){var b=this.hr;b.L(a)||(this.hr=a=a.aa(),this.h("maxLocation",b,a))});v.defineProperty(J,{Yz:"locationObjectName"},function(){return this.dr},function(a){var b=this.dr;b!==a&&(this.dr=a,this.Kk=null,Pl(this),this.h("locationObjectName",b,a))});
v.defineProperty(J,{Ze:"locationSpot"},function(){return this.er},function(a){var b=this.er;b.L(a)||(this.er=a=a.aa(),Pl(this),this.h("locationSpot",b,a))});J.prototype.move=function(a){this.position=a};J.prototype.moveTo=J.prototype.moveTo=function(a,b){var c=v.Rb(a,b);this.move(c);v.v(c)};
J.prototype.isVisible=function(){if(!this.visible)return!1;var a=this.layer;if(null!==a&&!a.visible)return!1;a=this.g;if(null!==a&&(a=a.Oa,a.pf&&(a=a.ay.la(this),null!==a&&a.kx)))return!0;a=this.Sa;return null===a||a.be&&a.isVisible()?!0:!1};J.prototype.oe=function(a){var b=this.g;a?(this.G(4),this.Zd(),null!==b&&b.Zf.add(this)):(this.G(8),this.Os());this.ol();null!==b&&(b.oc(),b.pa())};
J.prototype.findObject=J.prototype.Yd=function(a){if(this.name===a)return this;var b=this.Mk;null===b&&(this.Mk=b=new pa);if(void 0!==b[a])return b[a];for(var c=this.wa.n,d=c.length,e=0;e<d;e++){var f=c[e];if(f.name===a)return b[a]=f;if(f instanceof C)if(null===f.si&&null===f.ag){if(f=f.Yd(a),null!==f)return b[a]=f}else if(Ck(f)&&(f=f.wa.first(),null!==f&&f.name===a))return b[a]=f}return b[a]=null};
function Zn(a,b,c,d){void 0===d&&(d=new w);c.me()&&(c=Kb);var e=b.Fa;d.m(e.width*c.x+c.offsetX,e.height*c.y+c.offsetY);if(null===b||b===a)return d;b.transform.xb(d);for(b=b.T;null!==b&&b!==a;)b.transform.xb(d),b=b.T;a.Jk.xb(d);d.offset(-a.Vc.x,-a.Vc.y);return d}J.prototype.ensureBounds=J.prototype.mf=function(){Rh(this,Infinity,Infinity);this.zc()};
function Pi(a,b){var c;c=a.VF;var d;isNaN(a.vj)&&(a.vj=cn(a));d=a.vj;var e=2*d;if(!a.tl)return c.m(b.x-1-d,b.y-1-d,b.width+2+e,b.height+2+e),c;d=b.x;var e=b.y,f=b.width,h=b.height,k=a.shadowBlur,l=a.XI,f=f+k,h=h+k;d-=k/2;e-=k/2;0<l.x?f+=l.x:(d+=l.x,f-=l.x);0<l.y?h+=l.y:(e+=l.y,h-=l.y);c.m(d-1,e-1,f+2,h+2);return c}
J.prototype.zc=function(){this.pi();if(!1===Kj(this))Xn(this);else{var a=this.kc,b=v.Uf();b.assign(a);a.Na();var c=yi(this);this.Li(0,0,this.Vc.width,this.Vc.height);var d=this.position;Yn(this,d,this.location);a.x=d.x;a.y=d.y;a.freeze();this.bx(b,a);b.L(a)?this.uf(c):!this.Ld()||K.D(b.width,a.width)&&K.D(b.height,a.height)||0<=this.hC&&this.G(16);v.fc(b);Wn(this,!1)}};
J.prototype.bx=function(a,b){Al(this,!1);var c=this.g;if(null!==c){var d=!1,e=a.H();if(!1===c.nj){var f=c.Wd,h=c.padding,k=f.x+h.left,l=f.y+h.top,m=f.width-2*h.right,f=f.height-2*h.bottom;e&&a.x>k&&a.y>l&&a.right<m&&a.bottom<f&&b.x>k&&b.y>l&&b.right<m&&b.bottom<f&&(d=!0)}0!==(this.Q&65536)!==!0&&a.L(b)||Wj(this,d,c);c.pa();a.L(b)||this.ol()}};
v.defineProperty(J,{location:"location"},function(){return this.Kg},function(a){var b=this.Kg;if(!b.L(a)){a=a.aa();var c;c=a;if(this instanceof W)c=!1;else{this.Kg=c;if(!1===Kj(this)){var d=this.Xa,e=d.copy();d.m(d.x+(c.x-b.x),d.y+(c.y-b.y));Vl(this,!1);$n(this,this.g,d,e);this.h("position",e,d)}c=!0}c&&this.h("location",b,a)}});
J.prototype.CA=function(a,b){if(this instanceof W||!a.H())return!1;var c=this.g;if(null!==c&&($n(this,c,a,b),!0===c.ja.ib))return!0;this.Xa=a;var c=this.Kg,d=c.copy();c.m(c.x+(a.x-b.x),c.y+(a.y-b.y));!1===Lj(this)&&!1===Kj(this)&&(Vl(this,!1),Xn(this));this.h("location",d,c);return!0};function $n(a,b,c,d){null===b||a instanceof mf||(b=a.g.Oa,b.sc&&c.H()&&mi(b,a,"position",d.copy(),c.copy(),!1))}
J.prototype.DA=function(a,b){var c=this.Kg;!1===Lj(this)&&!1===Kj(this)?this.Kg.m(c.x+a-this.Xa.x,c.y+b-this.Xa.y):c.m(NaN,NaN);this.Xa.m(a,b);Vl(this,!0)};
function Yn(a,b,c){var d=NaN,e=NaN,f=v.M(),h=a.Ze,k=a.ac;h.me()&&v.k("determineOffset: Part's locationSpot must be real: "+h.toString());var l=k.Fa,d=0;k.nb&&(d=k.Sg);f.Ut(0,0,l.width+d,l.height+d,h);if(k!==a)for(k.nb&&f.offset(-d/2,-d/2),k.transform.xb(f),h=k.T;null!==h&&h!==a;)h.transform.xb(f),h=h.T;a.Jk.xb(f);f.offset(-a.Vc.x,-a.Vc.y);h=a.g;c.H()?(k=b.x,l=b.y,d=c.x-f.x,e=c.y-f.y,b.m(d,e),c=!1,null!==h&&(d=h.Oa,d.oj?c=!0:!d.sc||a instanceof mf||mi(d,a,"position",new w(k,l),b,!1),c||b.x===k&&b.y===
l||(d=h.lb,h.lb=!0,a.h("position",new w(k,l),b),h.lb=d))):b.H()&&(d=b.x,e=b.y,b=c.copy(),c.m(d+f.x,e+f.y),c.L(b)||null===h||(d=h.lb,h.lb=!0,a.h("location",b,c),h.lb=d));v.v(f);a.pi()}function Wj(a,b,c){Bl(a,!1);a instanceof S&&$k(c,a);a.layer.Bc||b||c.oc();b=a.kc;var d=c.tb;d.H()?(yi(a)?qb(b,d)||a.uf(!1):b.tg(d)&&a.uf(!0),a.updateAdornments()):c.Dk=!0}J.prototype.sl=function(){return!0};
function Bi(a,b){var c=a.kc;if(0!==c.width&&0!==c.height&&!isNaN(c.x)&&!isNaN(c.y)&&a.isVisible()){var d=a.transform,e=a.T,f=a.nn;f.reset();null!==e&&(e.Vf()?f.multiply(e.Ef):null!==e.T&&f.multiply(e.T.Ef));f.multiply(a.Td);null!==a.lc&&(Jl(a,b,a.lc,!0,!0),b.fillRect(c.x,c.y,c.width,c.height));null===a.lc&&null===a.Jb&&(Jl(a,b,"rgba(0,0,0,0.4)",!0,!1),b.fillRect(c.x,c.y,c.width,c.height));null!==a.Jb&&(d.nt()||b.transform(d.m11,d.m12,d.m21,d.m22,d.dx,d.dy),e=a.Fa,c=e.width,e=e.height,Jl(a,b,a.Jb,
!0,!1),b.fillRect(0,0,c+0,e+0),d.nt()||(c=1/(d.m11*d.m22-d.m12*d.m21),b.transform(d.m22*c,-d.m12*c,-d.m21*c,d.m11*c,c*(d.m21*d.dy-d.m22*d.dx),c*(d.m12*d.dx-d.m11*d.dy))))}}J.prototype.Ld=function(){return!0};
v.defineProperty(J,{Mc:"category"},function(){return this.ei},function(a){var b=this.ei;if(b!==a){v.j(a,"string",J,"category");var c=this.g,d=this.data,e=null;if(null!==c&&null!==d&&!(this instanceof mf)){var f=c.da.ja;f.isEnabled&&!f.ib&&(e=this.clone(),e.wa.Yc(this.wa))}this.ei=a;this.h("category",b,a);null===c||null===d||this instanceof mf?(e=this.Sh,null!==e&&(a=e.ci,null!==a&&a.remove(b),e.Uk(this.Mc,this))):(f=c.da,f.ja.ib||(this instanceof W?(f instanceof Q?f.kF(d,a):f instanceof te&&f.UI(d,
a),c=Mk(c,a),null!==c&&(of(c),c=c.copy(),null!==c&&ao(this,c,b,a))):(null!==f&&f.sx(d,a),c=Jk(c,d,a),null!==c&&(of(c),c=c.copy(),null===c||c instanceof W||(c.location=this.location,ao(this,c,b,a)))),null!==e&&(b=this.clone(),b.wa.Yc(this.wa),this.h("self",e,b))))}});v.defineProperty(J,{self:"self"},function(){return this},function(a){ao(this,a,this.Mc,a.Mc)});var bo=!1;
function ao(a,b,c,d){b.constructor===a.constructor||bo||(bo=!0,v.trace('Should not change the class of the Part when changing category from "'+c+'" to "'+d+'"'),v.trace("  Old class: "+v.nf(a)+", new class: "+v.nf(b)+", part: "+a.toString()));a.Os();var e=a.data;c=a.tf;var f=a.hb,h=a.Yg,k=!0,l=!0,m=!1;if(a instanceof S)var n=a,k=n.Ui,l=n.od,m=n.cu;b.Vh(a);b.cloneProtected(a);a.ei=d;a.P();a.pa();b=a.g;d=!0;null!==b&&(d=b.lb,b.lb=!0);a.uh=e;null!==e&&a.Ib();null!==b&&(b.lb=d);e=a.tf;e!==c&&(a.Gk=c,
a.tf=e);a instanceof S&&(n=a,n.Ui=k,n.od=l,n.cu=m,n.Ld()&&n.G(64));a.hb=f;a.Yg=h}J.prototype.canCopy=function(){if(!this.SG)return!1;var a=this.layer;if(null===a)return!0;if(!a.Qj)return!1;a=a.g;return null===a?!0:a.Qj?!0:!1};J.prototype.canDelete=function(){if(!this.ZG)return!1;var a=this.layer;if(null===a)return!0;if(!a.Am)return!1;a=a.g;return null===a?!0:a.Am?!0:!1};
J.prototype.canEdit=function(){if(!this.dJ)return!1;var a=this.layer;if(null===a)return!0;if(!a.nw)return!1;a=a.g;return null===a?!0:a.nw?!0:!1};J.prototype.canGroup=function(){if(!this.AH)return!1;var a=this.layer;if(null===a)return!0;if(!a.kw)return!1;a=a.g;return null===a?!0:a.kw?!0:!1};J.prototype.canMove=function(){if(!this.rI)return!1;var a=this.layer;if(null===a)return!0;if(!a.Yk)return!1;a=a.g;return null===a?!0:a.Yk?!0:!1};
J.prototype.canReshape=function(){if(!this.FI)return!1;var a=this.layer;if(null===a)return!0;if(!a.lw)return!1;a=a.g;return null===a?!0:a.lw?!0:!1};J.prototype.canResize=function(){if(!this.GI)return!1;var a=this.layer;if(null===a)return!0;if(!a.Ls)return!1;a=a.g;return null===a?!0:a.Ls?!0:!1};J.prototype.canRotate=function(){if(!this.JI)return!1;var a=this.layer;if(null===a)return!0;if(!a.mw)return!1;a=a.g;return null===a?!0:a.mw?!0:!1};
J.prototype.canSelect=function(){if(!this.zl)return!1;var a=this.layer;if(null===a)return!0;if(!a.lf)return!1;a=a.g;return null===a?!0:a.lf?!0:!1};v.defineProperty(J,{SG:"copyable"},function(){return 0!==(this.Q&1)},function(a){var b=0!==(this.Q&1);b!==a&&(this.Q^=1,this.h("copyable",b,a))});v.defineProperty(J,{ZG:"deletable"},function(){return 0!==(this.Q&2)},function(a){var b=0!==(this.Q&2);b!==a&&(this.Q^=2,this.h("deletable",b,a))});
v.defineProperty(J,{dJ:"textEditable"},function(){return 0!==(this.Q&4)},function(a){var b=0!==(this.Q&4);b!==a&&(this.Q^=4,this.h("textEditable",b,a),this.Zd())});v.defineProperty(J,{AH:"groupable"},function(){return 0!==(this.Q&8)},function(a){var b=0!==(this.Q&8);b!==a&&(this.Q^=8,this.h("groupable",b,a))});v.defineProperty(J,{rI:"movable"},function(){return 0!==(this.Q&16)},function(a){var b=0!==(this.Q&16);b!==a&&(this.Q^=16,this.h("movable",b,a))});
v.defineProperty(J,{QI:"selectionAdorned"},function(){return 0!==(this.Q&32)},function(a){var b=0!==(this.Q&32);b!==a&&(this.Q^=32,this.h("selectionAdorned",b,a),this.Zd())});v.defineProperty(J,{Sz:"isInDocumentBounds"},function(){return 0!==(this.Q&64)},function(a){var b=0!==(this.Q&64);if(b!==a){this.Q^=64;var c=this.g;null!==c&&c.oc();this.h("isInDocumentBounds",b,a)}});
v.defineProperty(J,{wE:"isLayoutPositioned"},function(){return 0!==(this.Q&128)},function(a){var b=0!==(this.Q&128);b!==a&&(this.Q^=128,this.h("isLayoutPositioned",b,a),this.G(a?4:8))});v.defineProperty(J,{zl:"selectable"},function(){return 0!==(this.Q&256)},function(a){var b=0!==(this.Q&256);b!==a&&(this.Q^=256,this.h("selectable",b,a),this.Zd())});
v.defineProperty(J,{FI:"reshapable"},function(){return 0!==(this.Q&512)},function(a){var b=0!==(this.Q&512);b!==a&&(this.Q^=512,this.h("reshapable",b,a),this.Zd())});v.defineProperty(J,{GI:"resizable"},function(){return 0!==(this.Q&1024)},function(a){var b=0!==(this.Q&1024);b!==a&&(this.Q^=1024,this.h("resizable",b,a),this.Zd())});v.defineProperty(J,{JI:"rotatable"},function(){return 0!==(this.Q&2048)},function(a){var b=0!==(this.Q&2048);b!==a&&(this.Q^=2048,this.h("rotatable",b,a),this.Zd())});
v.defineProperty(J,{hb:"isSelected"},function(){return 0!==(this.Q&4096)},function(a){var b=0!==(this.Q&4096);if(b!==a){var c=this.g;if(!a||this.canSelect()&&!(null!==c&&c.selection.count>=c.iI)){this.Q^=4096;var d=!1;if(null!==c){d=c.lb;c.lb=!0;var e=c.selection;e.Na();a?e.add(this):e.remove(this);e.freeze()}this.h("isSelected",b,a);this.Zd();a=this.SI;null!==a&&a(this);null!==c&&(c.de(),c.lb=d)}}});
v.defineProperty(J,{Yg:"isHighlighted"},function(){return 0!==(this.Q&524288)},function(a){var b=0!==(this.Q&524288);if(b!==a){this.Q^=524288;var c=this.g;null!==c&&(c=c.Kw,c.Na(),a?c.add(this):c.remove(this),c.freeze());this.h("isHighlighted",b,a);this.pa()}});v.defineProperty(J,{tl:"isShadowed"},function(){return 0!==(this.Q&8192)},function(a){var b=0!==(this.Q&8192);b!==a&&(this.Q^=8192,this.h("isShadowed",b,a),this.pa())});function Lj(a){return 0!==(a.Q&32768)}
function Wn(a,b){a.Q=b?a.Q|32768:a.Q&-32769}function Bl(a,b){a.Q=b?a.Q|65536:a.Q&-65537}function yi(a){return 0!==(a.Q&131072)}J.prototype.uf=function(a){this.Q=a?this.Q|131072:this.Q&-131073};function co(a,b){a.Q=b?a.Q|1048576:a.Q&-1048577}v.defineProperty(J,{oE:"isAnimated"},function(){return 0!==(this.Q&262144)},function(a){var b=0!==(this.Q&262144);b!==a&&(this.Q^=262144,this.h("isAnimated",b,a))});
v.defineProperty(J,{yA:"selectionObjectName"},function(){return this.es},function(a){var b=this.es;b!==a&&(this.es=a,this.sm=null,this.h("selectionObjectName",b,a))});v.defineProperty(J,{RI:"selectionAdornmentTemplate"},function(){return this.cs},function(a){var b=this.cs;b!==a&&(this instanceof W&&(a.type=dh),this.cs=a,this.h("selectionAdornmentTemplate",b,a))});
v.u(J,{Qt:"selectionObject"},function(){if(null===this.sm){var a=this.yA;null!==a&&""!==a?(a=this.Yd(a),this.sm=null!==a?a:this):this instanceof W?(a=this.path,this.sm=null!==a?a:this):this.sm=this}return this.sm});v.defineProperty(J,{SI:"selectionChanged"},function(){return this.ds},function(a){var b=this.ds;b!==a&&(null!==a&&v.j(a,"function",J,"selectionChanged"),this.ds=a,this.h("selectionChanged",b,a))});
v.defineProperty(J,{YE:"resizeAdornmentTemplate"},function(){return this.Qr},function(a){var b=this.Qr;b!==a&&(this.Qr=a,this.h("resizeAdornmentTemplate",b,a))});v.defineProperty(J,{$E:"resizeObjectName"},function(){return this.Sr},function(a){var b=this.Sr;b!==a&&(this.Sr=a,this.mo=null,this.h("resizeObjectName",b,a))});v.u(J,{ZE:"resizeObject"},function(){if(null===this.mo){var a=this.$E;null!==a&&""!==a?(a=this.Yd(a),this.mo=null!==a?a:this):this.mo=this}return this.mo});
v.defineProperty(J,{HI:"resizeCellSize"},function(){return this.Rr},function(a){var b=this.Rr;b.L(a)||(this.Rr=a=a.aa(),this.h("resizeCellSize",b,a))});v.defineProperty(J,{KI:"rotateAdornmentTemplate"},function(){return this.Tr},function(a){var b=this.Tr;b!==a&&(this.Tr=a,this.h("rotateAdornmentTemplate",b,a))});v.defineProperty(J,{LI:"rotateObjectName"},function(){return this.Ur},function(a){var b=this.Ur;b!==a&&(this.Ur=a,this.no=null,this.h("rotateObjectName",b,a))});
v.u(J,{bF:"rotateObject"},function(){if(null===this.no){var a=this.LI;null!==a&&""!==a?(a=this.Yd(a),this.no=null!==a?a:this):this.no=this}return this.no});v.defineProperty(J,{text:"text"},function(){return this.ie},function(a){var b=this.ie;b!==a&&(this.ie=a,this.h("text",b,a))});
v.defineProperty(J,{Sa:"containingGroup"},function(){return this.uk},function(a){if(this.Ld()){var b=this.uk;if(b!==a){null===a||this!==a&&!a.Yh(this)||(this===a&&v.k("Cannot make a Group a member of itself: "+this.toString()),v.k("Cannot make a Group indirectly contain itself: "+this.toString()+" already contains "+a.toString()));this.G(ak);var c=this.g;null!==b?eo(b,this):this instanceof T&&null!==c&&c.Sk.remove(this);this.uk=a;null!==a?fo(a,this):this instanceof T&&null!==c&&c.Sk.add(this);this.G(Sj);
if(null!==c){var d=this.data,e=c.da;null!==d&&e instanceof Q&&e.ux(d,e.mb(null!==a?a.data:null))}d=this.JD;null!==d&&(e=!0,null!==c&&(e=c.Qa,c.Qa=!0),d(this,b,a),null!==c&&(c.Qa=e));if(this instanceof T)for(c=new H(J),lf(c,this,!0,0,!0),c=c.i;c.next();)if(d=c.value,d instanceof S)for(d=d.ne;d.next();)Hk(d.value);if(this instanceof S)for(d=this.ne;d.next();)Hk(d.value);this.h("containingGroup",b,a);null!==a&&(b=a.layer,null!==b&&Qi(b,-1,a))}}else v.k("cannot set the Part.containingGroup of a Link or Adornment")});
g=J.prototype;g.ol=function(){var a=this.Sa;null!==a&&(a.P(),null!==a.Hb&&a.Hb.P(),a.invalidateConnectedLinks())};g.pa=function(){var a=this.g;null!==a&&!Kj(this)&&!Lj(this)&&this.isVisible()&&this.kc.H()&&a.pa(Pi(this,this.kc))};g.it=function(a){a||(a=this.uk,null!==a&&fo(a,this))};g.jt=function(a){a||(a=this.uk,null!==a&&eo(a,this))};g.Nm=function(){var a=this.data;if(null!==a){var b=this.g;null!==b&&(b=b.da,null!==b&&b.mx(a))}};
v.defineProperty(J,{JD:"containingGroupChanged"},function(){return this.eq},function(a){var b=this.eq;b!==a&&(null!==a&&v.j(a,"function",J,"containingGroupChanged"),this.eq=a,this.h("containingGroupChanged",b,a))});J.prototype.findSubGraphLevel=function(){return ho(this,this)};function ho(a,b){var c=b.Sa;return null!==c?1+ho(a,c):b instanceof S&&(c=b.ce,null!==c)?ho(a,c):0}J.prototype.findTopLevelPart=function(){return io(this,this)};
function io(a,b){var c=b.Sa;return null!==c?io(a,c):b instanceof S&&(c=b.ce,null!==c)?io(a,c):b}v.u(J,{bp:"isTopLevel"},function(){return null!==this.Sa||this instanceof S&&this.qf?!1:!0});J.prototype.isMemberOf=J.prototype.Yh=function(a){return a instanceof T?jo(this,this,a):!1};function jo(a,b,c){if(b===c||null===c)return!1;var d=b.Sa;return null===d||d!==c&&!jo(a,d,c)?b instanceof S&&(b=b.ce,null!==b)?jo(a,b,c):!1:!0}
J.prototype.findCommonContainingGroup=J.prototype.iH=function(a){if(null===a)return null;if(this===a)return this.Sa;for(var b=this;null!==b;)b instanceof T&&co(b,!0),b=b.Sa;for(var c=null,b=a;null!==b;){if(0!==(b.Q&1048576)){c=b;break}b=b.Sa}for(b=this;null!==b;)b instanceof T&&co(b,!1),b=b.Sa;return c};v.defineProperty(J,{ZH:"layoutConditions"},function(){return this.$q},function(a){var b=this.$q;b!==a&&(this.$q=a,this.h("layoutConditions",b,a))});
J.prototype.canLayout=function(){if(!this.wE||!this.isVisible())return!1;var a=this.layer;return null!==a&&a.Bc||this instanceof S&&this.qf?!1:!0};J.prototype.invalidateLayout=J.prototype.G=function(a){void 0===a&&(a=16777215);var b;this.wE&&0!==(a&this.ZH)?(b=this.layer,null!==b&&b.Bc||this instanceof S&&this.qf?b=!1:(b=this.g,b=null!==b&&b.ja.ib?!1:!0)):b=!1;if(b)if(b=this.uk,null!==b){var c=b.Pb;null!==c?c.G():b.G(a)}else a=this.g,null!==a&&(c=a.Pb,null!==c&&c.G())};
function Xj(a){if(!a.isVisible())return!1;a=a.layer;return null!==a&&a.Bc?!1:!0}v.defineProperty(J,{UD:"dragComputation"},function(){return this.uq},function(a){var b=this.uq;b!==a&&(null!==a&&v.j(a,"function",J,"dragComputation"),this.uq=a,this.h("dragComputation",b,a))});v.defineProperty(J,{XI:"shadowOffset"},function(){return this.tm},function(a){var b=this.tm;b.L(a)||(this.tm=a=a.aa(),this.pa(),this.h("shadowOffset",b,a))});
v.defineProperty(J,{shadowColor:"shadowColor"},function(){return this.Rg},function(a){var b=this.Rg;b!==a&&(this.Rg=a,this.pa(),this.h("shadowColor",b,a))});v.defineProperty(J,{shadowBlur:"shadowBlur"},function(){return this.Mh},function(a){var b=this.Mh;b!==a&&(this.Mh=a,this.pa(),this.h("shadowBlur",b,a))});function mf(a){0===arguments.length?J.call(this,yh):J.call(this,a);this.tf="Adornment";this.Eb=null;this.Q&=-257;this.Kg=new w(NaN,NaN);this.ej=new G(z);this.Hb=null}v.Ga(mf,J);
v.ga("Adornment",mf);mf.prototype.toString=function(){var a=this.Sh;return"Adornment("+this.Mc+")"+(null!==a?a.toString():"")};mf.prototype.updateRelationshipsFromData=function(){};mf.prototype.wt=function(a){var b=this.ec.V,c=this.ec;if(b instanceof W&&c instanceof X){var d=b.path,c=d.Ta;b.wt(a);c=d.Ta;a=this.wa.n;b=a.length;for(d=0;d<b;d++){var e=a[d];e.Lf&&e instanceof X&&(e.Ta=c)}}};v.u(mf,{placeholder:"placeholder"},function(){return this.Hb});
v.defineProperty(mf,{ec:"adornedObject"},function(){return this.Eb},function(a){var b=this.Sh,c=null;null!==a&&(c=a.V);null===b||null!==a&&b===c||b.yl(this.Mc);this.Eb=a;null!==c&&c.Uk(this.Mc,this)});v.u(mf,{Sh:"adornedPart"},function(){var a=this.Eb;return null!==a?a.V:null});mf.prototype.sl=function(){var a=this.Eb;if(null===a)return!0;a=a.V;return null===a||!Kj(a)};mf.prototype.Ld=function(){return!1};v.u(mf,{Sa:"containingGroup"},function(){return null});
mf.prototype.bn=function(a,b,c,d,e,f,h){if(a===Qd&&"elements"===b)if(e instanceof sh){var k=e;null===this.Hb?this.Hb=k:this.Hb!==k&&v.k("Cannot insert a second Placeholder into the visual tree of an Adornment.")}else e instanceof C&&(k=e.Vs(function(a){return a instanceof sh}),k instanceof sh&&(null===this.Hb?this.Hb=k:this.Hb!==k&&v.k("Cannot insert a second Placeholder into the visual tree of an Adornment.")));else a===be&&"elements"===b&&null!==this.Hb&&(d===this.Hb?this.Hb=null:d instanceof C&&
this.Hb.rl(d)&&(this.Hb=null));J.prototype.bn.call(this,a,b,c,d,e,f,h)};mf.prototype.updateAdornments=function(){};mf.prototype.Nm=function(){};function S(a){0===arguments.length?J.call(this,yh):J.call(this,a);this.dc=new G(W);this.Zn=this.Ik=this.br=this.ar=null;this.Tq=!0;this.Bs=!1;this.ws=null;this.Yp=this.Uq=!0;this.Zp=K.QF;this.Sd=this.rh=null;this.Ir=ko;this.Nj=!1}v.Ga(S,J);v.ga("Node",S);
S.prototype.cloneProtected=function(a){J.prototype.cloneProtected.call(this,a);a.ar=this.ar;a.br=this.br;a.Ik=this.Ik;a.Tq=this.Tq;a.Bs=this.Bs;a.ws=this.ws;a.Uq=this.Uq;a.Yp=this.Yp;a.Zp=this.Zp.aa();a.Ir=this.Ir};S.prototype.Vh=function(a){J.prototype.Vh.call(this,a);a.invalidateConnectedLinks();a.rh=this.rh;a.Sd=null};var lo;S.DirectionDefault=lo=v.p(S,"DirectionDefault",0);S.DirectionAbsolute=v.p(S,"DirectionAbsolute",1);var mo;S.DirectionRotatedNode=mo=v.p(S,"DirectionRotatedNode",2);var sl;
S.DirectionRotatedNodeOrthogonal=sl=v.p(S,"DirectionRotatedNodeOrthogonal",3);S.SpreadingNone=v.p(S,"SpreadingNone",10);var ko;S.SpreadingEvenly=ko=v.p(S,"SpreadingEvenly",11);var no;S.SpreadingPacked=no=v.p(S,"SpreadingPacked",12);function oo(a,b){null!==b&&(null===a.rh&&(a.rh=new H($i)),a.rh.add(b))}
function po(a,b,c,d){if(null===b||null===a.rh)return null;for(var e=a.rh.i;e.next();){var f=e.value;if(f.op===a&&f.Ct===b&&f.gx===c&&f.hx===d||f.op===b&&f.Ct===a&&f.gx===d&&f.hx===c)return f}return null}S.prototype.invalidateLinkBundle=function(a,b,c){if(void 0===b||null===b)b="";if(void 0===c||null===c)c="";a=po(this,a,b,c);null!==a&&a.Tm()};
S.prototype.bn=function(a,b,c,d,e,f,h){a===Qd&&"elements"===b?this.Sd=null:a===be&&"elements"===b&&(null===this.g?this.Sd=null:d instanceof R&&Zm(this,d,function(a,b){Wl(a,b,!0)}));J.prototype.bn.call(this,a,b,c,d,e,f,h)};S.prototype.invalidateConnectedLinks=function(a){void 0===a&&(a=null);for(var b=this.ne;b.next();){var c=b.value;null!==a&&a.contains(c)||(qo(this,c.$c),qo(this,c.Bd),c.gc())}};function qo(a,b){if(null!==b){b.lm=null;var c=a.Sa;null===c||c.be||qo(c,c.hl(""))}}S.prototype.sl=function(){return!0};
v.defineProperty(S,{zI:"portSpreading"},function(){return this.Ir},function(a){var b=this.Ir;b!==a&&(this.Ir=a,this.h("portSpreading",b,a),a=this.g,null!==a&&a.ja.ib||this.invalidateConnectedLinks())});v.defineProperty(S,{zD:"avoidable"},function(){return this.Yp},function(a){var b=this.Yp;if(b!==a){this.Yp=a;var c=this.g;null!==c&&$k(c,this);this.h("avoidable",b,a)}});
v.defineProperty(S,{AG:"avoidableMargin"},function(){return this.Zp},function(a){"number"===typeof a?a=new tb(a):v.C(a,tb,S,"avoidableMargin");var b=this.Zp;if(!b.L(a)){this.Zp=a=a.aa();var c=this.g;null!==c&&$k(c,this);this.h("avoidableMargin",b,a)}});S.prototype.canAvoid=function(){return this.zD&&!this.qf};S.prototype.getAvoidableRect=function(a){a.set(this.Z);a.hw(this.AG);return a};S.prototype.findVisibleNode=function(){for(var a=this;null!==a&&!a.isVisible();)a=a.Sa;return a};
S.prototype.isVisible=function(){if(!J.prototype.isVisible.call(this))return!1;var a=!0,b=!0,c=this.g;if(null!==c){a=c.Oa;if(a.pf&&(a=a.ay.la(this),null!==a&&a.kx))return!0;a=c.Md;b=c.MA===Wi}if(b){if(c=this.Pm(),null!==c&&!c.od)return!1}else if(c=a?this.kH():this.lH(),0<c.count&&c.all(function(a){return!a.od}))return!1;c=this.ce;return null!==c?c.isVisible():!0};S.prototype.oe=function(a){J.prototype.oe.call(this,a);for(var b=this.ne;b.next();)b.value.oe(a)};v.u(S,{ne:"linksConnected"},function(){return this.dc.i});
S.prototype.findLinksConnected=S.prototype.YD=function(a){void 0===a&&(a=null);if(null===a)return this.dc.i;var b=new La(this.dc),c=this;b.$m=function(b){return b.U===c&&b.rg===a||b.ba===c&&b.oh===a};return b};S.prototype.findLinksOutOf=S.prototype.Fw=function(a){void 0===a&&(a=null);var b=new La(this.dc),c=this;b.$m=function(b){return b.U!==c?!1:null===a?!0:b.rg===a};return b};
S.prototype.findLinksInto=S.prototype.qg=function(a){void 0===a&&(a=null);var b=new La(this.dc),c=this;b.$m=function(b){return b.ba!==c?!1:null===a?!0:b.oh===a};return b};
S.prototype.findNodesConnected=S.prototype.ZD=function(a){void 0===a&&(a=null);for(var b=null,c=null,d=this.dc.i;d.next();){var e=d.value;if(e.U===this){if(null===a||e.rg===a)e=e.ba,null!==b?b.add(e):null!==c&&c!==e?(b=new H(S),b.add(c),b.add(e)):c=e}else e.ba!==this||null!==a&&e.oh!==a||(e=e.U,null!==b?b.add(e):null!==c&&c!==e?(b=new H(S),b.add(c),b.add(e)):c=e)}return null!==b?b.i:null!==c?new Ja(c):Ia};
S.prototype.findNodesOutOf=S.prototype.lH=function(a){void 0===a&&(a=null);for(var b=null,c=null,d=this.dc.i;d.next();){var e=d.value;e.U!==this||null!==a&&e.rg!==a||(e=e.ba,null!==b?b.add(e):null!==c&&c!==e?(b=new H(S),b.add(c),b.add(e)):c=e)}return null!==b?b.i:null!==c?new Ja(c):Ia};
S.prototype.findNodesInto=S.prototype.kH=function(a){void 0===a&&(a=null);for(var b=null,c=null,d=this.dc.i;d.next();){var e=d.value;e.ba!==this||null!==a&&e.oh!==a||(e=e.U,null!==b?b.add(e):null!==c&&c!==e?(b=new H(S),b.add(c),b.add(e)):c=e)}return null!==b?b.i:null!==c?new Ja(c):Ia};
S.prototype.findLinksBetween=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=null);var d=new La(this.dc),e=this;d.$m=function(d){return(d.U!==e||d.ba!==a||null!==b&&d.rg!==b||null!==c&&d.oh!==c)&&(d.U!==a||d.ba!==e||null!==c&&d.rg!==c||null!==b&&d.oh!==b)?!1:!0};return d};S.prototype.findLinksTo=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=null);var d=new La(this.dc),e=this;d.$m=function(d){return d.U!==e||d.ba!==a||null!==b&&d.rg!==b||null!==c&&d.oh===c?!1:!0};return d};
v.defineProperty(S,{aI:"linkConnected"},function(){return this.ar},function(a){var b=this.ar;b!==a&&(null!==a&&v.j(a,"function",S,"linkConnected"),this.ar=a,this.h("linkConnected",b,a))});v.defineProperty(S,{bI:"linkDisconnected"},function(){return this.br},function(a){var b=this.br;b!==a&&(null!==a&&v.j(a,"function",S,"linkDisconnected"),this.br=a,this.h("linkDisconnected",b,a))});
v.defineProperty(S,{Yw:"linkValidation"},function(){return this.Ik},function(a){var b=this.Ik;b!==a&&(null!==a&&v.j(a,"function",S,"linkValidation"),this.Ik=a,this.h("linkValidation",b,a))});
function ro(a,b,c){qo(a,c);if(!a.dc.contains(b)){a.dc.add(b);var d=a.aI;if(null!==d){var e=!0,f=a.g;null!==f&&(e=f.Qa,f.Qa=!0);d(a,b,c);null!==f&&(f.Qa=e)}b.Cc&&(c=b.U,b=b.ba,null!==c&&null!==b&&c!==b&&(d=!0,f=a.g,null!==f&&(d=f.Md),a=d?b:c,e=d?c:b,a.Nj||(a.Nj=e),!e.Ui||null!==f&&f.ja.ib||(d?c===e&&(e.Ui=!1):b===e&&(e.Ui=!1))))}}
function so(a,b,c){qo(a,c);if(a.dc.remove(b)){var d=a.bI,e=a.g;if(null!==d){var f=!0;null!==e&&(f=e.Qa,e.Qa=!0);d(a,b,c);null!==e&&(e.Qa=f)}b.Cc&&(c=!0,null!==e&&(c=e.Md),a=c?b.ba:b.U,b=c?b.U:b.ba,null!==a&&(a.Nj=!1),null===b||b.Ui||(0===b.dc.count?(b.Nj=null,null!==e&&e.ja.ib||(b.Ui=!0)):Tk(b)))}}
function Tk(a){a.Nj=!1;if(0!==a.dc.count){var b=!0,c=a.g;if(null===c||!c.ja.ib){null!==c&&(b=c.Md);for(c=a.dc.i;c.next();){var d=c.value;if(d.Cc)if(b){if(d.U===a){a.Ui=!1;return}}else if(d.ba===a){a.Ui=!1;return}}a.Ui=!0}}}
S.prototype.updateRelationshipsFromData=function(){J.prototype.updateRelationshipsFromData.call(this);var a=this.data;if(null!==a){var b=this.g;if(null!==b){var c=b.da;if(c instanceof te){var d=c.Sm(a),b=b.We(d),e=this.Pm();b!==e&&(b=null!==e?c.mb(e.data):void 0,e=c.qp,"function"===typeof e?e(a,b):a[e]=b,c.mh(a,d))}}}};S.prototype.it=function(a){J.prototype.it.call(this,a);a||(Tk(this),a=this.Zn,null!==a&&to(a,this))};
S.prototype.jt=function(a){J.prototype.jt.call(this,a);a||(a=this.Zn,null!==a&&null!==a.we&&(a.we.remove(this),a.P()))};S.prototype.Nm=function(){if(0<this.dc.count){var a=this.g;if(null!==a)for(var b=a.rb.TD,c=this.dc.copy().i;c.next();){var d=c.value;b?a.remove(d):(d.U===this&&(d.U=null),d.ba===this&&(d.ba=null))}}this.ce=null;J.prototype.Nm.call(this)};v.u(S,{qf:"isLinkLabel"},function(){return null!==this.Zn});
v.defineProperty(S,{ce:"labeledLink"},function(){return this.Zn},function(a){var b=this.Zn;if(b!==a){var c=this.g,d=this.data;if(null!==b&&(null!==b.we&&(b.we.remove(this),b.P()),null!==c&&null!==d&&!c.ja.ib)){var e=b.data,f=c.da;if(null!==e&&f instanceof Q){var h=f.mb(d);void 0!==h&&f.TE(e,h)}}this.Zn=a;null!==a&&(to(a,this),null===c||null===d||c.ja.ib||(e=a.data,f=c.da,null!==e&&f instanceof Q&&(h=f.mb(d),void 0!==h&&f.jz(e,h))));Pl(this);this.h("labeledLink",b,a)}});
S.prototype.findPort=S.prototype.hl=function(a){if(null===this.Sd){if(""===a&&!1===this.Bh)return this;Xl(this)}var b=this.Sd.la(a);return null!==b||""!==a&&(b=this.Sd.la(""),null!==b)?b:this};v.u(S,{port:"port"},function(){return this.hl("")});v.u(S,{ports:"ports"},function(){null===this.Sd&&Xl(this);return this.Sd.zE});function Xl(a){null===a.Sd?a.Sd=new ma("string",R):a.Sd.clear();Zm(a,a,function(a,c){var d=c.Od;null!==d&&a.Sd.add(d,c)});0===a.Sd.count&&a.Sd.add("",a)}
function Wl(a,b,c){var d=b.Od;if(null!==d&&(null!==a.Sd&&a.Sd.remove(d),b=a.g,null!==b&&c)){c=null;for(d=a.YD(d);d.next();)a=d.value,null===c&&(c=v.jb()),c.push(a);if(null!==c){for(d=0;d<c.length;d++)a=c[d],b.remove(a);v.ra(c)}}}
S.prototype.isInTreeOf=function(a){if(null===a||a===this)return!1;var b=!0,c=this.g;null!==c&&(b=c.Md);c=this;if(b)for(;c!==a;){for(var b=null,d=c.dc.i;d.next();){var e=d.value;if(e.Cc&&(b=e.U,b!==c&&b!==this))break}if(b===this||null===b||b===c)return!1;c=b}else for(;c!==a;){b=null;for(d=c.dc.i;d.next()&&(e=d.value,!e.Cc||(b=e.ba,b===c||b===this)););if(b===this||null===b||b===c)return!1;c=b}return!0};
S.prototype.findTreeRoot=function(){var a=!0,b=this.g;null!==b&&(a=b.Md);b=this;if(a)for(;;){for(var a=null,c=b.dc.i;c.next();){var d=c.value;if(d.Cc&&(a=d.U,a!==b&&a!==this))break}if(a===this)return this;if(null===a||a===b)return b;b=a}else for(;;){a=null;for(c=b.dc.i;c.next()&&(d=c.value,!d.Cc||(a=d.ba,a===b||a===this)););if(a===this)return this;if(null===a||a===b)return b;b=a}};
S.prototype.findCommonTreeParent=function(a){if(null===a)return null;if(this===a)return this;for(var b=this;null!==b;)co(b,!0),b=b.Pm();for(var c=null,b=a;null!==b;){if(0!==(b.Q&1048576)){c=b;break}b=b.Pm()}for(b=this;null!==b;)co(b,!1),b=b.Pm();return c};S.prototype.findTreeParentLink=S.prototype.$s=function(){var a=!0,b=this.g;null!==b&&(a=b.Md);b=this.dc.i;if(a)for(;b.next();){if(a=b.value,a.Cc&&a.U!==this)return a}else for(;b.next();)if(a=b.value,a.Cc&&a.ba!==this)return a;return null};
S.prototype.findTreeParentNode=S.prototype.Pm=function(){var a=this.Nj;if(null===a)return null;if(a instanceof S)return a;var b=!0,a=this.g;null!==a&&(b=a.Md);a=this.dc.i;if(b)for(;a.next();){if(b=a.value,b.Cc&&(b=b.U,b!==this))return this.Nj=b}else for(;a.next();)if(b=a.value,b.Cc&&(b=b.ba,b!==this))return this.Nj=b;return this.Nj=null};S.prototype.findTreeLevel=function(){return uo(this,this)};function uo(a,b){var c=b.Pm();return null===c?0:1+uo(a,c)}
S.prototype.findTreeChildrenLinks=S.prototype.Hw=function(){var a=!0,b=this.g;null!==b&&(a=b.Md);if(a){var a=new La(this.dc),c=this;a.$m=function(a){return a.Cc&&a.U===c?!0:!1}}else a=new La(this.dc),c=this,a.$m=function(a){return a.Cc&&a.ba===c?!0:!1};return a};
S.prototype.findTreeChildrenNodes=S.prototype.aE=function(){var a=!0,b=this.g;null!==b&&(a=b.Md);var c=b=null,d=this.dc.i;if(a)for(;d.next();)a=d.value,a.Cc&&a.U===this&&(a=a.ba,null!==b?b.add(a):null!==c&&c!==a?(b=new G(S),b.add(c),b.add(a)):c=a);else for(;d.next();)a=d.value,a.Cc&&a.ba===this&&(a=a.U,null!==b?b.add(a):null!==c&&c!==a?(b=new G(S),b.add(c),b.add(a)):c=a);return null!==b?b.i:null!==c?new Ja(c):Ia};
S.prototype.findTreeParts=function(a){void 0===a&&(a=Infinity);v.j(a,"number",S,"collapseTree:level");var b=new H(J);lf(b,this,!1,a,!0);return b};S.prototype.collapseTree=S.prototype.collapseTree=function(a){void 0===a&&(a=1);v.Te(a,S,"collapseTree:level");1>a&&(a=1);var b=this.g;if(null!==b&&!b.Xg){b.Xg=!0;var c=new H(S);c.add(this);vo(this,c,b.Md,a,b.Oa,this,b.MA===Wi);b.Xg=!1}};
function vo(a,b,c,d,e,f,h){if(1<d)for(var k=c?a.Fw():a.qg();k.next();){var l=k.value;l.Cc&&(l=l.Jz(a),null===l||l===a||b.contains(l)||(b.add(l),vo(l,b,c,d-1,e,f,h)))}else wo(a,b,c,e,f,h)}function wo(a,b,c,d,e,f){for(var h=e===a?!0:a.od,k=c?a.Fw():a.qg();k.next();){var l=k.value;l.Cc&&(l=l.Jz(a),null===l||l===a||b.contains(l)||(b.add(l),h&&(f&&vi(d,l,e),l.ol(),l.oe(!1)),l.od&&(l.cu=l.od,wo(l,b,c,d,e,f))))}a.od=!1}
S.prototype.expandTree=S.prototype.expandTree=function(a){void 0===a&&(a=2);v.Te(a,S,"expandTree:level");2>a&&(a=2);var b=this.g;if(null!==b&&!b.Xg){b.Xg=!0;var c=new H(S);c.add(this);xo(this,c,b.Md,a,b.Oa,this,b.MA===Wi);b.Xg=!1}};function xo(a,b,c,d,e,f,h){for(var k=f===a?!1:a.od,l=c?a.Fw():a.qg();l.next();){var m=l.value;m.Cc&&(k||m.Df||m.gc(),m=m.Jz(a),null!==m&&m!==a&&!b.contains(m)&&(b.add(m),k||(m.oe(!0),m.ol(),h&&ui(e,m,f)),2<d||m.cu))&&(m.cu=!1,xo(m,b,c,d-1,e,f,h))}a.od=!0}
v.defineProperty(S,{od:"isTreeExpanded"},function(){return this.Tq},function(a){var b=this.Tq;if(b!==a){this.Tq=a;var c=this.g;this.h("isTreeExpanded",b,a);b=this.kJ;if(null!==b){var d=!0;null!==c&&(d=c.Qa,c.Qa=!0);b(this);null!==c&&(c.Qa=d)}null!==c&&c.ja.ib||(a?this.expandTree():this.collapseTree())}});v.defineProperty(S,{cu:"wasTreeExpanded"},function(){return this.Bs},function(a){var b=this.Bs;b!==a&&(this.Bs=a,this.h("wasTreeExpanded",b,a))});
v.defineProperty(S,{kJ:"treeExpandedChanged"},function(){return this.ws},function(a){var b=this.ws;b!==a&&(null!==a&&v.j(a,"function",S,"treeExpandedChanged"),this.ws=a,this.h("treeExpandedChanged",b,a))});v.defineProperty(S,{Ui:"isTreeLeaf"},function(){return this.Uq},function(a){var b=this.Uq;b!==a&&(this.Uq=a,this.h("isTreeLeaf",b,a))});
function W(){J.call(this,dh);this.Yf=null;this.Ah="";this.jg=this.Cq=null;this.Qh="";this.vs=null;this.Pr=this.Nr=this.Mr=!1;this.Vq=!0;this.Sp=gh;this.iq=0;this.lq=gh;this.mq=NaN;this.nm=gm;this.ls=.5;this.we=null;this.Wc=(new G(w)).freeze();this.oo=this.ye=null;this.Df=!1;this.Cv=null;this.Zy=!1;this.En=this.An=this.di=this.oi=this.Ta=null;this.ej=new G(z);this.cz=new w;this.WC=this.UC=null;this.Wx=!1;this.S=null}v.Ga(W,J);v.ga("Link",W);
W.prototype.cloneProtected=function(a){J.prototype.cloneProtected.call(this,a);a.Ah=this.Ah;a.Cq=this.Cq;a.Qh=this.Qh;a.vs=this.vs;a.Mr=this.Mr;a.Nr=this.Nr;a.Pr=this.Pr;a.Vq=this.Vq;a.Sp=this.Sp;a.iq=this.iq;a.lq=this.lq;a.mq=this.mq;a.nm=this.nm;a.ls=this.ls;a.S=null!==this.S?this.S.copy():null};W.prototype.Vh=function(a){J.prototype.Vh.call(this,a);this.Ah=a.Ah;this.Qh=a.Qh;a.ye=null;a.gc();a.di=this.di};var gm;W.Normal=gm=v.p(W,"Normal",1);W.Orthogonal=v.p(W,"Orthogonal",2);
W.AvoidsNodes=v.p(W,"AvoidsNodes",6);var yo;W.AvoidsNodesStraight=yo=v.p(W,"AvoidsNodesStraight",7);var gh;W.None=gh=v.p(W,"None",0);var nh;W.Bezier=nh=v.p(W,"Bezier",9);var fh;W.JumpGap=fh=v.p(W,"JumpGap",10);var eh;W.JumpOver=eh=v.p(W,"JumpOver",11);var dm;W.End=dm=v.p(W,"End",17);var em;W.Scale=em=v.p(W,"Scale",18);var fm;W.Stretch=fm=v.p(W,"Stretch",19);var qn;W.OrientAlong=qn=v.p(W,"OrientAlong",21);var zo;W.OrientPlus90=zo=v.p(W,"OrientPlus90",22);var Ao;
W.OrientMinus90=Ao=v.p(W,"OrientMinus90",23);var Bo;W.OrientOpposite=Bo=v.p(W,"OrientOpposite",24);var Co;W.OrientUpright=Co=v.p(W,"OrientUpright",25);var Do;W.OrientPlus90Upright=Do=v.p(W,"OrientPlus90Upright",26);var Eo;W.OrientMinus90Upright=Eo=v.p(W,"OrientMinus90Upright",27);var Fo;W.OrientUpright45=Fo=v.p(W,"OrientUpright45",28);W.prototype.Je=function(){this.S=new rl};
W.prototype.sl=function(){var a=this.U;if(null!==a){var b=a.findVisibleNode();null!==b&&(a=b);if(Kj(a)||Lj(a))return!1}a=this.ba;return null!==a&&(b=a.findVisibleNode(),null!==b&&(a=b),Kj(a)||Lj(a))?!1:!0};W.prototype.CA=function(){return!1};W.prototype.Ld=function(){return!1};
W.prototype.computeAngle=function(a,b,c){a=0;switch(b){default:case gh:a=0;break;case qn:a=c;break;case zo:a=c+90;break;case Ao:a=c-90;break;case Bo:a=c+180;break;case Co:a=K.Et(c);90<a&&270>a&&(a-=180);break;case Do:a=K.Et(c+90);90<a&&270>a&&(a-=180);break;case Eo:a=K.Et(c-90);90<a&&270>a&&(a-=180);break;case Fo:a=K.Et(c);if(45<a&&135>a||225<a&&315>a)return 0;90<a&&270>a&&(a-=180)}return K.Et(a)};
v.defineProperty(W,{U:"fromNode"},function(){return this.Yf},function(a){var b=this.Yf;if(b!==a){var c=this.$c;null!==b&&(this.jg!==b&&so(b,this,c),Go(this),this.G(ak));this.Yf=a;this.oi=null;this.gc();var d=this.g;if(null!==d){var e=this.data,f=d.da;if(null!==e)if(f instanceof Q){var h=null!==a?a.data:null;f.tx(e,f.mb(h))}else f instanceof te&&(h=null!==a?a.data:null,d.Md?f.mh(e,f.mb(h)):(null!==b&&f.mh(b.data,void 0),f.mh(h,f.mb(null!==this.jg?this.jg.data:null))))}e=this.$c;f=this.dE;null!==f&&
(h=!0,null!==d&&(h=d.Qa,d.Qa=!0),f(this,c,e),null!==d&&(d.Qa=h));null!==a&&(this.jg!==a&&ro(a,this,e),Ho(this),this.G(Sj));this.h("fromNode",b,a);Hk(this)}});
v.defineProperty(W,{rg:"fromPortId"},function(){return this.Ah},function(a){var b=this.Ah;if(b!==a){var c=this.$c;null!==c&&qo(this.U,c);Go(this);this.Ah=a;var d=this.$c;null!==d&&qo(this.U,d);var e=this.g;if(null!==e){var f=this.data,h=e.da;null!==f&&h instanceof Q&&h.AA(f,a)}c!==d&&(this.oi=null,this.gc(),f=this.dE,null!==f&&(h=!0,null!==e&&(h=e.Qa,e.Qa=!0),f(this,c,d),null!==e&&(e.Qa=h)));Ho(this);this.h("fromPortId",b,a)}});v.u(W,{$c:"fromPort"},function(){var a=this.Yf;return null===a?null:a.hl(this.Ah)});
v.defineProperty(W,{dE:"fromPortChanged"},function(){return this.Cq},function(a){var b=this.Cq;b!==a&&(null!==a&&v.j(a,"function",W,"fromPortChanged"),this.Cq=a,this.h("fromPortChanged",b,a))});
v.defineProperty(W,{ba:"toNode"},function(){return this.jg},function(a){var b=this.jg;if(b!==a){var c=this.Bd;null!==b&&(this.Yf!==b&&so(b,this,c),Go(this),this.G(ak));this.jg=a;this.oi=null;this.gc();var d=this.g;if(null!==d){var e=this.data,f=d.da;if(null!==e)if(f instanceof Q){var h=null!==a?a.data:null;f.wx(e,f.mb(h))}else f instanceof te&&(h=null!==a?a.data:null,d.Md?(null!==b&&f.mh(b.data,void 0),f.mh(h,f.mb(null!==this.Yf?this.Yf.data:null))):f.mh(e,f.mb(h)))}e=this.Bd;f=this.vF;null!==f&&
(h=!0,null!==d&&(h=d.Qa,d.Qa=!0),f(this,c,e),null!==d&&(d.Qa=h));null!==a&&(this.Yf!==a&&ro(a,this,e),Ho(this),this.G(Sj));this.h("toNode",b,a);Hk(this)}});
v.defineProperty(W,{oh:"toPortId"},function(){return this.Qh},function(a){var b=this.Qh;if(b!==a){var c=this.Bd;null!==c&&qo(this.ba,c);Go(this);this.Qh=a;var d=this.Bd;null!==d&&qo(this.ba,d);var e=this.g;if(null!==e){var f=this.data,h=e.da;null!==f&&h instanceof Q&&h.EA(f,a)}c!==d&&(this.oi=null,this.gc(),f=this.vF,null!==f&&(h=!0,null!==e&&(h=e.Qa,e.Qa=!0),f(this,c,d),null!==e&&(e.Qa=h)));Ho(this);this.h("toPortId",b,a)}});v.u(W,{Bd:"toPort"},function(){var a=this.jg;return null===a?null:a.hl(this.Qh)});
v.defineProperty(W,{vF:"toPortChanged"},function(){return this.vs},function(a){var b=this.vs;b!==a&&(null!==a&&v.j(a,"function",W,"toPortChanged"),this.vs=a,this.h("toPortChanged",b,a))});v.defineProperty(W,{Ab:"fromSpot"},function(){return null!==this.S?this.S.lj:yc},function(a){null===this.S&&this.Je();var b=this.S.lj;b.L(a)||(a=a.aa(),this.S.lj=a,this.h("fromSpot",b,a),this.gc())});
v.defineProperty(W,{il:"fromEndSegmentLength"},function(){return null!==this.S?this.S.jj:NaN},function(a){null===this.S&&this.Je();var b=this.S.jj;b!==a&&(0>a&&v.ua(a,">= 0",W,"fromEndSegmentLength"),this.S.jj=a,this.h("fromEndSegmentLength",b,a),this.gc())});v.defineProperty(W,{dt:"fromEndSegmentDirection"},function(){return null!==this.S?this.S.ij:lo},function(a){null===this.S&&this.Je();var b=this.S.ij;b!==a&&(this.S.ij=a,this.h("fromEndSegmentDirection",b,a),this.gc())});
v.defineProperty(W,{et:"fromShortLength"},function(){return null!==this.S?this.S.kj:NaN},function(a){null===this.S&&this.Je();var b=this.S.kj;b!==a&&(this.S.kj=a,this.h("fromShortLength",b,a),this.gc())});v.defineProperty(W,{Bb:"toSpot"},function(){return null!==this.S?this.S.Mj:yc},function(a){null===this.S&&this.Je();var b=this.S.Mj;b.L(a)||(a=a.aa(),this.S.Mj=a,this.h("toSpot",b,a),this.gc())});
v.defineProperty(W,{Fl:"toEndSegmentLength"},function(){return null!==this.S?this.S.Kj:NaN},function(a){null===this.S&&this.Je();var b=this.S.Kj;b!==a&&(0>a&&v.ua(a,">= 0",W,"toEndSegmentLength"),this.S.Kj=a,this.h("toEndSegmentLength",b,a),this.gc())});v.defineProperty(W,{Zt:"toEndSegmentDirection"},function(){return null!==this.S?this.S.Jj:lo},function(a){null===this.S&&this.Je();var b=this.S.Jj;b!==a&&(this.S.Jj=a,this.h("toEndSegmentDirection",b,a),this.gc())});
v.defineProperty(W,{au:"toShortLength"},function(){return null!==this.S?this.S.Lj:NaN},function(a){null===this.S&&this.Je();var b=this.S.Lj;b!==a&&(this.S.Lj=a,this.h("toShortLength",b,a),this.gc())});function Hk(a){var b=a.U,c=a.ba;null!==b?null!==c?Io(a,b.iH(c)):Io(a,null):Io(a,null)}function Io(a,b){var c=a.uk;if(c!==b){null!==c&&eo(c,a);a.uk=b;null!==b&&fo(b,a);var d=a.JD;if(null!==d){var e=!0,f=a.g;null!==f&&(e=f.Qa,f.Qa=!0);d(a,c,b);null!==f&&(f.Qa=e)}!a.Df||a.UC!==c&&a.WC!==c||a.gc()}}
W.prototype.ol=function(){var a=this.Sa;null!==a&&this.U!==a&&this.ba!==a&&J.prototype.ol.call(this)};W.prototype.getOtherNode=W.prototype.Jz=function(a){var b=this.U;return a===b?this.ba:b};W.prototype.getOtherPort=function(a){var b=this.$c;return a===b?this.Bd:b};v.u(W,{rK:"isLabeledLink"},function(){return null===this.we?!1:0<this.we.count});v.u(W,{Mf:"labelNodes"},function(){return null===this.we?Ia:this.we.i});function to(a,b){null===a.we&&(a.we=new H(S));a.we.add(b);a.P()}
W.prototype.it=function(a){J.prototype.it.call(this,a);Jo(this)&&hh(this,this.Z);a||(a=this.Yf,null!==a&&ro(a,this,this.$c),a=this.jg,null!==a&&ro(a,this,this.Bd),Ho(this))};W.prototype.jt=function(a){J.prototype.jt.call(this,a);Jo(this)&&hh(this,this.Z);a||(a=this.Yf,null!==a&&so(a,this,this.$c),a=this.jg,null!==a&&so(a,this,this.Bd),Go(this))};
W.prototype.Nm=function(){this.Df=!0;if(null!==this.we){var a=this.g;if(null!==a)for(var b=this.we.copy().i;b.next();)a.remove(b.value)}b=this.data;null!==b&&(a=this.g,null!==a&&(a=a.da,a instanceof Q?a.lx(b):a instanceof te&&a.mh(b,void 0)))};
W.prototype.updateRelationshipsFromData=function(){var a=this.data;if(null!==a){var b=this.g;if(null!==b){var c=b.da;if(c instanceof Q){var d=c.kl(a),e=b.We(d),f=this.U;e!==f&&(e=null!==f?c.mb(f.data):void 0,f=c.ep,"function"===typeof f?f(a,e):a[f]=e,c.tx(a,d));d=c.nl(a);e=b.We(d);f=this.ba;e!==f&&(e=null!==f?c.mb(f.data):void 0,f=c.gp,"function"===typeof f?f(a,e):a[f]=e,c.wx(a,d));var h=c.Xj(a);if(0<h.length||0<this.Mf.count){if(1===h.length&&1===this.Mf.count&&(b=h[0],d=this.Mf.first(),c.mb(d.data)===
b))return;var d=(new H).Yc(h),k=new H;this.Mf.each(function(a){null!==a.data&&(a=c.mb(a.data),void 0!==a&&k.add(a))});b=k.copy();b.tA(d);d=d.copy();d.tA(k);if(0<b.count||0<d.count)h.length=0,k.each(function(a){h.push(a)}),b.each(function(b){c.TE(a,b)}),d.each(function(b){c.jz(a,b)})}}}}};
W.prototype.move=function(a){var b=this.position,c=b.x;isNaN(c)&&(c=0);b=b.y;isNaN(b)&&(b=0);c=a.x-c;b=a.y-b;J.prototype.move.call(this,a);this.vl(c,b);for(a=this.Mf;a.next();){var d=a.value,e=d.position;d.moveTo(e.x+c,e.y+b)}};v.defineProperty(W,{CI:"relinkableFrom"},function(){return this.Mr},function(a){var b=this.Mr;b!==a&&(this.Mr=a,this.h("relinkableFrom",b,a),this.Zd())});
v.defineProperty(W,{DI:"relinkableTo"},function(){return this.Nr},function(a){var b=this.Nr;b!==a&&(this.Nr=a,this.h("relinkableTo",b,a),this.Zd())});W.prototype.canRelinkFrom=function(){if(!this.CI)return!1;var a=this.layer;if(null===a)return!0;if(!a.Bm)return!1;a=a.g;return null===a||a.Bm?!0:!1};W.prototype.canRelinkTo=function(){if(!this.DI)return!1;var a=this.layer;if(null===a)return!0;if(!a.Bm)return!1;a=a.g;return null===a||a.Bm?!0:!1};
v.defineProperty(W,{Lt:"resegmentable"},function(){return this.Pr},function(a){var b=this.Pr;b!==a&&(this.Pr=a,this.h("resegmentable",b,a),this.Zd())});v.defineProperty(W,{Cc:"isTreeLink"},function(){return this.Vq},function(a){var b=this.Vq;b!==a&&(this.Vq=a,this.h("isTreeLink",b,a),null!==this.U&&Tk(this.U),null!==this.ba&&Tk(this.ba))});v.u(W,{path:"path"},function(){var a=this.If();return a instanceof X?a:null});
v.u(W,{cn:"routeBounds"},function(){this.updateRoute();var a=new z;var b=Infinity,c=Infinity,d=this.ma;if(0===d)a.m(NaN,NaN,0,0);else{if(1===d)d=this.l(0),b=Math.min(d.x,b),c=Math.min(d.y,c),a.m(d.x,d.y,0,0);else if(2===d){var e=this.l(0),f=this.l(1),b=Math.min(e.x,f.x),c=Math.min(e.y,f.y);a.m(e.x,e.y,0,0);a.Zi(f)}else if(this.computeCurve()===nh&&3<=d&&!this.hc)if(e=this.l(0),b=e.x,c=e.y,a.m(b,c,0,0),3===d)d=this.l(1),b=Math.min(d.x,b),c=Math.min(d.y,c),f=this.l(2),b=Math.min(f.x,b),c=Math.min(f.y,
c),K.Fo(e.x,e.y,d.x,d.y,d.x,d.y,f.x,f.y,.5,a);else for(var h=3;h<d;h+=3){var k=this.l(h-2);h+3>=d&&(h=d-1);var l=this.l(h-1),f=this.l(h);K.Fo(e.x,e.y,k.x,k.y,l.x,l.y,f.x,f.y,.5,a);b=Math.min(f.x,b);c=Math.min(f.y,c);e=f}else for(e=this.l(0),f=this.l(1),b=Math.min(e.x,f.x),c=Math.min(e.y,f.y),a.m(e.x,e.y,0,0),a.Zi(f),h=2;h<d;h++)e=this.l(h),b=Math.min(e.x,b),c=Math.min(e.y,c),a.Zi(e);this.cz.m(b-a.x,c-a.y)}return this.Cv=a});v.u(W,{HE:"midPoint"},function(){this.updateRoute();return this.computeMidPoint(new w)});
W.prototype.computeMidPoint=function(a){var b=this.ma;if(0===b)return a.assign(K.OF),a;if(1===b)return a.assign(this.l(0)),a;if(2===b){var c=this.l(0),d=this.l(1);a.m((c.x+d.x)/2,(c.y+d.y)/2);return a}if(this.computeCurve()===nh&&3<=b&&!this.hc){if(3===b)return this.l(1);var b=(b-1)/3|0,e=3*(b/2|0);1===b%2?(c=this.l(e),d=this.l(e+1),b=this.l(e+2),e=this.l(e+3),K.DG(c.x,c.y,d.x,d.y,b.x,b.y,e.x,e.y,a)):a.assign(this.l(e));return a}for(var e=0,f=v.jb(),h=0;h<b-1;h++)c=0,c=this.l(h),d=this.l(h+1),K.sb(c.x,
d.x)?(c=d.y-c.y,0>c&&(c=-c)):K.sb(c.y,d.y)?(c=d.x-c.x,0>c&&(c=-c)):c=Math.sqrt(c.Tj(d)),f.push(c),e+=c;for(d=h=c=0;c<e/2&&h<b;){d=f[h];if(c+d>e/2)break;c+=d;h++}v.ra(f);b=this.l(h);f=this.l(h+1);b.x===f.x?b.y>f.y?a.m(b.x,b.y-(e/2-c)):a.m(b.x,b.y+(e/2-c)):b.y===f.y?b.x>f.x?a.m(b.x-(e/2-c),b.y):a.m(b.x+(e/2-c),b.y):(e=(e/2-c)/d,a.m(b.x+e*(f.x-b.x),b.y+e*(f.y-b.y)));return a};v.u(W,{GE:"midAngle"},function(){this.updateRoute();return this.computeMidAngle()});
W.prototype.computeMidAngle=function(){var a=this.ma;if(2>a)return NaN;if(this.computeCurve()===nh&&4<=a&&!this.hc){var b=(a-1)/3|0,c=3*(b/2|0);if(1===b%2){var c=Math.floor(c),a=this.l(c),b=this.l(c+1),d=this.l(c+2),c=this.l(c+3);return K.CG(a.x,a.y,b.x,b.y,d.x,d.y,c.x,c.y)}if(0<c&&c+1<a)return a=this.l(c-1),b=this.l(c+1),a.Wg(b)}d=a/2|0;if(0===a%2)return a=this.l(d-1),b=this.l(d),a.Wg(b);var a=this.l(d-1),b=this.l(d),d=this.l(d+1),c=a.Tj(b),e=b.Tj(d);return c>e+10?a.Wg(b):e>c+10?b.Wg(d):a.Wg(d)};
v.defineProperty(W,{points:"points"},function(){return this.Wc},function(a){var b=this.Wc;if(b!==a){var c=null;if(Array.isArray(a)){var d=0===a.length%2;if(d)for(var e=0;e<a.length;e++)if("number"!==typeof a[e]||isNaN(a[e])){d=!1;break}if(d)for(c=new G(w),d=0;d<a.length/2;d++)e=(new w(a[2*d],a[2*d+1])).freeze(),c.add(e);else{for(var f=!0,d=0;d<a.length;d++)if(e=a[d],!v.Wa(e)||"number"!==typeof e.x||isNaN(e.x)||"number"!==typeof e.y||isNaN(e.y)){f=!1;break}if(f)for(c=new G(w),d=0;d<a.length;d++)e=
a[d],c.add((new w(e.x,e.y)).freeze());else v.k("Link.points array must contain only an even number of numbers or objects with x and y properties, not: "+a)}}else if(a instanceof G)for(c=a.copy(),a=c.i;a.next();)a.value.freeze();else v.k("Link.points value is not an instance of List or Array: "+a);c.freeze();this.Wc=c;this.Ye();this.P();Ko(this);a=this.g;null!==a&&(a.ja.ib||a.Zw.add(this),a.Oa.sc&&(this.oo=c));this.h("points",b,c)}});v.u(W,{ma:"pointsCount"},function(){return this.Wc.count});
W.prototype.getPoint=W.prototype.l=function(a){return this.Wc.n[a]};W.prototype.setPoint=W.prototype.vf=function(a,b){null===this.ye&&v.k("Call Link.startRoute before modifying the points of the route.");this.Wc.zg(a,b)};W.prototype.setPointAt=W.prototype.Y=function(a,b,c){null===this.ye&&v.k("Call Link.startRoute before modifying the points of the route.");this.Wc.zg(a,new w(b,c))};
W.prototype.insertPoint=function(a,b){null===this.ye&&v.k("Call Link.startRoute before modifying the points of the route.");this.Wc.xd(a,b)};W.prototype.insertPointAt=W.prototype.w=function(a,b,c){null===this.ye&&v.k("Call Link.startRoute before modifying the points of the route.");this.Wc.xd(a,new w(b,c))};W.prototype.addPoint=W.prototype.Rh=function(a){null===this.ye&&v.k("Call Link.startRoute before modifying the points of the route.");this.Wc.add(a)};
W.prototype.addPointAt=W.prototype.Wk=function(a,b){null===this.ye&&v.k("Call Link.startRoute before modifying the points of the route.");this.Wc.add(new w(a,b))};W.prototype.removePoint=W.prototype.UE=function(a){null===this.ye&&v.k("Call Link.startRoute before modifying the points of the route.");this.Wc.Rc(a)};W.prototype.clearPoints=W.prototype.Jo=function(){null===this.ye&&v.k("Call Link.startRoute before modifying the points of the route.");this.Wc.clear()};
W.prototype.movePoints=W.prototype.vl=function(a,b){for(var c=new G(w),d=this.Wc.i;d.next();){var e=d.value;c.add((new w(e.x+a,e.y+b)).freeze())}c.freeze();d=this.Wc;this.Wc=c;this.P();Ko(this);e=this.g;null!==e&&e.Oa.sc&&(this.oo=c);this.h("points",d,c)};W.prototype.startRoute=W.prototype.Bl=function(){null===this.ye&&(this.ye=this.Wc,this.Wc=this.Wc.copy())};
W.prototype.commitRoute=W.prototype.Oi=function(){if(null!==this.ye){for(var a=this.ye,b=this.Wc,c=Infinity,d=Infinity,e=a.n,f=e.length,h=0;h<f;h++)var k=e[h],c=Math.min(k.x,c),d=Math.min(k.y,d);for(var l=Infinity,m=Infinity,n=b.n,p=n.length,h=0;h<p;h++)k=n[h],l=Math.min(k.x,l),m=Math.min(k.y,m),k.freeze();b.freeze();if(p===f)for(h=0;h<p;h++){if(f=e[h],k=n[h],f.x-c!==k.x-l||f.y-d!==k.y-m){this.P();this.Ye();break}}else this.P(),this.Ye();this.ye=null;c=this.g;null!==c&&c.Oa.sc&&(this.oo=b);Ko(this);
this.h("points",a,b)}};W.prototype.rollbackRoute=W.prototype.II=function(){null!==this.ye&&(this.Wc=this.ye,this.ye=null)};function Ko(a){0===a.Wc.count?a.Df=!1:(a.Df=!0,a.An=a.l(0).copy(),a.En=a.l(a.ma-1).copy(),Lo(a,!1))}W.prototype.invalidateRoute=W.prototype.gc=function(){if(!(this.Zy||this.g&&(this.g.Zw.contains(this)||this.g.ja.ib))){var a=this.path;if(null!==a){if(this.Df){var b=this.$c;null!==b&&(b=b.lm,null!==b&&b.Tm());b=this.Bd;null!==b&&(b=b.lm,null!==b&&b.Tm())}this.Df=!1;this.P();a.P()}}};
v.defineProperty(W,{Gp:"suspendsRouting"},function(){return this.Zy},function(a){this.Zy=a});W.prototype.updateRoute=function(){if(!this.Df&&!this.Wx){var a=!0;try{this.Wx=!0,this.Bl(),a=this.computePoints()}finally{this.Wx=!1,a?this.Oi():this.II()}}};
W.prototype.computePoints=function(){var a=this.g;if(null===a)return!1;var b=this.U,c=null;null===b?(a.om||(a.Dv=new X,a.Dv.xa=K.Np,a.Dv.nb=0,a.om=new S,a.om.add(a.Dv),a.om.mf()),this.An&&(a.om.position=a.om.location=this.An,a.om.mf(),b=a.om,c=a.Dv)):c=this.$c;if(null!==c){var d=Yl(c);d!==b&&b.isVisible()?c=d:(d=b.findVisibleNode(),null!==d&&d!==b?(b=d,c=d.hl("")):b=d)}this.UC=b;if(null===b||null===c||!b.location.H())return!1;var d=this.ba,e=null;null===d?(a.pm||(a.Ev=new X,a.Ev.xa=K.Np,a.Ev.nb=0,
a.pm=new S,a.pm.add(a.Ev),a.pm.mf()),this.En&&(a.pm.position=a.pm.location=this.En,a.pm.mf(),d=a.pm,e=a.Ev)):e=this.Bd;null!==e&&(a=Yl(e),a!==d&&d.isVisible()?e=a:(a=d.findVisibleNode(),null!==a&&a!==d?(d=a,e=a.hl("")):d=a));this.WC=d;if(null===d||null===e||!d.location.H())return!1;var a=this.ma,f=Mo(this,c),h=No(this,e),k=c===e&&null!==c,l=this.hc,m=this.Ge===nh;this.oi=k&&!l?m=!0:!1;var n=this.Is===gh||k;if(l||f!==xb||h!==xb||k){m=this.pl;n&&(l&&m||k)&&this.Jo();var p=k?this.computeCurviness():
0,q=this.getLinkPoint(b,c,f,!0,l,d,e),r=0,s=0,t=0;if(l||f!==xb||k){var u=this.computeEndSegmentLength(b,c,f,!0),t=this.getLinkDirection(b,c,q,f,!0,l,d,e);k&&(t-=l?90:30,0>p&&(t-=180));0>t?t+=360:360<=t&&(t-=360);k&&(u+=Math.abs(p));0===t?r=u:90===t?s=u:180===t?r=-u:270===t?s=-u:(r=u*Math.cos(t*Math.PI/180),s=u*Math.sin(t*Math.PI/180));if(f.me()&&k){var x=c.fb(Kb,v.M()),y=v.Rb(x.x+1E3*r,x.y+1E3*s);this.getLinkPointFromPoint(b,c,x,y,!0,q);v.v(x);v.v(y)}}var u=this.getLinkPoint(d,e,h,!1,l,b,c),A=0,B=
0,I=0;if(l||h!==xb||k)x=this.computeEndSegmentLength(d,e,h,!1),I=this.getLinkDirection(d,e,u,h,!1,l,b,c),k&&(I+=l?0:30,0>p&&(I+=180)),0>I?I+=360:360<=I&&(I-=360),k&&(x+=Math.abs(p)),0===I?A=x:90===I?B=x:180===I?A=-x:270===I?B=-x:(A=x*Math.cos(I*Math.PI/180),B=x*Math.sin(I*Math.PI/180)),h.me()&&k&&(x=e.fb(Kb,v.M()),y=v.Rb(x.x+1E3*A,x.y+1E3*B),this.getLinkPointFromPoint(d,e,x,y,!1,u),v.v(x),v.v(y));e=q;if(l||f!==xb||k)e=new w(q.x+r,q.y+s);c=u;if(l||h!==xb||k)c=new w(u.x+A,u.y+B);!n&&!l&&f===xb&&3<a&&
this.adjustPoints(0,q,a-2,c)?this.vf(a-1,u):!n&&!l&&h===xb&&3<a&&this.adjustPoints(1,e,a-1,u)?this.vf(0,q):!n&&!l&&4<a&&this.adjustPoints(1,e,a-2,c)?(this.vf(0,q),this.vf(a-1,u)):!n&&l&&6<=a&&!m&&this.adjustPoints(1,e,a-2,c)?(this.vf(0,q),this.vf(a-1,u)):(this.Jo(),this.Rh(q),(l||f!==xb||k)&&this.Rh(e),l&&this.addOrthoPoints(e,t,c,I,b,d),(l||h!==xb||k)&&this.Rh(c),this.Rh(u))}else f=!1,!n&&3<=a&&(n=this.getLinkPoint(b,c,xb,!0,!1,d,e),h=this.getLinkPoint(d,e,xb,!1,!1,b,c),f=this.adjustPoints(0,n,a-
1,h))&&(n=this.getLinkPoint(b,c,xb,!0,!1,d,e),h=this.getLinkPoint(d,e,xb,!1,!1,b,c),this.adjustPoints(0,n,a-1,h)),f||(this.Jo(),m?(a=this.getLinkPoint(b,c,xb,!0,!1,d,e),n=this.getLinkPoint(d,e,xb,!1,!1,b,c),f=n.x-a.x,h=n.y-a.y,k=this.computeCurviness(),m=l=0,q=a.x+f/3,t=a.y+h/3,r=q,s=t,K.D(h,0)?s=0<f?s-k:s+k:(l=-f/h,m=Math.sqrt(k*k/(l*l+1)),0>k&&(m=-m),r=(0>h?-1:1)*m+q,s=l*(r-q)+t),q=a.x+2*f/3,t=a.y+2*h/3,u=q,A=t,K.D(h,0)?A=0<f?A-k:A+k:(u=(0>h?-1:1)*m+q,A=l*(u-q)+t),this.Jo(),this.Rh(a),this.Wk(r,
s),this.Wk(u,A),this.Rh(n),this.vf(0,this.getLinkPoint(b,c,xb,!0,!1,d,e)),this.vf(3,this.getLinkPoint(d,e,xb,!1,!1,b,c))):(a=d,d=this.getLinkPoint(b,c,xb,!0,!1,a,e),e=this.getLinkPoint(a,e,xb,!1,!1,b,c),this.hasCurviness()?(h=e.x-d.x,b=e.y-d.y,c=this.computeCurviness(),a=d.x+h/2,n=d.y+b/2,f=a,k=n,K.D(b,0)?k=0<h?k-c:k+c:(h=-h/b,f=Math.sqrt(c*c/(h*h+1)),0>c&&(f=-f),f=(0>b?-1:1)*f+a,k=h*(f-a)+n),this.Rh(d),this.Wk(f,k)):this.Rh(d),this.Rh(e)));return!0};
function Oo(a,b){Math.abs(b.x-a.x)>Math.abs(b.y-a.y)?(b.x=b.x>=a.x?a.x+9E9:a.x-9E9,b.y=a.y):(b.y=b.y>=a.y?a.y+9E9:a.y-9E9,b.x=a.x);return b}
W.prototype.getLinkPointFromPoint=function(a,b,c,d,e,f){void 0===f&&(f=new w);if(null===a||null===b)return f.assign(c),f;a.isVisible()||(e=a.findVisibleNode(),null!==e&&e!==a&&(b=e.port));var h=e=0,k=0,l=0;a=null;e=b.T;null===e||e.Vf()||(e=e.T);if(null===e)e=d.x,h=d.y,k=c.x,l=c.y;else{a=e.Ef;e=1/(a.m11*a.m22-a.m12*a.m21);var k=a.m22*e,l=-a.m12*e,m=-a.m21*e,n=a.m11*e,p=e*(a.m21*a.dy-a.m22*a.dx),q=e*(a.m12*a.dx-a.m11*a.dy);e=d.x*k+d.y*m+p;h=d.x*l+d.y*n+q;k=c.x*k+c.y*m+p;l=c.x*l+c.y*n+q}b.Xo(e,h,k,l,
f);null!==a&&f.transform(a);return f};function Po(a,b){var c=b.lm;null===c&&(c=new Qo,c.port=b,c.Dc=b.V,b.lm=c);return Ro(c,a)}
W.prototype.getLinkPoint=function(a,b,c,d,e,f,h,k){void 0===k&&(k=new w);if(c.yd())return b.fb(c,k),k;if(c.ap()&&(c=Po(this,b),null!==c)){k.assign(c.fp);if(e&&this.ox===yo){var l=Po(this,h);if(null!==l&&c.Km<l.Km){c=v.M();var l=v.M(),m=new z(b.fb(zb,c),b.fb(Vb,l)),n=this.computeSpot(!d);a=this.getLinkPoint(f,h,n,!d,e,a,b,l);a.x>=m.x&&a.x<=m.x+m.width?k.x=a.x:a.y>=m.y&&a.y<=m.y+m.height&&(k.y=a.y);v.v(c);v.v(l)}}return k}f=b.fb(Kb,v.M());l=c=null;this.ma>(e?6:2)?(l=d?this.l(1):this.l(this.ma-2),e&&
(l=Oo(f,l.copy()))):(c=v.M(),l=h.fb(Kb,c),e&&(l=Oo(f,l)));this.getLinkPointFromPoint(a,b,f,l,d,k);v.v(f);null!==c&&v.v(c);return k};
W.prototype.getLinkDirection=function(a,b,c,d,e,f,h,k){a:if(d.yd())c=d.x>d.y?d.x>1-d.y?0:d.x<1-d.y?270:315:d.x<d.y?d.x>1-d.y?90:d.x<1-d.y?180:135:.5>d.x?225:.5<d.x?45:0;else{if(d.ap()){var l=Po(this,b);if(null!==l)switch(l.ee){case v.fd:c=270;break a;case v.Gc:c=180;break a;default:case v.Tc:c=0;break a;case v.Sc:c=90;break a}}var l=b.fb(Kb,v.M()),m=null,n=null;this.ma>(f?6:2)?(n=e?this.l(1):this.l(this.ma-2),n=f?Oo(l,n.copy()):c):(m=v.M(),n=k.fb(Kb,m));c=0;c=Math.abs(n.x-l.x)>Math.abs(n.y-l.y)?n.x>=
l.x?0:180:n.y>=l.y?90:270;v.v(l);null!==m&&v.v(m)}d.me()&&h.Yh(a)&&(c+=180,360<=c&&(c-=360));a=lo;a=e?this.dt:this.Zt;a===lo&&(a=e?b.dt:b.Zt);switch(a){case mo:b=b.jl();c+=b;360<=c&&(c-=360);break;case lo:case sl:b=b.jl();if(0===b)break;45<=b&&135>b?c+=90:135<=b&&225>b?c+=180:225<=b&&315>b&&(c+=270);360<=c&&(c-=360)}return c};
W.prototype.computeEndSegmentLength=function(a,b,c,d){if(null!==b&&c.ap()&&(a=Po(this,b),null!==a))return a.Aw;a=NaN;a=d?this.il:this.Fl;null!==b&&isNaN(a)&&(a=d?b.il:b.Fl);isNaN(a)&&(a=10);return a};W.prototype.computeSpot=function(a){return a?Mo(this,this.$c):No(this,this.Bd)};function Mo(a,b){if(null===b)return Kb;var c=a.Ab;c.Oc()&&(void 0===b&&(b=a.$c),null!==b&&(c=b.Ab));return c===yc?xb:c}
function No(a,b){if(null===b)return Kb;var c=a.Bb;c.Oc()&&(void 0===b&&(b=a.Bd),null!==b&&(c=b.Bb));return c===yc?xb:c}W.prototype.computeOtherPoint=function(a,b){var c=b.fb(Kb),d;d=b.lm;d=null!==d?Ro(d,this):null;null!==d&&(c=d.fp);return c};W.prototype.computeShortLength=function(a){return a?So(this):To(this)};function So(a){var b=a.et;isNaN(b)&&(a=a.$c,null!==a&&(b=a.et));return isNaN(b)?0:b}function To(a){var b=a.au;isNaN(b)&&(a=a.Bd,null!==a&&(b=a.au));return isNaN(b)?0:b}
W.prototype.Vj=function(a,b,c,d,e,f){if(!1===this.yg)return!1;void 0===b&&(b=null);void 0===c&&(c=null);var h=f;void 0===f&&(h=v.nh(),h.reset());h.multiply(this.transform);if(this.Hm(a,h))return dn(this,b,c,e),void 0===f&&v.Xe(h),!0;if(this.tg(a,h)){var k=!1;if(!this.Ig)for(var l=this.wa.n,m=l.length;m--;){var n=l[m];if(n.visible||n===this.ac){var p=n.Z,q=this.Fa;if(!(p.x>q.width||p.y>q.height||0>p.x+p.width||0>p.y+p.height)){p=v.nh();p.set(h);if(n instanceof C)k=n.Vj(a,b,c,d,e,p);else if(this.path===
n){var k=n,r=a,s=d,q=p;if(!1===k.yg)k=!1;else if(q.multiply(k.transform),s)b:{var t=r,u=q;if(k.Hm(t,u))k=!0;else{if(void 0===u&&(u=k.transform,t.Sj(k.Z))){k=!0;break b}var q=t.left,r=t.right,s=t.top,t=t.bottom,x=v.M(),y=v.M(),A=v.M(),B=v.nh();B.set(u);B.JE(k.transform);B.Pz();y.x=r;y.y=s;y.transform(B);x.x=q;x.y=s;x.transform(B);u=!1;on(k,x,y,A)?u=!0:(x.x=r,x.y=t,x.transform(B),on(k,x,y,A)?u=!0:(y.x=q,y.y=t,y.transform(B),on(k,x,y,A)?u=!0:(x.x=q,x.y=s,x.transform(B),on(k,x,y,A)&&(u=!0))));v.Xe(B);
v.v(x);v.v(y);v.v(A);k=u}}else k=k.Hm(r,q)}else k=xl(n,a,d,p);k&&(null!==b&&(n=b(n)),n&&(null===c||c(n))&&e.add(n));v.Xe(p)}}}void 0===f&&v.Xe(h);return k||null!==this.background||null!==this.Cm}void 0===f&&v.Xe(h);return!1};v.u(W,{hc:"isOrthogonal"},function(){return 2===(this.nm.value&2)});v.u(W,{pl:"isAvoiding"},function(){return 4===(this.nm.value&4)});W.prototype.computeCurve=function(){if(null===this.oi){var a=this.$c,b=this.hc;this.oi=null!==a&&a===this.Bd&&!b}return this.oi?nh:this.Ge};
W.prototype.computeCorner=function(){if(this.Ge===nh)return 0;var a=this.yz;if(isNaN(a)||0>a)a=10;return a};W.prototype.findMidLabel=function(){for(var a=this.path,b=this.wa.n,c=b.length,d=0;d<c;d++){var e=b[d];if(e!==a&&!e.Lf&&(-Infinity===e.pe||isNaN(e.pe)))return e}for(a=this.Mf;a.next();)if(b=a.value,-Infinity===b.pe||isNaN(b.pe))return b;return null};
W.prototype.computeSpacing=function(){if(!this.isVisible())return 0;var a;a=Math.max(14,this.computeThickness());var b=this.$c,c=this.Bd;if(null!==b&&null!==c){var d=this.findMidLabel();if(null!==d){var e=d.Fa,f=d.margin,h=isNaN(e.width)?30:e.width*d.scale+f.left+f.right,e=isNaN(e.height)?14:e.height*d.scale+f.top+f.bottom,d=d.Pt;d===qn||d===Co||d===Bo?a=Math.max(a,e):d===Ao||d===Eo||d===zo||d===Do?a=Math.max(a,h):(b=b.fb(Kb).Wg(c.fb(Kb))/180*Math.PI,a=Math.max(a,Math.abs(Math.sin(b)*h)+Math.abs(Math.cos(b)*
e)+1));this.Ge===nh&&(a*=1.333)}}return a};W.prototype.arrangeBundledLinks=function(a,b){if(b)for(var c=0;c<a.length;c++)a[c].gc()};W.prototype.computeCurviness=function(){var a=this.ww;if(isNaN(a)){var a=16,b=this.di;if(null!==b){for(var c=v.jb(),d=0,e=b.links,f=0;f<e.length;f++){var h=e[f],h=h.computeSpacing();c.push(h);d+=h}d=-d/2;for(f=0;f<e.length;f++){h=e[f];if(h===this){a=d+c[f]/2;break}d+=c[f]}b.op===this.U&&(a=-a);v.ra(c)}}return a};
W.prototype.computeThickness=function(){if(!this.isVisible())return 0;var a=this.path;return null!==a?Math.max(a.nb,1):1};W.prototype.hasCurviness=function(){return!isNaN(this.ww)||null!==this.di};
W.prototype.adjustPoints=function(a,b,c,d){var e=this.Is;if(this.hc){if(e===em)return!1;e===fm&&(e=dm)}switch(e){case em:var f=this.l(a),h=this.l(c);if(!f.L(b)||!h.L(d)){var e=f.x,f=f.y,k=h.x-e,l=h.y-f,m=Math.sqrt(k*k+l*l);if(!K.D(m,0)){var n=0;K.D(k,0)?n=0>l?-Math.PI/2:Math.PI/2:(n=Math.atan(l/Math.abs(k)),0>k&&(n=Math.PI-n));var h=b.x,p=b.y,l=d.x-h,q=d.y-p,r=Math.sqrt(l*l+q*q),k=0;K.D(l,0)?k=0>q?-Math.PI/2:Math.PI/2:(k=Math.atan(q/Math.abs(l)),0>l&&(k=Math.PI-k));m=r/m;n=k-n;this.vf(a,b);for(a+=
1;a<c;a++)b=this.l(a),k=b.x-e,l=b.y-f,b=Math.sqrt(k*k+l*l),K.D(b,0)||(q=0,K.D(k,0)?q=0>l?-Math.PI/2:Math.PI/2:(q=Math.atan(l/Math.abs(k)),0>k&&(q=Math.PI-q)),k=q+n,b*=m,this.Y(a,h+b*Math.cos(k),p+b*Math.sin(k)));this.vf(c,d)}}return!0;case fm:f=this.l(a);p=this.l(c);if(!f.L(b)||!p.L(d)){var e=f.x,f=f.y,h=p.x,p=p.y,m=(h-e)*(h-e)+(p-f)*(p-f),k=b.x,n=b.y,l=d.x,q=d.y,r=0,s=1,r=0!==l-k?(q-n)/(l-k):9E9;0!==r&&(s=Math.sqrt(1+1/(r*r)));this.vf(a,b);for(a+=1;a<c;a++){b=this.l(a);var t=b.x,u=b.y,x=.5;0!==m&&
(x=((e-t)*(e-h)+(f-u)*(f-p))/m);var y=e+x*(h-e),A=f+x*(p-f);b=Math.sqrt((t-y)*(t-y)+(u-A)*(u-A));u<r*(t-y)+A&&(b=-b);0<r&&(b=-b);t=k+x*(l-k);x=n+x*(q-n);0!==r?(b=t+b/s,this.Y(a,b,x-(b-t)/r)):this.Y(a,t,x+b)}this.vf(c,d)}return!0;case dm:return this.hc&&(e=this.l(a),f=this.l(a+1),h=this.l(a+2),K.D(e.y,f.y)?K.D(f.x,h.x)?this.Y(a+1,f.x,b.y):K.D(f.y,h.y)&&this.Y(a+1,b.x,f.y):K.D(e.x,f.x)&&(K.D(f.y,h.y)?this.Y(a+1,b.x,f.y):K.D(f.x,h.x)&&this.Y(a+1,f.x,b.y)),e=this.l(c),f=this.l(c-1),h=this.l(c-2),K.D(e.y,
f.y)?K.D(f.x,h.x)?this.Y(c-1,f.x,d.y):K.D(f.y,h.y)&&this.Y(c-1,d.x,f.y):K.D(e.x,f.x)&&(K.D(f.y,h.y)?this.Y(c-1,d.x,f.y):K.D(f.x,h.x)&&this.Y(c-1,f.x,d.y))),this.vf(a,b),this.vf(c,d),!0;default:return!1}};
W.prototype.addOrthoPoints=function(a,b,c,d,e,f){b=-45<=b&&45>b?0:45<=b&&135>b?90:135<=b&&225>b?180:270;d=-45<=d&&45>d?0:45<=d&&135>d?90:135<=d&&225>d?180:270;var h=e.Z.copy(),k=f.Z.copy();if(h.H()&&k.H()){h.Kf(8,8);k.Kf(8,8);h.Zi(a);k.Zi(c);var l,m;if(0===b)if(c.x>a.x||270===d&&c.y<a.y&&k.right>a.x||90===d&&c.y>a.y&&k.right>a.x)l=new w(c.x,a.y),m=new w(c.x,(a.y+c.y)/2),180===d?(l.x=this.computeMidOrthoPosition(a.x,c.x,!1),m.x=l.x,m.y=c.y):270===d&&c.y<a.y||90===d&&c.y>a.y?(l.x=a.x<k.left?this.computeMidOrthoPosition(a.x,
k.left,!1):a.x<k.right&&(270===d&&a.y<k.top||90===d&&a.y>k.bottom)?this.computeMidOrthoPosition(a.x,c.x,!1):k.right,m.x=l.x,m.y=c.y):0===d&&a.x<k.left&&a.y>k.top&&a.y<k.bottom&&(l.x=a.x,l.y=a.y<c.y?Math.min(c.y,k.top):Math.max(c.y,k.bottom),m.y=l.y);else{l=new w(a.x,c.y);m=new w((a.x+c.x)/2,c.y);if(180===d||90===d&&c.y<h.top||270===d&&c.y>h.bottom)180===d&&(k.Ca(a)||h.Ca(c))?l.y=this.computeMidOrthoPosition(a.y,c.y,!0):c.y<a.y&&(180===d||90===d)?l.y=this.computeMidOrthoPosition(h.top,Math.max(c.y,
k.bottom),!0):c.y>a.y&&(180===d||270===d)&&(l.y=this.computeMidOrthoPosition(h.bottom,Math.min(c.y,k.top),!0)),m.x=c.x,m.y=l.y;if(l.y>h.top&&l.y<h.bottom)if(c.x>=h.left&&c.x<=a.x||a.x<=k.right&&a.x>=c.x){if(90===d||270===d)l=new w(Math.max((a.x+c.x)/2,a.x),a.y),m=new w(l.x,c.y)}else l.y=270===d||(0===d||180===d)&&c.y<a.y?Math.min(c.y,0===d?h.top:Math.min(h.top,k.top)):Math.max(c.y,0===d?h.bottom:Math.max(h.bottom,k.bottom)),m.x=c.x,m.y=l.y}else if(180===b)if(c.x<a.x||270===d&&c.y<a.y&&k.left<a.x||
90===d&&c.y>a.y&&k.left<a.x)l=new w(c.x,a.y),m=new w(c.x,(a.y+c.y)/2),0===d?(l.x=this.computeMidOrthoPosition(a.x,c.x,!1),m.x=l.x,m.y=c.y):270===d&&c.y<a.y||90===d&&c.y>a.y?(l.x=a.x>k.right?this.computeMidOrthoPosition(a.x,k.right,!1):a.x>k.left&&(270===d&&a.y<k.top||90===d&&a.y>k.bottom)?this.computeMidOrthoPosition(a.x,c.x,!1):k.left,m.x=l.x,m.y=c.y):180===d&&a.x>k.right&&a.y>k.top&&a.y<k.bottom&&(l.x=a.x,l.y=a.y<c.y?Math.min(c.y,k.top):Math.max(c.y,k.bottom),m.y=l.y);else{l=new w(a.x,c.y);m=new w((a.x+
c.x)/2,c.y);if(0===d||90===d&&c.y<h.top||270===d&&c.y>h.bottom)0===d&&(k.Ca(a)||h.Ca(c))?l.y=this.computeMidOrthoPosition(a.y,c.y,!0):c.y<a.y&&(0===d||90===d)?l.y=this.computeMidOrthoPosition(h.top,Math.max(c.y,k.bottom),!0):c.y>a.y&&(0===d||270===d)&&(l.y=this.computeMidOrthoPosition(h.bottom,Math.min(c.y,k.top),!0)),m.x=c.x,m.y=l.y;if(l.y>h.top&&l.y<h.bottom)if(c.x<=h.right&&c.x>=a.x||a.x>=k.left&&a.x<=c.x){if(90===d||270===d)l=new w(Math.min((a.x+c.x)/2,a.x),a.y),m=new w(l.x,c.y)}else l.y=270===
d||(0===d||180===d)&&c.y<a.y?Math.min(c.y,180===d?h.top:Math.min(h.top,k.top)):Math.max(c.y,180===d?h.bottom:Math.max(h.bottom,k.bottom)),m.x=c.x,m.y=l.y}else if(90===b)if(c.y>a.y||180===d&&c.x<a.x&&k.bottom>a.y||0===d&&c.x>a.x&&k.bottom>a.y)l=new w(a.x,c.y),m=new w((a.x+c.x)/2,c.y),270===d?(l.y=this.computeMidOrthoPosition(a.y,c.y,!0),m.x=c.x,m.y=l.y):180===d&&c.x<a.x||0===d&&c.x>a.x?(l.y=a.y<k.top?this.computeMidOrthoPosition(a.y,k.top,!0):a.y<k.bottom&&(180===d&&a.x<k.left||0===d&&a.x>k.right)?
this.computeMidOrthoPosition(a.y,c.y,!0):k.bottom,m.x=c.x,m.y=l.y):90===d&&a.y<k.top&&a.x>k.left&&a.x<k.right&&(l.x=a.x<c.x?Math.min(c.x,k.left):Math.max(c.x,k.right),l.y=a.y,m.x=l.x);else{l=new w(c.x,a.y);m=new w(c.x,(a.y+c.y)/2);if(270===d||0===d&&c.x<h.left||180===d&&c.x>h.right)270===d&&(k.Ca(a)||h.Ca(c))?l.x=this.computeMidOrthoPosition(a.x,c.x,!1):c.x<a.x&&(270===d||0===d)?l.x=this.computeMidOrthoPosition(h.left,Math.max(c.x,k.right),!1):c.x>a.x&&(270===d||180===d)&&(l.x=this.computeMidOrthoPosition(h.right,
Math.min(c.x,k.left),!1)),m.x=l.x,m.y=c.y;if(l.x>h.left&&l.x<h.right)if(c.y>=h.top&&c.y<=a.y||a.y<=k.bottom&&a.y>=c.y){if(0===d||180===d)l=new w(a.x,Math.max((a.y+c.y)/2,a.y)),m=new w(c.x,l.y)}else l.x=180===d||(90===d||270===d)&&c.x<a.x?Math.min(c.x,90===d?h.left:Math.min(h.left,k.left)):Math.max(c.x,90===d?h.right:Math.max(h.right,k.right)),m.x=l.x,m.y=c.y}else if(c.y<a.y||180===d&&c.x<a.x&&k.top<a.y||0===d&&c.x>a.x&&k.top<a.y)l=new w(a.x,c.y),m=new w((a.x+c.x)/2,c.y),90===d?(l.y=this.computeMidOrthoPosition(a.y,
c.y,!0),m.x=c.x,m.y=l.y):180===d&&c.x<a.x||0===d&&c.x>=a.x?(l.y=a.y>k.bottom?this.computeMidOrthoPosition(a.y,k.bottom,!0):a.y>k.top&&(180===d&&a.x<k.left||0===d&&a.x>k.right)?this.computeMidOrthoPosition(a.y,c.y,!0):k.top,m.x=c.x,m.y=l.y):270===d&&a.y>k.bottom&&a.x>k.left&&a.x<k.right&&(l.x=a.x<c.x?Math.min(c.x,k.left):Math.max(c.x,k.right),l.y=a.y,m.x=l.x);else{l=new w(c.x,a.y);m=new w(c.x,(a.y+c.y)/2);if(90===d||0===d&&c.x<h.left||180===d&&c.x>h.right)90===d&&(k.Ca(a)||h.Ca(c))?l.x=this.computeMidOrthoPosition(a.x,
c.x,!1):c.x<a.x&&(90===d||0===d)?l.x=this.computeMidOrthoPosition(h.left,Math.max(c.x,k.right),!1):c.x>a.x&&(90===d||180===d)&&(l.x=this.computeMidOrthoPosition(h.right,Math.min(c.x,k.left),!1)),m.x=l.x,m.y=c.y;if(l.x>h.left&&l.x<h.right)if(c.y<=h.bottom&&c.y>=a.y||a.y>=k.top&&a.y<=c.y){if(0===d||180===d)l=new w(a.x,Math.min((a.y+c.y)/2,a.y)),m=new w(c.x,l.y)}else l.x=180===d||(90===d||270===d)&&c.x<a.x?Math.min(c.x,270===d?h.left:Math.min(h.left,k.left)):Math.max(c.x,270===d?h.right:Math.max(h.right,
k.right)),m.x=l.x,m.y=c.y}var n=l,p=m;if(this.pl){var q=this.g,r;(r=null===q)||(q.Oa.pf?r=!1:(r=q.$a,r=r instanceof wf?!r.Uv||r.LH:!0),r=!r);if(r||h.Ca(c)&&!f.Yh(e)||k.Ca(a)&&!e.Yh(f)||e===f||this.layer.Bc)a=!1;else if(e=Vk(q,!0,this.Sa,null),e.dp(Math.min(a.x,n.x),Math.min(a.y,n.y),Math.abs(a.x-n.x),Math.abs(a.y-n.y))&&e.dp(Math.min(n.x,p.x),Math.min(n.y,p.y),Math.abs(n.x-p.x),Math.abs(n.y-p.y))&&e.dp(Math.min(p.x,c.x),Math.min(p.y,c.y),Math.abs(p.x-c.x),Math.abs(p.y-c.y)))a=!1;else if(h=h.copy().bi(k),
h.Kf(2*e.Io,2*e.Go),Uo(e,a,b,c,d,h),k=Vo(e,c.x,c.y),e.abort||999999!==k||(Yk(e),k=e.pF,h.Kf(e.Io*k,e.Go*k),Uo(e,a,b,c,d,h),k=Vo(e,c.x,c.y)),e.abort||999999!==k||(Yk(e),k=e.AE,h.Kf(e.Io*k,e.Go*k),Uo(e,a,b,c,d,h),k=Vo(e,c.x,c.y)),!e.abort&&999999===k&&e.HF&&(Yk(e),Uo(e,a,b,c,d,e.pb),k=Vo(e,c.x,c.y)),!e.abort&&999999>k&&0!==Vo(e,c.x,c.y)){Wo(this,e,c.x,c.y,d,!0);d=this.l(2);if(4>this.ma)0===b||180===b?(d.x=a.x,d.y=c.y):(d.x=c.x,d.y=a.y),this.Y(2,d.x,d.y),this.w(3,d.x,d.y);else if(c=this.l(3),0===b||
180===b)K.D(d.x,c.x)?(b=0===b?Math.max(d.x,a.x):Math.min(d.x,a.x),this.Y(2,b,a.y),this.Y(3,b,c.y)):K.D(d.y,c.y)?(Math.abs(a.y-d.y)<=e.Go/2&&(this.Y(2,d.x,a.y),this.Y(3,c.x,a.y)),this.w(2,d.x,a.y)):this.Y(2,a.x,d.y);else if(90===b||270===b)K.D(d.y,c.y)?(b=90===b?Math.max(d.y,a.y):Math.min(d.y,a.y),this.Y(2,a.x,b),this.Y(3,c.x,b)):K.D(d.x,c.x)?(Math.abs(a.x-d.x)<=e.Io/2&&(this.Y(2,a.x,d.y),this.Y(3,a.x,c.y)),this.w(2,a.x,d.y)):this.Y(2,d.x,a.y);a=!0}else a=!1}else a=!1;a||(this.Rh(l),this.Rh(m))}};
W.prototype.computeMidOrthoPosition=function(a,b){if(this.hasCurviness()){var c=this.computeCurviness();return(a+b)/2+c}return(a+b)/2};function fg(a){if(!a.pl)return!1;var b=a.points.n,c=b.length;if(4>c)return!1;a=Vk(a.g,!0,a.Sa,null);for(var d=1;d<c-2;d++){var e=b[d],f=b[d+1];if(!a.dp(Math.min(e.x,f.x),Math.min(e.y,f.y),Math.abs(e.x-f.x),Math.abs(e.y-f.y)))return!0}return!1}
function Wo(a,b,c,d,e,f){var h=b.Io,k=b.Go,l=Vo(b,c,d),m=c,n=d;for(0===e?m+=h:90===e?n+=k:180===e?m-=h:n-=k;1<l&&Vo(b,m,n)===l-1;)c=m,d=n,0===e?m+=h:90===e?n+=k:180===e?m-=h:n-=k,l-=1;if(f){if(1<l)if(180===e||0===e)c=Math.floor(c/h)*h+h/2;else if(90===e||270===e)d=Math.floor(d/k)*k+k/2}else c=Math.floor(c/h)*h+h/2,d=Math.floor(d/k)*k+k/2;1<l&&(f=e,m=c,n=d,0===e?(f=90,n+=k):90===e?(f=180,m-=h):180===e?(f=270,n-=k):270===e&&(f=0,m+=h),Vo(b,m,n)===l-1?Wo(a,b,m,n,f,!1):(m=c,n=d,0===e?(f=270,n-=k):90===
e?(f=0,m+=h):180===e?(f=90,n+=k):270===e&&(f=180,m-=h),Vo(b,m,n)===l-1&&Wo(a,b,m,n,f,!1)));a.Wk(c,d)}W.prototype.findClosestSegment=function(a){var b=a.x;a=a.y;for(var c=this.l(0),d=this.l(1),e=Ya(b,a,c.x,c.y,d.x,d.y),f=0,h=1;h<this.ma-1;h++){var c=this.l(h+1),k=Ya(b,a,d.x,d.y,c.x,c.y),d=c;k<e&&(f=h,e=k)}return f};W.prototype.invalidateGeometry=W.prototype.Ye=function(){this.Ta=null};v.u(W,{Uo:"geometry"},function(){null===this.Ta&&(this.updateRoute(),this.Ta=this.makeGeometry());return this.Ta});
W.prototype.wt=function(a){if(a||null===this.Ta&&!1!==this.Df)if(this.Ta=this.makeGeometry(),a=this.path,null!==a){a.Ta=this.Ta;for(var b=this.wa.n,c=b.length,d=0;d<c;d++){var e=b[d];e!==a&&e.Lf&&e instanceof X&&(e.Ta=this.Ta)}}};
W.prototype.makeGeometry=function(){var a=this.ma;if(2>a){var b=new Xc(cd),c=new dd(0,0);b.Ub.add(c);return b}var d=!1,b=this.g;null!==b&&Jo(this)&&b.Ql.contains(this)&&null!==this.Cv&&(d=!0);var c=b=0,e=this.l(0).copy(),f=e.copy(),b=this.Wc.n,h=this.computeCurve();if(h===nh&&3<=a&&!K.sb(this.Ep,0))if(3===a)var k=this.l(1),b=Math.min(e.x,k.x),c=Math.min(e.y,k.y),k=this.l(2),b=Math.min(b,k.x),c=Math.min(c,k.y);else{if(this.hc)for(k=0;k<a;k++)c=b[k],f.x=Math.min(c.x,f.x),f.y=Math.min(c.y,f.y);else for(k=
3;k<a;k+=3)k+3>=a&&(k=a-1),b=this.l(k),f.x=Math.min(b.x,f.x),f.y=Math.min(b.y,f.y);b=f.x;c=f.y}else{for(k=0;k<a;k++)c=b[k],f.x=Math.min(c.x,f.x),f.y=Math.min(c.y,f.y);b=f.x;c=f.y}b-=this.cz.x;c-=this.cz.y;e.x-=b;e.y-=c;if(2===a){var l=this.l(1).copy();l.x-=b;l.y-=c;0!==So(this)&&Xo(this,e,!0,f);0!==To(this)&&Xo(this,l,!1,f);b=new Xc(fd);b.Ia=e.x;b.Ja=e.y;b.J=l.x;b.K=l.y}else{l=v.q();0!==So(this)&&Xo(this,e,!0,f);M(l,e.x,e.y,!1,!1);if(h===nh&&3<=a&&!K.sb(this.Ep,0))if(3===a)k=this.l(1),a=k.x-b,d=k.y-
c,k=this.l(2).copy(),k.x-=b,k.y-=c,0!==To(this)&&Xo(this,k,!1,f),O(l,a,d,a,d,k.x,k.y);else if(this.hc){for(var f=new w(b,c),e=this.l(1).copy(),h=new w(b,c),a=new w(b,c),d=this.l(0),m=null,n=this.Ep/3,k=1;k<this.ma-1;k++){var m=this.l(k),p=d,q=m,r=this.l(Yo(this,m,k,!1));if(!K.sb(p.x,q.x)||!K.sb(q.x,r.x))if(!K.sb(p.y,q.y)||!K.sb(q.y,r.y)){var s=n,t=h,u=a;isNaN(s)&&(s=this.Ep/3);var x=p.x,p=p.y,y=q.x,q=q.y,A=r.x,r=r.y,B=s*Zo(x,p,y,q),s=s*Zo(y,q,A,r);K.sb(p,q)&&K.sb(y,A)&&(y>x?r>q?(t.x=y-B,t.y=q-B,u.x=
y+s,u.y=q+s):(t.x=y-B,t.y=q+B,u.x=y+s,u.y=q-s):r>q?(t.x=y+B,t.y=q-B,u.x=y-s,u.y=q+s):(t.x=y+B,t.y=q+B,u.x=y-s,u.y=q-s));K.sb(x,y)&&K.sb(q,r)&&(q>p?(A>y?(t.x=y-B,t.y=q-B,u.x=y+s):(t.x=y+B,t.y=q-B,u.x=y-s),u.y=q+s):(A>y?(t.x=y-B,t.y=q+B,u.x=y+s):(t.x=y+B,t.y=q+B,u.x=y-s),u.y=q-s));if(K.sb(x,y)&&K.sb(y,A)||K.sb(p,q)&&K.sb(q,r))x=.5*(x+A),p=.5*(p+r),t.x=x,t.y=p,u.x=x,u.y=p;1===k?(e.x=.5*(d.x+m.x),e.y=.5*(d.y+m.y)):2===k&&K.sb(d.x,this.l(0).x)&&K.sb(d.y,this.l(0).y)&&(e.x=.5*(d.x+m.x),e.y=.5*(d.y+m.y));
O(l,e.x-b,e.y-c,h.x-b,h.y-c,m.x-b,m.y-c);f.set(h);e.set(a);d=m}}k=d.x;d=d.y;f=this.l(this.ma-1);k=.5*(k+f.x);d=.5*(d+f.y);O(l,a.x-b,a.y-c,k-b,d-c,f.x-b,f.y-c)}else for(k=3;k<a;k+=3)d=this.l(k-2),k+3>=a&&(k=a-1),f=this.l(k-1),e=this.l(k),k===a-1&&0!==To(this)&&(e=e.copy(),Xo(this,e,!1,K.fk)),O(l,d.x-b,d.y-c,f.x-b,f.y-c,e.x-b,e.y-c);else{f=v.M();f.assign(this.l(0));for(k=1;k<a;){k=Yo(this,f,k,1<k);t=this.l(k);if(k>=a-1){f!==t&&(0!==To(this)&&(t=t.copy(),Xo(this,t,!1,K.fk)),$o(this,l,-b,-c,f,t,d));break}k=
Yo(this,t,k+1,k<a-3);e=l;h=-b;m=-c;n=f;u=this.l(k);x=f;p=d;K.D(n.y,t.y)&&K.D(t.x,u.x)?(s=this.computeCorner(),s=Math.min(s,Math.abs(t.x-n.x)/2),s=y=Math.min(s,Math.abs(u.y-t.y)/2),K.D(s,0)?($o(this,e,h,m,n,t,p),x.assign(t)):(q=t.x,A=t.y,r=q,B=A,q=t.x>n.x?t.x-s:t.x+s,B=u.y>t.y?t.y+y:t.y-y,$o(this,e,h,m,n,new w(q,A),p),vd(e,t.x+h,t.y+m,r+h,B+m),x.m(r,B))):K.D(n.x,t.x)&&K.D(t.y,u.y)?(s=this.computeCorner(),y=Math.min(s,Math.abs(t.y-n.y)/2),y=s=Math.min(y,Math.abs(u.x-t.x)/2),K.D(s,0)?($o(this,e,h,m,
n,t,p),x.assign(t)):(q=t.x,B=A=t.y,A=t.y>n.y?t.y-y:t.y+y,r=u.x>t.x?t.x+s:t.x-s,$o(this,e,h,m,n,new w(q,A),p),vd(e,t.x+h,t.y+m,r+h,B+m),x.m(r,B))):($o(this,e,h,m,n,t,p),x.assign(t))}v.v(f)}b=l.o;v.s(l)}return b};function Zo(a,b,c,d){a=c-a;if(isNaN(a)||Infinity===a||-Infinity===a)return NaN;0>a&&(a=-a);b=d-b;if(isNaN(b)||Infinity===b||-Infinity===b)return NaN;0>b&&(b=-b);return K.sb(a,0)?b:K.sb(b,0)?a:Math.sqrt(a*a+b*b)}
function Xo(a,b,c,d){var e=a.ma;if(!(2>e))if(c){var f=a.l(1);c=f.x-d.x;d=f.y-d.y;f=Zo(b.x,b.y,c,d);0!==f&&(e=2===e?.5*f:f,a=So(a),a>e&&(a=e),c=a*(c-b.x)/f,a=a*(d-b.y)/f,b.x+=c,b.y+=a)}else f=a.l(e-2),c=f.x-d.x,d=f.y-d.y,f=Zo(b.x,b.y,c,d),0!==f&&(e=2===e?.5*f:f,a=To(a),a>e&&(a=e),c=a*(b.x-c)/f,a=a*(b.y-d)/f,b.x-=c,b.y-=a)}
function Yo(a,b,c,d){for(var e=a.ma,f=b;K.sb(b.x,f.x)&&K.sb(b.y,f.y);){if(c>=e)return e-1;f=a.l(c++)}if(!K.sb(b.x,f.x)&&!K.sb(b.y,f.y))return c-1;for(var h=f;K.sb(b.x,f.x)&&K.sb(f.x,h.x)&&(!d||(b.y>=f.y?f.y>=h.y:f.y<=h.y))||K.sb(b.y,f.y)&&K.sb(f.y,h.y)&&(!d||(b.x>=f.x?f.x>=h.x:f.x<=h.x));){if(c>=e)return e-1;h=a.l(c++)}return c-2}
function $o(a,b,c,d,e,f,h){if(!h&&Jo(a)){h=[];var k=0;a.isVisible()&&(k=ap(a,e,f,h));var l=e.x,l=e.y;if(0<k)if(K.D(e.y,f.y))if(e.x<f.x)for(var m=0;m<k;){var n=Math.max(e.x,Math.min(h[m++]-5,f.x-10));b.lineTo(n+c,f.y+d);for(var l=n+c,p=Math.min(n+10,f.x);m<k;){var q=h[m];if(q<p+10)m++,p=Math.min(q+5,f.x);else break}q=(n+p)/2+c;q=f.y-10+d;n=p+c;p=f.y+d;a.Ge===fh?M(b,n,p,!1,!1):O(b,l,q,n,q,n,p)}else for(m=k-1;0<=m;){n=Math.min(e.x,Math.max(h[m--]+5,f.x+10));b.lineTo(n+c,f.y+d);l=n+c;for(p=Math.max(n-
10,f.x);0<=m;)if(q=h[m],q>p-10)m--,p=Math.max(q-5,f.x);else break;q=f.y-10+d;n=p+c;p=f.y+d;a.Ge===fh?M(b,n,p,!1,!1):O(b,l,q,n,q,n,p)}else if(K.D(e.x,f.x))if(e.y<f.y)for(m=0;m<k;){n=Math.max(e.y,Math.min(h[m++]-5,f.y-10));b.lineTo(f.x+c,n+d);l=n+d;for(p=Math.min(n+10,f.y);m<k;)if(q=h[m],q<p+10)m++,p=Math.min(q+5,f.y);else break;q=f.x-10+c;n=f.x+c;p+=d;a.Ge===fh?M(b,n,p,!1,!1):O(b,q,l,q,p,n,p)}else for(m=k-1;0<=m;){n=Math.min(e.y,Math.max(h[m--]+5,f.y+10));b.lineTo(f.x+c,n+d);l=n+d;for(p=Math.max(n-
10,f.y);0<=m;)if(q=h[m],q>p-10)m--,p=Math.max(q-5,f.y);else break;q=f.x-10+c;n=f.x+c;p+=d;a.Ge===fh?M(b,n,p,!1,!1):O(b,q,l,q,p,n,p)}}b.lineTo(f.x+c,f.y+d)}
function ap(a,b,c,d){var e=a.g;if(null===e||b.L(c))return 0;for(e=e.Ww;e.next();){var f=e.value;if(null!==f&&f.visible)for(var f=f.zb.n,h=f.length,k=0;k<h;k++){var l=f[k];if(l instanceof W){if(l===a)return 0<d.length&&d.sort(function(a,b){return a-b}),d.length;if(l.isVisible()&&Jo(l)){var m=l.cn;m.H()&&a.cn.tg(m)&&!a.usesSamePort(l)&&(m=l.path,null!==m&&m.ul()&&bp(b,c,d,l))}}}}0<d.length&&d.sort(function(a,b){return a-b});return d.length}
function bp(a,b,c,d){for(var e=K.D(a.y,b.y),f=d.ma,h=d.l(0),k=v.M(),l=1;l<f;l++){var m=d.l(l);if(l<f-1){var n=d.l(l+1);if(h.y===m.y&&m.y===n.y){if(m.x>h.x&&n.x>m.x||m.x<h.x&&n.x<m.x)m=n,l++}else h.x===m.x&&m.x===n.x&&(m.y>h.y&&n.y>m.y||m.y<h.y&&n.y<m.y)&&(m=n,l++)}a:{var n=k,p=a.x,q=a.y,r=b.x,s=b.y,t=h.x,h=h.y,u=m.x,x=m.y;if(!K.D(p,r)){if(K.D(q,s)&&K.D(t,u)&&Math.min(p,r)<t&&Math.max(p,r)>t&&Math.min(h,x)<q&&Math.max(h,x)>q&&!K.D(h,x)){n.x=t;n.y=q;n=!0;break a}}else if(!K.D(q,s)&&K.D(h,x)&&Math.min(q,
s)<h&&Math.max(q,s)>h&&Math.min(t,u)<p&&Math.max(t,u)>p&&!K.D(t,u)){n.x=p;n.y=h;n=!0;break a}n.x=0;n.y=0;n=!1}n&&(e?c.push(k.x):c.push(k.y));h=m}v.v(k)}v.u(W,{at:"firstPickIndex"},function(){return 2>=this.ma?0:this.hc||Mo(this)!==xb?1:0});v.u(W,{Vw:"lastPickIndex"},function(){var a=this.ma;return 0===a?0:2>=a?a-1:this.hc||No(this)!==xb?a-2:a-1});function Jo(a){a=a.Ge;return a===eh||a===fh}function Lo(a,b){if(b||Jo(a)){var c=a.g;null===c||c.Ql.contains(a)||null===a.Cv||c.Ql.add(a,a.Cv)}}
function hh(a,b){var c=a.layer;if(null!==c&&c.visible&&!c.Bc){var d=c.g;if(null!==d)for(var e=!1,d=d.Ww;d.next();){var f=d.value;if(f.visible)if(f===c)for(var e=!0,h=!1,f=f.zb.n,k=f.length,l=0;l<k;l++){var m=f[l];m instanceof W&&(m===a?h=!0:h&&cp(a,m,b))}else if(e)for(f=f.zb.n,k=f.length,l=0;l<k;l++)m=f[l],m instanceof W&&cp(a,m,b)}}}function cp(a,b,c){if(null!==b&&null!==b.Ta&&Jo(b)){var d=b.cn;d.H()&&(a.cn.tg(d)||c.tg(d))&&(a.usesSamePort(b)||b.Ye())}}
W.prototype.usesSamePort=function(a){var b=this.ma,c=a.ma;if(0<b&&0<c){var d=this.l(0),e=a.l(0);if(d.Ie(e))return!0;b=this.l(b-1);a=a.l(c-1);if(b.Ie(a)||d.Ie(a)||b.Ie(e))return!0}else if(this.U===a.U||this.ba===a.ba||this.U===a.ba||this.ba===a.U)return!0;return!1};
W.prototype.isVisible=function(){if(!J.prototype.isVisible.call(this))return!1;var a=this.Sa,b=!0,c=this.g;null!==c&&(b=c.Md);c=this.U;if(null!==c){if(this.Cc&&b&&!c.od)return!1;if(c===a)return!0;c=c.findVisibleNode();if(null===c||c===a)return!1}c=this.ba;if(null!==c){if(this.Cc&&!b&&!c.od)return!1;if(c===a)return!0;b=c.findVisibleNode();if(null===b||b===a)return!1}return!0};W.prototype.oe=function(a){J.prototype.oe.call(this,a);null!==this.di&&this.di.Tm();if(null!==this.we)for(var b=this.we.i;b.next();)b.value.oe(a)};
v.defineProperty(W,{Is:"adjusting"},function(){return this.Sp},function(a){var b=this.Sp;b!==a&&(this.Sp=a,this.h("adjusting",b,a))});v.defineProperty(W,{yz:"corner"},function(){return this.iq},function(a){var b=this.iq;b!==a&&(this.iq=a,this.Ye(),this.h("corner",b,a))});v.defineProperty(W,{Ge:"curve"},function(){return this.lq},function(a){var b=this.lq;b!==a&&(this.lq=a,this.gc(),Lo(this,b===fh||b===eh||a===fh||a===eh),this.h("curve",b,a))});
v.defineProperty(W,{ww:"curviness"},function(){return this.mq},function(a){var b=this.mq;b!==a&&(this.mq=a,this.gc(),this.h("curviness",b,a))});v.defineProperty(W,{ox:"routing"},function(){return this.nm},function(a){var b=this.nm;b!==a&&(this.nm=a,this.oi=null,this.gc(),Lo(this,2===(b.value&2)||2===(a.value&2)),this.h("routing",b,a))});v.defineProperty(W,{Ep:"smoothness"},function(){return this.ls},function(a){var b=this.ls;b!==a&&(this.ls=a,this.Ye(),this.h("smoothness",b,a))});
function Ho(a){var b=a.Yf;if(null!==b){var c=a.jg;if(null!==c){var d=a.Ah;a=a.Qh;for(var e=null,f=null,h=b.dc.n,k=h.length,l=0;l<k;l++){var m=h[l];if(m.Yf===b&&m.Ah===d&&m.jg===c&&m.Qh===a||m.Yf===c&&m.Ah===a&&m.jg===b&&m.Qh===d)null===f?f=m:(null===e&&(e=[],e.push(f)),e.push(m))}if(null!==e){f=po(b,c,d,a);null===f&&(f=new $i,f.op=b,f.gx=d,f.Ct=c,f.hx=a,oo(b,f),oo(c,f));f.links=e;for(l=0;l<e.length;l++)m=e[l],m.di=f;f.Tm()}}}}
function Go(a){var b=a.di;null!==b&&(a.di=null,a=b.links.indexOf(a),0<=a&&(v.Th(b.links,a),b.Tm()))}function $i(){v.cc(this);this.bv=!1;this.hx=this.Ct=this.gx=this.op=null;this.links=[]}$i.prototype.Tm=function(){if(!this.bv){var a=this.links;0<a.length&&(a=a[0].g,null!==a&&a.RB.add(this))}this.bv=!0};
$i.prototype.OA=function(){if(this.bv){this.bv=!1;var a=this.links;if(0<a.length){var b=a[0],c=b.g;b.arrangeBundledLinks(a,null===c||c.ve);1===a.length&&(b.di=null,a.length=0)}0===a.length&&(a=this.op,null!==this&&null!==a.rh&&a.rh.remove(this),a=this.Ct,null!==this&&null!==a.rh&&a.rh.remove(this))}};v.Jd($i,{op:!0,gx:!0,Ct:!0,hx:!0,links:!0,spacing:!0});
function Wk(){v.cc(this);this.FA=this.group=null;this.kt=!0;this.abort=!1;this.eg=this.dg=1;this.jr=this.ir=-1;this.ge=this.fe=8;this.mc=null;this.HF=!1;this.pF=22;this.AE=111}v.Jd(Wk,{group:!0,FA:!0,kt:!0,abort:!0,HF:!0,pF:!0,AE:!0});
Wk.prototype.initialize=function(a){if(!(0>=a.width||0>=a.height)){var b=a.y,c=a.x+a.width,d=a.y+a.height;this.dg=Math.floor((a.x-this.fe)/this.fe)*this.fe;this.eg=Math.floor((b-this.ge)/this.ge)*this.ge;this.ir=Math.ceil((c+2*this.fe)/this.fe)*this.fe;this.jr=Math.ceil((d+2*this.ge)/this.ge)*this.ge;a=1+(Math.ceil((this.ir-this.dg)/this.fe)|0);b=1+(Math.ceil((this.jr-this.eg)/this.ge)|0);if(null===this.mc||this.yo<a-1||this.zo<b-1){c=[];for(d=0;d<=a;d++){for(var e=[],f=0;f<=b;f++)e[f]=0;c[d]=e}this.mc=
c;this.yo=a-1;this.zo=b-1}if(null!==this.mc)for(a=0;a<=this.yo;a++)for(b=0;b<=this.zo;b++)this.mc[a][b]=999999}};v.u(Wk,{pb:null},function(){return new z(this.dg,this.eg,this.ir-this.dg,this.jr-this.eg)});v.defineProperty(Wk,{Io:null},function(){return this.fe},function(a){0<a&&a!==this.fe&&(this.fe=a,this.initialize(this.pb))});v.defineProperty(Wk,{Go:null},function(){return this.ge},function(a){0<a&&a!==this.ge&&(this.ge=a,this.initialize(this.pb))});
function dp(a,b,c){return a.dg<=b&&b<=a.ir&&a.eg<=c&&c<=a.jr}function Vo(a,b,c){if(!dp(a,b,c))return 0;b-=a.dg;b/=a.fe;c-=a.eg;c/=a.ge;return a.mc[b|0][c|0]}function Zk(a,b,c){dp(a,b,c)&&(b-=a.dg,b/=a.fe,c-=a.eg,c/=a.ge,a.mc[b|0][c|0]=0)}function Yk(a){if(null!==a.mc)for(var b=0;b<=a.yo;b++)for(var c=0;c<=a.zo;c++)1<=a.mc[b][c]&&(a.mc[b][c]|=999999)}
Wk.prototype.dp=function(a,b,c,d){if(a>this.ir||a+c<this.dg||b>this.jr||b+d<this.eg)return!0;a=(a-this.dg)/this.fe|0;b=(b-this.eg)/this.ge|0;c=Math.max(0,c)/this.fe+1|0;var e=Math.max(0,d)/this.ge+1|0;0>a&&(c+=a,a=0);0>b&&(e+=b,b=0);if(0>c||0>e)return!0;d=Math.min(a+c-1,this.yo)|0;for(c=Math.min(b+e-1,this.zo)|0;a<=d;a++)for(e=b;e<=c;e++)if(0===this.mc[a][e])return!1;return!0};
function ep(a,b,c,d,e,f,h,k,l){if(!(b<f||b>h||c<k||c>l)){var m,n;m=b|0;n=c|0;var p=a.mc[m][n];if(1<=p&&999999>p)for(e?n+=d:m+=d,p+=1;f<=m&&m<=h&&k<=n&&n<=l&&!(p>=a.mc[m][n]);)a.mc[m][n]=p,p+=1,e?n+=d:m+=d;m=e?n:m;if(e)if(0<d)for(c+=d;c<m;c+=d)ep(a,b,c,1,!e,f,h,k,l),ep(a,b,c,-1,!e,f,h,k,l);else for(c+=d;c>m;c+=d)ep(a,b,c,1,!e,f,h,k,l),ep(a,b,c,-1,!e,f,h,k,l);else if(0<d)for(b+=d;b<m;b+=d)ep(a,b,c,1,!e,f,h,k,l),ep(a,b,c,-1,!e,f,h,k,l);else for(b+=d;b>m;b+=d)ep(a,b,c,1,!e,f,h,k,l),ep(a,b,c,-1,!e,f,h,
k,l)}}function fp(a,b,c,d,e,f,h,k,l,m,n){for(var p=b|0,q=c|0,r=a.mc[p][q];0===r&&p>k&&p<l&&q>m&&q<n;)if(h?q+=f:p+=f,r=a.mc[p][q],1>=Math.abs(p-d)&&1>=Math.abs(q-e))return a.abort=!0,0;p=b|0;q=c|0;r=a.mc[p][q];b=1;for(a.mc[p][q]=b;0===r&&p>k&&p<l&&q>m&&q<n;)h?q+=f:p+=f,r=a.mc[p][q],a.mc[p][q]=b,b+=1;return h?q:p}
function Uo(a,b,c,d,e,f){if(null!==a.mc){a.abort=!1;var h=b.x,k=b.y;if(dp(a,h,k)){var h=h-a.dg,h=h/a.fe,k=k-a.eg,k=k/a.ge,l=d.x,m=d.y;if(dp(a,l,m))if(l-=a.dg,l/=a.fe,m-=a.eg,m/=a.ge,1>=Math.abs(h-l)&&1>=Math.abs(k-m))a.abort=!0;else{var n=f.x;b=f.y;d=f.x+f.width;var p=f.y+f.height,n=n-a.dg,n=n/a.fe;b-=a.eg;b/=a.ge;d-=a.dg;d/=a.fe;p-=a.eg;p/=a.ge;f=Math.max(0,Math.min(a.yo,n|0));d=Math.min(a.yo,Math.max(0,d|0));b=Math.max(0,Math.min(a.zo,b|0));var p=Math.min(a.zo,Math.max(0,p|0)),h=h|0,k=k|0,l=l|0,
m=m|0,n=h,q=k,r=0===c||90===c?1:-1;(c=90===c||270===c)?q=fp(a,h,k,l,m,r,c,f,d,b,p):n=fp(a,h,k,l,m,r,c,f,d,b,p);if(!a.abort){a:{c=0===e||90===e?1:-1;e=90===e||270===e;for(var r=l|0,s=m|0,t=a.mc[r][s];0===t&&r>f&&r<d&&s>b&&s<p;)if(e?s+=c:r+=c,t=a.mc[r][s],1>=Math.abs(r-h)&&1>=Math.abs(s-k)){a.abort=!0;break a}r=l|0;s=m|0;t=a.mc[r][s];for(a.mc[r][s]=999999;0===t&&r>f&&r<d&&s>b&&s<p;)e?s+=c:r+=c,t=a.mc[r][s],a.mc[r][s]=999999}a.abort||(ep(a,n,q,1,!1,f,d,b,p),ep(a,n,q,-1,!1,f,d,b,p),ep(a,n,q,1,!0,f,d,
b,p),ep(a,n,q,-1,!0,f,d,b,p))}}}}}function Qo(){v.cc(this);this.port=this.Dc=null;this.Qf=[];this.np=!1}v.Jd(Qo,{Dc:!0,port:!0,Qf:!0,np:!0});Qo.prototype.toString=function(){for(var a=this.Qf,b=this.Dc.toString()+" "+a.length.toString()+":",c=0;c<a.length;c++){var d=a[c];null!==d&&(b+="\n  "+d.toString())}return b};
function gp(a,b,c,d){b=b.offsetY;switch(b){case v.Sc:return 90;case v.Gc:return 180;case v.fd:return 270;case v.Tc:return 0}switch(b){case v.Sc|v.fd:return 180<c?270:90;case v.Gc|v.Tc:return 90<c&&270>=c?180:0}a=180*Math.atan2(a.height,a.width)/Math.PI;switch(b){case v.Gc|v.fd:return c>a&&c<=180+a?180:270;case v.fd|v.Tc:return c>180-a&&c<=360-a?270:0;case v.Tc|v.Sc:return c>a&&c<=180+a?90:0;case v.Sc|v.Gc:return c>180-a&&c<=360-a?180:90;case v.Gc|v.fd|v.Tc:return 90<c&&c<=180+a?180:c>180+a&&c<=360-
a?270:0;case v.fd|v.Tc|v.Sc:return 180<c&&c<=360-a?270:c>a&&180>=c?90:0;case v.Tc|v.Sc|v.Gc:return c>a&&c<=180-a?90:c>180-a&&270>=c?180:0;case v.Sc|v.Gc|v.fd:return c>180-a&&c<=180+a?180:c>180+a?270:90}d&&b!==(v.Gc|v.fd|v.Tc|v.Sc)&&(c-=15,0>c&&(c+=360));return c>a&&c<180-a?90:c>=180-a&&c<=180+a?180:c>180+a&&c<360-a?270:0}Qo.prototype.Tm=function(){this.Qf.length=0};
function Ro(a,b){var c=a.Qf;if(0===c.length){a:if(!a.np){c=a.np;a.np=!0;var d,e=null,f=a.Dc,f=f instanceof T?f:null;if(null===f||f.be)d=a.Dc.YD(a.port.Od);else{if(!f.Z.H()){a.np=c;break a}e=f;d=e.XD()}var h=a.Qf.length=0,k=a.port.fb(zb,v.M()),l=a.port.fb(Vb,v.M()),f=v.ek(k.x,k.y,0,0);f.Zi(l);v.v(k);v.v(l);k=v.Rb(f.x+f.width/2,f.y+f.height/2);for(d=d.i;d.next();)if(l=d.value,l.isVisible()){var m=xb,n=l.$c===a.port||l.U.Yh(e),m=n?Mo(l,a.port):No(l,a.port);if(m.ap()&&(n=n?l.Bd:l.$c,null!==n)){var p=
n.V;if(null!==p){var n=l.computeOtherPoint(p,n),p=k.Wg(n),m=gp(f,m,p,l.hc),q=0;0===m?(q=v.Tc,180<p&&(p-=360)):q=90===m?v.Sc:180===m?v.Gc:v.fd;m=a.Qf[h];void 0===m?(m=new hp(l,p,q),a.Qf[h]=m):(m.link=l,m.angle=p,m.ee=q);m.ex.set(n);h++}}}v.v(k);a.Qf.sort(Qo.prototype.sI);e=a.Qf.length;k=-1;for(h=d=0;h<e;h++)m=a.Qf[h],void 0!==m&&(m.ee!==k&&(k=m.ee,d=0),m.Yo=d,d++);k=-1;d=0;for(h=e-1;0<=h;h--)m=a.Qf[h],void 0!==m&&(m.ee!==k&&(k=m.ee,d=m.Yo+1),m.Km=d);h=a.Qf;n=a.port;e=a.Dc.zI;k=v.M();d=v.M();l=v.M();
m=v.M();n.fb(zb,k);n.fb(Gb,d);n.fb(Vb,l);n.fb(Rb,m);var r=q=p=n=0;if(e===no)for(var s=0;s<h.length;s++){var t=h[s];if(null!==t){var u=t.link.computeThickness();switch(t.ee){case v.Sc:q+=u;break;case v.Gc:r+=u;break;case v.fd:n+=u;break;default:case v.Tc:p+=u}}}for(var x=0,y=0,A=1,s=0;s<h.length;s++)if(t=h[s],null!==t){var B,I;if(x!==t.ee){x=t.ee;switch(x){case v.Sc:B=l;I=m;break;case v.Gc:B=m;I=k;break;case v.fd:B=k;I=d;break;default:case v.Tc:B=d,I=l}var D=I.x-B.x;I=I.y-B.y;switch(x){case v.Sc:q>
Math.abs(D)?(A=Math.abs(D)/q,q=Math.abs(D)):A=1;break;case v.Gc:r>Math.abs(I)?(A=Math.abs(I)/r,r=Math.abs(I)):A=1;break;case v.fd:n>Math.abs(D)?(A=Math.abs(D)/n,n=Math.abs(D)):A=1;break;default:case v.Tc:p>Math.abs(I)?(A=Math.abs(I)/p,p=Math.abs(I)):A=1}y=0}var V=t.fp;if(e===no){u=t.link.computeThickness();u*=A;V.set(B);switch(x){case v.Sc:V.x=B.x+D/2+q/2-y-u/2;break;case v.Gc:V.y=B.y+I/2+r/2-y-u/2;break;case v.fd:V.x=B.x+D/2-n/2+y+u/2;break;default:case v.Tc:V.y=B.y+I/2-p/2+y+u/2}y+=u}else u=.5,
e===ko&&(u=(t.Yo+1)/(t.Km+1)),V.x=B.x+D*u,V.y=B.y+I*u}v.v(k);v.v(d);v.v(l);v.v(m);B=a.Qf;for(D=0;D<B.length;D++)I=B[D],null!==I&&(I.Aw=a.computeEndSegmentLength(I));a.np=c;v.fc(f)}c=a.Qf}for(f=0;f<c.length;f++)if(B=c[f],null!==B&&B.link===b)return B;return null}Qo.prototype.sI=function(a,b){return a===b?0:null===a?-1:null===b?1:a.ee<b.ee?-1:a.ee>b.ee?1:a.angle<b.angle?-1:a.angle>b.angle?1:0};
Qo.prototype.computeEndSegmentLength=function(a){var b=a.link,c=b.computeEndSegmentLength(this.Dc,this.port,xb,b.$c===this.port),d=a.Yo;if(0>d)return c;var e=a.Km;if(1>=e||!b.hc)return c;var b=a.ex,f=a.fp;if(a.ee===v.Gc||a.ee===v.Sc)d=e-1-d;return((a=a.ee===v.Gc||a.ee===v.Tc)?b.y<f.y:b.x<f.x)?c+8*d:(a?b.y===f.y:b.x===f.x)?c:c+8*(e-1-d)};function hp(a,b,c){this.link=a;this.angle=b;this.ee=c;this.ex=new w;this.Km=this.Yo=0;this.fp=new w;this.Aw=0}
v.Jd(hp,{link:!0,angle:!0,ee:!0,ex:!0,Yo:!0,Km:!0,fp:!0,Aw:!0});hp.prototype.toString=function(){return this.link.toString()+" "+this.angle.toString()+" "+this.ee.toString()+":"+this.Yo.toString()+"/"+this.Km.toString()+" "+this.fp.toString()+" "+this.Aw.toString()+" "+this.ex.toString()};function rl(){this.Mj=this.lj=yc;this.Kj=this.jj=NaN;this.Jj=this.ij=lo;this.Lj=this.kj=NaN}
rl.prototype.copy=function(){var a=new rl;a.lj=this.lj.aa();a.Mj=this.Mj.aa();a.jj=this.jj;a.Kj=this.Kj;a.ij=this.ij;a.Jj=this.Jj;a.kj=this.kj;a.Lj=this.Lj;return a};function T(a){0===arguments.length?S.call(this,yh):S.call(this,a);this.lr=new H(J);this.eo=new H(T);this.Lk=this.mr=this.kr=null;this.ys=!1;this.Sq=!0;this.As=!1;this.Hb=this.ps=null;this.bq=!1;this.cq=!0;this.Hq=this.dq=!1;this.Qd=new Me;this.Qd.group=this;this.Qy=!1}v.Ga(T,S);v.ga("Group",T);
T.prototype.cloneProtected=function(a){S.prototype.cloneProtected.call(this,a);a.kr=this.kr;a.mr=this.mr;a.Lk=this.Lk;a.ys=this.ys;a.Sq=this.Sq;a.As=this.As;a.ps=this.ps;var b=a.Vs(function(a){return a instanceof sh});a.Hb=b instanceof sh?b:null;a.bq=this.bq;a.cq=this.cq;a.dq=this.dq;a.Hq=this.Hq;null!==this.Qd?(a.Qd=this.Qd.copy(),a.Qd.group=a):(null!==a.Qd&&(a.Qd.group=null),a.Qd=null)};
T.prototype.Vh=function(a){S.prototype.Vh.call(this,a);var b=a.Ro();for(a=a.Pc;a.next();){var c=a.value;c.P();c.G(8);c.Os();if(c instanceof S)c.invalidateConnectedLinks(b);else if(c instanceof W)for(c=c.Mf;c.next();)c.value.invalidateConnectedLinks(b)}};
T.prototype.bn=function(a,b,c,d,e,f,h){if(a===Qd&&"elements"===b)if(e instanceof sh){var k=e;null===this.Hb?this.Hb=k:this.Hb!==k&&v.k("Cannot insert a second Placeholder into the visual tree of a Group.")}else e instanceof C&&(k=e.Vs(function(a){return a instanceof sh}),k instanceof sh&&(null===this.Hb?this.Hb=k:this.Hb!==k&&v.k("Cannot insert a second Placeholder into the visual tree of a Group.")));else a===be&&"elements"===b&&null!==this.Hb&&(d===this.Hb?this.Hb=null:d instanceof C&&this.Hb.rl(d)&&
(this.Hb=null));S.prototype.bn.call(this,a,b,c,d,e,f,h)};T.prototype.Li=function(a,b,c,d){this.Kk=this.Hb;C.prototype.Li.call(this,a,b,c,d)};T.prototype.sl=function(){if(!S.prototype.sl.call(this))return!1;for(var a=this.Pc;a.next();){var b=a.value;if(b instanceof S){if(b.isVisible()&&Kj(b))return!1}else if(b instanceof W&&b.isVisible()&&Kj(b)&&b.U!==this&&b.ba!==this)return!1}return!0};v.u(T,{placeholder:"placeholder"},function(){return this.Hb});
v.defineProperty(T,{HD:"computesBoundsAfterDrag"},function(){return this.bq},function(a){var b=this.bq;b!==a&&(v.j(a,"boolean",T,"computesBoundsAfterDrag"),this.bq=a,this.h("computesBoundsAfterDrag",b,a))});v.defineProperty(T,{LG:"computesBoundsIncludingLinks"},function(){return this.cq},function(a){v.j(a,"boolean",T,"computesBoundsIncludingLinks");var b=this.cq;b!==a&&(this.cq=a,this.h("computesBoundsIncludingLinks",b,a))});
v.defineProperty(T,{MG:"computesBoundsIncludingLocation"},function(){return this.dq},function(a){v.j(a,"boolean",T,"computesBoundsIncludingLocation");var b=this.dq;b!==a&&(this.dq=a,this.h("computesBoundsIncludingLocation",b,a))});v.defineProperty(T,{BH:"handlesDragDropForMembers"},function(){return this.Hq},function(a){v.j(a,"boolean",T,"handlesDragDropForMembers");var b=this.Hq;b!==a&&(this.Hq=a,this.h("handlesDragDropForMembers",b,a))});v.u(T,{Pc:"memberParts"},function(){return this.lr.i});
function fo(a,b){if(a.lr.add(b)){b instanceof T&&a.eo.add(b);var c=a.jI;if(null!==c){var d=!0,e=a.g;null!==e&&(d=e.Qa,e.Qa=!0);c(a,b);null!==e&&(e.Qa=d)}a.isVisible()&&a.be||b.oe(!1)}c=a.Hb;null===c&&(c=a);c.P()}function eo(a,b){if(a.lr.remove(b)){b instanceof T&&a.eo.remove(b);var c=a.kI;if(null!==c){var d=!0,e=a.g;null!==e&&(d=e.Qa,e.Qa=!0);c(a,b);null!==e&&(e.Qa=d)}a.isVisible()&&a.be||b.oe(!0)}c=a.Hb;null===c&&(c=a);c.P()}
T.prototype.Nm=function(){if(0<this.lr.count){var a=this.g;if(null!==a)for(var b=this.lr.copy().i;b.next();)a.remove(b.value)}S.prototype.Nm.call(this)};v.defineProperty(T,{Pb:"layout"},function(){return this.Qd},function(a){var b=this.Qd;b!==a&&(null!==a&&v.C(a,Me,T,"layout"),null!==b&&(b.g=null,b.group=null),this.Qd=a,null!==a&&(a.g=this.g,a.group=this),this.h("layout",b,a))});
v.defineProperty(T,{jI:"memberAdded"},function(){return this.kr},function(a){var b=this.kr;b!==a&&(null!==a&&v.j(a,"function",T,"memberAdded"),this.kr=a,this.h("memberAdded",b,a))});v.defineProperty(T,{kI:"memberRemoved"},function(){return this.mr},function(a){var b=this.mr;b!==a&&(null!==a&&v.j(a,"function",T,"memberRemoved"),this.mr=a,this.h("memberRemoved",b,a))});
v.defineProperty(T,{$z:"memberValidation"},function(){return this.Lk},function(a){var b=this.Lk;b!==a&&(null!==a&&v.j(a,"function",T,"memberValidation"),this.Lk=a,this.h("memberValidation",b,a))});T.prototype.canAddMembers=function(a){var b=this.g;if(null===b)return!1;b=b.rb;for(a=yf(a).i;a.next();)if(!b.isValidMember(this,a.value))return!1;return!0};
T.prototype.addMembers=function(a,b){var c=this.g;if(null===c)return!1;for(var c=c.rb,d=!0,e=yf(a).i;e.next();){var f=e.value;!b||c.isValidMember(this,f)?f.Sa=this:d=!1}return d};v.defineProperty(T,{mJ:"ungroupable"},function(){return this.ys},function(a){var b=this.ys;b!==a&&(v.j(a,"boolean",T,"ungroupable"),this.ys=a,this.h("ungroupable",b,a))});T.prototype.canUngroup=function(){if(!this.mJ)return!1;var a=this.layer;if(null!==a&&!a.ow)return!1;a=a.g;return null===a||a.ow?!0:!1};
T.prototype.invalidateConnectedLinks=function(a){void 0===a&&(a=null);S.prototype.invalidateConnectedLinks.call(this,a);for(var b=this.XD();b.next();){var c=b.value;if(null===a||!a.contains(c)){var d=c.U;null!==d&&d!==this&&d.Yh(this)&&!d.isVisible()?c.gc():(d=c.ba,null!==d&&d!==this&&d.Yh(this)&&!d.isVisible()&&c.gc())}}};
T.prototype.findExternalLinksConnected=T.prototype.XD=function(){var a=this.Ro();a.add(this);for(var b=new H(W),c=a.i;c.next();){var d=c.value;if(d instanceof S)for(d=d.ne;d.next();){var e=d.value;a.contains(e)||b.add(e)}}return b.i};T.prototype.findExternalNodesConnected=function(){var a=this.Ro();a.add(this);for(var b=new H(S),c=a.i;c.next();){var d=c.value;if(d instanceof S)for(d=d.ne;d.next();){var e=d.value,f=e.U;a.contains(f)&&f!==this||b.add(f);e=e.ba;a.contains(e)&&e!==this||b.add(e)}}return b.i};
T.prototype.findSubGraphParts=T.prototype.Ro=function(){var a=new H(J);lf(a,this,!0,0,!0);a.remove(this);return a};T.prototype.oe=function(a){S.prototype.oe.call(this,a);for(var b=this.Pc;b.next();)b.value.oe(a)};T.prototype.collapseSubGraph=T.prototype.collapseSubGraph=function(){var a=this.g;if(null!==a&&!a.Xg){a.Xg=!0;var b=this.Ro();ip(this,b,a.Oa,this);a.Xg=!1}};
function ip(a,b,c,d){for(var e=a.Pc;e.next();){var f=e.value;f.oe(!1);if(f instanceof T){var h=f;h.be&&(h.QA=h.be,ip(h,b,c,d))}if(f instanceof S)f.invalidateConnectedLinks(b),vi(c,f,d);else if(f instanceof W)for(f=f.Mf;f.next();)f.value.invalidateConnectedLinks(b)}a.be=!1}T.prototype.expandSubGraph=T.prototype.expandSubGraph=function(){var a=this.g;if(null!==a&&!a.Xg){a.Xg=!0;var b=this.Ro();jp(this,b,a.Oa,this);a.Xg=!1}};
function jp(a,b,c,d){for(var e=a.Pc;e.next();){var f=e.value;f.oe(!0);if(f instanceof T){var h=f;h.QA&&(h.QA=!1,jp(h,b,c,d))}if(f instanceof S)f.invalidateConnectedLinks(b),ui(c,f,d);else if(f instanceof W)for(f=f.Mf;f.next();)f.value.invalidateConnectedLinks(b)}a.be=!0}
v.defineProperty(T,{be:"isSubGraphExpanded"},function(){return this.Sq},function(a){var b=this.Sq;if(b!==a){v.j(a,"boolean",T,"isSubGraphExpanded");this.Sq=a;var c=this.g;this.h("isSubGraphExpanded",b,a);b=this.bJ;if(null!==b){var d=!0;null!==c&&(d=c.Qa,c.Qa=!0);b(this);null!==c&&(c.Qa=d)}null!==c&&c.ja.ib?null!==this.Hb&&this.Hb.P():a?this.expandSubGraph():this.collapseSubGraph()}});
v.defineProperty(T,{QA:"wasSubGraphExpanded"},function(){return this.As},function(a){var b=this.As;b!==a&&(v.j(a,"boolean",T,"wasSubGraphExpanded"),this.As=a,this.h("wasSubGraphExpanded",b,a))});v.defineProperty(T,{bJ:"subGraphExpandedChanged"},function(){return this.ps},function(a){var b=this.ps;b!==a&&(null!==a&&v.j(a,"function",T,"subGraphExpandedChanged"),this.ps=a,this.h("subGraphExpandedChanged",b,a))});
T.prototype.move=function(a){var b=this.position,c=b.x;isNaN(c)&&(c=0);b=b.y;isNaN(b)&&(b=0);var c=a.x-c,b=a.y-b,d=v.Rb(c,b);S.prototype.move.call(this,a);for(a=this.Ro().i;a.next();){var e=a.value;if(!(e instanceof W||e instanceof S&&e.qf)){var f=e.position,h=e.location;f.H()?(d.x=f.x+c,d.y=f.y+b,e.position=d):h.H()&&(d.x=h.x+c,d.y=h.y+b,e.location=d)}}for(a.reset();a.next();)e=a.value,e instanceof W&&(f=e.position,d.x=f.x+c,d.y=f.y+b,e.move(d));v.v(d)};
function sh(){R.call(this);this.Re=K.Mp;this.Xr=new z(NaN,NaN,NaN,NaN)}v.Ga(sh,R);v.ga("Placeholder",sh);sh.prototype.cloneProtected=function(a){R.prototype.cloneProtected.call(this,a);a.Re=this.Re.aa();a.Xr=this.Xr.copy()};sh.prototype.Rj=function(a){if(null===this.background&&null===this.Cm)return!1;var b=this.Fa;return sb(0,0,b.width,b.height,a.x,a.y)};
sh.prototype.ip=function(){var a=this.V;null!==a&&(a instanceof T||a instanceof mf)||v.k("Placeholder is not inside a Group or Adornment.");if(a instanceof T){var b=this.computeBorder(this.Xr),c=this.Jc;eb(c,b.width||0,b.height||0);vl(this,0,0,c.width,c.height);for(var c=a.Pc,d=!1;c.next();)if(c.value.isVisible()){d=!0;break}!d||isNaN(b.x)||isNaN(b.y)||(c=new w,c.St(b,a.Ze),a.location=new w(c.x,c.y))}else{var b=this.xa,c=this.Jc,d=this.padding,e=d.left+d.right,f=d.top+d.bottom;if(b.H())eb(c,b.width+
e||0,b.height+f||0),vl(this,-d.left,-d.top,c.width,c.height);else{var h=a.ec,k=h.fb(zb,v.M()),b=v.ek(k.x,k.y,0,0);b.Zi(h.fb(Vb,k));b.Zi(h.fb(Gb,k));b.Zi(h.fb(Rb,k));a.Kg.m(b.x,b.y);eb(c,b.width+e||0,b.height+f||0);vl(this,-d.left,-d.top,c.width,c.height);v.v(k);v.fc(b)}}};sh.prototype.Li=function(a,b,c,d){var e=this.Z;e.x=a;e.y=b;e.width=c;e.height=d};
sh.prototype.computeBorder=function(a){var b=this.V;if(b instanceof T){var c=b;if(c.HD&&this.Xr.H()){var d=c.g;if(null!==d&&(d=d.$a,d instanceof wf&&!d.vq&&null!==d.$b&&!d.$b.contains(c)))return a.assign(this.Xr),a}}var c=v.Uf(),d=this.computeMemberBounds(c),e=this.padding;a.m(d.x-e.left,d.y-e.top,d.width+e.left+e.right,d.height+e.top+e.bottom);v.fc(c);b instanceof T&&(c=b,c.MG&&c.location.H()&&a.Zi(c.location));return a};
sh.prototype.computeMemberBounds=function(a){if(!(this.V instanceof T))return a.m(0,0,0,0),a;for(var b=this.V,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,h=b.Pc;h.next();){var k=h.value;if(k.isVisible()){if(k instanceof W){var l=k;if(!b.LG)continue;if(Jj(l))continue;if(l.U===b||l.ba===b)continue}k=k.Z;k.left<c&&(c=k.left);k.top<d&&(d=k.top);k.right>e&&(e=k.right);k.bottom>f&&(f=k.bottom)}}isFinite(c)&&isFinite(d)?a.m(c,d,e-c,f-d):(b=b.location,c=this.padding,a.m(b.x+c.left,b.y+c.top,0,0));return a};
v.defineProperty(sh,{padding:"padding"},function(){return this.Re},function(a){"number"===typeof a?((isNaN(a)||0>a)&&v.ua(a,">= 0",sh,"padding"),a=new tb(a)):(v.C(a,tb,sh,"padding"),(isNaN(a.left)||0>a.left)&&v.ua(a.left,">= 0",sh,"padding:value.left"),(isNaN(a.right)||0>a.right)&&v.ua(a.right,">= 0",sh,"padding:value.right"),(isNaN(a.top)||0>a.top)&&v.ua(a.top,">= 0",sh,"padding:value.top"),(isNaN(a.bottom)||0>a.bottom)&&v.ua(a.bottom,">= 0",sh,"padding:value.bottom"));var b=this.Re;b.L(a)||(this.Re=
a=a.aa(),this.h("padding",b,a))});function Me(){0<arguments.length&&v.dd(Me);v.cc(this);this.zy=this.W=null;this.pj=this.Oq=!0;this.Wq=!1;this.Vp=(new w(0,0)).freeze();this.Pq=this.Rq=!0;this.DB="";this.Wl=!1;this.Ry=null}v.ga("Layout",Me);Me.prototype.cloneProtected=function(a){a.Oq=this.Oq;a.pj=this.pj;a.Wq=this.Wq;a.Vp.assign(this.Vp);a.Rq=this.Rq;a.Pq=this.Pq;a.DB=this.DB;this.pj||(a.Wl=!0)};Me.prototype.copy=function(){var a=new this.constructor;this.cloneProtected(a);return a};
Me.prototype.toString=function(){var a=v.nf(Object.getPrototypeOf(this)),a=a+"(";null!==this.group&&(a+=" in "+this.group);null!==this.g&&(a+=" for "+this.g);return a+")"};v.defineProperty(Me,{g:"diagram"},function(){return this.W},function(a){null!==a&&v.C(a,E,Me,"diagram");this.W=a});v.defineProperty(Me,{group:"group"},function(){return this.zy},function(a){this.zy!==a&&(null!==a&&v.C(a,T,Me,"group"),this.zy=a,null!==a&&(this.W=a.g))});
v.defineProperty(Me,{SH:"isOngoing"},function(){return this.Oq},function(a){this.Oq!==a&&(v.j(a,"boolean",Me,"isOngoing"),this.Oq=a)});v.defineProperty(Me,{vE:"isInitial"},function(){return this.pj},function(a){v.j(a,"boolean",Me,"isInitial");this.pj=a;a||(this.Wl=!0)});v.defineProperty(Me,{Tw:"isViewportSized"},function(){return this.Wq},function(a){this.Wq!==a&&(v.j(a,"boolean",Me,"isViewportSized"),(this.Wq=a)&&this.G())});
v.defineProperty(Me,{pt:"isRouting"},function(){return this.Rq},function(a){this.Rq!==a&&(v.j(a,"boolean",Me,"isRouting"),this.Rq=a)});v.defineProperty(Me,{Uz:"isRealtime"},function(){return this.Pq},function(a){this.Pq!==a&&(v.j(a,"boolean",Me,"isRealtime"),this.Pq=a)});v.defineProperty(Me,{sf:"isValidLayout"},function(){return this.Wl},function(a){this.Wl!==a&&(v.j(a,"boolean",Me,"isValidLayout"),this.Wl=a,a||(a=this.g,null!==a&&(a.su=!0)))});
Me.prototype.invalidateLayout=Me.prototype.G=function(){if(this.Wl){var a=this.g;if(null!==a&&!a.ja.ib){var b=a.Oa;!b.Xn&&(b.pf&&b.Xi(),this.SH&&a.ve||this.vE&&!a.ve)&&(this.sf=!1,a.de())}}};v.defineProperty(Me,{network:"network"},function(){return this.Ry},function(a){var b=this.Ry;b!==a&&(null!==a&&v.C(a,wa,Me,"network"),null!==b&&(b.Pb=null),this.Ry=a,null!==a&&(a.Pb=this))});Me.prototype.createNetwork=function(){return new wa};
Me.prototype.makeNetwork=function(a){var b=this.createNetwork();b.Pb=this;a instanceof E?(b.Oj(a.wg,!0),b.Oj(a.links,!0)):a instanceof T?b.Oj(a.Pc):b.Oj(a.i);return b};Me.prototype.updateParts=function(){var a=this.g;if(null===a&&null!==this.network)for(var b=this.network.vertexes.i;b.next();){var c=b.value.Dc;if(null!==c&&(a=c.g,null!==a))break}this.sf=!0;try{null!==a&&a.Qb("Layout"),this.commitLayout()}finally{null!==a&&a.wd("Layout")}};
Me.prototype.commitLayout=function(){for(var a=this.network.vertexes.i;a.next();)a.value.commit();if(this.pt)for(a=this.network.edges.i;a.next();)a.value.commit()};
Me.prototype.doLayout=function(a){null===a&&v.k("Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts");var b=new H(J);a instanceof E?(kp(this,b,a.wg,!0,this.eA,!0,!1,!0),kp(this,b,a.bk,!0,this.eA,!0,!1,!0)):a instanceof T?kp(this,b,a.Pc,!1,this.eA,!0,!1,!0):b.Yc(a.i);var c=b.count;if(0<c){a=this.g;null!==a&&a.Qb("Layout");for(var c=Math.ceil(Math.sqrt(c)),d=this.Ud.x,e=d,f=this.Ud.y,h=0,k=0,b=b.i;b.next();){var l=b.value;l.mf();var m=l.Ba,n=m.width,
m=m.height;l.moveTo(e,f);l.Qy=!1;e+=Math.max(n,50)+20;k=Math.max(k,Math.max(m,50));h>=c-1?(h=0,e=d,f+=k+20,k=0):h++}null!==a&&a.wd("Layout")}this.sf=!0};Me.prototype.eA=function(a){return!a.location.H()||a instanceof T&&a.Qy?!0:!1};
function kp(a,b,c,d,e,f,h,k){for(c=c.i;c.next();){var l=c.value;d&&!l.bp||null!==e&&!e(l)||!l.canLayout()||(f&&l instanceof S?l.qf||(l instanceof T?null===l.Pb?kp(a,b,l.Pc,!1,e,f,h,k):b.add(l):b.add(l)):h&&l instanceof W?b.add(l):!k||!l.Ld()||l instanceof S||b.add(l))}}
Me.prototype.collectParts=function(a){var b=new H(J);a instanceof E?(kp(this,b,a.wg,!0,null,!0,!0,!0),kp(this,b,a.links,!0,null,!0,!0,!0),kp(this,b,a.bk,!0,null,!0,!0,!0)):a instanceof T?kp(this,b,a.Pc,!1,null,!0,!0,!0):kp(this,b,a.i,!1,null,!0,!0,!0);return b};v.defineProperty(Me,{Ud:"arrangementOrigin"},function(){return this.Vp},function(a){v.C(a,w,Me,"arrangementOrigin");this.Vp.L(a)||(this.Vp.assign(a),this.G())});
Me.prototype.initialOrigin=function(a){var b=this.group;if(null!==b){var c=b.position.copy();(isNaN(c.x)||isNaN(c.y))&&c.set(a);b=b.placeholder;null!==b&&(c=b.fb(zb),(isNaN(c.x)||isNaN(c.y))&&c.set(a),c.x+=b.padding.left,c.y+=b.padding.top);return c}return a};function wa(){v.cc(this);this.Qd=null;this.clear()}v.ga("LayoutNetwork",wa);
wa.prototype.clear=function(){if(this.vertexes)for(var a=this.vertexes.i;a.next();){var b=a.value;b.clear();b.network=null}if(this.edges)for(a=this.edges.i;a.next();)b=a.value,b.clear(),b.network=null;this.vertexes=new H(ya);this.edges=new H(Aa);this.iA=new ma(S,ya);this.Xz=new ma(W,Aa)};
wa.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutNetwork"+(null!==this.Pb?"("+this.Pb.toString()+")":"");if(0>=a)return b;b+=" vertexes: "+this.vertexes.count+" edges: "+this.edges.count;if(1<a){for(var c=this.vertexes.i;c.next();)b+="\n    "+c.value.toString(a-1);for(c=this.edges.i;c.next();)b+="\n    "+c.value.toString(a-1)}return b};v.defineProperty(wa,{Pb:"layout"},function(){return this.Qd},function(a){this.Qd=a});wa.prototype.createVertex=function(){return new ya};
wa.prototype.createEdge=function(){return new Aa};
wa.prototype.addParts=wa.prototype.Oj=function(a,b,c){if(null!==a){void 0===b&&(b=!1);v.j(b,"boolean",wa,"addParts:toplevelonly");void 0===c&&(c=null);null===c&&(c=function(a){if(a instanceof S)return!a.qf;if(a instanceof W){var b=a.U;if(null===b||b.qf)return!1;a=a.ba;return null===a||a.qf?!1:!0}return!1});for(a=a.i;a.next();){var d=a.value;if(d instanceof S&&(!b||d.bp)&&d.canLayout()&&c(d))if(d instanceof T&&null===d.Pb)this.Oj(d.Pc,!1);else if(null===this.Qm(d)){var e=this.createVertex();e.Dc=d;
this.Xk(e)}}for(a.reset();a.next();)if(d=a.value,d instanceof W&&(!b||d.bp)&&d.canLayout()&&c(d)&&null===this.Cw(d)){var f=d.U,e=d.ba;null!==f&&null!==e&&f!==e&&(f=this.findGroupVertex(f),e=this.findGroupVertex(e),null!==f&&null!==e&&this.hp(f,e,d))}}};wa.prototype.findGroupVertex=function(a){if(null===a)return null;var b=a.findVisibleNode();if(null===b)return null;a=this.Qm(b);if(null!==a)return a;for(b=b.Sa;null!==b;){a=this.Qm(b);if(null!==a)return a;b=b.Sa}return null};
wa.prototype.addVertex=wa.prototype.Xk=function(a){if(null!==a){this.vertexes.add(a);var b=a.Dc;null!==b&&this.iA.add(b,a);a.network=this}};wa.prototype.addNode=wa.prototype.Hs=function(a){if(null===a)return null;var b=this.Qm(a);null===b&&(b=this.createVertex(),b.Dc=a,this.Xk(b));return b};wa.prototype.deleteVertex=wa.prototype.SD=function(a){if(null!==a&&lp(this,a)){for(var b=a.Me,c=b.count-1;0<=c;c--){var d=b.ha(c);this.No(d)}b=a.He;for(c=b.count-1;0<=c;c--)d=b.ha(c),this.No(d)}};
function lp(a,b){if(null===b)return!1;var c=a.vertexes.remove(b);c&&(a.iA.remove(b.Dc),b.network=null);return c}wa.prototype.deleteNode=function(a){null!==a&&(a=this.Qm(a),null!==a&&this.SD(a))};wa.prototype.findVertex=wa.prototype.Qm=function(a){return null===a?null:this.iA.la(a)};wa.prototype.addEdge=wa.prototype.Bo=function(a){if(null!==a){this.edges.add(a);var b=a.link;null!==b&&null===this.Cw(b)&&this.Xz.add(b,a);b=a.toVertex;null!==b&&b.rD(a);b=a.fromVertex;null!==b&&b.qD(a);a.network=this}};
wa.prototype.addLink=function(a){if(null===a)return null;var b=a.U,c=a.ba,d=this.Cw(a);null===d?(d=this.createEdge(),d.link=a,null!==b&&(d.fromVertex=this.Hs(b)),null!==c&&(d.toVertex=this.Hs(c)),this.Bo(d)):(d.fromVertex=null!==b?this.Hs(b):null,d.toVertex=null!==c?this.Hs(c):null);return d};wa.prototype.deleteEdge=wa.prototype.No=function(a){if(null!==a){var b=a.toVertex;null!==b&&b.RD(a);b=a.fromVertex;null!==b&&b.QD(a);mp(this,a)}};
function mp(a,b){null!==b&&a.edges.remove(b)&&(a.Xz.remove(b.link),b.network=null)}wa.prototype.deleteLink=function(a){null!==a&&(a=this.Cw(a),null!==a&&this.No(a))};wa.prototype.findEdge=wa.prototype.Cw=function(a){return null===a?null:this.Xz.la(a)};wa.prototype.linkVertexes=wa.prototype.hp=function(a,b,c){if(null===a||null===b)return null;if(a.network===this&&b.network===this){var d=this.createEdge();d.link=c;d.fromVertex=a;d.toVertex=b;this.Bo(d);return d}return null};
wa.prototype.reverseEdge=wa.prototype.nx=function(a){if(null!==a){var b=a.fromVertex,c=a.toVertex;null!==b&&null!==c&&(b.QD(a),c.RD(a),a.nx(),b.rD(a),c.qD(a))}};wa.prototype.deleteSelfEdges=wa.prototype.yw=function(){for(var a=v.jb(),b=this.edges.i;b.next();){var c=b.value;c.fromVertex===c.toVertex&&a.push(c)}b=a.length;for(c=0;c<b;c++)this.No(a[c]);v.ra(a)};
wa.prototype.deleteArtificialVertexes=function(){for(var a=v.jb(),b=this.vertexes.i;b.next();){var c=b.value;null===c.Dc&&a.push(c)}c=a.length;for(b=0;b<c;b++)this.SD(a[b]);c=v.jb();for(b=this.edges.i;b.next();){var d=b.value;null===d.link&&c.push(d)}d=c.length;for(b=0;b<d;b++)this.No(c[b]);v.ra(a);v.ra(c)};function np(a){for(var b=v.jb(),c=a.edges.i;c.next();){var d=c.value;null!==d.fromVertex&&null!==d.toVertex||b.push(d)}c=b.length;for(d=0;d<c;d++)a.No(b[d]);v.ra(b)}
wa.prototype.splitIntoSubNetworks=wa.prototype.aJ=function(){this.deleteArtificialVertexes();np(this);this.yw();for(var a=new G(wa),b=!0;b;)for(var b=!1,c=this.vertexes.i;c.next();){var d=c.value;if(0<d.Me.count||0<d.He.count){b=this.Pb.createNetwork();a.add(b);op(this,b,d);b=!0;break}}a.sort(function(a,b){return null===a||null===b||a===b?0:b.vertexes.count-a.vertexes.count});return a};
function op(a,b,c){if(null!==c&&c.network!==b){lp(a,c);b.Xk(c);for(var d=c.jc;d.next();){var e=d.value;e.network!==b&&(mp(a,e),b.Bo(e),op(a,b,e.fromVertex))}for(d=c.Zb;d.next();)c=d.value,c.network!==b&&(mp(a,c),b.Bo(c),op(a,b,c.toVertex))}}wa.prototype.findAllParts=function(){for(var a=new H(J),b=this.vertexes.i;b.next();)a.add(b.value.Dc);for(b=this.edges.i;b.next();)a.add(b.value.link);return a};
function ya(){v.cc(this);this.network=null;this.ca=(new z(0,0,10,10)).freeze();this.N=(new w(5,5)).freeze();this.clear()}v.ga("LayoutVertex",ya);ya.prototype.clear=function(){this.rd=this.uh=null;this.Me=new G(Aa);this.He=new G(Aa)};
ya.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutVertex#"+v.cd(this);if(0<a&&(b+=null!==this.Dc?"("+this.Dc.toString()+")":"",1<a)){a="";for(var c=!0,d=this.Me.i;d.next();){var e=d.value;c?c=!1:a+=",";a+=e.toString(0)}e="";c=!0;for(d=this.He.i;d.next();){var f=d.value;c?c=!1:e+=",";e+=f.toString(0)}b+=" sources: "+a+" destinations: "+e}return b};
v.defineProperty(ya,{data:"data"},function(){return this.uh},function(a){this.uh=a;if(null!==a){var b=a.bounds;a=b.x;var c=b.y,d=b.width,b=b.height;this.N.m(d/2,b/2);this.ca.m(a,c,d,b)}});v.defineProperty(ya,{Dc:"node"},function(){return this.rd},function(a){if(this.rd!==a){this.rd=a;a.mf();var b=a.Z,c=b.x,d=b.y,e=b.width,b=b.height;isNaN(c)&&(c=0);isNaN(d)&&(d=0);this.ca.m(c,d,e,b);if(!(a instanceof T)&&(a=a.ac.fb(Kb),a.H())){this.N.m(a.x-c,a.y-d);return}this.N.m(e/2,b/2)}});
v.defineProperty(ya,{pb:"bounds"},function(){return this.ca},function(a){this.ca.L(a)||this.ca.assign(a)});v.defineProperty(ya,{focus:"focus"},function(){return this.N},function(a){this.N.L(a)||this.N.assign(a)});v.defineProperty(ya,{oa:"centerX"},function(){return this.ca.x+this.N.x},function(a){var b=this.ca;b.x+this.N.x!==a&&(b.Na(),b.x=a-this.N.x,b.freeze())});
v.defineProperty(ya,{va:"centerY"},function(){return this.ca.y+this.N.y},function(a){var b=this.ca;b.y+this.N.y!==a&&(b.Na(),b.y=a-this.N.y,b.freeze())});v.defineProperty(ya,{bt:"focusX"},function(){return this.N.x},function(a){var b=this.N;b.x!==a&&(b.Na(),b.x=a,b.freeze())});v.defineProperty(ya,{ct:"focusY"},function(){return this.N.y},function(a){var b=this.N;b.y!==a&&(b.Na(),b.y=a,b.freeze())});
v.defineProperty(ya,{x:"x"},function(){return this.ca.x},function(a){var b=this.ca;b.x!==a&&(b.Na(),b.x=a,b.freeze())});v.defineProperty(ya,{y:"y"},function(){return this.ca.y},function(a){var b=this.ca;b.y!==a&&(b.Na(),b.y=a,b.freeze())});v.defineProperty(ya,{width:"width"},function(){return this.ca.width},function(a){var b=this.ca;b.width!==a&&(b.Na(),b.width=a,b.freeze())});
v.defineProperty(ya,{height:"height"},function(){return this.ca.height},function(a){var b=this.ca;b.height!==a&&(b.Na(),b.height=a,b.freeze())});ya.prototype.commit=function(){var a=this.uh;if(null!==a){var b=this.pb,c=a.bounds;v.Wa(c)?(c.x=b.x,c.y=b.y,c.width=b.width,c.height=b.height):a.bounds=b.copy()}else if(a=this.Dc,null!==a){b=this.pb;if(!(a instanceof T)){var c=a.Z,d=a.ac.fb(Kb);if(c.H()&&d.H()){a.moveTo(b.x+this.bt-(d.x-c.x),b.y+this.ct-(d.y-c.y));return}}a.moveTo(b.x,b.y)}};
ya.prototype.addSourceEdge=ya.prototype.rD=function(a){null!==a&&(this.Me.contains(a)||this.Me.add(a))};ya.prototype.deleteSourceEdge=ya.prototype.RD=function(a){null!==a&&this.Me.remove(a)};ya.prototype.addDestinationEdge=ya.prototype.qD=function(a){null!==a&&(this.He.contains(a)||this.He.add(a))};ya.prototype.deleteDestinationEdge=ya.prototype.QD=function(a){null!==a&&this.He.remove(a)};v.u(ya,{$I:"sourceVertexes"},function(){for(var a=new H(ya),b=this.jc;b.next();)a.add(b.value.fromVertex);return a.i});
v.u(ya,{aH:"destinationVertexes"},function(){for(var a=new H(ya),b=this.Zb;b.next();)a.add(b.value.toVertex);return a.i});v.u(ya,{vertexes:"vertexes"},function(){for(var a=new H(ya),b=this.jc;b.next();)a.add(b.value.fromVertex);for(b=this.Zb;b.next();)a.add(b.value.toVertex);return a.i});v.u(ya,{jc:"sourceEdges"},function(){return this.Me.i});v.u(ya,{Zb:"destinationEdges"},function(){return this.He.i});
v.u(ya,{edges:"edges"},function(){for(var a=new G(Aa),b=this.jc;b.next();)a.add(b.value);for(b=this.Zb;b.next();)a.add(b.value);return a.i});v.u(ya,{gH:"edgesCount"},function(){return this.Me.count+this.He.count});var pp;ya.standardComparer=pp=function(a,b){var c=a.rd,d=b.rd;return c?d?(c=c.text,d=d.text,c<d?-1:c>d?1:0):1:null!==d?-1:0};
ya.smartComparer=function(a,b){if(null!==a){if(null!==b){var c=a.rd,d=b.rd;if(null!==c){if(null!==d){for(var c=c.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/),d=d.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/),e=0;e<c.length;e++)if(""!==d[e]&&void 0!==d[e]){var f=parseFloat(c[e]),h=parseFloat(d[e]);if(isNaN(f)){if(!isNaN(h))return 1;if(0!==c[e].localeCompare(d[e]))return c[e].localeCompare(d[e])}else{if(isNaN(h))return-1;if(0!==f-h)return f-
h}}else if(""!==c[e])return 1;return""!==d[e]&&void 0!==d[e]?-1:0}return 1}return null!==d?-1:0}return 1}return null!==b?-1:0};function Aa(){v.cc(this);this.network=null;this.clear()}v.ga("LayoutEdge",Aa);Aa.prototype.clear=function(){this.toVertex=this.fromVertex=this.link=this.data=null};
Aa.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutEdge#"+v.cd(this);0<a&&(b+=null!==this.link?"("+this.link.toString()+")":"",1<a&&(b+=" "+(this.fromVertex?this.fromVertex.toString():"null")+" --\x3e "+(this.toVertex?this.toVertex.toString():"null")));return b};Aa.prototype.nx=function(){var a=this.fromVertex;this.fromVertex=this.toVertex;this.toVertex=a};Aa.prototype.commit=function(){};
Aa.prototype.getOtherVertex=Aa.prototype.tH=function(a){return this.toVertex===a?this.fromVertex:this.fromVertex===a?this.toVertex:null};function fl(){0<arguments.length&&v.dd(fl);Me.call(this);this.Tw=!0;this.Cs=this.Ds=NaN;this.cj=(new ia(NaN,NaN)).freeze();this.Oh=(new ia(10,10)).freeze();this.te=om;this.gd=mm;this.Nh=im;this.th=qp}v.Ga(fl,Me);v.ga("GridLayout",fl);
fl.prototype.cloneProtected=function(a){Me.prototype.cloneProtected.call(this,a);a.Ds=this.Ds;a.Cs=this.Cs;a.cj.assign(this.cj);a.Oh.assign(this.Oh);a.te=this.te;a.gd=this.gd;a.Nh=this.Nh;a.th=this.th};
fl.prototype.doLayout=function(a){null===a&&v.k("Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts");this.Ud=this.initialOrigin(this.Ud);var b=this.g,c=new H(J);a instanceof E?(b=a,kp(this,c,a.wg,!0,null,!0,!0,!0),kp(this,c,a.links,!0,null,!0,!0,!0),kp(this,c,a.bk,!0,null,!0,!0,!0)):a instanceof T?(b=a.g,kp(this,c,a.Pc,!1,null,!0,!0,!0)):c.Yc(a.i);for(a=c.copy().i;a.next();){var d=a.value;if(d instanceof W){var e=d;if(null!==e.U||null!==e.ba){c.remove(e);
continue}}d.mf();if(d instanceof T)for(d=d.Pc;d.next();)c.remove(d.value)}e=c.ed();if(0!==e.length){switch(this.sorting){case lm:e.reverse();break;case im:e.sort(this.comparer);break;case jm:e.sort(this.comparer),e.reverse()}var f=this.pJ;isNaN(f)&&(f=0);var h=this.KF,h=isNaN(h)&&null!==b?Math.max(b.tb.width-b.padding.left-b.padding.right,0):Math.max(this.KF,0);0>=f&&0>=h&&(f=1);c=this.spacing.width;isFinite(c)||(c=0);a=this.spacing.height;isFinite(a)||(a=0);null!==b&&b.Qb("Layout");d=[];switch(this.alignment){case pm:var k=
c,l=a,m=Math.max(this.Ho.width,1);if(!isFinite(m))for(var n=m=0;n<e.length;n++)var p=e[n],q=p.Ba,m=Math.max(m,q.width);var m=Math.max(m+k,1),r=Math.max(this.Ho.height,1);if(!isFinite(r))for(n=r=0;n<e.length;n++)p=e[n],q=p.Ba,r=Math.max(r,q.height);for(var r=Math.max(r+l,1),s=this.Ff,t=this.Ud.x,u=t,x=this.Ud.y,y=0,A=0,n=0;n<e.length;n++){var p=e[n],q=p.Ba,B=Math.ceil((q.width+k)/m)*m,I=Math.ceil((q.height+l)/r)*r,D=0;switch(s){case nm:D=Math.abs(u-q.width);break;default:D=u+q.width}if(0<f&&y>f-1||
0<h&&0<y&&D>h)d.push(new z(0,x,h+k,A)),y=0,u=t,x+=A,A=0;A=Math.max(A,I);I=0;switch(s){case nm:I=-q.width;break;default:I=0}p.moveTo(u+I,x);switch(s){case nm:u-=B;break;default:u+=B}y++}d.push(new z(0,x,h+k,A));break;case om:k=f;l=c;m=a;n=Math.max(this.Ho.width,1);p=x=B=0;q=v.M();for(f=0;f<e.length;f++)r=e[f],s=r.Ba,t=Zn(r,r.ac,r.Ze,q),B=Math.max(B,t.x),x=Math.max(x,s.width-t.x),p=Math.max(p,t.y);u=this.Ff;switch(u){case nm:B+=l;break;default:x+=l}var n=isFinite(n)?Math.max(n+l,1):Math.max(B+x,1),
V=x=this.Ud.x,y=this.Ud.y,A=0;h>=B&&(h-=B);for(var B=I=0,D=Math.max(this.Ho.height,1),ba=p=0,U=!0,N=v.M(),f=0;f<e.length;f++){r=e[f];s=r.Ba;t=Zn(r,r.ac,r.Ze,q);if(0<A)switch(u){case nm:V=Math.floor((V-x-(s.width-t.x))/n)*n+x;break;default:V=Math.ceil((V-x+t.x)/n)*n+x}else switch(u){case nm:I=V+t.x+s.width;break;default:I=V-t.x}var Z=0;switch(u){case nm:Z=-(V+t.x)+I;break;default:Z=V+s.width-t.x-I}if(0<k&&A>k-1||0<h&&0<A&&Z>h){d.push(new z(0,U?y-p:y,h+l,ba+p+m));for(V=0;V<A&&f!==A;V++){var Z=e[f-A+
V],Ga=Zn(Z,Z.ac,Z.Ze,N);Z.moveTo(Z.position.x,Z.position.y+p-Ga.y)}ba+=m;y=U?y+ba:y+(ba+p);A=ba=p=0;V=x;U=!1}V===x&&(B=u===nm?Math.max(B,s.width-t.x):Math.min(B,-t.x));p=Math.max(p,t.y);ba=Math.max(ba,s.height-t.y);isFinite(D)&&(ba=Math.max(ba,Math.max(s.height,D)-t.y));U?r.moveTo(V-t.x,y-t.y):r.moveTo(V-t.x,y);switch(u){case nm:V-=t.x+l;break;default:V+=s.width-t.x+l}A++}d.push(new z(0,y,h+l,(U?ba:ba+p)+m));for(V=0;V<A&&f!==A;V++)Z=e[f-A+V],Ga=Zn(Z,Z.ac,Z.Ze,q),Z.moveTo(Z.position.x,Z.position.y+
p-Ga.y);v.v(q);v.v(N);if(u===nm)for(f=0;f<d.length;f++)e=d[f],e.width+=B,e.x-=B;else for(f=0;f<d.length;f++)e=d[f],e.x>B&&(e.width+=e.x-B,e.x=B)}for(k=f=h=e=0;k<d.length;k++)l=d[k],e=Math.min(e,l.x),h=Math.min(h,l.y),f=Math.max(f,l.x+l.width);this.Ff===nm?this.commitLayers(d,new w(e+c/2-(f+e),h-a/2)):this.commitLayers(d,new w(e-c/2,h-a/2));null!==b&&b.wd("Layout");this.sf=!0}};fl.prototype.commitLayers=function(){};
v.defineProperty(fl,{KF:"wrappingWidth"},function(){return this.Ds},function(a){this.Ds!==a&&(v.j(a,"number",fl,"wrappingWidth"),0<a||isNaN(a))&&(this.Ds=a,this.Tw=isNaN(a),this.G())});v.defineProperty(fl,{pJ:"wrappingColumn"},function(){return this.Cs},function(a){this.Cs!==a&&(v.j(a,"number",fl,"wrappingColumn"),0<a||isNaN(a))&&(this.Cs=a,this.G())});v.defineProperty(fl,{Ho:"cellSize"},function(){return this.cj},function(a){v.C(a,ia,fl,"cellSize");this.cj.L(a)||(this.cj.assign(a),this.G())});
v.defineProperty(fl,{spacing:"spacing"},function(){return this.Oh},function(a){v.C(a,ia,fl,"spacing");this.Oh.L(a)||(this.Oh.assign(a),this.G())});v.defineProperty(fl,{alignment:"alignment"},function(){return this.te},function(a){this.te!==a&&(v.qb(a,fl,fl,"alignment"),a===om||a===pm)&&(this.te=a,this.G())});v.defineProperty(fl,{Ff:"arrangement"},function(){return this.gd},function(a){this.gd!==a&&(v.qb(a,fl,fl,"arrangement"),a===mm||a===nm)&&(this.gd=a,this.G())});
v.defineProperty(fl,{sorting:"sorting"},function(){return this.Nh},function(a){this.Nh!==a&&(v.qb(a,fl,fl,"sorting"),a===km||a===lm||a===im||a===jm)&&(this.Nh=a,this.G())});v.defineProperty(fl,{comparer:"comparer"},function(){return this.th},function(a){this.th!==a&&(v.j(a,"function",fl,"comparer"),this.th=a,this.G())});var qp;fl.standardComparer=qp=function(a,b){var c=a.text,d=b.text;return c<d?-1:c>d?1:0};
fl.smartComparer=function(a,b){if(null!==a){if(null!==b){for(var c=a.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/),d=b.text.toLocaleLowerCase().split(/([+\-]?[\.]?\d+(?:\.\d*)?(?:e[+\-]?\d+)?)/),e=0;e<c.length;e++)if(""!==d[e]&&void 0!==d[e]){var f=parseFloat(c[e]),h=parseFloat(d[e]);if(isNaN(f)){if(!isNaN(h))return 1;if(0!==c[e].localeCompare(d[e]))return c[e].localeCompare(d[e])}else{if(isNaN(h))return-1;if(0!==f-h)return f-h}}else if(""!==c[e])return 1;return""!==
d[e]&&void 0!==d[e]?-1:0}return 1}return null!==b?-1:0};var pm;fl.Position=pm=v.p(fl,"Position",0);var om;fl.Location=om=v.p(fl,"Location",1);var mm;fl.LeftToRight=mm=v.p(fl,"LeftToRight",2);var nm;fl.RightToLeft=nm=v.p(fl,"RightToLeft",3);var km;fl.Forward=km=v.p(fl,"Forward",4);var lm;fl.Reverse=lm=v.p(fl,"Reverse",5);var im;fl.Ascending=im=v.p(fl,"Ascending",6);var jm;fl.Descending=jm=v.p(fl,"Descending",7);
function qm(){0<arguments.length&&v.dd(qm);Me.call(this);this.py=this.Kn=this.Ed=0;this.wq=360;this.oy=Jm;this.wk=0;this.KB=Jm;this.Bu=this.lg=this.eD=0;this.ew=new rp;this.Du=this.im=0;this.eG=600;this.Jr=NaN;this.Xp=1;this.os=0;this.qs=360;this.gd=Jm;this.na=Fm;this.Nh=Cm;this.th=pp;this.Oh=6;this.yr=Mm}v.Ga(qm,Me);v.ga("CircularLayout",qm);
qm.prototype.cloneProtected=function(a){Me.prototype.cloneProtected.call(this,a);a.Jr=this.Jr;a.Xp=this.Xp;a.os=this.os;a.qs=this.qs;a.gd=this.gd;a.na=this.na;a.Nh=this.Nh;a.th=this.th;a.Oh=this.Oh;a.yr=this.yr};qm.prototype.createNetwork=function(){return new sp};
qm.prototype.doLayout=function(a){null===a&&v.k("Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts");null===this.network&&(this.network=this.makeNetwork(a));a=this.network.vertexes;if(1>=a.count)1===a.count&&(a=a.first(),a.oa=0,a.va=0);else{var b=new G(tp);b.Yc(a.i);a=new G(tp);var c=new G(tp),d;d=this.sort(b);var e=this.oy,f=this.KB,h=this.Ed,k=this.Kn,l=this.py,m=this.wq,b=this.wk,n=this.eD,p=this.lg,q=this.Bu,e=this.Ff,f=this.$w,h=this.AI;if(!isFinite(h)||
0>=h)h=NaN;k=this.zG;if(!isFinite(k)||0>=k)k=1;l=this.Ne;isFinite(l)||(l=0);m=this.Sf;if(!isFinite(m)||360<m||1>m)m=360;b=this.spacing;isFinite(b)||(b=NaN);e===Km&&f===Lm?e=Jm:e===Km&&f!==Lm&&(f=Lm,e=this.Ff);if((this.direction===Dm||this.direction===Em)&&this.sorting!==Cm){for(var r=0;!(r>=d.length);r+=2){a.add(d.ha(r));if(r+1>=d.length)break;c.add(d.ha(r+1))}this.direction===Dm?(this.Ff===Km&&a.reverse(),d=new G(tp),d.Yc(a),d.Yc(c)):(this.Ff===Km&&c.reverse(),d=new G(tp),d.Yc(c),d.Yc(a))}for(var s=
d.length,t=n=0,r=0;r<d.length;r++){var p=l+m*t*(this.direction===Fm?1:-1)/s,u=d.ha(r).diameter;isNaN(u)&&(u=up(d.ha(r),p));360>m&&(0===r||r===d.length-1)&&(u/=2);n+=u;t++}if(isNaN(h)||e===Km){isNaN(b)&&(b=6);if(e!==Jm&&e!==Km){u=-Infinity;for(r=0;r<s;r++){var q=d.ha(r),x=d.ha(r===s-1?0:r+1);isNaN(q.diameter)&&up(q,0);isNaN(x.diameter)&&up(x,0);u=Math.max(u,(q.diameter+x.diameter)/2)}q=u+b;e===Hm?(p=2*Math.PI/s,h=(u+b)/p):h=vp(this,q*(360<=m?s:s-1),k,l*Math.PI/180,m*Math.PI/180)}else h=vp(this,n+(360<=
m?s:s-1)*(e!==Km?b:1.6*b),k,l*Math.PI/180,m*Math.PI/180);p=h*k}else if(p=h*k,t=wp(this,h,p,l*Math.PI/180,m*Math.PI/180),isNaN(b)){if(e===Jm||e===Km)b=(t-n)/(360<=m?s:s-1)}else if(e===Jm||e===Km)r=(t-n)/(360<=m?s:s-1),r<b?(h=vp(this,n+b*(360<=m?s:s-1),k,l*Math.PI/180,m*Math.PI/180),p=h*k):b=r;else{u=-Infinity;for(r=0;r<s;r++)q=d.ha(r),x=d.ha(r===s-1?0:r+1),isNaN(q.diameter)&&up(q,0),isNaN(x.diameter)&&up(x,0),u=Math.max(u,(q.diameter+x.diameter)/2);q=u+b;r=vp(this,q*(360<=m?s:s-1),k,l*Math.PI/180,
m*Math.PI/180);r>h?(h=r,p=h*k):q=t/(360<=m?s:s-1)}this.oy=e;this.KB=f;this.Ed=h;this.Kn=k;this.py=l;this.wq=m;this.wk=b;this.eD=n;this.lg=p;this.Bu=q;b=d;d=this.oy;e=this.Ed;f=this.py;k=this.wq;l=this.wk;m=this.lg;n=this.Bu;if(this.direction!==Dm&&this.direction!==Em||d!==Km)if(this.direction===Dm||this.direction===Em){h=0;switch(d){case Im:h=180*xp(this,e,m,f,n)/Math.PI;break;case Jm:n=b=0;h=a.first();null!==h&&(b=up(h,Math.PI/2));h=c.first();null!==h&&(n=up(h,Math.PI/2));h=180*xp(this,e,m,f,l+(b+
n)/2)/Math.PI;break;case Hm:h=k/b.length}if(this.direction===Dm){switch(d){case Im:yp(this,a,f,Gm);break;case Jm:zp(this,a,f,Gm);break;case Hm:Ap(this,a,k/2,f,Gm)}switch(d){case Im:yp(this,c,f+h,Fm);break;case Jm:zp(this,c,f+h,Fm);break;case Hm:Ap(this,c,k/2,f+h,Fm)}}else{switch(d){case Im:yp(this,c,f,Gm);break;case Jm:zp(this,c,f,Gm);break;case Hm:Ap(this,c,k/2,f,Gm)}switch(d){case Im:yp(this,a,f+h,Fm);break;case Jm:zp(this,a,f+h,Fm);break;case Hm:Ap(this,a,k/2,f+h,Fm)}}}else switch(d){case Im:yp(this,
b,f,this.direction);break;case Jm:zp(this,b,f,this.direction);break;case Hm:Ap(this,b,k,f,this.direction);break;case Km:Bp(this,b,k,f,this.direction)}else Bp(this,b,k,f-k/2,Fm)}this.updateParts();this.network=null;this.sf=!0};
function Ap(a,b,c,d,e){var f=a.wq,h=a.Ed;a=a.lg;d=d*Math.PI/180;c=c*Math.PI/180;for(var k=b.length,l=0;l<k;l++){var m=d+(e===Fm?l*c/(360<=f?k:k-1):-(l*c)/k),n=b.ha(l),p=h*Math.tan(m)/a,p=Math.sqrt((h*h+a*a*p*p)/(1+p*p));n.oa=p*Math.cos(m);n.va=p*Math.sin(m);n.actualAngle=180*m/Math.PI}}
function zp(a,b,c,d){var e=a.Ed,f=a.lg,h=a.wk;c=c*Math.PI/180;for(var k=b.length,l=0;l<k;l++){var m=b.ha(l),n=b.ha(l===k-1?0:l+1),p=f*Math.sin(c);m.oa=e*Math.cos(c);m.va=p;m.actualAngle=180*c/Math.PI;isNaN(m.diameter)&&up(m,0);isNaN(n.diameter)&&up(n,0);m=xp(a,e,f,d===Fm?c:-c,(m.diameter+n.diameter)/2+h);c+=d===Fm?m:-m}}
function yp(a,b,c,d){var e=a.Ed,f=a.lg,h=a.Bu;c=c*Math.PI/180;for(var k=b.length,l=0;l<k;l++){var m=b.ha(l);m.oa=e*Math.cos(c);m.va=f*Math.sin(c);m.actualAngle=180*c/Math.PI;m=xp(a,e,f,d===Fm?c:-c,h);c+=d===Fm?m:-m}}function Bp(a,b,c,d,e){var f=a.Du,f=a.wq;a.im=0;a.ew=new rp;if(360>c){for(f=d+(e===Fm?f:-f);0>f;)f+=360;f%=360;180<f&&(f-=360);f*=Math.PI/180;a.Du=f;Cp(a,b,c,d,e)}else Dp(a,b,c,d,e);a.ew.commit(b)}
function Dp(a,b,c,d,e){var f=a.Ed,h=a.wk,k=a.Kn,l=f*Math.cos(d*Math.PI/180),m=a.lg*Math.sin(d*Math.PI/180),n=b.ed();if(3===n.length)n[0].oa=f,n[0].va=0,n[1].oa=n[0].oa-n[0].width/2-n[1].width/2-h,n[1].y=n[0].y,n[2].oa=(n[0].oa+n[1].oa)/2,n[2].y=n[0].y-n[2].height-h;else if(4===n.length)n[0].oa=f,n[0].va=0,n[2].oa=-n[0].oa,n[2].va=n[0].va,n[1].oa=0,n[1].y=Math.min(n[0].y,n[2].y)-n[1].height-h,n[3].oa=0,n[3].y=Math.max(n[0].y+n[0].height+h,n[2].y+n[2].height+h);else{for(var f=v.M(),p=0;p<n.length;p++){n[p].oa=
l;n[p].va=m;if(p>=n.length-1)break;Ep(a,l,m,n,p,e,f)||Fp(a,l,m,n,p,e,f);l=f.x;m=f.y}v.v(f);a.im++;if(!(23<a.im)){var l=n[0].oa,m=n[0].va,f=n[n.length-1].oa,p=n[n.length-1].va,q=Math.abs(l-f)-((n[0].width+n[n.length-1].width)/2+h),r=Math.abs(m-p)-((n[0].height+n[n.length-1].height)/2+h),h=0;1>Math.abs(r)?Math.abs(l-f)<(n[0].width+n[n.length-1].width)/2&&(h=0):h=0<r?r:1>Math.abs(q)?0:q;q=!1;q=Math.abs(f)>Math.abs(p)?0<f!==m>p:0<p!==l<f;if(q=e===Fm?q:!q)h=-Math.abs(h),h=Math.min(h,-n[n.length-1].width),
h=Math.min(h,-n[n.length-1].height);a.ew.compare(h,n);1<Math.abs(h)&&(a.Ed=8>a.im?a.Ed-h/(2*Math.PI):5>n.length&&10<h?a.Ed/2:a.Ed-(0<h?1.7:-2.3),a.lg=a.Ed*k,Dp(a,b,c,d,e))}}}
function Cp(a,b,c,d,e){for(var f=a.Ed,h=a.lg,k=a.Kn,l=f*Math.cos(d*Math.PI/180),m=h*Math.sin(d*Math.PI/180),n=v.M(),p=b.ed(),q=0;q<p.length;q++){p[q].oa=l;p[q].va=m;if(q>=p.length-1)break;Ep(a,l,m,p,q,e,n)||Fp(a,l,m,p,q,e,n);l=n.x;m=n.y}v.v(n);a.im++;if(!(23<a.im)){l=Math.atan2(m,l);l=e===Fm?a.Du-l:l-a.Du;l=Math.abs(l)<Math.abs(l-2*Math.PI)?l:l-2*Math.PI;f=l*(f+h)/2;h=a.ew;if(Math.abs(f)<Math.abs(h.To))for(h.To=f,h.gn=[],h.Jp=[],l=0;l<p.length;l++)h.gn[l]=p[l].pb.x,h.Jp[l]=p[l].pb.y;1<Math.abs(f)&&
(a.Ed=8>a.im?a.Ed-f/(2*Math.PI):a.Ed-(0<f?1.7:-2.3),a.lg=a.Ed*k,Cp(a,b,c,d,e))}}function Ep(a,b,c,d,e,f,h){var k=a.Ed,l=a.lg,m=0,n=0;a=(d[e].width+d[e+1].width)/2+a.wk;var p=!1;if(0<=c!==(f===Fm)){if(m=b+a,m>k){m=b-a;if(m<-k)return h.x=m,h.y=n,!1;p=!0}}else if(m=b-a,m<-k){m=b+a;if(m>k)return h.x=m,h.y=n,!1;p=!0}n=Math.sqrt(1-Math.min(1,m*m/(k*k)))*l;0>c!==p&&(n=-n);if(Math.abs(c-n)>(d[e].height+d[e+1].height)/2)return h.x=m,h.y=n,!1;h.x=m;h.y=n;return!0}
function Fp(a,b,c,d,e,f,h){var k=a.Ed,l=a.lg,m=0,n=0;a=(d[e].height+d[e+1].height)/2+a.wk;d=!1;if(0<=b!==(f===Fm)){if(n=c-a,n<-l){n=c+a;if(n>l){h.x=m;h.y=n;return}d=!0}}else if(n=c+a,n>l){n=c-a;if(n<-l){h.x=m;h.y=n;return}d=!0}m=Math.sqrt(1-Math.min(1,n*n/(l*l)))*k;0>b!==d&&(m=-m);h.x=m;h.y=n}qm.prototype.commitLayout=function(){this.commitNodes();this.pt&&this.commitLinks()};
qm.prototype.commitNodes=function(){for(var a=this.pG,b=this.network.vertexes.i;b.next();){var c=b.value;c.x+=a.x;c.y+=a.y;c.commit()}};qm.prototype.commitLinks=function(){for(var a=this.network.edges.i;a.next();)a.value.commit()};
function wp(a,b,c,d,e){var f=a.eG;if(.001>Math.abs(a.Kn-1))return void 0!==d&&void 0!==e?e*b:2*Math.PI*b;a=b>c?Math.sqrt(b*b-c*c)/b:Math.sqrt(c*c-b*b)/c;for(var h=0,k=0,k=void 0!==d&&void 0!==e?e/(f+1):Math.PI/(2*(f+1)),l=0,m=0;m<=f;m++)l=void 0!==d&&void 0!==e?d+m*e/f:m*Math.PI/(2*f),l=Math.sin(l),h+=Math.sqrt(1-a*a*l*l)*k;return void 0!==d&&void 0!==e?(b>c?b:c)*h:4*(b>c?b:c)*h}function vp(a,b,c,d,e){var f=0,f=void 0!==d&&void 0!==e?wp(a,1,c,d,e):wp(a,1,c);return b/f}
function xp(a,b,c,d,e){if(.001>Math.abs(a.Kn-1))return e/b;var f=b>c?Math.sqrt(b*b-c*c)/b:Math.sqrt(c*c-b*b)/c,h=0;a=2*Math.PI/(700*a.network.vertexes.count);b>c&&(d+=Math.PI/2);for(var k=0;;k++){var l=Math.sin(d+k*a),h=h+(b>c?b:c)*Math.sqrt(1-f*f*l*l)*a;if(h>=e)return k*a}}
qm.prototype.sort=function(a){switch(this.sorting){case tm:break;case Bm:a.reverse();break;case rm:a.sort(this.comparer);break;case sm:a.sort(this.comparer);a.reverse();break;case Cm:for(var b=[],c=0;c<a.length;c++)b.push(0);for(var d=new G(tp),c=0;c<a.length;c++){var e=-1,f=-1;if(0===c)for(var h=0;h<a.length;h++){var k=a.ha(h).gH;k>e&&(e=k,f=h)}else for(h=0;h<a.length;h++)k=b[h],k>e&&(e=k,f=h);d.add(a.ha(f));b[f]=-1;f=a.ha(f);e=0;for(h=f.jc;h.next();)e=a.indexOf(h.value.fromVertex),0>e||0<=b[e]&&
b[e]++;for(f=f.Zb;f.next();)e=a.indexOf(f.value.toVertex),0>e||0<=b[e]&&b[e]++}a=[];for(b=0;b<d.length;b++){h=d.ha(b);a[b]=[];for(var l=0,c=h.Zb;c.next();)l=d.indexOf(c.value.toVertex),l!==b&&0>a[b].indexOf(l)&&a[b].push(l);for(c=h.jc;c.next();)l=d.indexOf(c.value.fromVertex),l!==b&&0>a[b].indexOf(l)&&a[b].push(l)}h=[];for(b=0;b<a.length;b++)h[b]=0;for(var c=[],k=[],m=[],e=[],f=new G(tp),n=0,b=0;b<a.length;b++){var p=a[b].length;if(1===p)e.push(b);else if(0===p)f.add(d.ha(b));else{if(0===n)c.push(b);
else{for(var q=Infinity,r=Infinity,s=-1,t=[],p=0;p<c.length;p++)0>a[c[p]].indexOf(c[p===c.length-1?0:p+1])&&t.push(p===c.length-1?0:p+1);if(0===t.length)for(p=0;p<c.length;p++)t.push(p);for(p=0;p<t.length;p++){var u=t[p],x,l=a[b];x=k;for(var y=m,A=h,B=u,I=c,D=0,V=0;V<x.length;V++){var ba=A[x[V]],U=A[y[V]],N=0,Z=0;ba<U?(N=ba,Z=U):(N=U,Z=ba);if(N<B&&B<=Z)for(ba=0;ba<l.length;ba++)U=l[ba],0>I.indexOf(U)||N<A[U]&&A[U]<Z||N===A[U]||Z===A[U]||D++;else for(ba=0;ba<l.length;ba++)U=l[ba],0>I.indexOf(U)||N<
A[U]&&A[U]<Z&&N!==A[U]&&Z!==A[U]&&D++}x=D;for(A=y=0;A<a[b].length;A++)l=c.indexOf(a[b][A]),0<=l&&(l=Math.abs(u-(l>=u?l+1:l)),y+=l<c.length+1-l?l:c.length+1-l);for(A=0;A<k.length;A++)l=h[k[A]],B=h[m[A]],l>=u&&l++,B>=u&&B++,l>B&&(I=B,B=l,l=I),B-l<(c.length+2)/2===(l<u&&u<=B)&&y++;if(x<q||x===q&&y<r)q=x,r=y,s=u}c.splice(s,0,b);for(p=0;p<c.length;p++)h[c[p]]=p;for(p=0;p<a[b].length;p++)q=a[b][p],0<=c.indexOf(q)&&(k.push(b),m.push(q))}n++}}k=!1;for(m=c.length;;){k=!0;for(h=0;h<e.length;h++)if(b=e[h],n=
a[b][0],l=c.indexOf(n),0<=l){for(r=p=0;r<a[n].length;r++)q=a[n][r],q=c.indexOf(q),0>q||q===l||(s=q>l?q-l:l-q,p+=q<l!==s>m-s?1:-1);c.splice(0>p?l:l+1,0,b);e.splice(h,1);h--}else k=!1;if(k)break;else c.push(e[0]),e.splice(0,1)}for(b=0;b<c.length;b++)l=c[b],f.add(d.ha(l));return f;default:v.k("Invalid sorting type.")}return a};v.defineProperty(qm,{AI:"radius"},function(){return this.Jr},function(a){this.Jr!==a&&(v.j(a,"number",qm,"radius"),0<a||isNaN(a))&&(this.Jr=a,this.G())});
v.defineProperty(qm,{zG:"aspectRatio"},function(){return this.Xp},function(a){this.Xp!==a&&(v.j(a,"number",qm,"aspectRatio"),0<a&&(this.Xp=a,this.G()))});v.defineProperty(qm,{Ne:"startAngle"},function(){return this.os},function(a){this.os!==a&&(v.j(a,"number",qm,"startAngle"),this.os=a,this.G())});v.defineProperty(qm,{Sf:"sweepAngle"},function(){return this.qs},function(a){this.qs!==a&&(v.j(a,"number",qm,"sweepAngle"),this.qs=0<a&&360>=a?a:360,this.G())});
v.defineProperty(qm,{Ff:"arrangement"},function(){return this.gd},function(a){this.gd!==a&&(v.qb(a,qm,qm,"arrangement"),a===Km||a===Jm||a===Im||a===Hm)&&(this.gd=a,this.G())});v.defineProperty(qm,{direction:"direction"},function(){return this.na},function(a){this.na!==a&&(v.qb(a,qm,qm,"direction"),a===Fm||a===Gm||a===Dm||a===Em)&&(this.na=a,this.G())});
v.defineProperty(qm,{sorting:"sorting"},function(){return this.Nh},function(a){this.Nh!==a&&(v.qb(a,qm,qm,"sorting"),a===tm||a===Bm||a===rm||sm||a===Cm)&&(this.Nh=a,this.G())});v.defineProperty(qm,{comparer:"comparer"},function(){return this.th},function(a){this.th!==a&&(v.j(a,"function",qm,"comparer"),this.th=a,this.G())});v.defineProperty(qm,{spacing:"spacing"},function(){return this.Oh},function(a){this.Oh!==a&&(v.j(a,"number",qm,"spacing"),this.Oh=a,this.G())});
v.defineProperty(qm,{$w:"nodeDiameterFormula"},function(){return this.yr},function(a){this.yr!==a&&(v.qb(a,qm,qm,"nodeDiameterFormula"),a===Mm||a===Lm)&&(this.yr=a,this.G())});v.u(qm,{qG:"actualXRadius"},function(){return this.Ed});v.u(qm,{rG:"actualYRadius"},function(){return this.lg});v.u(qm,{sJ:"actualSpacing"},function(){return this.wk});v.u(qm,{pG:"actualCenter"},function(){return isNaN(this.Ud.x)||isNaN(this.Ud.y)?new w(0,0):new w(this.Ud.x+this.qG,this.Ud.y+this.rG)});var Jm;
qm.ConstantSpacing=Jm=v.p(qm,"ConstantSpacing",0);var Im;qm.ConstantDistance=Im=v.p(qm,"ConstantDistance",1);var Hm;qm.ConstantAngle=Hm=v.p(qm,"ConstantAngle",2);var Km;qm.Packed=Km=v.p(qm,"Packed",3);var Fm;qm.Clockwise=Fm=v.p(qm,"Clockwise",4);var Gm;qm.Counterclockwise=Gm=v.p(qm,"Counterclockwise",5);var Dm;qm.BidirectionalLeft=Dm=v.p(qm,"BidirectionalLeft",6);var Em;qm.BidirectionalRight=Em=v.p(qm,"BidirectionalRight",7);var tm;qm.Forwards=tm=v.p(qm,"Forwards",8);var Bm;
qm.Reverse=Bm=v.p(qm,"Reverse",9);var rm;qm.Ascending=rm=v.p(qm,"Ascending",10);var sm;qm.Descending=sm=v.p(qm,"Descending",11);var Cm;qm.Optimized=Cm=v.p(qm,"Optimized",12);var Mm;qm.Pythagorean=Mm=v.p(qm,"Pythagorean",13);var Lm;qm.Circular=Lm=v.p(qm,"Circular",14);function rp(){this.To=-Infinity;this.Jp=this.gn=null}
rp.prototype.compare=function(a,b){if(0<a&&0>this.To||Math.abs(a)<Math.abs(this.To)&&!(0>a&&0<this.To)){this.To=a;this.gn=[];this.Jp=[];for(var c=0;c<b.length;c++)this.gn[c]=b[c].pb.x,this.Jp[c]=b[c].pb.y}};rp.prototype.commit=function(a){if(null!==this.gn&&null!==this.Jp)for(var b=0;b<this.gn.length;b++){var c=a.ha(b);c.x=this.gn[b];c.y=this.Jp[b]}};function sp(){wa.call(this)}v.Ga(sp,wa);v.ga("CircularNetwork",sp);sp.prototype.createVertex=function(){return new tp};sp.prototype.createEdge=function(){return new Gp};
function tp(){ya.call(this);this.actualAngle=this.diameter=NaN}v.Ga(tp,ya);v.ga("CircularVertex",tp);
function up(a,b){var c=a.network;if(null===c)return NaN;c=c.Pb;if(null===c)return NaN;if(c.Ff===Km)if(c.$w===Lm)a.diameter=Math.max(a.width,a.height);else{var c=Math.abs(Math.sin(b)),d=Math.abs(Math.cos(b));if(0===c)return a.width;if(0===d)return a.height;a.diameter=Math.min(a.height/c,a.width/d)}else a.diameter=c.$w===Lm?Math.max(a.width,a.height):Math.sqrt(a.width*a.width+a.height*a.height);return a.diameter}function Gp(){Aa.call(this)}v.Ga(Gp,Aa);v.ga("CircularEdge",Gp);
function Hp(){0<arguments.length&&v.dd(Hp);Me.call(this);this.kg=null;this.Yq=0;this.Wf=(new ia(100,100)).freeze();this.Wp=!1;this.Lh=!0;this.sh=!1;this.co=100;this.yq=1;this.Ch=1E3;this.Kr=Math;this.Dn=.05;this.Cn=50;this.zn=150;this.Bn=0;this.qq=10;this.pq=5}v.Ga(Hp,Me);v.ga("ForceDirectedLayout",Hp);
Hp.prototype.cloneProtected=function(a){Me.prototype.cloneProtected.call(this,a);a.Wf.assign(this.Wf);a.Wp=this.Wp;a.Lh=this.Lh;a.sh=this.sh;a.co=this.co;a.yq=this.yq;a.Ch=this.Ch;a.Kr=this.Kr;a.Dn=this.Dn;a.Cn=this.Cn;a.zn=this.zn;a.Bn=this.Bn;a.qq=this.qq;a.pq=this.pq};Hp.prototype.createNetwork=function(){return new Ip};
Hp.prototype.doLayout=function(a){null===a&&v.k("Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts");null===this.network&&(this.network=this.makeNetwork(a));a=this.Zz;if(0<this.network.vertexes.count){this.network.yw();for(var b=this.network.vertexes.i;b.next();){var c=b.value;c.charge=this.electricalCharge(c);c.mass=this.gravitationalMass(c)}for(b=this.network.edges.i;b.next();)c=b.value,c.stiffness=this.springStiffness(c),c.length=this.springLength(c);
this.lz();this.Yq=0;if(this.needsClusterLayout()){b=this.network;for(c=b.aJ().i;c.next();){this.network=c.value;for(var d=this.network.vertexes.i;d.next();){var e=d.value;e.Rf=e.vertexes.count;e.ak=1;e.Gm=null;e.lh=null}Jp(this,0,a)}this.network=b;c.reset();for(var d=this.wD,f=c.count,h=!0,k=e=0,l=v.jb(),m=0;m<f+b.vertexes.count+2;m++)l[m]=null;f=0;c.reset();for(var n=v.Uf();c.next();)if(m=c.value,this.Ug(m,n),h)h=!1,e=n.x+n.width/2,k=n.y+n.height/2,l[0]=new w(n.x+n.width+d.width,n.y),l[1]=new w(n.x,
n.y+n.height+d.height),f=2;else{var p=Kp(l,f,e,k,n.width,n.height,d),q=l[p],r=new w(q.x+n.width+d.width,q.y),s=new w(q.x,q.y+n.height+d.height);p+1<f&&l.splice(p+1,0,null);l[p]=r;l[p+1]=s;f++;p=q.x-n.x;q=q.y-n.y;for(m=m.vertexes.i;m.next();)r=m.value,r.oa+=p,r.va+=q}v.fc(n);for(m=b.vertexes.i;m.next();)h=m.value,n=h.pb,2>f?(e=n.x+n.width/2,k=n.y+n.height/2,l[0]=new w(n.x+n.width+d.width,n.y),l[1]=new w(n.x,n.y+n.height+d.height),f=2):(p=Kp(l,f,e,k,n.width,n.height,d),q=l[p],r=new w(q.x+n.width+d.width,
q.y),s=new w(q.x,q.y+n.height+d.height),p+1<f&&l.splice(p+1,0,null),l[p]=r,l[p+1]=s,f++,h.oa=q.x+h.width/2,h.va=q.y+h.height/2);v.ra(l);for(c.reset();c.next();){d=c.value;for(e=d.vertexes.i;e.next();)b.Xk(e.value);for(d=d.edges.i;d.next();)b.Bo(d.value)}}Lp(this,a);this.updateParts()}this.co=a;this.network=null;this.sf=!0};
Hp.prototype.needsClusterLayout=function(){if(3>this.network.vertexes.count)return!1;for(var a=0,b=0,c=this.network.vertexes.first().pb,d=this.network.vertexes.i;d.next();){if(d.value.pb.tg(c)&&(a++,2<a))return!0;if(10<b)break;b++}return!1};Hp.prototype.Ug=function(a,b){for(var c=!0,d=a.vertexes.i;d.next();){var e=d.value;c?(c=!1,b.set(e.pb)):b.bi(e.pb)}return b};
function Jp(a,b,c){if(Mp(a,b)){var d=a.Ch;a.Ch*=1+1/(b+1);var e=Np(a,b),f=Math.max(0,Math.max(Math.min(a.network.vertexes.count,c*(b+1)/11),10));a.Zz+=f;Jp(a,b+1,c);Lp(a,f);Op(a,e);b=a.kg;null===b?b=new G(Pp):b.clear();b.Yc(e.vertexes);b.sort(function(a,b){return null===a||null===b||a===b?0:b.Rf-a.Rf});for(e=b.i;e.next();)Qp(a,e.value);a.Ch=d}}
function Mp(a,b){if(10<b||3>a.network.vertexes.count)return!1;null===a.kg?a.kg=new G(Pp):a.kg.clear();a.kg.Yc(a.network.vertexes);var c=a.kg;c.sort(function(a,b){return null===a||null===b||a===b?0:b.Rf-a.Rf});for(var d=c.count-1;0<=d&&1>=c.ha(d).Rf;)d--;return 1<c.count-d}
function Np(a,b){for(var c=a.network,d=new Ip,e=a.kg.i;e.next();){var f=e.value;if(1<f.Rf){d.Xk(f);var h=new Rp;h.Hx=f.Rf;h.Kx=f.width;h.Gx=f.height;h.TA=f.N.x;h.UA=f.N.y;null===f.lh&&(f.lh=new G(Rp));f.lh.add(h);f.wA=f.lh.count-1}else break}for(var k=c.edges.i;k.next();)if(e=k.value,e.fromVertex.network===d&&e.toVertex.network===d)d.Bo(e);else if(e.fromVertex.network===d){var l=e.fromVertex.Gm;null===l&&(l=new G(Pp),e.fromVertex.Gm=l);l.add(e.toVertex);e.fromVertex.Rf--;e.fromVertex.ak+=e.toVertex.ak}else e.toVertex.network===
d&&(l=e.toVertex.Gm,null===l&&(l=new G(Pp),e.toVertex.Gm=l),l.add(e.fromVertex),e.toVertex.Rf--,e.toVertex.ak+=e.fromVertex.ak);for(e=d.edges.i;e.next();)f=e.value,f.length*=Math.max(1,K.sqrt((f.fromVertex.ak+f.toVertex.ak)/(4*b+1)));for(e=d.vertexes.i;e.next();)if(f=e.value,l=f.Gm,null!==l&&0<l.count&&(h=f.lh.ha(f.lh.count-1),h=h.Hx-f.Rf,!(0>=h))){for(var m=0,n=0,p=l.count-h;p<l.count;p++){for(var q=l.ha(p),r=null,k=q.edges.i;k.next();){var s=k.value;if(s.tH(q)===f){r=s;break}}null!==r&&(n+=r.length,
m+=q.width*q.height)}l=f.oa;k=f.va;p=f.width;q=f.height;r=f.N;s=p*q;1>s&&(s=1);m=K.sqrt((m+s+n*n*4/(h*h))/s);h=(m-1)*p/2;m=(m-1)*q/2;f.pb=new z(l-r.x-h,k-r.y-m,p+2*h,q+2*m);f.focus=new w(r.x+h,r.y+m)}a.network=d;return c}function Op(a,b){for(var c=a.network.vertexes.i;c.next();){var d=c.value;d.network=b;if(null!==d.lh){var e=d.lh.ha(d.wA);d.Rf=e.Hx;var f=e.TA,h=e.UA;d.pb=new z(d.oa-f,d.va-h,e.Kx,e.Gx);d.focus=new w(f,h);d.wA--}}for(c=a.network.edges.i;c.next();)c.value.network=b;a.network=b}
function Qp(a,b){var c=b.Gm;if(null!==c&&0!==c.count){var d=b.oa,e=b.va,f=b.width,h=b.height;null!==b.lh&&0<b.lh.count&&(h=b.lh.ha(0),f=h.Kx,h=h.Gx);for(var f=K.sqrt(f*f+h*h)/2,k=!1,l=h=0,m=0,n=b.vertexes.i;n.next();){var p=n.value;1>=p.Rf?l++:(k=!0,m++,h+=Math.atan2(b.va-p.va,b.oa-p.oa))}if(0!==l)for(0<m&&(h/=m),n=m=0,m=k?2*Math.PI/(l+1):2*Math.PI/l,0===l%2&&(n=m/2),1<c.count&&c.sort(function(a,b){return null===a||null===b||a===b?0:b.width*b.height-a.width*a.height}),k=0===l%2?0:1,c=c.i;c.next();)if(l=
c.value,!(1<l.Rf||a.isFixed(l))){for(var p=null,q=l.edges.i;q.next();){p=q.value;break}var q=l.width,r=l.height,q=K.sqrt(q*q+r*r)/2,p=f+p.length+q,q=h+(m*(k/2>>1)+n)*(0===k%2?1:-1);l.oa=d+p*Math.cos(q);l.va=e+p*Math.sin(q);k++}}}function Kp(a,b,c,d,e,f,h){var k=9E19,l=-1,m=0;a:for(;m<b;m++){var n=a[m],p=n.x-c,q=n.y-d,p=p*p+q*q;if(p<k){for(q=m-1;0<=q;q--)if(a[q].y>n.y&&a[q].x-n.x<e+h.width)continue a;for(q=m+1;q<b;q++)if(a[q].x>n.x&&a[q].y-n.y<f+h.height)continue a;l=m;k=p}}return l}
Hp.prototype.lz=function(){if(this.comments)for(var a=this.network.vertexes.i;a.next();)this.addComments(a.value)};
Hp.prototype.addComments=function(a){var b=a.Dc;if(null!==b)for(b=b.ZD();b.next();){var c=b.value;if("Comment"===c.Mc&&c.isVisible()){var d=this.network.Qm(c);null===d&&(d=this.network.Hs(c));d.charge=this.VG;for(var c=null,e=d.Zb;e.next();){var f=e.value;if(f.toVertex===a){c=f;break}}if(null===c)for(e=d.jc;e.next();)if(f=e.value,f.fromVertex===a){c=f;break}null===c&&(c=this.network.hp(a,d,null));c.length=this.WG}}};
function Zp(a,b){var c=a.ca,d=c.x,e=c.y,f=c.width,c=c.height,h=b.ca,k=h.x,l=h.y,m=h.width,h=h.height;return d+f<k?e>l+h?(d=d+f-k,e=e-l-h,K.sqrt(d*d+e*e)):e+c<l?(d=d+f-k,e=e+c-l,K.sqrt(d*d+e*e)):k-(d+f):d>k+m?e>l+h?(d=d-k-m,e=e-l-h,K.sqrt(d*d+e*e)):e+c<l?(d=d-k-m,e=e+c-l,K.sqrt(d*d+e*e)):d-(k+m):e>l+h?e-(l+h):e+c<l?l-(e+c):.1}function Lp(a,b){a.kg=null;for(var c=a.Yq+b;a.Yq<c&&(a.Yq++,cq(a)););a.kg=null}
function cq(a){null===a.kg&&(a.kg=new G(Pp),a.kg.Yc(a.network.vertexes));var b=a.kg.n;if(0>=b.length)return!1;var c=b[0];c.forceX=0;c.forceY=0;for(var d=c.oa,e=d,f=c.va,h=f,c=1;c<b.length;c++){var k=b[c];k.forceX=0;k.forceY=0;var l=k.oa,k=k.va,d=Math.min(d,l),e=Math.max(e,l),f=Math.min(f,k),h=Math.max(h,k)}(f=e-d>h-f)?b.sort(function(a,b){return null===a||null===b||a===b?0:a.oa-b.oa}):b.sort(function(a,b){return null===a||null===b||a===b?0:a.va-b.va});for(var h=a.Ch,m=0,n=0,p=0,c=0;c<b.length;c++){var k=
b[c],l=k.ca,q=k.N,d=l.x+q.x,l=l.y+q.y,n=k.charge*a.electricalFieldX(d,l),p=k.charge*a.electricalFieldY(d,l),n=n+k.mass*a.gravitationalFieldX(d,l),p=p+k.mass*a.gravitationalFieldY(d,l);k.forceX+=n;k.forceY+=p;for(q=c+1;q<b.length;q++)if(e=b[q],e!==k){var r=e.ca,n=e.N,p=r.x+n.x,r=r.y+n.y;if(d-p>h||p-d>h){if(f)break}else if(l-r>h||r-l>h){if(!f)break}else{var s=Zp(k,e);1>s?(n=a.jx,null===n&&(a.jx=n=new Fa(0)),m=n.random(),s=n.random(),d>p?(n=Math.abs(e.ca.right-k.ca.x),n=(1+n)*m):d<p?(n=Math.abs(e.ca.x-
k.ca.right),n=-(1+n)*m):(n=Math.max(e.width,k.width),n=(1+n)*m-n/2),l>r?(p=Math.abs(e.ca.bottom-k.ca.y),p=(1+p)*s):d<p?(p=Math.abs(e.ca.y-k.ca.bottom),p=-(1+p)*s):(p=Math.max(e.height,k.height),p=(1+p)*s-p/2)):(m=-(k.charge*e.charge)/(s*s),n=(p-d)/s*m,p=(r-l)/s*m);k.forceX+=n;k.forceY+=p;e.forceX-=n;e.forceY-=p}}}for(c=a.network.edges.i;c.next();)f=c.value,k=f.fromVertex,e=f.toVertex,l=k.ca,q=k.N,d=l.x+q.x,l=l.y+q.y,r=e.ca,n=e.N,p=r.x+n.x,r=r.y+n.y,s=Zp(k,e),1>s?(n=a.jx,null===n&&(a.jx=n=new Fa(0)),
m=n.random(),s=n.random(),n=(d>p?1:-1)*(1+(e.width>k.width)?e.width:k.width)*m,p=(l>r?1:-1)*(1+(e.height>k.height)?e.height:k.height)*s):(m=f.stiffness*(s-f.length),n=(p-d)/s*m,p=(r-l)/s*m),k.forceX+=n,k.forceY+=p,e.forceX-=n,e.forceY-=p;c=0;d=Math.max(a.Ch/20,50);for(e=0;e<b.length;e++)k=b[e],a.isFixed(k)?a.moveFixedVertex(k):(f=k.forceX,h=k.forceY,f<-d?f=-d:f>d&&(f=d),h<-d?h=-d:h>d&&(h=d),k.oa+=f,k.va+=h,c=Math.max(c,f*f+h*h));return c>a.WD*a.WD}Hp.prototype.moveFixedVertex=function(){};
Hp.prototype.commitLayout=function(){this.BA();this.commitNodes();this.pt&&this.commitLinks()};Hp.prototype.BA=function(){if(this.Cp)for(var a=this.network.edges.i;a.next();){var b=a.value.link;null!==b&&(b.Ab=yc,b.Bb=yc)}};Hp.prototype.commitNodes=function(){var a=0,b=0;if(this.yG){var c=v.Uf();this.Ug(this.network,c);b=this.Ud;a=b.x-c.x;b=b.y-c.y;v.fc(c)}for(var c=v.Uf(),d=this.network.vertexes.i;d.next();){var e=d.value;if(0!==a||0!==b)c.assign(e.pb),c.x+=a,c.y+=b,e.pb=c;e.commit()}v.fc(c)};
Hp.prototype.commitLinks=function(){for(var a=this.network.edges.i;a.next();)a.value.commit()};Hp.prototype.springStiffness=function(a){a=a.stiffness;return isNaN(a)?this.Dn:a};Hp.prototype.springLength=function(a){a=a.length;return isNaN(a)?this.Cn:a};Hp.prototype.electricalCharge=function(a){a=a.charge;return isNaN(a)?this.zn:a};Hp.prototype.electricalFieldX=function(){return 0};Hp.prototype.electricalFieldY=function(){return 0};
Hp.prototype.gravitationalMass=function(a){a=a.mass;return isNaN(a)?this.Bn:a};Hp.prototype.gravitationalFieldX=function(){return 0};Hp.prototype.gravitationalFieldY=function(){return 0};Hp.prototype.isFixed=function(a){return a.isFixed};v.u(Hp,{UJ:"currentIteration"},function(){return this.Yq});v.defineProperty(Hp,{wD:"arrangementSpacing"},function(){return this.Wf},function(a){v.C(a,ia,Hp,"arrangementSpacing");this.Wf.L(a)||(this.Wf.assign(a),this.G())});
v.defineProperty(Hp,{yG:"arrangesToOrigin"},function(){return this.Wp},function(a){this.Wp!==a&&(v.j(a,"boolean",Hp,"arrangesToOrigin"),this.Wp=a,this.G())});v.defineProperty(Hp,{Cp:"setsPortSpots"},function(){return this.Lh},function(a){this.Lh!==a&&(v.j(a,"boolean",Hp,"setsPortSpots"),this.Lh=a,this.G())});v.defineProperty(Hp,{comments:"comments"},function(){return this.sh},function(a){this.sh!==a&&(v.j(a,"boolean",Hp,"comments"),this.sh=a,this.G())});
v.defineProperty(Hp,{Zz:"maxIterations"},function(){return this.co},function(a){this.co!==a&&(v.j(a,"number",Hp,"maxIterations"),0<=a&&(this.co=a,this.G()))});v.defineProperty(Hp,{WD:"epsilonDistance"},function(){return this.yq},function(a){this.yq!==a&&(v.j(a,"number",Hp,"epsilonDistance"),0<a&&(this.yq=a,this.G()))});v.defineProperty(Hp,{mK:"infinityDistance"},function(){return this.Ch},function(a){this.Ch!==a&&(v.j(a,"number",Hp,"infinityDistance"),1<a&&(this.Ch=a,this.G()))});
v.defineProperty(Hp,{jx:"randomNumberGenerator"},function(){return this.Kr},function(a){this.Kr!==a&&(null!==a&&"function"!==typeof a.random&&v.k('ForceDirectedLayout.randomNumberGenerator must have a "random()" function on it: '+a),this.Kr=a)});v.defineProperty(Hp,{gK:"defaultSpringStiffness"},function(){return this.Dn},function(a){this.Dn!==a&&(v.j(a,"number",Hp,"defaultSpringStiffness"),this.Dn=a,this.G())});
v.defineProperty(Hp,{fK:"defaultSpringLength"},function(){return this.Cn},function(a){this.Cn!==a&&(v.j(a,"number",Hp,"defaultSpringLength"),this.Cn=a,this.G())});v.defineProperty(Hp,{$J:"defaultElectricalCharge"},function(){return this.zn},function(a){this.zn!==a&&(v.j(a,"number",Hp,"defaultElectricalCharge"),this.zn=a,this.G())});v.defineProperty(Hp,{aK:"defaultGravitationalMass"},function(){return this.Bn},function(a){this.Bn!==a&&(v.j(a,"number",Hp,"defaultGravitationalMass"),this.Bn=a,this.G())});
v.defineProperty(Hp,{WG:"defaultCommentSpringLength"},function(){return this.qq},function(a){this.qq!==a&&(v.j(a,"number",Hp,"defaultCommentSpringLength"),this.qq=a,this.G())});v.defineProperty(Hp,{VG:"defaultCommentElectricalCharge"},function(){return this.pq},function(a){this.pq!==a&&(v.j(a,"number",Hp,"defaultCommentElectricalCharge"),this.pq=a,this.G())});function Rp(){this.UA=this.TA=this.Gx=this.Kx=this.Hx=0}function Ip(){wa.call(this)}v.Ga(Ip,wa);v.ga("ForceDirectedNetwork",Ip);
Ip.prototype.createVertex=function(){return new Pp};Ip.prototype.createEdge=function(){return new dq};function Pp(){ya.call(this);this.isFixed=!1;this.mass=this.charge=NaN;this.ak=this.Rf=this.forceY=this.forceX=0;this.lh=this.Gm=null;this.wA=0}v.Ga(Pp,ya);v.ga("ForceDirectedVertex",Pp);function dq(){Aa.call(this);this.length=this.stiffness=NaN}v.Ga(dq,Aa);v.ga("ForceDirectedEdge",dq);
function hm(){0<arguments.length&&v.dd(hm);Me.call(this);this.Dd=this.am=25;this.na=0;this.yn=eq;this.ao=fq;this.Sn=gq;this.Yl=4;this.mn=hq;this.Bi=iq;this.Lh=!0;this.cr=4;this.Gb=this.kv=this.ob=-1;this.Af=this.nr=0;this.Lb=this.zf=this.bg=this.Jg=this.Pd=null;this.ur=0;this.tr=this.gm=null;this.fg=0;this.vr=null;this.Lg=[];this.Lg.length=100}v.Ga(hm,Me);v.ga("LayeredDigraphLayout",hm);
hm.prototype.cloneProtected=function(a){Me.prototype.cloneProtected.call(this,a);a.am=this.am;a.Dd=this.Dd;a.na=this.na;a.yn=this.yn;a.ao=this.ao;a.Sn=this.Sn;a.Yl=this.Yl;a.mn=this.mn;a.Bi=this.Bi;a.Lh=this.Lh;a.cr=this.cr};hm.prototype.createNetwork=function(){return new jq};
hm.prototype.doLayout=function(a){null===a&&v.k("Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts");null===this.network&&(this.network=this.makeNetwork(a));this.Ud=this.initialOrigin(this.Ud);this.kv=-1;this.Af=this.nr=0;this.vr=this.tr=this.gm=null;for(a=0;a<this.Lg.length;a++)this.Lg[a]=null;if(0<this.network.vertexes.count){this.network.yw();for(a=this.network.edges.i;a.next();)a.value.rev=!1;switch(this.yn){default:case kq:var b=0,c=this.network.vertexes.count-
1;a=[];a.length=c+1;for(var d=this.network.vertexes.i;d.next();)d.value.valid=!0;for(;null!==lq(this.network);){for(d=mq(this.network);null!==d;)a[c]=d,c--,d.valid=!1,d=mq(this.network);for(d=nq(this.network);null!==d;)a[b]=d,b++,d.valid=!1,d=nq(this.network);for(var d=null,e=0,f=this.network.vertexes.i;f.next();){var h=f.value;if(h.valid){for(var k=0,l=h.Zb;l.next();)l.value.toVertex.valid&&k++;for(var l=0,m=h.jc;m.next();)m.value.fromVertex.valid&&l++;if(null===d||e<k-l)d=h,e=k-l}}null!==d&&(a[b]=
d,b++,d.valid=!1)}for(b=0;b<this.network.vertexes.count;b++)a[b].index=b;for(a=this.network.edges.i;a.next();)b=a.value,b.fromVertex.index>b.toVertex.index&&(this.network.nx(b),b.rev=!0);break;case eq:for(b=this.network.vertexes.i;b.next();)a=b.value,a.Oo=-1,a.finish=-1;for(a=this.network.edges.i;a.next();)a.value.forest=!1;this.ur=0;for(b.reset();b.next();)c=b.value,0===c.jc.count&&oq(this,c);for(b.reset();b.next();)c=b.value,-1===c.Oo&&oq(this,c);for(a.reset();a.next();)b=a.value,b.forest||(c=b.fromVertex,
d=c.finish,e=b.toVertex,f=e.finish,e.Oo<c.Oo&&d<f&&(this.network.nx(b),b.rev=!0))}for(a=this.network.vertexes.i;a.next();)a.value.layer=-1;this.ob=-1;this.assignLayers();for(a.reset();a.next();)this.ob=Math.max(this.ob,a.value.layer);a=[];for(c=this.network.edges.i;c.next();)b=c.value,b.valid=!1,a.push(b);for(c=0;c<a.length;c++)if(b=a[c],!b.valid&&(null!==b.fromVertex.rd&&null!==b.toVertex.rd||b.fromVertex.layer!==b.toVertex.layer)){l=h=k=f=0;e=b.fromVertex;d=b.toVertex;if(null!==b.link){k=b.link;
if(null===k)continue;var n=e.rd,f=d.rd;if(null===n||null===f)continue;var p=k.U,h=k.ba,q=k.$c,l=k.Bd;b.rev&&(k=p,m=q,p=h,q=l,h=k,l=m);var r=e.N,k=b.toVertex.N,s=b.rev?d.ca:e.ca,m=v.M();s.H()?(Zn(p,q,Kb,m),m.H()||m.assign(r)):m.assign(r);n!==p&&s.H()&&p.isVisible()&&(n=e.ca,n.H()&&(m.x+=s.x-n.x,m.y+=s.y-n.y));p=b.rev?e.ca:d.ca;n=v.M();p.H()?(Zn(h,l,Kb,n),n.H()||n.assign(k)):n.assign(k);f!==h&&p.H()&&h.isVisible()&&(f=d.ca,f.H()&&(n.x+=p.x-f.x,n.y+=p.y-f.y));90===this.na||270===this.na?(f=Math.round((m.x-
r.x)/this.Dd),h=m.x,k=Math.round((n.x-k.x)/this.Dd),l=n.x):(f=Math.round((m.y-r.y)/this.Dd),h=m.y,k=Math.round((n.y-k.y)/this.Dd),l=n.y);v.v(m);v.v(n);b.portFromColOffset=f;b.portFromPos=h;b.portToColOffset=k;b.portToPos=l}else b.portFromColOffset=0,b.portFromPos=0,b.portToColOffset=0,b.portToPos=0;m=e.layer;r=d.layer;n=b;p=0;s=n.link;if(null!==s){var t=s.$c,u=s.Bd;if(null!==t&&null!==u){var x=s.U,q=s.ba;if(null!==x&&null!==q){var y=t.Ab,A=u.Bb;this.Cp||(s.Ab.Oc()||(y=s.Ab),s.Bb.Oc()||(A=s.Bb));if(y.Oc()||
y===xb)y=pq(this,!0);if(A.Oc()||A===xb)A=pq(this,!1);var B=s.hc,I=s.getLinkPoint(x,t,y,!0,B,q,u,v.M()),y=s.getLinkDirection(x,t,I,y,!0,B,q,u);v.v(I);y===qq(this,n,!0)?p+=1:this.Cp&&null!==x&&1===x.ports.count&&n.rev&&(p+=1);I=s.getLinkPoint(q,u,A,!1,B,x,t,v.M());s=s.getLinkDirection(q,u,I,A,!1,B,x,t);v.v(I);s===qq(this,n,!1)?p+=2:this.Cp&&null!==q&&1===q.ports.count&&n.rev&&(p+=2)}}}n=1===p||3===p?!0:!1;if(p=2===p||3===p?!0:!1)q=this.network.createVertex(),q.rd=null,q.Dm=1,q.layer=m,q.near=e,this.network.Xk(q),
e=this.network.hp(e,q,b.link),e.valid=!1,e.rev=b.rev,e.portFromColOffset=f,e.portToColOffset=0,e.portFromPos=h,e.portToPos=0,e=q;s=1;n&&s--;if(m-r>s&&0<m){b.valid=!1;q=this.network.createVertex();q.rd=null;q.Dm=2;q.layer=m-1;this.network.Xk(q);e=this.network.hp(e,q,b.link);e.valid=!0;e.rev=b.rev;e.portFromColOffset=p?0:f;e.portToColOffset=0;e.portFromPos=p?0:h;e.portToPos=0;e=q;for(m--;m-r>s&&0<m;)q=this.network.createVertex(),q.rd=null,q.Dm=3,q.layer=m-1,this.network.Xk(q),e=this.network.hp(e,q,
b.link),e.valid=!0,e.rev=b.rev,e.portFromColOffset=0,e.portToColOffset=0,e.portFromPos=0,e.portToPos=0,e=q,m--;e=this.network.hp(q,d,b.link);e.valid=!n;n&&(q.near=d);e.rev=b.rev;e.portFromColOffset=0;e.portToColOffset=k;e.portFromPos=0;e.portToPos=l}else b.valid=!0}b=this.Pd=[];for(c=0;c<=this.ob;c++)b[c]=0;for(a=this.network.vertexes.i;a.next();)c=a.value,c.index=-1;this.initializeIndices();this.kv=-1;for(c=this.Af=this.nr=0;c<=this.ob;c++)b[c]>b[this.Af]&&(this.kv=b[c]-1,this.Af=c),b[c]<b[this.nr]&&
(this.nr=c);this.vr=[];for(c=0;c<b.length;c++)this.vr[c]=[];for(a.reset();a.next();)b=a.value,c=this.vr[b.layer],c[b.index]=b;this.Gb=-1;for(a=0;a<=this.ob;a++){b=rq(this,a);c=0;d=this.Pd[a];for(e=0;e<d;e++)f=b[e],c+=this.nodeMinColumnSpace(f,!0),f.column=c,c+=1,c+=this.nodeMinColumnSpace(f,!1);this.Gb=Math.max(this.Gb,c-1);sq(this,a,b)}this.reduceCrossings();this.straightenAndPack();this.updateParts()}this.network=null;this.sf=!0};
hm.prototype.linkMinLength=function(a){var b=a.toVertex,c=0;for(a=a.fromVertex.Zb;a.next();)a.value.toVertex===b&&c++;return 1<c?2:1};function tq(a){var b=a.fromVertex.rd;a=a.toVertex.rd;return null===b&&null===a?8:null===b||null===a?4:1}hm.prototype.nodeMinLayerSpace=function(a,b){return null===a.rd?0:90===this.na||270===this.na?b?a.N.y+10:a.ca.height-a.N.y+10:b?a.N.x+10:a.ca.width-a.N.x+10};
hm.prototype.nodeMinColumnSpace=function(a,b){if(null===a.rd)return 0;var c=b?a.gA:a.fA;if(null!==c)return c;c=this.na;return 90===c||270===c?b?a.gA=a.N.x/this.Dd+1|0:a.fA=(a.ca.width-a.N.x)/this.Dd+1|0:b?a.gA=a.N.y/this.Dd+1|0:a.fA=(a.ca.height-a.N.y)/this.Dd+1|0};function uq(a){null===a.gm&&(a.gm=[]);for(var b=0,c=a.network.vertexes.i;c.next();){var d=c.value;a.gm[b]=d.layer;b++;a.gm[b]=d.column;b++;a.gm[b]=d.index;b++}return a.gm}
function vq(a,b){for(var c=0,d=a.network.vertexes.i;d.next();){var e=d.value;e.layer=b[c];c++;e.column=b[c];c++;e.index=b[c];c++}}
function wq(a,b,c){var d=rq(a,b),e=a.Pd[b];if(null===a.tr||a.tr.length<e*e)a.tr=[];for(var f=a.tr,h=0;h<e;h++){var k=0,l=d[h],m=l.near,n=0;if(null!==m&&m.layer===l.layer)if(n=m.index,n>h)for(var p=h+1;p<n;p++)l=d[p],l.near===m&&l.Dm===m.Dm||k++;else for(p=h-1;p>n;p--)l=d[p],l.near===m&&l.Dm===m.Dm||k++;var m=0,q,r=q=p=l=0,s,t=0,u=0;s=0;var x;if(0<=c)for(n=d[h].Me,m=0;m<n.count;m++)if(q=n.n[m],q.valid&&q.fromVertex.layer!==b)for(l=q.fromVertex.index,p=q.portToPos,q=q.portFromPos,r=m+1;r<n.count;r++)s=
n.n[r],s.valid&&s.fromVertex.layer!==b&&(t=s.fromVertex.index,u=s.portToPos,s=s.portFromPos,p<u&&(l>t||l===t&&q>s)&&k++,u<p&&(t>l||t===l&&s>q)&&k++);if(0>=c)for(n=d[h].He,m=0;m<n.count;m++)if(q=n.n[m],q.valid&&q.toVertex.layer!==b)for(l=q.toVertex.index,p=q.portToPos,q=q.portFromPos,r=m+1;r<n.count;r++)s=n.n[r],s.valid&&s.toVertex.layer!==b&&(t=s.toVertex.index,u=s.portToPos,s=s.portFromPos,q<s&&(l>t||l===t&&p>u)&&k++,s<q&&(t>l||t===l&&u>p)&&k++);f[h*e+h]=k;for(n=h+1;n<e;n++){var y=0,A=0;if(0<=c)for(k=
d[h].Me,x=d[n].Me,m=0;m<k.count;m++)if(q=k.n[m],q.valid&&q.fromVertex.layer!==b)for(l=q.fromVertex.index,q=q.portFromPos,r=0;r<x.count;r++)s=x.n[r],s.valid&&s.fromVertex.layer!==b&&(t=s.fromVertex.index,s=s.portFromPos,(l<t||l===t&&q<s)&&A++,(t<l||t===l&&s<q)&&y++);if(0>=c)for(k=d[h].He,x=d[n].He,m=0;m<k.count;m++)if(q=k.n[m],q.valid&&q.toVertex.layer!==b)for(l=q.toVertex.index,p=q.portToPos,r=0;r<x.count;r++)s=x.n[r],s.valid&&s.toVertex.layer!==b&&(t=s.toVertex.index,u=s.portToPos,(l<t||l===t&&p<
u)&&A++,(t<l||t===l&&u<p)&&y++);f[h*e+n]=y;f[n*e+h]=A}}sq(a,b,d);return f}hm.prototype.countCrossings=function(){for(var a=0,b=0;b<=this.ob;b++)for(var c=wq(this,b,1),d=this.Pd[b],e=0;e<d;e++)for(var f=e;f<d;f++)a+=c[e*d+f];return a};
function xq(a){for(var b=0,c=0;c<=a.ob;c++){for(var d=a,e=c,f=rq(d,e),h=d.Pd[e],k=0,l=0;l<h;l++){var m=null,m=f[l].He,n,p=0,q=0;if(null!==m)for(var r=0;r<m.count;r++)n=m.n[r],n.valid&&n.toVertex.layer!==e&&(p=n.fromVertex.column+n.portFromColOffset,q=n.toVertex.column+n.portToColOffset,k+=(Math.abs(p-q)+1)*tq(n))}sq(d,e,f);b+=k}return b}
hm.prototype.normalize=function(){var a=Infinity;this.Gb=-1;for(var b=this.network.vertexes.i;b.next();){var c=b.value,a=Math.min(a,c.column-this.nodeMinColumnSpace(c,!0));this.Gb=Math.max(this.Gb,c.column+this.nodeMinColumnSpace(c,!1))}for(b.reset();b.next();)b.value.column-=a;this.Gb-=a};
function yq(a,b,c){for(var d=rq(a,b),e=a.Pd[b],f=[],h=0;h<e;h++){var k=d[h],l=null;0>=c&&(l=k.Me);var m=null;0<=c&&(m=k.He);var n=0,p=0,q=k.near;null!==q&&q.layer===k.layer&&(n+=q.column-1,p++);if(null!==l)for(q=0;q<l.count;q++){var k=l.n[q],r=k.fromVertex;k.valid&&!k.rev&&r.layer!==b&&(n+=r.column+k.portFromColOffset,p++)}if(null!==m)for(l=0;l<m.count;l++)k=m.n[l],q=k.toVertex,k.valid&&!k.rev&&q.layer!==b&&(n+=q.column+k.portToColOffset,p++);f[h]=0===p?-1:n/p}sq(a,b,d);return f}
function zq(a,b,c){for(var d=rq(a,b),e=a.Pd[b],f=[],h=0;h<e;h++){var k=d[h],l=null;0>=c&&(l=k.Me);var m=null;0<=c&&(m=k.He);var n=0,p=[],q=k.near;null!==q&&q.layer===k.layer&&(p[n]=q.column-1,n++);if(null!==l)for(q=0;q<l.count;q++){var k=l.n[q],r=k.fromVertex;k.valid&&!k.rev&&r.layer!==b&&(p[n]=r.column+k.portFromColOffset,n++)}if(null!==m)for(l=0;l<m.count;l++)k=m.n[l],q=k.toVertex,k.valid&&!k.rev&&q.layer!==b&&(p[n]=q.column+k.portToColOffset,n++);0===n?f[h]=-1:(p.sort(function(a,b){return a-b}),
m=n>>1,f[h]=n&1?p[m]:p[m-1]+p[m]>>1)}sq(a,b,d);return f}function Aq(a,b,c,d,e,f){if(b.component===d){b.component=c;var h=0,k=0;if(e)for(var l=b.Zb;l.next();){var k=l.value,m=k.toVertex,h=b.layer-m.layer,k=a.linkMinLength(k);h===k&&Aq(a,m,c,d,e,f)}if(f)for(l=b.jc;l.next();)k=l.value,m=k.fromVertex,h=m.layer-b.layer,k=a.linkMinLength(k),h===k&&Aq(a,m,c,d,e,f)}}
function Bq(a,b,c,d,e,f){if(b.component===d){b.component=c;if(e)for(var h=b.Zb;h.next();)Bq(a,h.value.toVertex,c,d,e,f);if(f)for(b=b.jc;b.next();)Bq(a,b.value.fromVertex,c,d,e,f)}}function lq(a){for(a=a.vertexes.i;a.next();){var b=a.value;if(b.valid)return b}return null}function mq(a){for(a=a.vertexes.i;a.next();){var b=a.value;if(b.valid){for(var c=!0,d=b.Zb;d.next();)if(d.value.toVertex.valid){c=!1;break}if(c)return b}}return null}
function nq(a){for(a=a.vertexes.i;a.next();){var b=a.value;if(b.valid){for(var c=!0,d=b.jc;d.next();)if(d.value.fromVertex.valid){c=!1;break}if(c)return b}}return null}function oq(a,b){b.Oo=a.ur;a.ur++;for(var c=b.Zb;c.next();){var d=c.value,e=d.toVertex;-1===e.Oo&&(d.forest=!0,oq(a,e))}b.finish=a.ur;a.ur++}
hm.prototype.assignLayers=function(){switch(this.ao){case Cq:Dq(this);break;case Eq:for(var a=0,b=this.network.vertexes.i;b.next();)a=Fq(this,b.value),this.ob=Math.max(a,this.ob);for(b.reset();b.next();)a=b.value,a.layer=this.ob-a.layer;break;default:case fq:Dq(this);for(b=this.network.vertexes.i;b.next();)b.value.valid=!1;for(b.reset();b.next();)a=b.value,0===a.jc.count&&Gq(this,a);a=Infinity;for(b.reset();b.next();)a=Math.min(a,b.value.layer);this.ob=-1;for(b.reset();b.next();){var c=b.value;c.layer-=
a;this.ob=Math.max(this.ob,c.layer)}}};function Dq(a){for(var b=a.network.vertexes.i;b.next();){var c=Hq(a,b.value);a.ob=Math.max(c,a.ob)}}function Hq(a,b){var c=0;if(-1===b.layer){for(var d=b.Zb;d.next();)var e=d.value,f=e.toVertex,e=a.linkMinLength(e),c=Math.max(c,Hq(a,f)+e);b.layer=c}else c=b.layer;return c}function Fq(a,b){var c=0;if(-1===b.layer){for(var d=b.jc;d.next();)var e=d.value,f=e.fromVertex,e=a.linkMinLength(e),c=Math.max(c,Fq(a,f)+e);b.layer=c}else c=b.layer;return c}
function Gq(a,b){if(!b.valid){b.valid=!0;for(var c=b.Zb;c.next();)Gq(a,c.value.toVertex);for(c=a.network.vertexes.i;c.next();)c.value.component=-1;for(var d=b.Me.n,e=d.length,f=0;f<e;f++){var h=d[f],k=a.linkMinLength(h);h.fromVertex.layer-h.toVertex.layer>k&&Aq(a,h.fromVertex,0,-1,!0,!1)}for(Aq(a,b,1,-1,!0,!0);0!==b.component;){for(var k=0,d=Infinity,l=0,m=null,n=a.network.vertexes.i;n.next();){var p=n.value;if(1===p.component){for(var q=0,r=!1,s=p.Me.n,e=s.length,f=0;f<e;f++){var h=s[f],t=h.fromVertex,
q=q+1;1!==t.component&&(k+=1,t=t.layer-p.layer,h=a.linkMinLength(h),d=Math.min(d,t-h))}h=p.He.n;e=h.length;for(f=0;f<e;f++)s=h[f].toVertex,q-=1,1!==s.component?k-=1:r=!0;(null===m||q<l)&&!r&&(m=p,l=q)}}if(0<k){for(c.reset();c.next();)e=c.value,1===e.component&&(e.layer+=d);b.component=0}else m.component=0}for(c=a.network.vertexes.i;c.next();)c.value.component=-1;for(Aq(a,b,1,-1,!0,!1);0!==b.component;){f=0;e=Infinity;d=0;k=null;for(l=a.network.vertexes.i;l.next();)if(m=l.value,1===m.component){n=
0;p=!1;h=m.Me.n;q=h.length;for(r=0;r<q;r++)s=h[r].fromVertex,n+=1,1!==s.component?f+=1:p=!0;h=m.He.n;q=h.length;for(r=0;r<q;r++)s=h[r],t=s.toVertex,n-=1,1!==t.component&&(f-=1,t=m.layer-t.layer,s=a.linkMinLength(s),e=Math.min(e,t-s));(null===k||n>d)&&!p&&(k=m,d=n)}if(0>f){for(c.reset();c.next();)f=c.value,1===f.component&&(f.layer-=e);b.component=0}else k.component=0}}}
function qq(a,b,c){return 90===a.na?c&&!b.rev||!c&&b.rev?270:90:180===a.na?c&&!b.rev||!c&&b.rev?0:180:270===a.na?c&&!b.rev||!c&&b.rev?90:270:c&&!b.rev||!c&&b.rev?180:0}
hm.prototype.initializeIndices=function(){switch(this.Sn){default:case Iq:for(var a=this.network.vertexes.i;a.next();){var b=a.value,c=b.layer;b.index=this.Pd[c];this.Pd[c]++}break;case gq:a=this.network.vertexes.i;for(b=this.ob;0<=b;b--)for(a.reset();a.next();)c=a.value,c.layer===b&&-1===c.index&&Jq(this,c);break;case Kq:for(a=this.network.vertexes.i,b=0;b<=this.ob;b++)for(a.reset();a.next();)c=a.value,c.layer===b&&-1===c.index&&Lq(this,c)}};
function Jq(a,b){var c=b.layer;b.index=a.Pd[c];a.Pd[c]++;for(var c=b.He.ed(),d=!0;d;)for(var d=!1,e=0;e<c.length-1;e++){var f=c[e],h=c[e+1];f.portFromColOffset>h.portFromColOffset&&(d=!0,c[e]=h,c[e+1]=f)}for(e=0;e<c.length;e++)d=c[e],d.valid&&(d=d.toVertex,-1===d.index&&Jq(a,d))}
function Lq(a,b){var c=b.layer;b.index=a.Pd[c];a.Pd[c]++;for(var c=b.Me.ed(),d=!0,e=0;d;)for(d=!1,e=0;e<c.length-1;e++){var f=c[e],h=c[e+1];f.portToColOffset>h.portToColOffset&&(d=!0,c[e]=h,c[e+1]=f)}for(e=0;e<c.length;e++)d=c[e],d.valid&&(d=d.fromVertex,-1===d.index&&Lq(a,d))}
hm.prototype.reduceCrossings=function(){for(var a=this.countCrossings(),b=uq(this),c=0,d=0,e=0,c=0;c<this.Yl;c++){for(d=0;d<=this.ob;d++)Mq(this,d,1),Nq(this,d,1);e=this.countCrossings();e<a&&(a=e,b=uq(this));for(d=this.ob;0<=d;d--)Mq(this,d,-1),Nq(this,d,-1);e=this.countCrossings();e<a&&(a=e,b=uq(this))}vq(this,b);for(c=0;c<this.Yl;c++){for(d=0;d<=this.ob;d++)Mq(this,d,0),Nq(this,d,0);e=this.countCrossings();e<a&&(a=e,b=uq(this));for(d=this.ob;0<=d;d--)Mq(this,d,0),Nq(this,d,0);e=this.countCrossings();
e<a&&(a=e,b=uq(this))}vq(this,b);var f=!1,h=c=0,k=0,d=0;switch(this.mn){case Oq:break;case Pq:for(k=a+1;(d=this.countCrossings())<k;)for(k=d,c=this.ob;0<=c;c--)for(h=0;h<=c;h++){for(f=!0;f;)for(f=!1,d=c;d>=h;d--)f=Nq(this,d,-1)||f;e=this.countCrossings();e>=a?vq(this,b):(a=e,b=uq(this));for(f=!0;f;)for(f=!1,d=c;d>=h;d--)f=Nq(this,d,1)||f;e=this.countCrossings();e>=a?vq(this,b):(a=e,b=uq(this));for(f=!0;f;)for(f=!1,d=h;d<=c;d++)f=Nq(this,d,1)||f;e>=a?vq(this,b):(a=e,b=uq(this));for(f=!0;f;)for(f=!1,
d=h;d<=c;d++)f=Nq(this,d,-1)||f;e>=a?vq(this,b):(a=e,b=uq(this));for(f=!0;f;)for(f=!1,d=c;d>=h;d--)f=Nq(this,d,0)||f;e>=a?vq(this,b):(a=e,b=uq(this));for(f=!0;f;)for(f=!1,d=h;d<=c;d++)f=Nq(this,d,0)||f;e>=a?vq(this,b):(a=e,b=uq(this))}break;default:case hq:for(c=this.ob,h=0,k=a+1;(d=this.countCrossings())<k;){k=d;for(f=!0;f;)for(f=!1,d=c;d>=h;d--)f=Nq(this,d,-1)||f;e=this.countCrossings();e>=a?vq(this,b):(a=e,b=uq(this));for(f=!0;f;)for(f=!1,d=c;d>=h;d--)f=Nq(this,d,1)||f;e=this.countCrossings();
e>=a?vq(this,b):(a=e,b=uq(this));for(f=!0;f;)for(f=!1,d=h;d<=c;d++)f=Nq(this,d,1)||f;e>=a?vq(this,b):(a=e,b=uq(this));for(f=!0;f;)for(f=!1,d=h;d<=c;d++)f=Nq(this,d,-1)||f;e>=a?vq(this,b):(a=e,b=uq(this));for(f=!0;f;)for(f=!1,d=c;d>=h;d--)f=Nq(this,d,0)||f;e>=a?vq(this,b):(a=e,b=uq(this));for(f=!0;f;)for(f=!1,d=h;d<=c;d++)f=Nq(this,d,0)||f;e>=a?vq(this,b):(a=e,b=uq(this))}}vq(this,b)};
function Mq(a,b,c){var d=0,e=rq(a,b),f=a.Pd[b],h=zq(a,b,c);c=yq(a,b,c);for(d=0;d<f;d++)-1===c[d]&&(c[d]=e[d].column),-1===h[d]&&(h[d]=e[d].column);for(var k=!0,l;k;)for(k=!1,d=0;d<f-1;d++)if(h[d+1]<h[d]||h[d+1]===h[d]&&c[d+1]<c[d])k=!0,l=h[d],h[d]=h[d+1],h[d+1]=l,l=c[d],c[d]=c[d+1],c[d+1]=l,l=e[d],e[d]=e[d+1],e[d+1]=l;for(d=h=0;d<f;d++)l=e[d],l.index=d,h+=a.nodeMinColumnSpace(l,!0),l.column=h,h+=1,h+=a.nodeMinColumnSpace(l,!1);sq(a,b,e)}
function Nq(a,b,c){var d=rq(a,b),e=a.Pd[b];c=wq(a,b,c);var f=0,h;h=[];for(f=0;f<e;f++)h[f]=-1;var k;k=[];for(f=0;f<e;f++)k[f]=-1;for(var l=!1,m=!0;m;)for(m=!1,f=0;f<e-1;f++){var n=c[d[f].index*e+d[f+1].index],p=c[d[f+1].index*e+d[f].index],q=0,r=0,s=d[f].column,t=d[f+1].column,u=a.nodeMinColumnSpace(d[f],!0),x=a.nodeMinColumnSpace(d[f],!1),y=a.nodeMinColumnSpace(d[f+1],!0),A=a.nodeMinColumnSpace(d[f+1],!1),u=s-u+y,x=t-x+A,y=y=0,B=d[f].jc.i;for(B.reset();B.next();)if(A=B.value,A.valid&&A.fromVertex.layer===
b){A=A.fromVertex;for(y=0;d[y]!==A;)y++;y<f&&(q+=2*(f-y),r+=2*(f+1-y));y===f+1&&(q+=1);y>f+1&&(q+=4*(y-f),r+=4*(y-(f+1)))}B=d[f].Zb.i;for(B.reset();B.next();)if(A=B.value,A.valid&&A.toVertex.layer===b){A=A.toVertex;for(y=0;d[y]!==A;)y++;y===f+1&&(r+=1)}B=d[f+1].jc.i;for(B.reset();B.next();)if(A=B.value,A.valid&&A.fromVertex.layer===b){A=A.fromVertex;for(y=0;d[y]!==A;)y++;y<f&&(q+=2*(f+1-y),r+=2*(f-y));y===f&&(r+=1);y>f+1&&(q+=4*(y-(f+1)),r+=4*(y-f))}B=d[f+1].Zb.i;for(B.reset();B.next();)if(A=B.value,
A.valid&&A.toVertex.layer===b){A=A.toVertex;for(y=0;d[y]!==A;)y++;y===f&&(q+=1)}var y=A=0,B=h[d[f].index],I=k[d[f].index],D=h[d[f+1].index],V=k[d[f+1].index];-1!==B&&(A+=Math.abs(B-s),y+=Math.abs(B-x));-1!==I&&(A+=Math.abs(I-s),y+=Math.abs(I-x));-1!==D&&(A+=Math.abs(D-t),y+=Math.abs(D-u));-1!==V&&(A+=Math.abs(V-t),y+=Math.abs(V-u));if(r<q-.5||r===q&&p<n-.5||r===q&&p===n&&y<A-.5)m=l=!0,d[f].column=x,d[f+1].column=u,n=d[f],d[f]=d[f+1],d[f+1]=n}for(f=0;f<e;f++)d[f].index=f;sq(a,b,d);return l}
hm.prototype.straightenAndPack=function(){var a=0,b=!1,c=0!==(this.Bi&Qq),a=this.Bi===iq;1E3<this.network.edges.count&&!a&&(c=!1);if(c){b=[];for(a=a=0;a<=this.ob;a++)b[a]=0;for(var d=0,e=this.network.vertexes.i;e.next();){var f=e.value,a=f.layer,d=f.column,f=this.nodeMinColumnSpace(f,!1);b[a]=Math.max(b[a],d+f)}for(e.reset();e.next();)f=e.value,a=f.layer,d=f.column,f.column=(8*(this.Gb-b[a])>>1)+8*d;this.Gb*=8}if(0!==(this.Bi&Rq))for(b=!0;b;){b=!1;for(a=this.Af+1;a<=this.ob;a++)b=Sq(this,a,1)||b;
for(a=this.Af-1;0<=a;a--)b=Sq(this,a,-1)||b;b=Sq(this,this.Af,0)||b}if(0!==(this.Bi&Tq)){for(a=this.Af+1;a<=this.ob;a++)Uq(this,a,1);for(a=this.Af-1;0<=a;a--)Uq(this,a,-1);Uq(this,this.Af,0)}c&&(Vq(this,-1),Vq(this,1));if(0!==(this.Bi&Rq))for(b=!0;b;){b=!1;b=Sq(this,this.Af,0)||b;for(a=this.Af+1;a<=this.ob;a++)b=Sq(this,a,0)||b;for(a=this.Af-1;0<=a;a--)b=Sq(this,a,0)||b}};function Sq(a,b,c){for(var d=!1;Wq(a,b,c);)d=!0;return d}
function Wq(a,b,c){var d=0,e=rq(a,b),f=a.Pd[b],h=yq(a,b,-1);if(0<c)for(d=0;d<f;d++)h[d]=-1;var k=yq(a,b,1);if(0>c)for(d=0;d<f;d++)k[d]=-1;for(var l=!1,m=!0;m;)for(m=!1,d=0;d<f;d++){var n=e[d].column,p=a.nodeMinColumnSpace(e[d],!0),q=a.nodeMinColumnSpace(e[d],!1),r=0,r=0>d-1||n-e[d-1].column-1>p+a.nodeMinColumnSpace(e[d-1],!1)?n-1:n,p=0,p=d+1>=f||e[d+1].column-n-1>q+a.nodeMinColumnSpace(e[d+1],!0)?n+1:n,s=q=0,t=0,u=0,x=0,y=0;if(0>=c)for(var A=e[d].jc.i;A.next();){var B=A.value;B.valid&&B.fromVertex.layer!==
b&&(u=tq(B),x=B.portFromColOffset,y=B.portToColOffset,B=B.fromVertex.column,q+=(Math.abs(n+y-(B+x))+1)*u,s+=(Math.abs(r+y-(B+x))+1)*u,t+=(Math.abs(p+y-(B+x))+1)*u)}if(0<=c)for(A=e[d].Zb.i;A.next();)B=A.value,B.valid&&B.toVertex.layer!==b&&(u=tq(B),x=B.portFromColOffset,y=B.portToColOffset,B=B.toVertex.column,q+=(Math.abs(n+x-(B+y))+1)*u,s+=(Math.abs(r+x-(B+y))+1)*u,t+=(Math.abs(p+x-(B+y))+1)*u);y=x=u=0;A=h[e[d].index];B=k[e[d].index];-1!==A&&(u+=Math.abs(A-n),x+=Math.abs(A-r),y+=Math.abs(A-p));-1!==
B&&(u+=Math.abs(B-n),x+=Math.abs(B-r),y+=Math.abs(B-p));if(s<q||s===q&&x<u)m=l=!0,e[d].column=r;if(t<q||t===q&&y<u)m=l=!0,e[d].column=p}sq(a,b,e);a.normalize();return l}
function Uq(a,b,c){var d=0,e=rq(a,b),f=a.Pd[b],h=zq(a,b,c);c=[];for(d=0;d<f;d++)c[d]=h[d];for(h=!0;h;)for(h=!1,d=0;d<f;d++){var k=e[d].column,l=a.nodeMinColumnSpace(e[d],!0),m=a.nodeMinColumnSpace(e[d],!1),n=0,p=0,q=0,q=p=0;-1===c[d]?0===d&&d===f-1?n=k:0===d?(p=e[d+1].column,n=p-k===m+a.nodeMinColumnSpace(e[d+1],!0)?k-1:k):d===f-1?(q=e[d-1].column,n=k-q===l+a.nodeMinColumnSpace(e[d-1],!1)?k+1:k):(q=e[d-1].column,q=q+a.nodeMinColumnSpace(e[d-1],!1)+l+1,p=e[d+1].column,p=p-a.nodeMinColumnSpace(e[d+
1],!0)-m-1,n=(q+p)/2|0):0===d&&d===f-1?n=c[d]:0===d?(p=e[d+1].column,p=p-a.nodeMinColumnSpace(e[d+1],!0)-m-1,n=Math.min(c[d],p)):d===f-1?(q=e[d-1].column,q=q+a.nodeMinColumnSpace(e[d-1],!1)+l+1,n=Math.max(c[d],q)):(q=e[d-1].column,q=q+a.nodeMinColumnSpace(e[d-1],!1)+l+1,p=e[d+1].column,p=p-a.nodeMinColumnSpace(e[d+1],!0)-m-1,q<c[d]&&c[d]<p?n=c[d]:q>=c[d]?n=q:p<=c[d]&&(n=p));n!==k&&(h=!0,e[d].column=n)}sq(a,b,e);a.normalize()}
function Xq(a,b){for(var c=!0,d=a.network.vertexes.i;d.next();){var e=d.value,f=a.nodeMinColumnSpace(e,!0),h=a.nodeMinColumnSpace(e,!1);if(e.column-f<=b&&e.column+h>=b){c=!1;break}}e=!1;if(c)for(d.reset();d.next();)c=d.value,c.column>b&&(c.column-=1,e=!0);return e}
function Yq(a,b){for(var c=b,c=b+1,d=0,e=[],f=[],d=0;d<=a.ob;d++)e[d]=!1,f[d]=!1;for(var h=a.network.vertexes.i;h.next();){var d=h.value,k=d.column-a.nodeMinColumnSpace(d,!0),l=d.column+a.nodeMinColumnSpace(d,!1);k<=b&&l>=b&&(e[d.layer]=!0);k<=c&&l>=c&&(f[d.layer]=!0)}k=!0;c=!1;for(d=0;d<=a.ob;d++)k=k&&!(e[d]&&f[d]);if(k)for(h.reset();h.next();)e=h.value,e.column>b&&(e.column-=1,c=!0);return c}
function Vq(a,b){for(var c=0;c<=a.Gb;c++)for(;Xq(a,c););a.normalize();for(c=0;c<a.Gb;c++)for(;Yq(a,c););a.normalize();var c=0,d,e=0,f=0,h=0;if(0<b)for(c=0;c<=a.Gb;c++)for(d=uq(a),e=xq(a),f=e+1;e<f;)f=e,Zq(a,c,1),h=xq(a),h>e?vq(a,d):h<e&&(e=h,d=uq(a));if(0>b)for(c=a.Gb;0<=c;c--)for(d=uq(a),e=xq(a),f=e+1;e<f;)f=e,Zq(a,c,-1),h=xq(a),h>e?vq(a,d):h<e&&(e=h,d=uq(a));a.normalize()}
function Zq(a,b,c){a.fg=0;for(var d=a.network.vertexes.i;d.next();)d.value.component=-1;if(0<c)for(d.reset();d.next();){var e=d.value;e.column-a.nodeMinColumnSpace(e,!0)<=b&&(e.component=a.fg)}if(0>c)for(d.reset();d.next();)e=d.value,e.column+a.nodeMinColumnSpace(e,!1)>=b&&(e.component=a.fg);a.fg++;for(d.reset();d.next();)b=d.value,-1===b.component&&(Bq(a,b,a.fg,-1,!0,!0),a.fg++);var f=0;b=[];for(f=0;f<a.fg*a.fg;f++)b[f]=!1;e=[];for(f=0;f<(a.ob+1)*(a.Gb+1);f++)e[f]=-1;for(d.reset();d.next();)for(var f=
d.value,h=f.layer,k=Math.max(0,f.column-a.nodeMinColumnSpace(f,!0)),l=Math.min(a.Gb,f.column+a.nodeMinColumnSpace(f,!1));k<=l;k++)e[h*(a.Gb+1)+k]=f.component;for(f=0;f<=a.ob;f++){if(0<c)for(k=0;k<a.Gb;k++)-1!==e[f*(a.Gb+1)+k]&&-1!==e[f*(a.Gb+1)+k+1]&&e[f*(a.Gb+1)+k]!==e[f*(a.Gb+1)+k+1]&&(b[e[f*(a.Gb+1)+k]*a.fg+e[f*(a.Gb+1)+k+1]]=!0);if(0>c)for(k=a.Gb;0<k;k--)-1!==e[f*(a.Gb+1)+k]&&-1!==e[f*(a.Gb+1)+k-1]&&e[f*(a.Gb+1)+k]!==e[f*(a.Gb+1)+k-1]&&(b[e[f*(a.Gb+1)+k]*a.fg+e[f*(a.Gb+1)+k-1]]=!0)}e=[];for(f=
0;f<a.fg;f++)e[f]=!0;h=new G("number");h.add(0);for(l=0;0!==h.count;)if(l=h.n[h.count-1],h.Rc(h.count-1),e[l])for(e[l]=!1,f=0;f<a.fg;f++)b[l*a.fg+f]&&h.xd(0,f);if(0<c)for(d.reset();d.next();)a=d.value,e[a.component]&&(a.column-=1);if(0>c)for(d.reset();d.next();)c=d.value,e[c.component]&&(c.column+=1)}
hm.prototype.commitLayout=function(){if(this.Cp)for(var a=pq(this,!0),b=pq(this,!1),c=this.network.edges.i;c.next();){var d=c.value.link;null!==d&&(d.Ab=a,d.Bb=b)}this.commitNodes();this.qz();this.pt&&this.commitLinks()};function pq(a,b){return 270===a.na?b?zc:Cc:90===a.na?b?Cc:zc:180===a.na?b?Ac:Bc:b?Bc:Ac}
hm.prototype.commitNodes=function(){this.Jg=[];this.bg=[];this.zf=[];this.Lb=[];for(var a=0;a<=this.ob;a++)this.Jg[a]=0,this.bg[a]=0,this.zf[a]=0,this.Lb[a]=0;for(a=this.network.vertexes.i;a.next();){var b=a.value,c=b.layer;this.Jg[c]=Math.max(this.Jg[c],this.nodeMinLayerSpace(b,!0));this.bg[c]=Math.max(this.bg[c],this.nodeMinLayerSpace(b,!1))}for(var b=0,d=this.am,c=0;c<=this.ob;c++){var e=d;0>=this.Jg[c]+this.bg[c]&&(e=0);0<c&&(b+=e/2);90===this.na||0===this.na?(b+=this.bg[c],this.zf[c]=b,b+=this.Jg[c]):
(b+=this.Jg[c],this.zf[c]=b,b+=this.bg[c]);c<this.ob&&(b+=e/2);this.Lb[c]=b}d=b;b=this.Ud;for(c=0;c<=this.ob;c++)270===this.na?this.zf[c]=b.y+this.zf[c]:90===this.na?(this.zf[c]=b.y+d-this.zf[c],this.Lb[c]=d-this.Lb[c]):180===this.na?this.zf[c]=b.x+this.zf[c]:(this.zf[c]=b.x+d-this.zf[c],this.Lb[c]=d-this.Lb[c]);for(a.reset();a.next();){var c=a.value,d=c.layer,e=c.column|0,f=0,h=0;270===this.na||90===this.na?(f=b.x+this.Dd*e,h=this.zf[d]):(f=this.zf[d],h=b.y+this.Dd*e);c.oa=f;c.va=h;c.commit()}};
hm.prototype.qz=function(){for(var a=0,b=this.am,c=0;c<=this.ob;c++)a+=this.Jg[c],a+=this.bg[c];for(var a=a+this.ob*b,b=[],c=this.Dd*this.Gb,d=this.gI;0<=d;d--)270===this.na?0===d?b.push(new z(0,0,c,Math.abs(this.Lb[0]))):b.push(new z(0,this.Lb[d-1],c,Math.abs(this.Lb[d-1]-this.Lb[d]))):90===this.na?0===d?b.push(new z(0,this.Lb[0],c,Math.abs(this.Lb[0]-a))):b.push(new z(0,this.Lb[d],c,Math.abs(this.Lb[d-1]-this.Lb[d]))):180===this.na?0===d?b.push(new z(0,0,Math.abs(this.Lb[0]),c)):b.push(new z(this.Lb[d-
1],0,Math.abs(this.Lb[d-1]-this.Lb[d]),c)):0===d?b.push(new z(this.Lb[0],0,Math.abs(this.Lb[0]-a),c)):b.push(new z(this.Lb[d],0,Math.abs(this.Lb[d-1]-this.Lb[d]),c));this.commitLayers(b,K.fk)};hm.prototype.commitLayers=function(){};
hm.prototype.commitLinks=function(){for(var a=this.network.edges.i,b;a.next();)b=a.value.link,null!==b&&(b.Bl(),b.Jo(),b.Oi());for(a.reset();a.next();)b=a.value.link,null!==b&&b.updateRoute();for(a.reset();a.next();){var c=a.value;b=c.link;if(null!==b){b.Bl();var d=b,e=d.U,f=d.ba,h=d.$c,k=d.Bd;if(c.valid){if(b.Ge===nh&&4===b.ma){if(c.rev)var l=e,e=f,f=l,m=h,h=k,k=m;if(c.fromVertex.column===c.toVertex.column){var n=b.getLinkPoint(e,h,b.computeSpot(!0),!0,!1,f,k),p=b.getLinkPoint(f,k,b.computeSpot(!1),
!1,!1,e,h);n.H()||n.set(e.Z.Zk);p.H()||p.set(f.Z.Zk);b.Jo();b.Wk(n.x,n.y);b.Wk((2*n.x+p.x)/3,(2*n.y+p.y)/3);b.Wk((n.x+2*p.x)/3,(n.y+2*p.y)/3);b.Wk(p.x,p.y)}else{var q=!1,r=!1;null!==h&&b.computeSpot(!0)===xb&&(q=!0);null!==k&&b.computeSpot(!1)===xb&&(r=!0);if(q||r){var s=b.l(0).x,t=b.l(0).y,u=b.l(1).x,x=b.l(1).y,y=b.l(2).x,A=b.l(2).y,B=b.l(3).x,I=b.l(3).y;if(q){90===this.na||270===this.na?(u=s,x=(t+I)/2):(u=(s+B)/2,x=t);b.Y(1,u,x);var D=b.getLinkPoint(e,h,b.computeSpot(!0),!0,!1,f,k);D.H()||D.set(e.Z.Zk);
b.Y(0,D.x,D.y)}r&&(90===this.na||270===this.na?(y=B,A=(t+I)/2):(y=(s+B)/2,A=I),b.Y(2,y,A),D=b.getLinkPoint(f,k,b.computeSpot(!1),!1,!1,e,h),D.H()||D.set(f.Z.Zk),b.Y(3,D.x,D.y))}}}b.Oi()}else if(c.fromVertex.layer===c.toVertex.layer)b.Oi();else{var V=!1,ba=!1,U=0,N=b.at+1;if(b.hc)ba=!0,U=b.ma,4<U&&b.points.removeRange(2,U-3);else if(b.Ge===nh)V=!0,U=b.ma,4<U&&b.points.removeRange(2,U-3),N=2;else{var U=b.ma,Z=b.computeSpot(!0)===xb,Ga=b.computeSpot(!1)===xb;2<U&&Z&&Ga?b.points.removeRange(1,U-2):3<
U&&Z&&!Ga?b.points.removeRange(1,U-3):3<U&&!Z&&Ga?b.points.removeRange(2,U-2):4<U&&!Z&&!Ga&&b.points.removeRange(2,U-3)}var ta=c.fromVertex,Pa=c.toVertex,la,Ca;if(c.rev){for(var qa=0;null!==Pa&&ta!==Pa;){Ca=la=null;for(var cc=Pa.jc.i;cc.next();){var id=cc.value;if(id.link===c.link&&(la=id.fromVertex,Ca=id.toVertex,null===la.rd))break}la!==ta&&(Ta=b.l(N-1).x,fb=b.l(N-1).y,xa=la.oa,za=la.va,ba?180===this.na||0===this.na?2===N?(b.w(N++,Ta,fb),b.w(N++,Ta,za)):(jc=null!==Ca?Ca.va:fb,jc!==za&&(kb=this.Lb[la.layer-
1],b.w(N++,kb,fb),b.w(N++,kb,za))):2===N?(b.w(N++,Ta,fb),b.w(N++,xa,fb)):(ie=null!==Ca?Ca.oa:Ta,ie!==xa&&(kb=this.Lb[la.layer-1],b.w(N++,Ta,kb),b.w(N++,xa,kb))):2===N?V?(Hb=Math.max(10,this.Jg[Pa.layer]),ab=Math.max(10,this.bg[Pa.layer]),180===this.na?(qa=Pa.ca.x,b.w(N++,qa-Hb,za),b.w(N++,qa,za),b.w(N++,qa+ab,za)):90===this.na?(qa=Pa.ca.y+Pa.ca.height,b.w(N++,xa,qa+ab),b.w(N++,xa,qa),b.w(N++,xa,qa-Hb)):270===this.na?(qa=Pa.ca.y,b.w(N++,xa,qa-Hb),b.w(N++,xa,qa),b.w(N++,xa,qa+ab)):(qa=Pa.ca.x+Pa.ca.width,
b.w(N++,qa+ab,za),b.w(N++,qa,za),b.w(N++,qa-Hb,za))):(b.w(N++,Ta,fb),180===this.na||0===this.na?b.w(N++,Ta,za):b.w(N++,xa,fb),b.w(N++,xa,za)):(Hb=Math.max(10,this.Jg[la.layer]),ab=Math.max(10,this.bg[la.layer]),180===this.na?(V&&b.w(N++,xa-Hb,za),b.w(N++,xa,za),V&&b.w(N++,xa+ab,za)):90===this.na?(V&&b.w(N++,xa,za+ab),b.w(N++,xa,za),V&&b.w(N++,xa,za-Hb)):270===this.na?(V&&b.w(N++,xa,za-Hb),b.w(N++,xa,za),V&&b.w(N++,xa,za+ab)):(V&&b.w(N++,xa+ab,za),b.w(N++,xa,za),V&&b.w(N++,xa-Hb,za))));Pa=la}if(null===
k||b.computeSpot(!1)!==xb)if(Ta=b.l(N-1).x,fb=b.l(N-1).y,xa=b.l(N).x,za=b.l(N).y,ba){var Pf=this.bg[ta.layer],dc=0;180===this.na||0===this.na?(dc=fb,dc>=ta.ca.y&&dc<=ta.ca.bottom&&(qa=ta.oa+Pf,dc=dc<ta.ca.y+ta.ca.height/2?ta.ca.y-this.Dd/2:ta.ca.bottom+this.Dd/2,b.w(N++,qa,fb),b.w(N++,qa,dc)),b.w(N++,xa,dc)):(dc=Ta,dc>=ta.ca.x&&dc<=ta.ca.right&&(qa=ta.va+Pf,dc=dc<ta.ca.x+ta.ca.width/2?ta.ca.x-this.Dd/2:ta.ca.right+this.Dd/2,b.w(N++,Ta,qa),b.w(N++,dc,qa)),b.w(N++,dc,za));b.w(N++,xa,za)}else V?(Hb=
Math.max(10,this.Jg[ta.layer]),ab=Math.max(10,this.bg[ta.layer]),180===this.na?(qa=ta.ca.x+ta.ca.width,b.Y(N-2,qa,fb),b.Y(N-1,qa+ab,fb)):90===this.na?(qa=ta.ca.y,b.Y(N-2,Ta,qa),b.Y(N-1,Ta,qa-Hb)):270===this.na?(qa=ta.ca.y+ta.ca.height,b.Y(N-2,Ta,qa),b.Y(N-1,Ta,qa+ab)):(qa=ta.ca.x,b.Y(N-2,qa,fb),b.Y(N-1,qa-Hb,fb))):(180===this.na||0===this.na?b.w(N++,xa,fb):b.w(N++,Ta,za),b.w(N++,xa,za))}else{for(;null!==ta&&ta!==Pa;){Ca=la=null;for(var Ve=ta.Zb.i;Ve.next();){var Qf=Ve.value;if(Qf.link===c.link&&(la=
Qf.toVertex,Ca=Qf.fromVertex,null!==Ca.rd&&(Ca=null),null===la.rd))break}var Ta=0,fb=0,xa=0,za=0,kb=0,Hb=0,ab=0;if(la!==Pa)if(Ta=b.l(N-1).x,fb=b.l(N-1).y,xa=la.oa,za=la.va,ba)if(180===this.na||0===this.na){var jc=null!==Ca?Ca.va:fb;jc!==za&&(kb=this.Lb[la.layer],2===N&&(kb=0===this.na?Math.max(kb,Ta):Math.min(kb,Ta)),b.w(N++,kb,fb),b.w(N++,kb,za))}else{var ie=null!==Ca?Ca.oa:Ta;ie!==xa&&(kb=this.Lb[la.layer],2===N&&(kb=90===this.na?Math.max(kb,fb):Math.min(kb,fb)),b.w(N++,Ta,kb),b.w(N++,xa,kb))}else Hb=
Math.max(10,this.Jg[la.layer]),ab=Math.max(10,this.bg[la.layer]),180===this.na?(b.w(N++,xa+ab,za),V&&b.w(N++,xa,za),b.w(N++,xa-Hb,za)):90===this.na?(b.w(N++,xa,za-Hb),V&&b.w(N++,xa,za),b.w(N++,xa,za+ab)):270===this.na?(b.w(N++,xa,za+ab),V&&b.w(N++,xa,za),b.w(N++,xa,za-Hb)):(b.w(N++,xa-Hb,za),V&&b.w(N++,xa,za),b.w(N++,xa+ab,za));ta=la}ba&&(Ta=b.l(N-1).x,fb=b.l(N-1).y,xa=b.l(N).x,za=b.l(N).y,180===this.na||0===this.na?fb!==za&&(kb=0===this.na?Math.min(Math.max((xa+Ta)/2,this.Lb[Pa.layer]),xa):Math.max(Math.min((xa+
Ta)/2,this.Lb[Pa.layer]),xa),b.w(N++,kb,fb),b.w(N++,kb,za)):Ta!==xa&&(kb=90===this.na?Math.min(Math.max((za+fb)/2,this.Lb[Pa.layer]),za):Math.max(Math.min((za+fb)/2,this.Lb[Pa.layer]),za),b.w(N++,Ta,kb),b.w(N++,xa,kb)))}if(null!==d&&V){if(null!==h){if(b.computeSpot(!0)===xb){var qc=b.l(0),Rd=b.l(2);qc.L(Rd)||b.Y(1,(qc.x+Rd.x)/2,(qc.y+Rd.y)/2)}D=b.getLinkPoint(e,h,xb,!0,!1,f,k);D.H()||D.set(e.Z.Zk);b.Y(0,D.x,D.y)}null!==k&&(b.computeSpot(!1)===xb&&(qc=b.l(b.ma-1),Rd=b.l(b.ma-3),qc.L(Rd)||b.Y(b.ma-
2,(qc.x+Rd.x)/2,(qc.y+Rd.y)/2)),D=b.getLinkPoint(f,k,xb,!1,!1,e,h),D.H()||D.set(f.Z.Zk),b.Y(b.ma-1,D.x,D.y))}b.Oi();c.commit()}}}for(var je=new G(W),We=this.network.edges.i;We.next();){var qf=We.value.link;null!==qf&&qf.hc&&!je.contains(qf)&&je.add(qf)}if(0<je.count)if(90===this.na||270===this.na){for(var Sd=0,Ib=new G($q),Mb,Lc,Og=je.i;Og.next();){var Nb=Og.value;if(null!==Nb&&Nb.hc)for(var Bb=2;Bb<Nb.ma-3;Bb++)if(Mb=Nb.l(Bb),Lc=Nb.l(Bb+1),this.D(Mb.y,Lc.y)&&!this.D(Mb.x,Lc.x)){var ec=new $q;ec.layer=
Math.floor(Mb.y/2);var lb=Nb.l(0),Ae=Nb.l(Nb.ma-1);ec.first=lb.x*lb.x+lb.y;ec.Nd=Ae.x*Ae.x+Ae.y;ec.Ee=Math.min(Mb.x,Lc.x);ec.Vd=Math.max(Mb.x,Lc.x);ec.index=Bb;ec.link=Nb;if(Bb+2<Nb.ma){var Td=Nb.l(Bb-1),qg=Nb.l(Bb+2),Rf=0;Td.y<Mb.y?Rf=qg.y<Mb.y?3:Mb.x<Lc.x?2:1:Td.y>Mb.y&&(Rf=qg.y>Mb.y?0:Lc.x<Mb.x?2:1);ec.ai=Rf}Ib.add(ec)}}if(1<Ib.count){Ib.sort(this.gF);for(var Cb=0;Cb<Ib.count;){for(var jd=Ib.n[Cb].layer,rc=Cb+1;rc<Ib.count&&Ib.n[rc].layer===jd;)rc++;if(1<rc-Cb)for(var yb=Cb;yb<rc;){for(var Mc=
Ib.n[yb].Vd,Ob=Cb+1;Ob<rc&&Ib.n[Ob].Ee<Mc;)Mc=Math.max(Mc,Ib.n[Ob].Vd),Ob++;var Na=Ob-yb;if(1<Na){Ib.Fp(this.px,yb,yb+Na);for(var gb=1,Db=Ib.n[yb].Nd,Bb=yb;Bb<Ob;Bb++){var fc=Ib.n[Bb];fc.Nd!==Db&&(gb++,Db=fc.Nd)}Ib.Fp(this.fF,yb,yb+Na);for(var Ud=1,Db=Ib.n[yb].first,Bb=yb;Bb<Ob;Bb++)fc=Ib.n[Bb],fc.first!==Db&&(Ud++,Db=fc.first);var Vd=!0,rf=Ud;gb<Ud?(Vd=!1,rf=gb,Db=Ib.n[yb].Nd,Ib.Fp(this.px,yb,yb+Na)):Db=Ib.n[yb].first;for(var Be=0,Bb=yb;Bb<Ob;Bb++){fc=Ib.n[Bb];(Vd?fc.first:fc.Nd)!==Db&&(Be++,Db=
Vd?fc.first:fc.Nd);Nb=fc.link;Mb=Nb.l(fc.index);Lc=Nb.l(fc.index+1);var sf=this.BE*(Be-(rf-1)/2);Sd++;Nb.Bl();Nb.Y(fc.index,Mb.x,Mb.y+sf);Nb.Y(fc.index+1,Lc.x,Lc.y+sf);Nb.Oi()}}yb=Ob}Cb=rc}}}else{for(var Sb=0,db=new G($q),sc,Yc,kd=je.i;kd.next();){var bb=kd.value;if(null!==bb&&bb.hc)for(var vb=2;vb<bb.ma-3;vb++)if(sc=bb.l(vb),Yc=bb.l(vb+1),this.D(sc.x,Yc.x)&&!this.D(sc.y,Yc.y)){var kc=new $q;kc.layer=Math.floor(sc.x/2);var ld=bb.l(0),Pg=bb.l(bb.ma-1);kc.first=ld.x+ld.y*ld.y;kc.Nd=Pg.x+Pg.y*Pg.y;kc.Ee=
Math.min(sc.y,Yc.y);kc.Vd=Math.max(sc.y,Yc.y);kc.index=vb;kc.link=bb;if(vb+2<bb.ma){var Qg=bb.l(vb-1),Rg=bb.l(vb+2),Sf=0;Qg.x<sc.x?Sf=Rg.x<sc.x?3:sc.y<Yc.y?2:1:Qg.x>sc.x&&(Sf=Rg.x>sc.x?0:Yc.y<sc.y?2:1);kc.ai=Sf}db.add(kc)}}if(1<db.count){db.sort(this.gF);for(var Nc=0;Nc<db.count;){for(var Zc=db.n[Nc].layer,Oc=Nc+1;Oc<db.count&&db.n[Oc].layer===Zc;)Oc++;if(1<Oc-Nc)for(var mb=Nc;mb<Oc;){for(var ke=db.n[mb].Vd,nb=Nc+1;nb<Oc&&db.n[nb].Ee<ke;)ke=Math.max(ke,db.n[nb].Vd),nb++;var Ec=nb-mb;if(1<Ec){db.Fp(this.px,
mb,mb+Ec);for(var Ce=1,Eb=db.n[mb].Nd,vb=mb;vb<nb;vb++){var Fb=db.n[vb];Fb.Nd!==Eb&&(Ce++,Eb=Fb.Nd)}db.Fp(this.fF,mb,mb+Ec);for(var md=1,Eb=db.n[mb].first,vb=mb;vb<nb;vb++)Fb=db.n[vb],Fb.first!==Eb&&(md++,Eb=Fb.first);var $c=!0,Wd=md;Ce<md?($c=!1,Wd=Ce,Eb=db.n[mb].Nd,db.Fp(this.px,mb,mb+Ec)):Eb=db.n[mb].first;for(var Xd=0,vb=mb;vb<nb;vb++){Fb=db.n[vb];($c?Fb.first:Fb.Nd)!==Eb&&(Xd++,Eb=$c?Fb.first:Fb.Nd);bb=Fb.link;sc=bb.l(Fb.index);Yc=bb.l(Fb.index+1);var Xe=this.BE*(Xd-(Wd-1)/2);Sb++;bb.Bl();bb.Y(Fb.index,
sc.x+Xe,sc.y);bb.Y(Fb.index+1,Yc.x+Xe,Yc.y);bb.Oi()}}mb=nb}Nc=Oc}}}};hm.prototype.gF=function(a,b){return a instanceof $q&&b instanceof $q&&a!==b?a.layer<b.layer?-1:a.layer>b.layer?1:a.Ee<b.Ee?-1:a.Ee>b.Ee?1:a.Vd<b.Vd?-1:a.Vd>b.Vd?1:0:0};hm.prototype.fF=function(a,b){return a instanceof $q&&b instanceof $q&&a!==b?a.first<b.first?-1:a.first>b.first||a.ai<b.ai?1:a.ai>b.ai||a.Ee<b.Ee?-1:a.Ee>b.Ee?1:a.Vd<b.Vd?-1:a.Vd>b.Vd?1:0:0};
hm.prototype.px=function(a,b){return a instanceof $q&&b instanceof $q&&a!==b?a.Nd<b.Nd?-1:a.Nd>b.Nd||a.ai<b.ai?1:a.ai>b.ai||a.Ee<b.Ee?-1:a.Ee>b.Ee?1:a.Vd<b.Vd?-1:a.Vd>b.Vd?1:0:0};hm.prototype.D=function(a,b){var c=a-b;return-1<c&&1>c};function rq(a,b){var c,d=a.Pd[b];if(d>=a.Lg.length){c=[];for(var e=0;e<a.Lg.length;e++)c[e]=a.Lg[e];a.Lg=c}void 0===a.Lg[d]||null===a.Lg[d]?c=[]:(c=a.Lg[d],a.Lg[d]=null);d=a.vr[b];for(e=0;e<d.length;e++){var f=d[e];c[f.index]=f}return c}
function sq(a,b,c){a.Lg[a.Pd[b]]=c}v.defineProperty(hm,{layerSpacing:"layerSpacing"},function(){return this.am},function(a){this.am!==a&&(v.j(a,"number",hm,"layerSpacing"),0<=a&&(this.am=a,this.G()))});v.defineProperty(hm,{RJ:"columnSpacing"},function(){return this.Dd},function(a){this.Dd!==a&&(v.j(a,"number",hm,"columnSpacing"),0<=a&&(this.Dd=a,this.G()))});v.defineProperty(hm,{direction:"direction"},function(){return this.na},function(a){this.na!==a&&(v.j(a,"number",hm,"direction"),this.na=a,this.G())});
v.defineProperty(hm,{UG:"cycleRemoveOption"},function(){return this.yn},function(a){this.yn!==a&&(v.qb(a,hm,hm,"cycleRemoveOption"),a===kq||a===eq)&&(this.yn=a,this.G())});v.defineProperty(hm,{YH:"layeringOption"},function(){return this.ao},function(a){this.ao!==a&&(v.qb(a,hm,hm,"layeringOption"),a===fq||a===Cq||a===Eq)&&(this.ao=a,this.G())});
v.defineProperty(hm,{JH:"initializeOption"},function(){return this.Sn},function(a){this.Sn!==a&&(v.qb(a,hm,hm,"initializeOption"),a===gq||a===Kq||a===Iq)&&(this.Sn=a,this.G())});v.defineProperty(hm,{yK:"iterations"},function(){return this.Yl},function(a){this.Yl!==a&&(v.Te(a,jq,"iterations"),0<=a&&(this.Yl=a,this.G()))});v.defineProperty(hm,{wG:"aggressiveOption"},function(){return this.mn},function(a){this.mn!==a&&(v.qb(a,hm,hm,"aggressiveOption"),a===Oq||a===hq||a===Pq)&&(this.mn=a,this.G())});
v.defineProperty(hm,{YK:"packOption"},function(){return this.Bi},function(a){this.Bi!==a&&(v.j(a,"number",hm,"packOption"),0<=a&&8>a&&(this.Bi=a,this.G()))});v.defineProperty(hm,{Cp:"setsPortSpots"},function(){return this.Lh},function(a){this.Lh!==a&&(v.j(a,"boolean",hm,"setsPortSpots"),this.Lh=a,this.G())});v.defineProperty(hm,{BE:"linkSpacing"},function(){return this.cr},function(a){this.cr!==a&&(v.j(a,"number",hm,"linkSpacing"),0<=a&&(this.cr=a,this.G()))});v.u(hm,{gI:"maxLayer"},function(){return this.ob});
v.u(hm,{GK:"maxIndex"},function(){return this.kv});v.u(hm,{FK:"maxColumn"},function(){return this.Gb});v.u(hm,{MK:"minIndexLayer"},function(){return this.nr});v.u(hm,{HK:"maxIndexLayer"},function(){return this.Af});var eq;hm.CycleDepthFirst=eq=v.p(hm,"CycleDepthFirst",0);var kq;hm.CycleGreedy=kq=v.p(hm,"CycleGreedy",1);var fq;hm.LayerOptimalLinkLength=fq=v.p(hm,"LayerOptimalLinkLength",0);var Cq;hm.LayerLongestPathSink=Cq=v.p(hm,"LayerLongestPathSink",1);var Eq;
hm.LayerLongestPathSource=Eq=v.p(hm,"LayerLongestPathSource",2);var gq;hm.InitDepthFirstOut=gq=v.p(hm,"InitDepthFirstOut",0);var Kq;hm.InitDepthFirstIn=Kq=v.p(hm,"InitDepthFirstIn",1);var Iq;hm.InitNaive=Iq=v.p(hm,"InitNaive",2);var Oq;hm.AggressiveNone=Oq=v.p(hm,"AggressiveNone",0);var hq;hm.AggressiveLess=hq=v.p(hm,"AggressiveLess",1);var Pq;hm.AggressiveMore=Pq=v.p(hm,"AggressiveMore",2);hm.PackNone=0;var Qq;hm.PackExpand=Qq=1;var Rq;hm.PackStraighten=Rq=2;var Tq;hm.PackMedian=Tq=4;var iq;
hm.PackAll=iq=7;function $q(){this.index=this.Vd=this.Ee=this.Nd=this.first=this.layer=0;this.link=null;this.ai=0}v.Jd($q,{layer:!0,first:!0,Nd:!0,Ee:!0,Vd:!0,index:!0,link:!0,ai:!0});function jq(){wa.call(this)}v.Ga(jq,wa);v.ga("LayeredDigraphNetwork",jq);jq.prototype.createVertex=function(){return new ar};jq.prototype.createEdge=function(){return new br};
function ar(){ya.call(this);this.index=this.column=this.layer=-1;this.component=NaN;this.near=null;this.valid=!1;this.finish=this.Oo=NaN;this.Dm=0;this.fA=this.gA=null}v.Ga(ar,ya);v.ga("LayeredDigraphVertex",ar);function br(){Aa.call(this);this.forest=this.rev=this.valid=!1;this.portToPos=this.portFromPos=NaN;this.portToColOffset=this.portFromColOffset=0}v.Ga(br,Aa);v.ga("LayeredDigraphEdge",br);
function Y(){0<arguments.length&&v.dd(Y);Me.call(this);this.td=new H(Object);this.Er=cr;this.yf=dr;this.xs=er;this.iv=fr;this.cB=null;this.sh=!0;this.gd=gr;this.Wf=(new ia(10,10)).freeze();this.ta=new hr;this.sa=new hr;this.az=[]}v.Ga(Y,Me);v.ga("TreeLayout",Y);Y.prototype.cloneProtected=function(a){Me.prototype.cloneProtected.call(this,a);a.Er=this.Er;a.xs=this.xs;a.iv=this.iv;a.sh=this.sh;a.gd=this.gd;a.Wf.assign(this.Wf);a.ta.copyInheritedPropertiesFrom(this.ta);a.sa.copyInheritedPropertiesFrom(this.sa)};
Y.prototype.createNetwork=function(){return new ir};Y.prototype.makeNetwork=function(a){function b(a){if(a instanceof S)return!a.qf&&"Comment"!==a.Mc;if(a instanceof W){var b=a.U;if(null===b||b.qf||"Comment"===b.Mc)return!1;a=a.ba;return null===a||a.qf||"Comment"===a.Mc?!1:!0}return!1}var c=this.createNetwork();c.Pb=this;a instanceof E?(c.Oj(a.wg,!0,b),c.Oj(a.links,!0,b)):a instanceof T?c.Oj(a.Pc,!1,b):c.Oj(a.i,!1,b);return c};
Y.prototype.doLayout=function(a){null===a&&v.k("Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts");null===this.network&&(this.network=this.makeNetwork(a));this.Ff!==jr&&(this.Ud=this.initialOrigin(this.Ud));var b=this.g;null===b&&a instanceof E&&(b=a);this.yf=this.path===cr&&null!==b?b.Md?dr:kr:this.path===cr?dr:this.path;if(0<this.network.vertexes.count){this.network.yw();for(a=this.network.vertexes.i;a.next();)b=a.value,b.initialized=!1,b.level=
0,b.parent=null,b.children=[];if(0<this.td.count){a=new H(hr);for(b=this.td.i;b.next();){var c=b.value;c instanceof S?(c=this.network.Qm(c),null!==c&&a.add(c)):c instanceof hr&&a.add(c)}this.td=a}0===this.td.count&&this.findRoots();for(a=this.td.copy().i;a.next();)b=a.value,b.initialized||(b.initialized=!0,lr(this,b));for(a=this.td.i;a.next();)b=a.value,b instanceof hr&&mr(this,b);for(a=this.td.i;a.next();)b=a.value,b instanceof hr&&nr(this,b);for(a=this.td.i;a.next();)b=a.value,b instanceof hr&&
or(this,b);this.lz();if(this.Vz===pr){c=[];for(a=this.network.vertexes.i;a.next();){var d=a.value,b=d.parent;null===b&&(b=d);var b=0===b.angle||180===b.angle,e=c[d.level];void 0===e&&(e=0);c[d.level]=Math.max(e,b?d.width:d.height)}for(d=0;d<c.length;d++)void 0===c[d]&&(c[d]=0);this.cB=c;for(a=this.network.vertexes.i;a.next();)d=a.value,b=d.parent,null===b&&(b=d),0===b.angle||180===b.angle?(180===b.angle&&(d.bt+=c[d.level]-d.width),d.width=c[d.level]):(270===b.angle&&(d.ct+=c[d.level]-d.height),d.height=
c[d.level])}else if(this.Vz===qr)for(a=this.network.vertexes.i;a.next();){c=a.value;b=0===c.angle||180===c.angle;e=-1;for(d=0;d<c.children.length;d++)var f=c.children[d],e=Math.max(e,b?f.width:f.height);if(0<=e)for(d=0;d<c.children.length;d++)f=c.children[d],b?(180===c.angle&&(f.bt+=e-f.width),f.width=e):(270===c.angle&&(f.ct+=e-f.height),f.height=e)}for(a=this.td.i;a.next();)b=a.value,b instanceof hr&&this.layoutTree(b);this.arrangeTrees();this.updateParts()}this.network=null;this.td=new H(Object);
this.sf=!0};
Y.prototype.findRoots=function(){for(var a=this.network.vertexes.i;a.next();){var b=a.value;switch(this.yf){case dr:0===b.jc.count&&this.td.add(b);break;case kr:0===b.Zb.count&&this.td.add(b);break;default:v.k("Unhandled path value "+this.yf.toString())}}if(0===this.td.count){for(var a=999999,b=null,c=this.network.vertexes.i;c.next();){var d=c.value;switch(this.yf){case dr:d.jc.count<a&&(a=d.jc.count,b=d);break;case kr:d.Zb.count<a&&(a=d.Zb.count,b=d);break;default:v.k("Unhandled path value "+this.yf.toString())}}null!==
b&&this.td.add(b)}};
function lr(a,b){if(null!==b){switch(a.yf){case dr:if(0<b.Zb.count){for(var c=new G(hr),d=b.aH;d.next();){var e=d.value;rr(a,b,e)&&c.add(e)}0<c.count&&(b.children=c.ed())}break;case kr:if(0<b.jc.count){c=new G(hr);for(d=b.$I;d.next();)e=d.value,rr(a,b,e)&&c.add(e);0<c.count&&(b.children=c.ed())}break;default:v.k("Unhandled path value"+a.yf.toString())}c=b.children;d=c.length;for(e=0;e<d;e++){var f=c[e];f.initialized=!0;f.level=b.level+1;f.parent=b;a.td.remove(f)}for(e=0;e<d;e++)f=c[e],lr(a,f)}}
function rr(a,b,c){if(c.initialized){var d;if(null===b)d=!1;else{for(d=b.parent;null!==d&&d!==c;)d=d.parent;d=d===c}if(d||c.level>b.level)return!1;a.removeChild(c.parent,c)}return!0}Y.prototype.removeChild=function(a,b){if(null!==a&&null!==b){for(var c=a.children,d=0,e=0;e<c.length;e++)c[e]===b&&d++;if(0<d){for(var d=Array(c.length-d),f=0,e=0;e<c.length;e++)c[e]!==b&&(d[f++]=c[e]);a.children=d}}};
function mr(a,b){if(null!==b){a.initializeTreeVertexValues(b);b.alignment===sr&&a.sortTreeVertexChildren(b);for(var c=0,d=b.Fm,e=0,f=b.children,h=f.length,k=0;k<h;k++){var l=f[k];mr(a,l);c+=l.descendantCount+1;d=Math.max(d,l.maxChildrenCount);e=Math.max(e,l.maxGenerationCount)}b.descendantCount=c;b.maxChildrenCount=d;b.maxGenerationCount=0<d?e+1:0}}
function tr(a,b){switch(a.xs){default:case er:return null!==b.parent?b.parent:a.ta;case ur:return null===b.parent?a.ta:null===b.parent.parent?a.sa:b.parent;case vr:if(null!==b.parent)return null!==b.parent.parent?b.parent.parent:a.sa;case wr:var c=!0;if(0===b.Fm)c=!1;else for(var d=b.children,e=d.length,f=0;f<e;f++)if(0<d[f].Fm){c=!1;break}return c&&null!==b.parent?a.sa:null!==b.parent?b.parent:a.ta}}
Y.prototype.initializeTreeVertexValues=function(a){var b=tr(this,a);a.copyInheritedPropertiesFrom(b);if(null!==a.parent&&a.parent.alignment===sr){for(var b=a.angle,c=a.parent.children,d=0;d<c.length&&a!==c[d];)d++;0===d%2?d!==c.length-1&&(b=90===b?180:180===b?270:270===b?180:270):b=90===b?0:180===b?90:270===b?0:90;a.angle=b}a.initialized=!0};function nr(a,b){if(null!==b){a.assignTreeVertexValues(b);for(var c=b.children,d=c.length,e=0;e<d;e++)nr(a,c[e])}}Y.prototype.assignTreeVertexValues=function(){};
function or(a,b){if(null!==b){b.alignment!==sr&&a.sortTreeVertexChildren(b);for(var c=b.children,d=c.length,e=0;e<d;e++)or(a,c[e])}}Y.prototype.sortTreeVertexChildren=function(a){switch(a.sorting){case xr:break;case yr:a.children.reverse();break;case zr:a.children.sort(a.comparer);break;case Ar:a.children.sort(a.comparer);a.children.reverse();break;default:v.k("Unhandled sorting value "+a.sorting.toString())}};Y.prototype.lz=function(){if(this.comments)for(var a=this.network.vertexes.i;a.next();)this.addComments(a.value)};
Y.prototype.addComments=function(a){var b=a.angle,c=a.parent,d=0,e=Br,e=!1;null!==c&&(d=c.angle,e=c.alignment,e=Cr(e));var b=90===b||270===b,d=90===d||270===d,c=0===a.Fm,f=0,h=0,k=0,l=a.commentSpacing;if(null!==a.Dc)for(var m=a.Dc.ZD();m.next();){var n=m.value;"Comment"===n.Mc&&n.isVisible()&&(null===a.comments&&(a.comments=[]),a.comments.push(n),n.mf(),n=n.Ba,b&&!c||!e&&!d&&c||e&&d&&c?(f=Math.max(f,n.width),h+=n.height+Math.abs(k)):(f+=n.width+Math.abs(k),h=Math.max(h,n.height)),k=l)}null!==a.comments&&
(b&&!c||!e&&!d&&c||e&&d&&c?(f+=Math.abs(a.commentMargin),h=Math.max(0,h-a.height)):(h+=Math.abs(a.commentMargin),f=Math.max(0,f-a.width)),e=v.ek(0,0,a.ca.width+f,a.ca.height+h),a.pb=e,v.fc(e))};function Cr(a){return a===Dr||a===sr||a===Er||a===Fr}function Gr(a){return a===Dr||a===sr}function Hr(a){var b=a.parent;if(null!==b){var c=b.alignment;if(Cr(c)){if(Gr(c)){b=b.children;for(c=0;c<b.length&&a!==b[c];)c++;return 0===c%2}if(c===Er)return!0}}return!1}
Y.prototype.layoutComments=function(a){if(null!==a.comments){var b=a.Dc.Ba,c=a.parent,d=a.angle,e=0,f=Br,f=!1;null!==c&&(e=c.angle,f=c.alignment,f=Cr(f));for(var c=90===d||270===d,d=90===e||270===e,h=0===a.Fm,k=Hr(a),l=0,m=a.comments,n=m.length,p=v.M(),q=0;q<n;q++){var r=m[q],s=r.Ba;if(c&&!h||!f&&!d&&h||f&&d&&h){if(135<e&&!f||d&&k)if(0<=a.commentMargin)for(p.m(a.ca.x-a.commentMargin-s.width,a.ca.y+l),r.move(p),r=r.qg();r.next();){var t=r.value;t.Ab=Ac;t.Bb=Bc}else for(p.m(a.ca.x+2*a.N.x-a.commentMargin,
a.ca.y+l),r.move(p),r=r.qg();r.next();)t=r.value,t.Ab=Bc,t.Bb=Ac;else if(0<=a.commentMargin)for(p.m(a.ca.x+2*a.N.x+a.commentMargin,a.ca.y+l),r.move(p),r=r.qg();r.next();)t=r.value,t.Ab=Bc,t.Bb=Ac;else for(p.m(a.ca.x+a.commentMargin-s.width,a.ca.y+l),r.move(p),r=r.qg();r.next();)t=r.value,t.Ab=Ac,t.Bb=Bc;l=0<=a.commentSpacing?l+(s.height+a.commentSpacing):l+(a.commentSpacing-s.height)}else{if(135<e&&!f||!d&&k)if(0<=a.commentMargin)for(p.m(a.ca.x+l,a.ca.y-a.commentMargin-s.height),r.move(p),r=r.qg();r.next();)t=
r.value,t.Ab=zc,t.Bb=Cc;else for(p.m(a.ca.x+l,a.ca.y+2*a.N.y-a.commentMargin),r.move(p),r=r.qg();r.next();)t=r.value,t.Ab=Cc,t.Bb=zc;else if(0<=a.commentMargin)for(p.m(a.ca.x+l,a.ca.y+2*a.N.y+a.commentMargin),r.move(p),r=r.qg();r.next();)t=r.value,t.Ab=Cc,t.Bb=zc;else for(p.m(a.ca.x+l,a.ca.y+a.commentMargin-s.height),r.move(p),r=r.qg();r.next();)t=r.value,t.Ab=zc,t.Bb=Cc;l=0<=a.commentSpacing?l+(s.width+a.commentSpacing):l+(a.commentSpacing-s.width)}}v.v(p);b=l-a.commentSpacing-(c?b.height:b.width);
if(this.yf===dr)for(e=a.Zb;e.next();)a=e.value.link,null===a||a.pl||(a.il=0<b?b:NaN);else for(e=a.jc;e.next();)a=e.value.link,null===a||a.pl||(a.Fl=0<b?b:NaN)}};
Y.prototype.layoutTree=function(a){if(null!==a){for(var b=a.children,c=b.length,d=0;d<c;d++)this.layoutTree(b[d]);switch(a.compaction){case Ir:Jr(this,a);break;case Kr:if(a.alignment===sr)Jr(this,a);else if(0===a.Fm){var d=a.parent,b=!1,c=0,e=Br;null!==d&&(c=d.angle,e=d.alignment,b=Cr(e));d=Hr(a);a.ka.m(0,0);a.eb.m(a.width,a.height);null===a.parent||null===a.comments||(180!==c&&270!==c||b)&&!d?a.La.m(0,0):180===c&&!b||(90===c||270===c)&&d?a.La.m(a.width-2*a.N.x,0):a.La.m(0,a.height-2*a.N.y);a.rt=
null;a.Mt=null}else{for(var f=Lr(a),b=90===f||270===f,h=0,k=a.children,l=k.length,m=0;m<l;m++)var n=k[m],h=Math.max(h,b?n.eb.width:n.eb.height);var p=a.alignment,d=p===Mr,q=p===Nr,r=Cr(p),s=Math.max(0,a.breadthLimit),c=Or(a),t=a.nodeSpacing,u=Pr(a),x=a.rowSpacing,y=0;if(d||q||a.xp||a.yp&&1===a.maxGenerationCount)y=Math.max(0,a.rowIndent);var d=a.width,e=a.height,A=0,B=0,I=0,D=null,V=null,ba=0,U=0,N=0,Z=0,Ga=0,ta=0,Pa=0,la=0,n=0;r&&!Gr(p)&&135<f&&k.reverse();if(Gr(p))if(1<l)for(m=0;m<l;m++)0===m%2&&
m!==l-1?la=Math.max(la,b?k[m].eb.width:k[m].eb.height):0!==m%2&&(n=Math.max(n,b?k[m].eb.width:k[m].eb.height));else 1===l&&(la=b?k[0].eb.width:k[0].eb.height);if(r){switch(p){case Dr:U=135>f?Qr(a,k,la,A,B):Rr(a,k,la,A,B);la=U.x;A=U.width;B=U.height;break;case Er:for(m=0;m<l;m++){var n=k[m],Ca=n.eb,D=0===ta?0:x;b?(n.ka.m(h-Ca.width,Z+D),A=Math.max(A,Ca.width),B=Math.max(B,Z+D+Ca.height),Z+=D+Ca.height):(n.ka.m(N+D,h-Ca.height),A=Math.max(A,N+D+Ca.width),B=Math.max(B,Ca.height),N+=D+Ca.width);ta++}break;
case Fr:for(m=0;m<l;m++)n=k[m],Ca=n.eb,D=0===ta?0:x,b?(n.ka.m(t/2+a.N.x,Z+D),A=Math.max(A,Ca.width),B=Math.max(B,Z+D+Ca.height),Z+=D+Ca.height):(n.ka.m(N+D,t/2+a.N.y),A=Math.max(A,N+D+Ca.width),B=Math.max(B,Ca.height),N+=D+Ca.width),ta++}D=Sr(this,2);V=Sr(this,2);b?(D[0].m(0,0),D[1].m(0,B),V[0].m(A,0)):(D[0].m(0,0),D[1].m(A,0),V[0].m(0,B));V[1].m(A,B)}else for(m=0;m<l;m++){n=k[m];Ca=n.eb;if(b){0<s&&0<ta&&N+t+Ca.width>s&&(N<h&&Yr(a,p,h-N,0,Pa,m-1),Ga++,ta=0,Pa=m,I=B,N=0,Z=135<f?-B-x:B+x);Zr(this,n,
0,Z);var qa=0;if(0===ta){if(D=n.rt,V=n.Mt,ba=Ca.width,U=Ca.height,null===D||null===V||f!==Lr(n))D=Sr(this,2),V=Sr(this,2),D[0].m(0,0),D[1].m(0,U),V[0].m(ba,0),V[1].m(ba,U)}else{var cc=v.jb(),U=$r(this,a,n,D,V,ba,U,cc),qa=U.x,D=cc[0],V=cc[1],ba=U.width,U=U.height;v.ra(cc);N<Ca.width&&0>qa&&(as(a,-qa,0,Pa,m-1),bs(D,-qa,0),bs(V,-qa,0),qa=0)}n.ka.m(qa,Z);A=Math.max(A,ba);B=Math.max(B,I+(0===Ga?0:x)+Ca.height);N=ba}else{0<s&&0<ta&&Z+t+Ca.height>s&&(Z<h&&Yr(a,p,0,h-Z,Pa,m-1),Ga++,ta=0,Pa=m,I=A,Z=0,N=135<
f?-A-x:A+x);Zr(this,n,N,0);qa=0;if(0===ta){if(D=n.rt,V=n.Mt,ba=Ca.width,U=Ca.height,null===D||null===V||f!==Lr(n))D=Sr(this,2),V=Sr(this,2),D[0].m(0,0),D[1].m(ba,0),V[0].m(0,U),V[1].m(ba,U)}else cc=v.jb(),U=$r(this,a,n,D,V,ba,U,cc),qa=U.x,D=cc[0],V=cc[1],ba=U.width,U=U.height,v.ra(cc),Z<Ca.height&&0>qa&&(as(a,0,-qa,Pa,m-1),bs(D,0,-qa),bs(V,0,-qa),qa=0);n.ka.m(N,qa);B=Math.max(B,U);A=Math.max(A,I+(0===Ga?0:x)+Ca.width);Z=U}ta++}0<Ga&&(b?(B+=Math.max(0,c),N<A&&Yr(a,p,A-N,0,Pa,l-1),0<y&&(q||as(a,y,0,
0,l-1),A+=y)):(A+=Math.max(0,c),Z<B&&Yr(a,p,0,B-Z,Pa,l-1),0<y&&(q||as(a,0,y,0,l-1),B+=y)));q=h=0;switch(p){case cs:b?h+=A/2-a.N.x-u/2:q+=B/2-a.N.y-u/2;break;case Br:0<Ga?b?h+=A/2-a.N.x-u/2:q+=B/2-a.N.y-u/2:b?(m=k[0].ka.x+k[0].La.x,la=k[l-1].ka.x+k[l-1].La.x+2*k[l-1].N.x,h+=m+(la-m)/2-a.N.x-u/2):(m=k[0].ka.y+k[0].La.y,la=k[l-1].ka.y+k[l-1].La.y+2*k[l-1].N.y,q+=m+(la-m)/2-a.N.y-u/2);break;case Mr:b?(h-=u,A+=u):(q-=u,B+=u);break;case Nr:b?(h+=A-a.width+u,A+=u):(q+=B-a.height+u,B+=u);break;case Dr:b?
h=1<l?h+(la+t/2-a.N.x):h+(k[0].N.x-a.N.x+k[0].La.x):q=1<l?q+(la+t/2-a.N.y):q+(k[0].N.y-a.N.y+k[0].La.y);break;case Er:b?h+=A+t/2-a.N.x:q+=B+t/2-a.N.y;break;case Fr:break;default:v.k("Unhandled alignment value "+p.toString())}for(m=0;m<l;m++)n=k[m],b?n.ka.m(n.ka.x+n.La.x-h,n.ka.y+(135<f?(r?-B:-n.eb.height)+n.La.y-c:e+c+n.La.y)):n.ka.m(n.ka.x+(135<f?(r?-A:-n.eb.width)+n.La.x-c:d+c+n.La.x),n.ka.y+n.La.y-q);l=k=0;r?b?(A=ds(a,A,h),0>h&&(h=0),135<f&&(q+=B+c),B+=e+c,p===Fr&&(k+=t/2+a.N.x),l+=e+c):(135<f&&
(h+=A+c),A+=d+c,B=es(a,B,q),0>q&&(q=0),p===Fr&&(l+=t/2+a.N.y),k+=d+c):b?(null===a.comments?d>A&&(p=fs(p,d-A,0),k=p.x,l=p.y,A=d,h=0):A=ds(a,A,h),0>h&&(k-=h,h=0),135<f&&(q+=B+c),B=Math.max(Math.max(B,e),B+e+c),l+=e+c):(135<f&&(h+=A+c),A=Math.max(Math.max(A,d),A+d+c),null===a.comments?e>B&&(p=fs(p,0,e-B),k=p.x,l=p.y,B=e,q=0):B=es(a,B,q),0>q&&(l-=q,q=0),k+=d+c);if(0<Ga)f=Sr(this,4),p=Sr(this,4),b?(f[2].m(0,e+c),f[3].m(f[2].x,B),p[2].m(A,f[2].y),p[3].m(p[2].x,f[3].y)):(f[2].m(d+c,0),f[3].m(A,f[2].y),p[2].m(f[2].x,
B),p[3].m(f[3].x,p[2].y));else{f=Sr(this,D.length+2);p=Sr(this,V.length+2);for(m=0;m<D.length;m++)r=D[m],f[m+2].m(r.x+k,r.y+l);for(m=0;m<V.length;m++)r=V[m],p[m+2].m(r.x+k,r.y+l)}b?(f[0].m(h,0),f[1].m(f[0].x,e),f[2].y<f[1].y&&(f[2].x>f[0].x?f[2].assign(f[1]):f[1].assign(f[2])),f[3].y<f[2].y&&(f[3].x>f[0].x?f[3].assign(f[2]):f[2].assign(f[3])),p[0].m(h+d,0),p[1].m(p[0].x,e),p[2].y<p[1].y&&(p[2].x<p[0].x?p[2].assign(p[1]):p[1].assign(p[2])),p[3].y<p[2].y&&(p[3].x<p[0].x?p[3].assign(p[2]):p[2].assign(p[3])),
f[2].y-=c/2,p[2].y-=c/2):(f[0].m(0,q),f[1].m(d,f[0].y),f[2].x<f[1].x&&(f[2].y>f[0].y?f[2].assign(f[1]):f[1].assign(f[2])),f[3].x<f[2].x&&(f[3].y>f[0].y?f[3].assign(f[2]):f[2].assign(f[3])),p[0].m(0,q+e),p[1].m(d,p[0].y),p[2].x<p[1].x&&(p[2].y<p[0].y?p[2].assign(p[1]):p[1].assign(p[2])),p[3].x<p[2].x&&(p[3].y<p[0].y?p[3].assign(p[2]):p[2].assign(p[3])),f[2].x-=c/2,p[2].x-=c/2);gs(this,D);gs(this,V);a.rt=f;a.Mt=p;a.La.m(h,q);a.eb.m(A,B)}break;default:v.k("Unhandled compaction value "+a.compaction.toString())}}};
function Jr(a,b){if(0===b.Fm){var c=!1,d=0,e=Br;null!==b.parent&&(d=b.parent.angle,e=b.parent.alignment,c=Cr(e));e=Hr(b);b.ka.m(0,0);b.eb.m(b.width,b.height);null===b.parent||null===b.comments||(180!==d&&270!==d||c)&&!e?b.La.m(0,0):180===d&&!c||(90===d||270===d)&&e?b.La.m(b.width-2*b.N.x,0):b.La.m(0,b.height-2*b.N.y)}else{for(var c=Lr(b),d=90===c||270===c,f=0,e=b.children,h=e.length,k=0;k<h;k++)var l=e[k],f=Math.max(f,d?l.eb.width:l.eb.height);var m=b.alignment,n=m===Mr,p=m===Nr,q=Cr(m),r=Math.max(0,
b.breadthLimit),s=Or(b),t=b.nodeSpacing,u=Pr(b),x=n||p?0:u/2,y=b.rowSpacing,A=0;if(n||p||b.xp||b.yp&&1===b.maxGenerationCount)A=Math.max(0,b.rowIndent);var n=b.width,B=b.height,I=0,D=0,V=0,ba=0,U=0,N=0,Z=0,Ga=0,ta=0,Pa=0;q&&!Gr(m)&&135<c&&e.reverse();if(Gr(m))if(1<h)for(k=0;k<h;k++){var l=e[k],la=l.eb;0===k%2&&k!==h-1?ta=Math.max(ta,(d?la.width:la.height)+hs(l)-t):0!==k%2&&(Pa=Math.max(Pa,(d?la.width:la.height)+hs(l)-t))}else 1===h&&(ta=d?e[0].eb.width:e[0].eb.height);if(q)switch(m){case Dr:case sr:D=
135>c?Qr(b,e,ta,I,D):Rr(b,e,ta,I,D);ta=D.x;I=D.width;D=D.height;break;case Er:for(k=0;k<h;k++)l=e[k],la=l.eb,r=0===Z?0:y,d?(l.ka.m(f-la.width,U+r),I=Math.max(I,la.width),D=Math.max(D,U+r+la.height),U+=r+la.height):(l.ka.m(ba+r,f-la.height),I=Math.max(I,ba+r+la.width),D=Math.max(D,la.height),ba+=r+la.width),Z++;break;case Fr:for(f=0;f<h;f++)l=e[f],la=l.eb,r=0===Z?0:y,d?(l.ka.m(t/2+b.N.x,U+r),I=Math.max(I,la.width),D=Math.max(D,U+r+la.height),U+=r+la.height):(l.ka.m(ba+r,t/2+b.N.y),I=Math.max(I,ba+
r+la.width),D=Math.max(D,la.height),ba+=r+la.width),Z++}else for(k=0;k<h;k++)l=e[k],la=l.eb,d?(0<r&&0<Z&&ba+t+la.width>r&&(ba<f&&Yr(b,m,f-ba,0,Ga,k-1),N++,Z=0,Ga=k,V=D,ba=0,U=135<c?-D-y:D+y),Pa=0===Z?x:t,Zr(a,l,0,U),l.ka.m(ba+Pa,U),I=Math.max(I,ba+Pa+la.width),D=Math.max(D,V+(0===N?0:y)+la.height),ba+=Pa+la.width):(0<r&&0<Z&&U+t+la.height>r&&(U<f&&Yr(b,m,0,f-U,Ga,k-1),N++,Z=0,Ga=k,V=I,U=0,ba=135<c?-I-y:I+y),Pa=0===Z?x:t,Zr(a,l,ba,0),l.ka.m(ba,U+Pa),D=Math.max(D,U+Pa+la.height),I=Math.max(I,V+(0===
N?0:y)+la.width),U+=Pa+la.height),Z++;0<N&&(d?(D+=Math.max(0,s),ba<I&&Yr(b,m,I-ba,0,Ga,h-1),0<A&&(p||as(b,A,0,0,h-1),I+=A)):(I+=Math.max(0,s),U<D&&Yr(b,m,0,D-U,Ga,h-1),0<A&&(p||as(b,0,A,0,h-1),D+=A)));A=p=0;switch(m){case cs:d?p+=I/2-b.N.x-u/2:A+=D/2-b.N.y-u/2;break;case Br:0<N?d?p+=I/2-b.N.x-u/2:A+=D/2-b.N.y-u/2:d?(m=e[0].ka.x+e[0].La.x,t=e[h-1].ka.x+e[h-1].La.x+2*e[h-1].N.x,p+=m+(t-m)/2-b.N.x-u/2):(m=e[0].ka.y+e[0].La.y,t=e[h-1].ka.y+e[h-1].La.y+2*e[h-1].N.y,A+=m+(t-m)/2-b.N.y-u/2);break;case Mr:d?
(p-=u,I+=u):(A-=u,D+=u);break;case Nr:d?(p+=I-b.width+u,I+=u):(A+=D-b.height+u,D+=u);break;case Dr:case sr:d?p=1<h?p+(ta+t/2-b.N.x):p+(e[0].N.x-b.N.x+e[0].La.x):A=1<h?A+(ta+t/2-b.N.y):A+(e[0].N.y-b.N.y+e[0].La.y);break;case Er:d?p+=I+t/2-b.N.x:A+=D+t/2-b.N.y;break;case Fr:break;default:v.k("Unhandled alignment value "+m.toString())}for(k=0;k<h;k++)l=e[k],d?l.ka.m(l.ka.x+l.La.x-p,l.ka.y+(135<c?(q?-D:-l.eb.height)+l.La.y-s:B+s+l.La.y)):l.ka.m(l.ka.x+(135<c?(q?-I:-l.eb.width)+l.La.x-s:n+s+l.La.x),l.ka.y+
l.La.y-A);d?(I=ds(b,I,p),0>p&&(p=0),135<c&&(A+=D+s),D+=B+s):(135<c&&(p+=I+s),I+=n+s,D=es(b,D,A),0>A&&(A=0));b.La.m(p,A);b.eb.m(I,D)}}
function Qr(a,b,c,d,e){var f=b.length;if(0===f)return new z(c,0,d,e);if(1===f){var h=b[0];d=h.eb.width;e=h.eb.height;return new z(c,0,d,e)}for(var k=a.nodeSpacing,l=a.rowSpacing,m=90===Lr(a),n=0,p=0,q=0,r=0;r<f;r++)if(!(0!==r%2||1<f&&r===f-1)){var h=b[r],s=h.eb,t=0===n?0:l;if(m){var u=hs(h)-k;h.ka.m(c-(s.width+u),q+t);d=Math.max(d,s.width+u);e=Math.max(e,q+t+s.height);q+=t+s.height}else u=hs(h)-k,h.ka.m(p+t,c-(s.height+u)),e=Math.max(e,s.height+u),d=Math.max(d,p+t+s.width),p+=t+s.width;n++}var n=
0,x=p,y=q;m?(p=c+k,q=0):(p=0,q=c+k);for(r=0;r<f;r++)0!==r%2&&(h=b[r],s=h.eb,t=0===n?0:l,m?(u=hs(h)-k,h.ka.m(p+u,q+t),d=Math.max(d,p+s.width+u),e=Math.max(e,q+t+s.height),q+=t+s.height):(u=hs(h)-k,h.ka.m(p+t,q+u),d=Math.max(d,p+t+s.width),e=Math.max(e,q+s.height+u),p+=t+s.width),n++);1<f&&1===f%2&&(h=b[f-1],s=h.eb,b=is(h,m?Math.max(Math.abs(y),Math.abs(q)):Math.max(Math.abs(x),Math.abs(p))),m?(h.ka.m(c+k/2-h.N.x-h.La.x,e+b),m=c+k/2-h.N.x-h.La.x,d=Math.max(d,m+s.width),0>m&&(d-=m),e=Math.max(e,Math.max(y,
q)+b+s.height),0>h.ka.x&&(c=js(a,h.ka.x,!1,c,k))):(h.ka.m(d+b,c+k/2-h.N.y-h.La.y),d=Math.max(d,Math.max(x,p)+b+s.width),m=c+k/2-h.N.y-h.La.y,e=Math.max(e,m+s.height),0>m&&(e-=m),0>h.ka.y&&(c=js(a,h.ka.y,!0,c,k))));return new z(c,0,d,e)}
function Rr(a,b,c,d,e){var f=b.length;if(0===f)return new z(c,0,d,e);if(1===f){var h=b[0];d=h.eb.width;e=h.eb.height;return new z(c,0,d,e)}for(var k=a.nodeSpacing,l=a.rowSpacing,m=270===Lr(a),n=0,p=0,q=0,r=0;r<f;r++)if(!(0!==r%2||1<f&&r===f-1)){var h=b[r],s=h.eb,t=0===n?0:l;if(m){var u=hs(h)-k,q=q-(t+s.height);h.ka.m(c-(s.width+u),q);d=Math.max(d,s.width+u);e=Math.max(e,Math.abs(q))}else u=hs(h)-k,p-=t+s.width,h.ka.m(p,c-(s.height+u)),e=Math.max(e,s.height+u),d=Math.max(d,Math.abs(p));n++}var n=0,
x=p,y=q;m?(p=c+k,q=0):(p=0,q=c+k);for(r=0;r<f;r++)0!==r%2&&(h=b[r],s=h.eb,t=0===n?0:l,m?(u=hs(h)-k,q-=t+s.height,h.ka.m(p+u,q),d=Math.max(d,p+s.width+u),e=Math.max(e,Math.abs(q))):(u=hs(h)-k,p-=t+s.width,h.ka.m(p,q+u),e=Math.max(e,q+s.height+u),d=Math.max(d,Math.abs(p))),n++);1<f&&1===f%2&&(h=b[f-1],s=h.eb,l=is(h,m?Math.max(Math.abs(y),Math.abs(q)):Math.max(Math.abs(x),Math.abs(p))),m?(h.ka.m(c+k/2-h.N.x-h.La.x,-e-s.height-l),p=c+k/2-h.N.x-h.La.x,d=Math.max(d,p+s.width),0>p&&(d-=p),e=Math.max(e,Math.abs(Math.min(y,
q))+l+s.height),0>h.ka.x&&(c=js(a,h.ka.x,!1,c,k))):(h.ka.m(-d-s.width-l,c+k/2-h.N.y-h.La.y),d=Math.max(d,Math.abs(Math.min(x,p))+l+s.width),p=c+k/2-h.N.y-h.La.y,e=Math.max(e,p+s.height),0>p&&(e-=p),0>h.ka.y&&(c=js(a,h.ka.y,!0,c,k))));for(r=0;r<f;r++)h=b[r],m?h.ka.m(h.ka.x,h.ka.y+e):h.ka.m(h.ka.x+d,h.ka.y);return new z(c,0,d,e)}function hs(a){return null===a.parent?0:a.parent.nodeSpacing}function is(a){return null===a.parent?0:a.parent.rowSpacing}
function js(a,b,c,d,e){a=a.children;for(var f=a.length,h=0;h<f;h++)c?a[h].ka.m(a[h].ka.x,a[h].ka.y-b):a[h].ka.m(a[h].ka.x-b,a[h].ka.y);b=a[f-1];return Math.max(d,c?b.La.y+b.N.y-e/2:b.La.x+b.N.x-e/2)}
function ds(a,b,c){switch(a.alignment){case Br:case cs:var d=b;c+a.width>d&&(d=c+a.width);0>c&&(d-=c);return d;case Mr:return a.width>b?a.width:b;case Nr:return 2*a.N.x>b?a.width:b+a.width-2*a.N.x;case Dr:case sr:return d=Math.min(0,c),c=Math.max(b,c+a.width),Math.max(a.width,c-d);case Er:return a.width-a.N.x+a.nodeSpacing/2+b;case Fr:return Math.max(a.width,a.N.x+a.nodeSpacing/2+b);default:return b}}
function es(a,b,c){switch(a.alignment){case Br:case cs:var d=b;c+a.height>d&&(d=c+a.height);0>c&&(d-=c);return d;case Mr:return a.height>b?a.height:b;case Nr:return 2*a.N.y>b?a.height:b+a.height-2*a.N.y;case Dr:case sr:return d=Math.min(0,c),c=Math.max(b,c+a.height),Math.max(a.height,c-d);case Er:return a.height-a.N.y+a.nodeSpacing/2+b;case Fr:return Math.max(a.height,a.N.y+a.nodeSpacing/2+b);default:return b}}
function fs(a,b,c){switch(a){case cs:b/=2;c/=2;break;case Br:b/=2;c/=2;break;case Mr:c=b=0;break;case Nr:break;default:v.k("Unhandled alignment value "+a.toString())}return new w(b,c)}function Yr(a,b,c,d,e,f){b=fs(b,c,d);as(a,b.x,b.y,e,f)}function as(a,b,c,d,e){if(0!==b||0!==c)for(a=a.children;d<=e;d++){var f=a[d].ka;f.x+=b;f.y+=c}}
function Zr(a,b,c,d){var e=b.parent;switch(a.yf){case dr:for(a=b.jc;a.next();)b=a.value,b.fromVertex===e&&b.Lr.m(c,d);break;case kr:for(a=b.Zb;a.next();)b=a.value,b.toVertex===e&&b.Lr.m(c,d);break;default:v.k("Unhandled path value "+a.yf.toString())}}function bs(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];e.x+=b;e.y+=c}}
function $r(a,b,c,d,e,f,h,k){var l=Lr(b),m=90===l||270===l,n=b.nodeSpacing;b=d;var p=e;d=f;e=h;var q=c.rt,r=c.Mt;h=c.eb;var s=m?Math.max(e,h.height):Math.max(d,h.width);if(null===q||l!==Lr(c))q=Sr(a,2),r=Sr(a,2),m?(q[0].m(0,0),q[1].m(0,h.height),r[0].m(h.width,0),r[1].m(r[0].x,q[1].y)):(q[0].m(0,0),q[1].m(h.width,0),r[0].m(0,h.height),r[1].m(q[1].x,r[0].y));if(m){c=d;d=9999999;if(!(null===p||2>p.length||null===q||2>q.length))for(m=l=0;l<p.length&&m<q.length;){e=p[l];var t=q[m];f=t.x;var u=t.y;f+=
c;var x=e;l+1<p.length&&(x=p[l+1]);var y=t,t=y.x,y=y.y;m+1<q.length&&(y=q[m+1],t=y.x,y=y.y,t+=c);var A=d;e.y===u?A=f-e.x:e.y>u&&e.y<y?A=f+(e.y-u)/(y-u)*(t-f)-e.x:u>e.y&&u<x.y&&(A=f-(e.x+(u-e.y)/(x.y-e.y)*(x.x-e.x)));A<d&&(d=A);x.y<=e.y?l++:y<=u?m++:(x.y<=y&&l++,y<=x.y&&m++)}c-=d;c+=n;l=q;m=c;if(null===b||2>b.length||null===l||2>l.length)d=null;else{n=Sr(a,b.length+l.length);for(d=f=e=0;f<l.length&&l[f].y<b[0].y;)u=l[f++],n[d++].m(u.x+m,u.y);for(;e<b.length;)u=b[e++],n[d++].m(u.x,u.y);for(e=b[b.length-
1].y;f<l.length&&l[f].y<=e;)f++;for(;f<l.length&&l[f].y>e;)u=l[f++],n[d++].m(u.x+m,u.y);l=Sr(a,d);for(e=0;e<d;e++)l[e].assign(n[e]);gs(a,n);d=l}f=r;u=c;if(null===p||2>p.length||null===f||2>f.length)e=null;else{n=Sr(a,p.length+f.length);for(m=x=l=0;l<p.length&&p[l].y<f[0].y;)e=p[l++],n[m++].m(e.x,e.y);for(;x<f.length;)e=f[x++],n[m++].m(e.x+u,e.y);for(f=f[f.length-1].y;l<p.length&&p[l].y<=f;)l++;for(;l<p.length&&p[l].y>f;)e=p[l++],n[m++].m(e.x,e.y);e=Sr(a,m);for(l=0;l<m;l++)e[l].assign(n[l]);gs(a,n)}f=
Math.max(0,c)+h.width;h=s}else{c=e;d=9999999;if(!(null===p||2>p.length||null===q||2>q.length))for(m=l=0;l<p.length&&m<q.length;)e=p[l],t=q[m],f=t.x,u=t.y,u+=c,x=e,l+1<p.length&&(x=p[l+1]),y=t,t=y.x,y=y.y,m+1<q.length&&(y=q[m+1],t=y.x,y=y.y,y+=c),A=d,e.x===f?A=u-e.y:e.x>f&&e.x<t?A=u+(e.x-f)/(t-f)*(y-u)-e.y:f>e.x&&f<x.x&&(A=u-(e.y+(f-e.x)/(x.x-e.x)*(x.y-e.y))),A<d&&(d=A),x.x<=e.x?l++:t<=f?m++:(x.x<=t&&l++,t<=x.x&&m++);c-=d;c+=n;l=q;m=c;if(null===b||2>b.length||null===l||2>l.length)d=null;else{n=Sr(a,
b.length+l.length);for(d=f=e=0;f<l.length&&l[f].x<b[0].x;)u=l[f++],n[d++].m(u.x,u.y+m);for(;e<b.length;)u=b[e++],n[d++].m(u.x,u.y);for(e=b[b.length-1].x;f<l.length&&l[f].x<=e;)f++;for(;f<l.length&&l[f].x>e;)u=l[f++],n[d++].m(u.x,u.y+m);l=Sr(a,d);for(e=0;e<d;e++)l[e].assign(n[e]);gs(a,n);d=l}f=r;u=c;if(null===p||2>p.length||null===f||2>f.length)e=null;else{n=Sr(a,p.length+f.length);for(m=x=l=0;l<p.length&&p[l].x<f[0].x;)e=p[l++],n[m++].m(e.x,e.y);for(;x<f.length;)e=f[x++],n[m++].m(e.x,e.y+u);for(f=
f[f.length-1].x;l<p.length&&p[l].x<=f;)l++;for(;l<p.length&&p[l].x>f;)e=p[l++],n[m++].m(e.x,e.y);e=Sr(a,m);for(l=0;l<m;l++)e[l].assign(n[l]);gs(a,n)}f=s;h=Math.max(0,c)+h.height}gs(a,b);gs(a,q);gs(a,p);gs(a,r);k[0]=d;k[1]=e;return new z(c,0,f,h)}function Sr(a,b){var c=a.az[b];if(void 0!==c&&(c=c.pop(),void 0!==c))return c;for(var c=[],d=0;d<b;d++)c[d]=new w;return c}function gs(a,b){var c=b.length,d=a.az[c];void 0===d&&(d=[],a.az[c]=d);d.push(b)}
Y.prototype.arrangeTrees=function(){if(this.gd===jr)for(var a=this.td.i;a.next();){var b=a.value;if(b instanceof hr){var c=b.Dc;if(null!==c){var d=c.position,c=d.x,d=d.y;isFinite(c)||(c=0);isFinite(d)||(d=0);ks(this,b,c,d)}}}else{c=[];for(a=this.td.i;a.next();)b=a.value,b instanceof hr&&c.push(b);switch(this.sorting){case xr:break;case yr:c.reverse();break;case zr:c.sort(this.comparer);break;case Ar:c.sort(this.comparer);c.reverse();break;default:v.k("Unhandled sorting value "+this.sorting.toString())}b=
this.Ud;a=b.x;b=b.y;for(d=0;d<c.length;d++){var e=c[d];ks(this,e,a+e.La.x,b+e.La.y);switch(this.gd){case gr:b+=e.eb.height+this.Wf.height;break;case ls:a+=e.eb.width+this.Wf.width;break;default:v.k("Unhandled arrangement value "+this.gd.toString())}}}};function ks(a,b,c,d){if(null!==b){b.x=c;b.y=d;b=b.children;for(var e=b.length,f=0;f<e;f++){var h=b[f];ks(a,h,c+h.ka.x,d+h.ka.y)}}}Y.prototype.commitLayout=function(){this.BA();this.commitNodes();this.qz();this.pt&&this.commitLinks()};
Y.prototype.commitNodes=function(){for(var a=this.network.vertexes.i;a.next();)a.value.commit();for(a.reset();a.next();)this.layoutComments(a.value)};
Y.prototype.qz=function(){if(this.Vz===pr){for(var a=this.cB,b=[],c=null,d=this.network.vertexes.i;d.next();){var e=d.value;null===c?c=e.pb.copy():c.bi(e.pb);var f=b[e.level],f=void 0===f?Or(e):Math.max(f,Or(e));b[e.level]=f}for(d=0;d<b.length;d++)void 0===b[d]&&(b[d]=0);90===this.angle||270===this.angle?(c.Kf(this.nodeSpacing/2,this.layerSpacing),e=new w(-this.nodeSpacing/2,-this.layerSpacing/2)):(c.Kf(this.layerSpacing,this.nodeSpacing/2),e=new w(-this.layerSpacing/2,-this.nodeSpacing/2));var f=
[],c=90===this.angle||270===this.angle?c.width:c.height,h=0;if(180===this.angle||270===this.angle)for(d=0;d<a.length;d++)h+=a[d]+b[d];for(d=0;d<a.length;d++){var k=a[d]+b[d];270===this.angle?(h-=k,f.push(new z(0,h,c,k))):90===this.angle?(f.push(new z(0,h,c,k)),h+=k):180===this.angle?(h-=k,f.push(new z(h,0,k,c))):(f.push(new z(h,0,k,c)),h+=k)}this.commitLayers(f,e)}};Y.prototype.commitLayers=function(){};Y.prototype.commitLinks=function(){for(var a=this.network.edges.i;a.next();)a.value.commit()};
Y.prototype.BA=function(){for(var a=this.td.i;a.next();){var b=a.value;b instanceof hr&&ms(this,b)}};function ms(a,b){if(null!==b){a.setPortSpots(b);for(var c=b.children,d=c.length,e=0;e<d;e++)ms(a,c[e])}}
Y.prototype.setPortSpots=function(a){var b=a.alignment;if(Cr(b)){var c=this.yf===dr,d=Lr(a),e;switch(d){case 0:e=Bc;break;case 90:e=Cc;break;case 180:e=Ac;break;default:e=zc}var f=a.children,h=f.length;switch(b){case Dr:case sr:for(b=0;b<h;b++){var k=f[b],k=(c?k.jc:k.Zb).first();if(null!==k&&(k=k.link,null!==k)){var l=90===d||270===d?Ac:zc;if(1===h||b===h-1&&1===h%2)switch(d){case 0:l=Ac;break;case 90:l=zc;break;case 180:l=Bc;break;default:l=Cc}else 0===b%2&&(l=90===d||270===d?Bc:Cc);c?(a.setsPortSpot&&
(k.Ab=e),a.setsChildPortSpot&&(k.Bb=l)):(a.setsPortSpot&&(k.Ab=l),a.setsChildPortSpot&&(k.Bb=e))}}break;case Er:l=90===d||270===d?Bc:Cc;for(d=c?a.Zb:a.jc;d.next();)k=d.value.link,null!==k&&(c?(a.setsPortSpot&&(k.Ab=e),a.setsChildPortSpot&&(k.Bb=l)):(a.setsPortSpot&&(k.Ab=l),a.setsChildPortSpot&&(k.Bb=e)));break;case Fr:for(l=90===d||270===d?Ac:zc,d=c?a.Zb:a.jc;d.next();)k=d.value.link,null!==k&&(c?(a.setsPortSpot&&(k.Ab=e),a.setsChildPortSpot&&(k.Bb=l)):(a.setsPortSpot&&(k.Ab=l),a.setsChildPortSpot&&
(k.Bb=e)))}}else if(c=Lr(a),this.yf===dr)for(e=a.Zb;e.next();){if(d=e.value.link,null!==d){if(a.setsPortSpot)if(a.portSpot.Oc())switch(c){case 0:d.Ab=Bc;break;case 90:d.Ab=Cc;break;case 180:d.Ab=Ac;break;default:d.Ab=zc}else d.Ab=a.portSpot;if(a.setsChildPortSpot)if(a.childPortSpot.Oc())switch(c){case 0:d.Bb=Ac;break;case 90:d.Bb=zc;break;case 180:d.Bb=Bc;break;default:d.Bb=Cc}else d.Bb=a.childPortSpot}}else for(e=a.jc;e.next();)if(d=e.value.link,null!==d){if(a.setsPortSpot)if(a.portSpot.Oc())switch(c){case 0:d.Bb=
Bc;break;case 90:d.Bb=Cc;break;case 180:d.Bb=Ac;break;default:d.Bb=zc}else d.Bb=a.portSpot;if(a.setsChildPortSpot)if(a.childPortSpot.Oc())switch(c){case 0:d.Ab=Ac;break;case 90:d.Ab=zc;break;case 180:d.Ab=Bc;break;default:d.Ab=Cc}else d.Ab=a.childPortSpot}};function Lr(a){a=a.angle;return 45>=a?0:135>=a?90:225>=a?180:315>=a?270:0}
function Or(a){var b=Lr(a),b=90===b||270===b,c=a.layerSpacing;if(0<a.layerSpacingParentOverlap)var d=Math.min(1,a.layerSpacingParentOverlap),c=c-(b?a.height*d:a.width*d);c<(b?-a.height:-a.width)&&(c=b?-a.height:-a.width);return c}function Pr(a){var b=Lr(a),b=90===b||270===b,c=a.nodeIndent;if(0<a.nodeIndentPastParent)var d=Math.min(1,a.nodeIndentPastParent),c=c+(b?a.width*d:a.height*d);return c=Math.max(0,c)}
v.defineProperty(Y,{eL:"roots"},function(){return this.td},function(a){this.td!==a&&(v.C(a,H,Y,"roots"),this.td=a,this.G())});v.defineProperty(Y,{path:"path"},function(){return this.Er},function(a){this.Er!==a&&(v.qb(a,Y,Y,"path"),this.Er=a,this.G())});v.defineProperty(Y,{lJ:"treeStyle"},function(){return this.xs},function(a){this.gd!==a&&(v.qb(a,Y,Y,"treeStyle"),a===er||a===vr||a===wr||a===ur)&&(this.xs=a,this.G())});
v.defineProperty(Y,{Vz:"layerStyle"},function(){return this.iv},function(a){this.gd!==a&&(v.qb(a,Y,Y,"layerStyle"),a===fr||a===qr||a===pr)&&(this.iv=a,this.G())});v.defineProperty(Y,{comments:"comments"},function(){return this.sh},function(a){this.sh!==a&&(v.j(a,"boolean",Y,"comments"),this.sh=a,this.G())});v.defineProperty(Y,{Ff:"arrangement"},function(){return this.gd},function(a){this.gd!==a&&(v.qb(a,Y,Y,"arrangement"),a===gr||a===ls||a===jr)&&(this.gd=a,this.G())});
v.defineProperty(Y,{wD:"arrangementSpacing"},function(){return this.Wf},function(a){v.C(a,ia,Y,"arrangementSpacing");this.Wf.L(a)||(this.Wf.assign(a),this.G())});v.defineProperty(Y,{dL:"rootDefaults"},function(){return this.ta},function(a){this.ta!==a&&(v.C(a,hr,Y,"rootDefaults"),this.ta=a,this.G())});v.defineProperty(Y,{BJ:"alternateDefaults"},function(){return this.sa},function(a){this.sa!==a&&(v.C(a,hr,Y,"alternateDefaults"),this.sa=a,this.G())});
v.defineProperty(Y,{sorting:"sorting"},function(){return this.ta.sorting},function(a){this.ta.sorting!==a&&(v.qb(a,Y,Y,"sorting"),a===xr||a===yr||a===zr||Ar)&&(this.ta.sorting=a,this.G())});v.defineProperty(Y,{comparer:"comparer"},function(){return this.ta.comparer},function(a){this.ta.comparer!==a&&(v.j(a,"function",Y,"comparer"),this.ta.comparer=a,this.G())});
v.defineProperty(Y,{angle:"angle"},function(){return this.ta.angle},function(a){this.ta.angle!==a&&(v.j(a,"number",Y,"angle"),0===a||90===a||180===a||270===a)&&(this.ta.angle=a,this.G())});v.defineProperty(Y,{alignment:"alignment"},function(){return this.ta.alignment},function(a){this.ta.alignment!==a&&(v.qb(a,Y,Y,"alignment"),this.ta.alignment=a,this.G())});
v.defineProperty(Y,{nodeIndent:"nodeIndent"},function(){return this.ta.nodeIndent},function(a){this.ta.nodeIndent!==a&&(v.j(a,"number",Y,"nodeIndent"),0<=a&&(this.ta.nodeIndent=a,this.G()))});v.defineProperty(Y,{nodeIndentPastParent:"nodeIndentPastParent"},function(){return this.ta.nodeIndentPastParent},function(a){this.ta.nodeIndentPastParent!==a&&(v.j(a,"number",Y,"nodeIndentPastParent"),0<=a&&1>=a&&(this.ta.nodeIndentPastParent=a,this.G()))});
v.defineProperty(Y,{nodeSpacing:"nodeSpacing"},function(){return this.ta.nodeSpacing},function(a){this.ta.nodeSpacing!==a&&(v.j(a,"number",Y,"nodeSpacing"),this.ta.nodeSpacing=a,this.G())});v.defineProperty(Y,{layerSpacing:"layerSpacing"},function(){return this.ta.layerSpacing},function(a){this.ta.layerSpacing!==a&&(v.j(a,"number",Y,"layerSpacing"),this.ta.layerSpacing=a,this.G())});
v.defineProperty(Y,{layerSpacingParentOverlap:"layerSpacingParentOverlap"},function(){return this.ta.layerSpacingParentOverlap},function(a){this.ta.layerSpacingParentOverlap!==a&&(v.j(a,"number",Y,"layerSpacingParentOverlap"),0<=a&&1>=a&&(this.ta.layerSpacingParentOverlap=a,this.G()))});v.defineProperty(Y,{compaction:"compaction"},function(){return this.ta.compaction},function(a){this.ta.compaction!==a&&(v.qb(a,Y,Y,"compaction"),a===Ir||a===Kr)&&(this.ta.compaction=a,this.G())});
v.defineProperty(Y,{breadthLimit:"breadthLimit"},function(){return this.ta.breadthLimit},function(a){this.ta.breadthLimit!==a&&(v.j(a,"number",Y,"breadthLimit"),0<=a&&(this.ta.breadthLimit=a,this.G()))});v.defineProperty(Y,{rowSpacing:"rowSpacing"},function(){return this.ta.rowSpacing},function(a){this.ta.rowSpacing!==a&&(v.j(a,"number",Y,"rowSpacing"),this.ta.rowSpacing=a,this.G())});
v.defineProperty(Y,{rowIndent:"rowIndent"},function(){return this.ta.rowIndent},function(a){this.ta.rowIndent!==a&&(v.j(a,"number",Y,"rowIndent"),0<=a&&(this.ta.rowIndent=a,this.G()))});v.defineProperty(Y,{commentSpacing:"commentSpacing"},function(){return this.ta.commentSpacing},function(a){this.ta.commentSpacing!==a&&(v.j(a,"number",Y,"commentSpacing"),this.ta.commentSpacing=a,this.G())});
v.defineProperty(Y,{commentMargin:"commentMargin"},function(){return this.ta.commentMargin},function(a){this.ta.commentMargin!==a&&(v.j(a,"number",Y,"commentMargin"),this.ta.commentMargin=a,this.G())});v.defineProperty(Y,{setsPortSpot:"setsPortSpot"},function(){return this.ta.setsPortSpot},function(a){this.ta.setsPortSpot!==a&&(v.j(a,"boolean",Y,"setsPortSpot"),this.ta.setsPortSpot=a,this.G())});
v.defineProperty(Y,{portSpot:"portSpot"},function(){return this.ta.portSpot},function(a){v.C(a,L,Y,"portSpot");this.ta.portSpot.L(a)||(this.ta.portSpot=a,this.G())});v.defineProperty(Y,{setsChildPortSpot:"setsChildPortSpot"},function(){return this.ta.setsChildPortSpot},function(a){this.ta.setsChildPortSpot!==a&&(v.j(a,"boolean",Y,"setsChildPortSpot"),this.ta.setsChildPortSpot=a,this.G())});
v.defineProperty(Y,{childPortSpot:"childPortSpot"},function(){return this.ta.childPortSpot},function(a){v.C(a,L,Y,"childPortSpot");this.ta.childPortSpot.L(a)||(this.ta.childPortSpot=a,this.G())});v.defineProperty(Y,{MJ:"alternateSorting"},function(){return this.sa.sorting},function(a){this.sa.sorting!==a&&(v.qb(a,Y,Y,"alternateSorting"),a===xr||a===yr||a===zr||Ar)&&(this.sa.sorting=a,this.G())});
v.defineProperty(Y,{AJ:"alternateComparer"},function(){return this.sa.comparer},function(a){this.sa.comparer!==a&&(v.j(a,"function",Y,"alternateComparer"),this.sa.comparer=a,this.G())});v.defineProperty(Y,{uJ:"alternateAngle"},function(){return this.sa.angle},function(a){this.sa.angle!==a&&(v.j(a,"number",Y,"alternateAngle"),0===a||90===a||180===a||270===a)&&(this.sa.angle=a,this.G())});
v.defineProperty(Y,{tJ:"alternateAlignment"},function(){return this.sa.alignment},function(a){this.sa.alignment!==a&&(v.qb(a,Y,Y,"alternateAlignment"),this.sa.alignment=a,this.G())});v.defineProperty(Y,{EJ:"alternateNodeIndent"},function(){return this.sa.nodeIndent},function(a){this.sa.nodeIndent!==a&&(v.j(a,"number",Y,"alternateNodeIndent"),0<=a&&(this.sa.nodeIndent=a,this.G()))});
v.defineProperty(Y,{FJ:"alternateNodeIndentPastParent"},function(){return this.sa.nodeIndentPastParent},function(a){this.sa.nodeIndentPastParent!==a&&(v.j(a,"number",Y,"alternateNodeIndentPastParent"),0<=a&&1>=a&&(this.sa.nodeIndentPastParent=a,this.G()))});v.defineProperty(Y,{GJ:"alternateNodeSpacing"},function(){return this.sa.nodeSpacing},function(a){this.sa.nodeSpacing!==a&&(v.j(a,"number",Y,"alternateNodeSpacing"),this.sa.nodeSpacing=a,this.G())});
v.defineProperty(Y,{CJ:"alternateLayerSpacing"},function(){return this.sa.layerSpacing},function(a){this.sa.layerSpacing!==a&&(v.j(a,"number",Y,"alternateLayerSpacing"),this.sa.layerSpacing=a,this.G())});v.defineProperty(Y,{DJ:"alternateLayerSpacingParentOverlap"},function(){return this.sa.layerSpacingParentOverlap},function(a){this.sa.layerSpacingParentOverlap!==a&&(v.j(a,"number",Y,"alternateLayerSpacingParentOverlap"),0<=a&&1>=a&&(this.sa.layerSpacingParentOverlap=a,this.G()))});
v.defineProperty(Y,{zJ:"alternateCompaction"},function(){return this.sa.compaction},function(a){this.sa.compaction!==a&&(v.qb(a,Y,Y,"alternateCompaction"),a===Ir||a===Kr)&&(this.sa.compaction=a,this.G())});v.defineProperty(Y,{vJ:"alternateBreadthLimit"},function(){return this.sa.breadthLimit},function(a){this.sa.breadthLimit!==a&&(v.j(a,"number",Y,"alternateBreadthLimit"),0<=a&&(this.sa.breadthLimit=a,this.G()))});
v.defineProperty(Y,{JJ:"alternateRowSpacing"},function(){return this.sa.rowSpacing},function(a){this.sa.rowSpacing!==a&&(v.j(a,"number",Y,"alternateRowSpacing"),this.sa.rowSpacing=a,this.G())});v.defineProperty(Y,{IJ:"alternateRowIndent"},function(){return this.sa.rowIndent},function(a){this.sa.rowIndent!==a&&(v.j(a,"number",Y,"alternateRowIndent"),0<=a&&(this.sa.rowIndent=a,this.G()))});
v.defineProperty(Y,{yJ:"alternateCommentSpacing"},function(){return this.sa.commentSpacing},function(a){this.sa.commentSpacing!==a&&(v.j(a,"number",Y,"alternateCommentSpacing"),this.sa.commentSpacing=a,this.G())});v.defineProperty(Y,{xJ:"alternateCommentMargin"},function(){return this.sa.commentMargin},function(a){this.sa.commentMargin!==a&&(v.j(a,"number",Y,"alternateCommentMargin"),this.sa.commentMargin=a,this.G())});
v.defineProperty(Y,{LJ:"alternateSetsPortSpot"},function(){return this.sa.setsPortSpot},function(a){this.sa.setsPortSpot!==a&&(v.j(a,"boolean",Y,"alternateSetsPortSpot"),this.sa.setsPortSpot=a,this.G())});v.defineProperty(Y,{HJ:"alternatePortSpot"},function(){return this.sa.portSpot},function(a){v.C(a,L,Y,"alternatePortSpot");this.sa.portSpot.L(a)||(this.sa.portSpot=a,this.G())});
v.defineProperty(Y,{KJ:"alternateSetsChildPortSpot"},function(){return this.sa.setsChildPortSpot},function(a){this.sa.setsChildPortSpot!==a&&(v.j(a,"boolean",Y,"alternateSetsChildPortSpot"),this.sa.setsChildPortSpot=a,this.G())});v.defineProperty(Y,{wJ:"alternateChildPortSpot"},function(){return this.sa.childPortSpot},function(a){v.C(a,L,Y,"alternateChildPortSpot");this.sa.childPortSpot.L(a)||(this.sa.childPortSpot=a,this.G())});var cr;Y.PathDefault=cr=v.p(Y,"PathDefault",-1);var dr;
Y.PathDestination=dr=v.p(Y,"PathDestination",0);var kr;Y.PathSource=kr=v.p(Y,"PathSource",1);var xr;Y.SortingForwards=xr=v.p(Y,"SortingForwards",10);var yr;Y.SortingReverse=yr=v.p(Y,"SortingReverse",11);var zr;Y.SortingAscending=zr=v.p(Y,"SortingAscending",12);var Ar;Y.SortingDescending=Ar=v.p(Y,"SortingDescending",13);var cs;Y.AlignmentCenterSubtrees=cs=v.p(Y,"AlignmentCenterSubtrees",20);var Br;Y.AlignmentCenterChildren=Br=v.p(Y,"AlignmentCenterChildren",21);var Mr;
Y.AlignmentStart=Mr=v.p(Y,"AlignmentStart",22);var Nr;Y.AlignmentEnd=Nr=v.p(Y,"AlignmentEnd",23);var Dr;Y.AlignmentBus=Dr=v.p(Y,"AlignmentBus",24);var sr;Y.AlignmentBusBranching=sr=v.p(Y,"AlignmentBusBranching",25);var Er;Y.AlignmentTopLeftBus=Er=v.p(Y,"AlignmentTopLeftBus",26);var Fr;Y.AlignmentBottomRightBus=Fr=v.p(Y,"AlignmentBottomRightBus",27);var Ir;Y.CompactionNone=Ir=v.p(Y,"CompactionNone",30);var Kr;Y.CompactionBlock=Kr=v.p(Y,"CompactionBlock",31);var er;
Y.StyleLayered=er=v.p(Y,"StyleLayered",40);var wr;Y.StyleLastParents=wr=v.p(Y,"StyleLastParents",41);var vr;Y.StyleAlternating=vr=v.p(Y,"StyleAlternating",42);var ur;Y.StyleRootOnly=ur=v.p(Y,"StyleRootOnly",43);var gr;Y.ArrangementVertical=gr=v.p(Y,"ArrangementVertical",50);var ls;Y.ArrangementHorizontal=ls=v.p(Y,"ArrangementHorizontal",51);var jr;Y.ArrangementFixedRoots=jr=v.p(Y,"ArrangementFixedRoots",52);var fr;Y.LayerIndividual=fr=v.p(Y,"LayerIndividual",60);var qr;
Y.LayerSiblings=qr=v.p(Y,"LayerSiblings",61);var pr;Y.LayerUniform=pr=v.p(Y,"LayerUniform",62);function ir(){wa.call(this)}v.Ga(ir,wa);v.ga("TreeNetwork",ir);ir.prototype.createVertex=function(){return new hr};ir.prototype.createEdge=function(){return new ns};
function hr(){ya.call(this);this.initialized=!1;this.parent=null;this.children=[];this.maxGenerationCount=this.maxChildrenCount=this.descendantCount=this.level=0;this.comments=null;this.ka=new w(0,0);this.eb=new ia(0,0);this.La=new w(0,0);this.yp=this.xp=this.NI=!1;this.Mt=this.rt=null;this.sorting=xr;this.comparer=pp;this.angle=0;this.alignment=Br;this.nodeIndentPastParent=this.nodeIndent=0;this.nodeSpacing=20;this.layerSpacing=50;this.layerSpacingParentOverlap=0;this.compaction=Kr;this.breadthLimit=
0;this.rowSpacing=25;this.commentSpacing=this.rowIndent=10;this.commentMargin=20;this.setsPortSpot=!0;this.portSpot=yc;this.setsChildPortSpot=!0;this.childPortSpot=yc}v.Ga(hr,ya);v.ga("TreeVertex",hr);
hr.prototype.copyInheritedPropertiesFrom=function(a){null!==a&&(this.sorting=a.sorting,this.comparer=a.comparer,this.angle=a.angle,this.alignment=a.alignment,this.nodeIndent=a.nodeIndent,this.nodeIndentPastParent=a.nodeIndentPastParent,this.nodeSpacing=a.nodeSpacing,this.layerSpacing=a.layerSpacing,this.layerSpacingParentOverlap=a.layerSpacingParentOverlap,this.compaction=a.compaction,this.breadthLimit=a.breadthLimit,this.rowSpacing=a.rowSpacing,this.rowIndent=a.rowIndent,this.commentSpacing=a.commentSpacing,
this.commentMargin=a.commentMargin,this.setsPortSpot=a.setsPortSpot,this.portSpot=a.portSpot,this.setsChildPortSpot=a.setsChildPortSpot,this.childPortSpot=a.childPortSpot)};v.u(hr,{Fm:"childrenCount"},function(){return this.children.length});v.defineProperty(hr,{cL:"relativePosition"},function(){return this.ka},function(a){this.ka.set(a)});v.defineProperty(hr,{oL:"subtreeSize"},function(){return this.eb},function(a){this.eb.set(a)});
v.defineProperty(hr,{nL:"subtreeOffset"},function(){return this.La},function(a){this.La.set(a)});function ns(){Aa.call(this);this.Lr=new w(0,0)}v.Ga(ns,Aa);v.ga("TreeEdge",ns);
ns.prototype.commit=function(){var a=this.link;if(null!==a&&!a.pl){var b=this.network.Pb,c=null,d=null;switch(b.yf){case dr:c=this.fromVertex;d=this.toVertex;break;case kr:c=this.toVertex;d=this.fromVertex;break;default:v.k("Unhandled path value "+b.yf.toString())}if(null!==c&&null!==d)if(b=this.Lr,0!==b.x||0!==b.y||c.NI){var d=c.pb,e=Lr(c),f=Or(c),h=c.rowSpacing;a.updateRoute();var k=a.Ge===nh,l=a.hc,m=0,n,p;a.Bl();if(l||k){for(m=2;4<a.ma;)a.UE(2);n=a.l(1);p=a.l(2)}else{for(m=1;3<a.ma;)a.UE(1);n=
a.l(0);p=a.l(a.ma-1)}var q=a.l(a.ma-1),r=0;0===e?(c.alignment===Nr?(r=d.bottom+b.y,0===b.y&&n.y>q.y+c.rowIndent&&(r=Math.min(r,Math.max(n.y,r-Pr(c))))):c.alignment===Mr?(r=d.top+b.y,0===b.y&&n.y<q.y-c.rowIndent&&(r=Math.max(r,Math.min(n.y,r+Pr(c))))):r=c.xp||c.yp&&1===c.maxGenerationCount?d.top-c.La.y+b.y:d.y+d.height/2+b.y,k?(a.w(m,n.x,r),m++,a.w(m,d.right+f,r),m++,a.w(m,d.right+f+(b.x-h)/3,r),m++,a.w(m,d.right+f+2*(b.x-h)/3,r),m++,a.w(m,d.right+f+(b.x-h),r),m++,a.w(m,p.x,r)):(l&&(a.w(m,d.right+
f/2,n.y),m++),a.w(m,d.right+f/2,r),m++,a.w(m,d.right+f+b.x-(l?h/2:h),r),m++,l&&a.w(m,a.l(m-1).x,p.y))):90===e?(c.alignment===Nr?(r=d.right+b.x,0===b.x&&n.x>q.x+c.rowIndent&&(r=Math.min(r,Math.max(n.x,r-Pr(c))))):c.alignment===Mr?(r=d.left+b.x,0===b.x&&n.x<q.x-c.rowIndent&&(r=Math.max(r,Math.min(n.x,r+Pr(c))))):r=c.xp||c.yp&&1===c.maxGenerationCount?d.left-c.La.x+b.x:d.x+d.width/2+b.x,k?(a.w(m,r,n.y),m++,a.w(m,r,d.bottom+f),m++,a.w(m,r,d.bottom+f+(b.y-h)/3),m++,a.w(m,r,d.bottom+f+2*(b.y-h)/3),m++,
a.w(m,r,d.bottom+f+(b.y-h)),m++,a.w(m,r,p.y)):(l&&(a.w(m,n.x,d.bottom+f/2),m++),a.w(m,r,d.bottom+f/2),m++,a.w(m,r,d.bottom+f+b.y-(l?h/2:h)),m++,l&&a.w(m,p.x,a.l(m-1).y))):180===e?(c.alignment===Nr?(r=d.bottom+b.y,0===b.y&&n.y>q.y+c.rowIndent&&(r=Math.min(r,Math.max(n.y,r-Pr(c))))):c.alignment===Mr?(r=d.top+b.y,0===b.y&&n.y<q.y-c.rowIndent&&(r=Math.max(r,Math.min(n.y,r+Pr(c))))):r=c.xp||c.yp&&1===c.maxGenerationCount?d.top-c.La.y+b.y:d.y+d.height/2+b.y,k?(a.w(m,n.x,r),m++,a.w(m,d.left-f,r),m++,a.w(m,
d.left-f+(b.x+h)/3,r),m++,a.w(m,d.left-f+2*(b.x+h)/3,r),m++,a.w(m,d.left-f+(b.x+h),r),m++,a.w(m,p.x,r)):(l&&(a.w(m,d.left-f/2,n.y),m++),a.w(m,d.left-f/2,r),m++,a.w(m,d.left-f+b.x+(l?h/2:h),r),m++,l&&a.w(m,a.l(m-1).x,p.y))):270===e?(c.alignment===Nr?(r=d.right+b.x,0===b.x&&n.x>q.x+c.rowIndent&&(r=Math.min(r,Math.max(n.x,r-Pr(c))))):c.alignment===Mr?(r=d.left+b.x,0===b.x&&n.x<q.x-c.rowIndent&&(r=Math.max(r,Math.min(n.x,r+Pr(c))))):r=c.xp||c.yp&&1===c.maxGenerationCount?d.left-c.La.x+b.x:d.x+d.width/
2+b.x,k?(a.w(m,r,n.y),m++,a.w(m,r,d.top-f),m++,a.w(m,r,d.top-f+(b.y+h)/3),m++,a.w(m,r,d.top-f+2*(b.y+h)/3),m++,a.w(m,r,d.top-f+(b.y+h)),m++,a.w(m,r,p.y)):(l&&(a.w(m,n.x,d.top-f/2),m++),a.w(m,r,d.top-f/2),m++,a.w(m,r,d.top-f+b.y+(l?h/2:h)),m++,l&&a.w(m,p.x,a.l(m-1).y))):v.k("Invalid angle "+e);a.Oi()}else e=c,f=d,a=this.link,c=Lr(e),c!==Lr(f)&&(b=Or(e),d=e.pb,e=f.pb,0===c&&e.left-d.right<b+1||90===c&&e.top-d.bottom<b+1||180===c&&d.left-e.right<b+1||270===c&&d.top-e.bottom<b+1||(a.updateRoute(),e=a.Ge===
nh,f=a.hc,h=Cr(this.fromVertex.alignment),a.Bl(),0===c?(c=d.right+b/2,e?4===a.ma&&(b=a.l(3).y,a.Y(1,c-20,a.l(1).y),a.w(2,c-20,b),a.w(3,c,b),a.w(4,c+20,b),a.Y(5,a.l(5).x,b)):f?h?a.Y(3,a.l(2).x,a.l(4).y):6===a.ma&&(a.Y(2,c,a.l(2).y),a.Y(3,c,a.l(3).y)):4===a.ma?a.w(2,c,a.l(2).y):3===a.ma?a.Y(1,c,a.l(2).y):2===a.ma&&a.w(1,c,a.l(1).y)):90===c?(b=d.bottom+b/2,e?4===a.ma&&(c=a.l(3).x,a.Y(1,a.l(1).x,b-20),a.w(2,c,b-20),a.w(3,c,b),a.w(4,c,b+20),a.Y(5,c,a.l(5).y)):f?h?a.Y(3,a.l(2).x,a.l(4).y):6===a.ma&&(a.Y(2,
a.l(2).x,b),a.Y(3,a.l(3).x,b)):4===a.ma?a.w(2,a.l(2).x,b):3===a.ma?a.Y(1,a.l(2).x,b):2===a.ma&&a.w(1,a.l(1).x,b)):180===c?(c=d.left-b/2,e?4===a.ma&&(b=a.l(3).y,a.Y(1,c+20,a.l(1).y),a.w(2,c+20,b),a.w(3,c,b),a.w(4,c-20,b),a.Y(5,a.l(5).x,b)):f?h?a.Y(3,a.l(2).x,a.l(4).y):6===a.ma&&(a.Y(2,c,a.l(2).y),a.Y(3,c,a.l(3).y)):4===a.ma?a.w(2,c,a.l(2).y):3===a.ma?a.Y(1,c,a.l(2).y):2===a.ma&&a.w(1,c,a.l(1).y)):270===c&&(b=d.top-b/2,e?4===a.ma&&(c=a.l(3).x,a.Y(1,a.l(1).x,b+20),a.w(2,c,b+20),a.w(3,c,b),a.w(4,c,b-
20),a.Y(5,c,a.l(5).y)):f?h?a.Y(3,a.l(2).x,a.l(4).y):6===a.ma&&(a.Y(2,a.l(2).x,b),a.Y(3,a.l(3).x,b)):4===a.ma?a.w(2,a.l(2).x,b):3===a.ma?a.Y(1,a.l(2).x,b):2===a.ma&&a.w(1,a.l(1).x,b)),a.Oi()))}};v.defineProperty(ns,{bL:"relativePoint"},function(){return this.Lr},function(a){this.Lr.set(a)});function hn(){R.call(this);this.Oe=null}v.Ga(hn,R);hn.prototype.cloneProtected=function(a){R.prototype.cloneProtected.call(this,a);a.element=this.Oe.cloneNode(!0)};
hn.prototype.toString=function(){return"HTMLHost("+this.Oe.toString()+")#"+v.cd(this)};hn.prototype.Uj=function(a,b){var c=this.Oe;if(null!==c){var d=this.fb(Kb);d.x-=this.Z.width/2;d.y-=this.Z.height/2;d.x-=this.Z.x;d.y-=this.Z.y;var d=b.CF(d),e=b.fl;null===e||e.contains(c)||e.appendChild(c);e=this.transform;c.style.transform="matrix("+e.m11+","+e.m12+","+e.m21+","+e.m22+","+e.dx+","+e.dy+")";c.style.transformOrigin="0 0";e=d.y;c.style.left=d.x+"px";c.style.top=e+"px"}};
hn.prototype.ip=function(a,b,c,d){var e=this.xa;isFinite(e.width)&&(a=e.width);isFinite(e.height)&&(b=e.height);var e=this.af,f=this.ug;c=Math.max(c,f.width);d=Math.max(d,f.height);a=Math.min(e.width,a);b=Math.min(e.height,b);a=Math.max(c,a);b=Math.max(d,b);c=this.Oe;null!==c&&(b=c.getBoundingClientRect(),a=b.width,b=b.height);eb(this.Jc,a,b);vl(this,0,0,a,b)};hn.prototype.Li=function(a,b,c,d){zl(this,a,b,c,d)};v.u(hn,{Fa:"naturalBounds"},function(){return this.Jc});
v.defineProperty(hn,{element:"element"},function(){return this.Oe},function(a){var b=this.Oe;b!==a&&(a instanceof HTMLElement||v.k("HTMLHost.element must be an instance of HTMLElement."),this.Oe=a,a.className="HTMLHost",this.h("element",b,a),this.pa())});ea.version="1.6.0-beta3";
window&&(window.module&&"object"===typeof window.module&&"object"===typeof window.module.exports?window.module.exports=ea:window.define&&"function"===typeof window.define&&window.define.amd?(window.go=ea,window.define(ea)):window.go=ea);"undefined"!==typeof module&&"object"===typeof module.exports&&(module.exports=ea); })(window);


/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Merging js: ../js/NodeLabelDraggingTool.js begins */
/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */


"use strict";
/*
*  Copyright (C) 1998-2016 by Northwoods Software Corporation. All Rights Reserved.
*/

// A custom Tool for moving a label on a Node

/**
* @constructor
* @extends Tool
* @class
* This tool only works when the Node has a label (any GraphObject) marked with
* { _isNodeLabel: true } that is positioned in a Spot Panel.
* It works by modifying that label's GraphObject.alignment property to have an
* offset from the center of the panel.
*/
function NodeLabelDraggingTool() {
  go.Tool.call(this);
  this.name = "NodeLabelDragging";

  /** @type {GraphObject} */
  this.label = null;
  /** @type {Point} */
  this._originalAlignment = null;
  /** @type {Point} */
  this._originalCenter = null;
}
go.Diagram.inherit(NodeLabelDraggingTool, go.Tool);

/**
* This tool can only start if the mouse has moved enough so that it is not a click,
* and if the mouse down point is on a GraphObject "label" in a Spot Panel,
* as determined by findLabel().
* @this {NodeLabelDraggingTool}
* @return {boolean}
*/
NodeLabelDraggingTool.prototype.canStart = function() {
  if (!go.Tool.prototype.canStart.call(this)) return false;
  var diagram = this.diagram;
  if (diagram === null) return false;
  // require left button & that it has moved far enough away from the mouse down point, so it isn't a click
  var e = diagram.lastInput;
  if (!e.left) return false;
  if (!this.isBeyondDragSize()) return false;

  return this.findLabel() !== null;
}

/**
* From the GraphObject at the mouse point, search up the visual tree until we get to
* an object that has the "_isNodeLabel" property set to true, that is in a Spot Panel,
* and that is not the first element of that Panel (i.e. not the main element of the panel).
* @this {NodeLabelDraggingTool}
* @return {GraphObject} This returns null if no such label is at the mouse down point.
*/
NodeLabelDraggingTool.prototype.findLabel = function() {
  var diagram = this.diagram;
  var e = diagram.firstInput;
  var elt = diagram.findObjectAt(e.documentPoint, null, null);

  if (elt === null || !(elt.part instanceof go.Node)) return null;
  while (elt.panel !== null && elt.panel.type === go.Panel.Spot && elt.panel.elt(0) !== elt) {
    if (elt._isNodeLabel) return elt;
    elt = elt.panel;
  }
  return null;
};

/**
* Start a transaction, call findLabel and remember it as the "label" property,
* and remember the original value for the label's alignment property.
* @this {NodeLabelDraggingTool}
*/
NodeLabelDraggingTool.prototype.doActivate = function() {
  this.startTransaction("Shifted Label");
  this.label = this.findLabel();
  if (this.label !== null) {
    this._originalAlignment = this.label.alignment.copy();
    var main = this.label.panel.findMainElement();
    this._originalCenter = main.getDocumentPoint(go.Spot.Center);
  }
  go.Tool.prototype.doActivate.call(this);
}

/**
* Stop any ongoing transaction.
* @this {NodeLabelDraggingTool}
*/
NodeLabelDraggingTool.prototype.doDeactivate = function() {
  go.Tool.prototype.doDeactivate.call(this);
  this.stopTransaction();
}

/**
* Clear any reference to a label element.
* @this {NodeLabelDraggingTool}
*/
NodeLabelDraggingTool.prototype.doStop = function() {
  this.label = null;
  go.Tool.prototype.doStop.call(this);
}

/**
* Restore the label's original value for GraphObject.alignment.
* @this {NodeLabelDraggingTool}
*/
NodeLabelDraggingTool.prototype.doCancel = function() {
  if (this.label !== null) {
    this.label.alignment = this._originalAlignment;
  }
  go.Tool.prototype.doCancel.call(this);
}

/**
* During the drag, call updateAlignment in order to set the GraphObject.alignment of the label.
* @this {NodeLabelDraggingTool}
*/
NodeLabelDraggingTool.prototype.doMouseMove = function() {
  if (!this.isActive) return;
  this.updateAlignment();
}

/**
* At the end of the drag, update the alignment of the label and finish the tool,
* completing a transaction.
* @this {NodeLabelDraggingTool}
*/
NodeLabelDraggingTool.prototype.doMouseUp = function() {
  if (!this.isActive) return;
  this.updateAlignment();
  this.transactionResult = "Shifted Label";
  this.stopTool();
}

/**
* Save the label's GraphObject.alignment as an absolute offset from the center of the Spot Panel
* that the label is in.
* @this {NodeLabelDraggingTool}
*/
NodeLabelDraggingTool.prototype.updateAlignment = function() {
  if (this.label === null) return;
  var last = this.diagram.lastInput.documentPoint;
  var cntr = this._originalCenter;
  this.label.alignment = new go.Spot(0.5, 0.5, last.x - cntr.x, last.y - cntr.y);
}
